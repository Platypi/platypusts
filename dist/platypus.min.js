"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),plat;!function(t){"use strict;";function e(){}function n(t,e,n,i,r,o){Object.defineProperty(t,e,{value:n,enumerable:!0===i,configurable:!0===r,writable:!0===o})}function i(t,e,n,i,r){Object.defineProperty(t,e,{get:function(){return n},enumerable:!0===i,configurable:!0===r})}function r(t,e,i){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];if(b(i))return i;var l,u,h;return h=y(e)?e:e?function(t,e,i){n(t,e,i,!0,!0,!0)}:function(t,e,n){t[e]=n},v(o)&&o.push(i),S(function(e,n){a(e)&&S(function(n){if(u=e[n],t){if(x(u))return void r(t,h,i[n]||(i[n]=[]),u);if(w(u))return void h(i,n,new Date(u.getTime()));if(f(u))return void h(i,n,new RegExp(u));if(c(u))return void h(i,n,u.cloneNode(!0));if(p(u))return void h(i,n,u);if(a(u))return void r(t,h,i[n]||(i[n]={}),u)}h(i,n,u)},l=Object.keys(e))},o),i}function o(t,e){if(!a(t))return t;if(w(t))return new Date(t.getTime());if(f(t))return new RegExp(t);if(c(t))return t.cloneNode(e);if(p(t))return t;if(s(t))return new t.constructor(t.message);var n={};return x(t)&&(n=[]),m(e)&&e?r(!0,!1,n,t):r(!1,!1,n,t)}function s(t){return _i.call(t)===fi}function a(t){return null!=t&&"object"==typeof t}function l(t){return!!(t&&t.document&&t.setInterval)}function u(t){return!(!t||t.nodeType!==Node.DOCUMENT_NODE)}function c(t){return!(!t||"number"!=typeof t.nodeType)}function h(t){return!(!t||t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)}function p(t){return a(t)&&_i.call(t)===di}function _(t){return"string"==typeof t||a(t)&&_i.call(t)===Ci}function f(t){return a(t)&&_i.call(t)===bi}function d(t){return a(t)&&(_i.call(t)===xi||y(t.then))}function v(t){return!!b(t)||(_(t)||x(t)?0===t.length:!!a(t)&&0===Object.keys(t).length)}function m(t){return!0===t||!1===t||a(t)&&_i.call(t)===mi}function g(t){return("number"==typeof t||a(t)&&_i.call(t)===yi)&&!isNaN(t)}function y(t){return"function"==typeof t}function b(t){return null===t||void 0===t}function C(t){return void 0===t}function x(t){return hi?Array.isArray(t):_i.call(t)===vi}function E(t){return!(b(t)||l(t)||y(t))&&(_(t)||t.length>=0)}function w(t){return"object"==typeof t&&_i.call(t)===gi}function T(t,e,n){var i=[];return b(e)?i:y(e.filter)?e.filter(t,n):(S(function(e,n,r){t(e,n,r)&&i.push(e)},e),i)}function N(t,e){return T(function(e){return!P(function(t,n){return e[n]!==t},t)},e)}function S(t,e,n){if(b(e)||!a(e)&&!E(e))return e;var i,r,o;if(y(e.forEach))return e.forEach(t,n);if(E(e))for(i=0,o=e.length;i<o;++i)t.call(n,e[i],i,e);else{var s=Object.keys(e);for(o=s.length;s.length>0;)r=s.shift(),t.call(n,e[r],r,e)}return e}function k(t,e,n){var i=[];return b(e)?i:y(e.map)?e.map(t,n):(S(function(r,o){i.push(t.call(n,r,o,e))},e),i)}function I(t,e,n){return(Nt=Nt||plat.acquire(Ft)).all(k(t,e,n))}function R(t,e,n,i){var r=(Nt=Nt||plat.acquire(Ft)).resolve([]);if(!x(e))return r;t=t.bind(n);var o=function(e,n,i,r){return e.then(function(e){return t(n,i,r).then(function(t){return e.concat(t)})})};return!0===i?e.reduceRight(o,r):e.reduce(o,r)}function j(t,e,n){return R(t,e,n)}function A(t,e,n){return R(t,e,n,!0)}function L(t,e){return k(function(e){return e[t]},e)}function P(t,e,n){if(b(e)||y(e))return!1;var i,r,o;if(y(e.some))return e.some(t,n);if(E(e)){for(i=0,o=e.length;i<o;++i)if(!0===t.call(n,e[i],i,e))return!0}else{var s=Object.keys(e);for(o=s.length;s.length>0;)if(r=s.shift(),!0===t.call(n,e[r],r,e))return!0}return!1}function O(t,e,n){return $(t,0,e,n)}function $(t,e,n,i){var r=setTimeout(function(){t.apply(i,n)},e);return function(){clearTimeout(r)}}function F(t,e,n,i){var r=setInterval(function(){t.apply(i,n)},e);return function(){clearInterval(r)}}function M(t,n){var i=(St=St||plat.acquire(Mt)).requestAnimationFrame;if(C(i))return O(function(){t.call(n,Date.now())});var r=i(t.bind(n)),o=St.cancelAnimationFrame||e;return function(){o(r)}}function D(t){function e(){return t+n.join("")}b(t)&&(t="");var n=pi[t];b(n)&&(n=pi[t]=["0","/"]);for(var i,r=n.length;r--;){if(57===(i=n[r].charCodeAt(0)))return n[r]="A",e();if(90===i)return n[r]="a",e();if(122!==i)return n[r]=String.fromCharCode(i+1),e();n[r]="0"}return n.unshift("0"),e()}function z(t){return!_(t)||v(t)?t:(t=t.charAt(0).toLowerCase()+t.slice(1),kt=kt||plat.acquire(Ut).camelCaseRegex,t.replace(kt,function(t,e,n,i){return i?n.toUpperCase():n}))}function B(t,e){return!_(t)||v(t)?t:(b(e)&&(e=""),It=It||plat.acquire(Ut).capitalCaseRegex,t.replace(It,function(t,n){return n?e+t.toLowerCase():t.toLowerCase()}))}function U(t,e){return b(t)||delete t[e],t}function V(t,e){return b(t)?t:t[e]}function q(t){if(!v(t)){for(var e,n=(t=t.replace(/^\?+/,"")).split("&"),i={},r=n.length,o=0;o<r;++o)i[(e=n[o].split("="))[0]]=e[1];return i}}function H(t){var e="";return e+=k(function(t,e){return e+"="+t},t).join("&"),v(e)||(e="?"+e),e}function Q(t){return x(t)?t.reduce(function(t,e){return t&&!1!==e},!0):!m(t)||t}function W(t,e,n){var i=h(e),r=!c(e),o=i?e:(Rt||(Rt=plat.acquire(zt))).createDocumentFragment();r&&(e=o);var s,a=x(t)?t:Array.prototype.slice.call(t),l=a.length;if(!0===n){var u=void 0;for(s=0;s<l;++s)u=a[s].cloneNode(!0),o.insertBefore(u,null)}else for(s=0;s<l;++s)o.insertBefore(a[s],null);return i||r||e.appendChild(o),e}function Y(t){for(var e=Array.prototype.slice.call(t.childNodes);e.length>0;)t.removeChild(e.pop())}function X(t,e){if(y(t.push)||(t=Array.prototype.slice.call(t)),b(e))for(var n;t.length>0;)b(e=(n=t.pop()).parentNode)||e.removeChild(n);else G(t,e)}function G(t,e){for(;t.length>0;)e.removeChild(t.pop())}function J(t){St=St||(St=plat.acquire(Mt)),Rt=Rt||(Rt=plat.acquire(zt));var e=Ei.exec(t),n=Rt.createElement("div");if(b(e))return(n=ot(n,t)).removeChild(n.lastChild);t=t.trim();var i=e[1];if(St.pushState&&C(Ii[i]))return ot(n,t);if("body"===i)return(n=ot(Rt.createElement("html"),t)).removeChild(n.lastChild);var r=Ri[i]||Ri._default,o=r[0];for(n=ot(n,r[1]+t+r[2]);o-- >0;)n=n.lastChild;return n}function K(t,e){if(Y(t),!v(e)){var n=J(e);return n.childNodes.length>0?W(n.childNodes,t):t.insertBefore(n,null),t}}function Z(t,e,n){if(!b(t)&&a(e)){C(n)&&(n=null);var i;if(c(e))return i=e,e=Array.prototype.slice.call(i.childNodes),t.insertBefore(i,n),e;y(e.push)||(e=Array.prototype.slice.call(e)),Rt=Rt||(Rt=plat.acquire(zt));var r=e.length;i=Rt.createDocumentFragment();for(var o=0;o<r;++o)i.insertBefore(e[o],null);return t.insertBefore(i,n),e}}function tt(t){var e=t.parentNode,n=Z(e,t.childNodes,t);return e.removeChild(t),n}function et(t,e){if(b(e))return e;if(t.nodeType===Node.ELEMENT_NODE)for(var n=t.attributes,i=n.length,r=void 0,o=0;o<i;++o)r=n[o],e.setAttribute(r.name,r.value);var s=t.parentNode;return Z(e,t.childNodes),s.replaceChild(e,t),e}function nt(t){var e=(Rt=Rt||(Rt=plat.acquire(zt))).createDocumentFragment();return v(t)||K(e,t),e}function it(t,e){if(!b(t)){var n,i=t.nextSibling,r=t.parentNode;if(b(e)&&(e=null),!b(r)&&(b(e)||e.parentNode===r))for(;i!==e;)n=i.nextSibling,r.removeChild(i),i=n}}function rt(t,e){b(t)||(it(t,e),st(t),st(e))}function ot(t,e){return(St=St||(St=plat.acquire(Mt))).msApp?MSApp.execUnsafeLocalFunction(function(){t.innerHTML=e}):t.innerHTML=e,t}function st(t){if(c(t)){var e=t.parentNode;b(e)||e.removeChild(t)}}function at(t,e){var n=(t||{}).className;if(_(n)&&_(e)&&""!==e){var i,r=e.split(wi);if(C(t.classList)){if(v(n))return void(t.className=e);for(;r.length>0;)""!==(i=r.shift())&&(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g").test(n)||(t.className+=" "+i))}else for(;r.length>0;)""!==(i=r.shift())&&t.classList.add(i)}}function lt(t,e){var n=(t||{}).className;if(_(n)&&_(e)&&""!==e){var i,r=e.split(wi);if(C(t.classList)){if(n===e)return void(t.className="");for(;r.length>0;)""!==(i=r.shift())&&(t.className=n=n.replace(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g"),""))}else for(;r.length>0;)""!==(i=r.shift())&&t.classList.remove(i)}}function ut(t,e){var n=(t||{}).className;if(_(n)&&_(e)&&""!==e){var i,r=e.split(wi);if(C(t.classList)){var o=void 0;if(""===n)t.className=e;else if(n===e)return void(t.className="");for(;r.length>0;)if(""!==(i=r.shift())){if((o=new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g")).test(n)){t.className=n=n.replace(o,"");continue}t.className+=" "+i}}else for(;r.length>0;)""!==(i=r.shift())&&t.classList.toggle(i)}}function ct(t,e,n){var i=(t||{}).className;if(_(i)&&_(n)&&""!==n)if(C(t.classList)){var r=new RegExp("^"+e+"\\s+","g"),o=new RegExp("\\s+"+e+"\\s+","g"),s=new RegExp("\\s+"+e+"$","g");t.className=i.replace(r,n+" ").replace(o," "+n+" ").replace(s," "+n)}else t.classList.add(n),t.classList.remove(e)}function ht(t,e){var n=(t||{}).className;if(!_(n)||!_(e)||""===e)return!1;var i,r=e.split(wi);if(C(t.classList)){if(""===n)return!1;if(n===e)return!0;for(;r.length>0;)if(""!==(i=r.shift())&&!new RegExp("^"+i+"\\s|\\s"+i+"$|\\s"+i+"\\s","g").test(n))return!1;return!0}for(;r.length>0;)if(""!==(i=r.shift())&&!t.classList.contains(i))return!1;return!0}function pt(t){return jt=jt||(jt=plat.acquire(Yt)),At=At||(At=plat.acquire($t)),jt.put(t,jt.read(t).catch(function(e){if(b(e))return At.ajax({url:t})}).then(function(e){if(h(e))return jt.put(t,e);if(!a(e)||!_(e.response))return(Lt=Lt||(Lt=plat.acquire(Bt))).warn("No template found at "+t),jt.put(t);var n=e.response;return v(n.trim())?jt.put(t):jt.put(t,n)}).catch(function(e){return O(function(){(Lt=Lt||(Lt=plat.acquire(Bt))).error(new Error("Failure to get template from "+t+"."))}),e}))}function _t(t,n){if(!c(n))return(Lt=Lt||(Lt=plat.acquire(Bt))).error(new Error("Attempting to check DOM presence of something that isn't a Node.")),e;var i=(Rt=Rt||(Rt=plat.acquire(zt))).body;if(c(n.parentElement)&&i.contains(n))return t(),e;var r=F(function(){c(n.parentElement)&&i.contains(n)&&(r(),t())},100);return r}function ft(t,n){if(!c(n))return(Lt=Lt||(Lt=plat.acquire(Bt))).error(new Error("Attempting to check visibility of something that isn't a Node.")),e;var i=n.clientWidth,r=n.clientHeight;if(!g(i)||!g(r))return(Lt=Lt||(Lt=plat.acquire(Bt))).error(new Error("Attempting to check visibility of something that isn't an Element.")),e;if(i>0&&r>0)return t(),e;var o=F(function(){n.clientWidth>0&&n.clientHeight>0&&(o(),t())},100);return o}function dt(t){for(var e,n=x(t),i=(e=n?Di.Injector.getDependencies(t):Di.Injector.getDependencies([t])).length,r=[],o=0;o<i;++o)r.push(e[o].inject());return n?r:r[0]}function vt(){return window}function mt(t){return t.document}function gt(t){return!b(Hi[t])}function yt(t){return!b(qi[t])}function bt(t){return!b(Vi[t])}function Ct(t){return!C(Qi[t])}function xt(t,e,n,i,r,o){return Yi._parser=t,Yi._ContextManager=e,Yi._EventManager=n,Yi._Promise=i,Yi._dom=r,Yi._log=o,Yi}function Et(){return Xi}function wt(t,e,n,i,r,o){return Ji._compat=t,Ji._EventManager=e,Ji._document=n,Ji._compiler=i,Ji._LifecycleEvent=r,Ji._log=o,Ji}function Tt(t){return t.app}var Nt,St,kt,It,Rt,jt,At,Lt,Pt,Ot="$AppStatic",$t="$Http",Ft="$Promise",Mt="$Compat",Dt="$ControlFactory",zt="$Document",Bt="$Log",Ut="$Regex",Vt="$NavigatorInstance",qt="$ContextManagerStatic",Ht="$ElementManagerFactory",Qt="$CacheFactory",Wt="$ManagerCache",Yt="$TemplateCache",Xt="$BindableTemplatesFactory",Gt="$DomEvents",Jt="$ResourcesFactory",Kt="$TemplateControlFactory",Zt="$Utils",te="$RouterStatic",ee="$Window",ne="$InjectorStatic",ie="plat-",re=ie+"bind",oe=ie+"href",se=ie+"src",ae=ie+"keydown",le=ie+"keypress",ue=ie+"keyup",ce=ie+"charpress",he=ie+"name",pe=ie+"options",_e=ie+"checked",fe=ie+"disabled",de=ie+"selected",ve=ie+"readonly",me=ie+"visible",ge=ie+"style",ye=ie+"tap",be=ie+"blur",Ce=ie+"change",xe=ie+"copy",Ee=ie+"cut",we=ie+"paste",Te=ie+"dbltap",Ne=ie+"focus",Se=ie+"submit",ke=ie+"touchstart",Ie=ie+"touchend",Re=ie+"touchmove",je=ie+"touchcancel",Ae=ie+"hold",Le=ie+"release",Pe=ie+"swipe",Oe=ie+"swipeleft",$e=ie+"swiperight",Fe=ie+"swipeup",Me=ie+"swipedown",De=ie+"track",ze=ie+"trackleft",Be=ie+"trackright",Ue=ie+"trackup",Ve=ie+"trackdown",qe=ie+"trackend",He=ie+"react",Qe=ie+"link",We=ie+"foreach",Ye=ie+"html",Xe=ie+"if",Ge=ie+"ignore",Je=ie+"select",Ke=ie+"template",Ze=ie+"viewport",tn=ie+"control",en=ie+"viewcontrol",nn=ie+"resources",rn=ie+"context",on=Ke+"-context",sn=ie+"callback",an="__templateControlCache",ln="head",un="beforeLoad",cn=ie+"hide",hn=ie+"animating",pn=ie+"animation",_n=ie+"transition",fn=ie+"enter",dn=ie+"leave",vn=ie+"move",mn=ie+"fadein",gn=ie+"fadeout",yn=ie+"back-nav",bn="$tap",Cn="$dbltap",xn="$touchstart",En="$touchend",wn="$touchmove",Tn="$touchcancel",Nn="$hold",Sn="$release",kn="$swipe",In="$swipeleft",Rn="$swiperight",jn="$swipeup",An="$swipedown",Ln="$track",Pn="$trackleft",On="$trackright",$n="$trackup",Fn="$trackdown",Mn="$trackend",Dn={index:"index",even:"even",odd:"odd",first:"first",last:"last"},zn="base",Bn="variable",Un="static",Vn="splat",qn="dynamic",Hn="{{",Qn="}}",Wn="static",Yn="singleton",Xn="instance",Gn="factory",Jn="class",Kn="css",Zn="-@",ti="js",ei="noop",ni="observable",ii="injectable",ri="object",oi="function",si="literal",ai="root",li="rootContext",ui="control",ci="context",hi=!!Array.isArray,pi={},_i=Object.prototype.toString,fi="[object Error]",di="[object File]",vi="[object Array]",mi="[object Boolean]",gi="[object Date]",yi="[object Number]",bi="[object RegExp]",Ci="[object String]",xi="[object Promise]",Ei=/<([\w:]+)/,wi=/\s+/g,Ti=[1,'<select multiple="multiple">',"</select>"],Ni=[1,"<table>","</table>"],Si=[3,"<table><tbody><tr>","</tr></tbody></table>"],ki=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],Ii={thead:Ni,tbody:Ni,tfoot:Ni,colgroup:Ni,caption:Ni,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:Si,th:Si},Ri=r(!1,!1,{},Ii,{option:Ti,optgroup:Ti,legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],text:ki,circle:ki,ellipse:ki,line:ki,path:ki,polygon:ki,polyline:ki,rect:ki,_default:[0,"",""]}),ji={},Ai={},Li={},Pi={},Oi={},$i={},Fi={},Mi={};!function(t){function e(e,n,i,r,o,s){var a=e[n]=new Di.Injector(n,i,r,o);return!0===s&&($i[n]=a),t}function n(t,n,i,r){if(_(r)){if((r=r.toLowerCase())===Gn||r===Wn||r===Jn)return e(Pi,t,n,i,r,!0);if(r!==Yn&&r!==Xn)throw new Error("Invalid injectable type "+r+" during injectable registration.")}else r=Yn;return e(Pi,t,n,i,r,!1)}function i(n,i,r,o){if(_(o)&&(o=o.toLowerCase())!==Kn&&o!==ti)throw new Error('Invalid animationType "'+o+'" during animation registration.');return e(o===ti?Mi:Fi,n,i,r,t.injectable.INSTANCE)}t.app=function(e,n,i){var r=dt(ne);return dt(Ot).registerApp(new r(e,n,i)),t},t.control=function(t,n,i,r){if(!_(t))throw new Error("A Control must be registered with a string name");return"head"===(t=t.toLowerCase())&&(r=!0),e(ji,t,n,i,r?Wn:void 0)},t.viewControl=function(t,n,i){if(!_(t))throw new Error("A ViewControl must be registered with a string name");return t=t.toLowerCase(),e(Ai,t,n,i)},t.injectable=n,function(t){t.STATIC=Wn,t.SINGLETON=Yn,t.INSTANCE=Xn,t.FACTORY=Gn,t.CLASS=Jn}(n=t.injectable||(t.injectable={})),t.animation=i,function(t){t.CSS=Kn,t.JS=ti}(i=t.animation||(t.animation={}))}(Pt=t.register||(t.register={}));var Di;!function(t){var n=function(){function t(e,n,i,r){void 0===r&&(r=null),this.name=e,this.Constructor=n,this.type=r;var o,s=this.dependencies=t.convertDependencies(i),a=s.indexOf(ei);if(Object.defineProperty(n,"__injectorName",{value:e,enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(n,"__injectorDependencies",{value:s.slice(0),enumerable:!1,configurable:!0,writable:!0}),a>-1){var l=i[a];if(b(l))throw new TypeError("The dependency for "+e+" at index "+a+" is undefined, did you forget to include a file?");throw new TypeError("Could not resolve dependency "+l.slice(9,l.indexOf("("))+" for "+e+". Are you using a static injectable Type?")}if(o=t.__findCircularReferences(this),_(o))throw new Error("Circular dependency detected from "+this.name+" to "+o+".");if(e===Ot){var u=this.inject();this.dependencies=s,u.start()}}return t.initialize=function(){for(var t=$i,e=Object.keys(t),n=e.length,i=0;i<n;++i)t[e[i]].inject();$i={}},t.getDependencies=function(e){if(b(e)||v(e))return[];for(var n=[],i=e.length,r=0;r<i;++r)n.push(t.getDependency(e[r]));return n},t.getDependency=function(e){return b(e)||e===ei?t.__noop():t.isInjector(e)?e:t.__locateInjector(e)},t.convertDependencies=function(e){if(!x(e))return[];for(var n=t.convertDependency,i=[],r=e.length,o=0;o<r;++o)i.push(n(e[o]));return i},t.convertDependency=function(e){return b(e)?ei:t.__getInjectorName(e)},t.isInjector=function(t){return y(t.inject)&&!C(t.type)&&!C(t.name)&&!C(t.Constructor)},t.__getInjectorName=function(e){if(b(e))return ei;if(_(e))return e;var n=e,i=a(n._inject)?n._inject:{};if(_(n.__injectorName)&&(e=n.__injectorName),!_(e))return new t(e,n,i.dependencies);var r=t.__findInjector.bind(t,e),o=r(Pi)||r(Oi)||r($i)||r(Ai)||r(ji)||r(Fi)||r(Mi);return!a(o)&&_(e)&&(o=Oi[e]=new t(e,n,n._inject.dependencies)),a(o)?o.name:ei},t.__construct=function(e,n,i){if(b(e)||b(e.prototype))return e;var r,o=Object.create(e.prototype),s=i===Xn;s&&(r=Li[e.__injectorName]),a(r)||(r=t.__walk(o,Object.getPrototypeOf(o),{}),s&&(Li[e.__injectorName]=r));for(var l=dt(k(function(t){return t},r)),u=Object.keys(r),c=u.length,h=0;h<c;++h)o[u[h]]=l[h];var p=o.constructor.apply(o,n);return C(p)?o:p},t.__walk=function(e,n,i){var s=n.constructor,l={};return a(s._inject)&&s!==Object&&(l=t.__walk(e,Object.getPrototypeOf(n),i)),r(!1,!1,{},i,l,o(s._inject,!0))},t.__locateInjector=function(e){if(!b(e)){var n=e;_(e.__injectorName)&&(n=e.__injectorName);var i=t.__findInjector.bind(t,n),r=i(Pi)||i(Oi)||i($i)||i(ji)||i(Ai)||i(Fi)||i(Mi);return a(r)||(y(e)?(_(n)||(n=D(ie)),r=new t(n,e,a(e._inject)?e._injectorDependencies:[]),Oi[n]=r):r=t.__wrap(e)),r}},t.__findInjector=function(e,n){if(!b(e)){if(e===t||e===ne){var i=t.__wrap(t);return i.name=ne,i}return _(e)?n[e]||n[e.toLowerCase()]:void 0}},t.__wrap=function(t){return{inject:function(){return t},name:"wrapped",dependencies:[],Constructor:t}},t.__noop=function(){return{inject:e,type:ei,name:ei,dependencies:[],Constructor:e}},t.__findCircularReferences=function(e){if(a(e)&&x(e.dependencies))for(var n,i,r,o=e.name,s=e.dependencies,l=[{name:o,dependencies:s.slice(0)}],u=t.__locateInjector;l.length>0;){r=(s=(n=l.pop()).dependencies).length;for(var c=0;c<r;++c){if((i=s[c])===o)return n.name;a(e=u(i))&&x(e.dependencies)&&l.push({name:e.name,dependencies:e.dependencies.slice(0)})}}},t.prototype.inject=function(){for(var e,n,i=[],r=this.type,o=this.dependencies,s=o.length,a=0;a<s;++a)e=t.getDependency(o[a]),i.push(e.inject());return n=t.__construct(this.Constructor,i,r),_(r)&&r!==Xn&&this._wrapInjector(n),n.__injectable__type=r,n},t.prototype._wrapInjector=function(t){return this.inject=function(){return t},this},t}();t.Injector=n;!function(t){t.control=ji,t.viewControl=Ai,t.injectable=Pi,t.staticInjectable=$i,t.animation=Fi,t.jsAnimation=Mi}(t.injectors||(t.injectors={}))}(Di=t.dependency||(t.dependency={})),C(window)||(C(window.plat)&&(window.plat=plat),C(window.module)&&(window.module={})),t.acquire=dt;!function(t){var e=function(){function t(){this.ERROR=5,this.WARN=4,this.INFO=3,this.DEBUG=2,this.TRACE=1,this._level=this.INFO}return t.prototype.error=function(t){throw this._log(t,this.ERROR),t},t.prototype.warn=function(t){this._log(t,this.WARN)},t.prototype.info=function(t){this._log(t,this.INFO)},t.prototype.debug=function(t){this._log(t,this.DEBUG)},t.prototype.trace=function(t){this._log(t,this.TRACE)},t.prototype.setLogLevel=function(t){switch(_(t)&&(t=this[t.toUpperCase()]),t){case this.ERROR:case this.WARN:case this.INFO:case this.DEBUG:case this.TRACE:this._level=t;break;default:this._level=this.INFO}},t.prototype._log=function(e,n){if(this._shouldLog(n)){_(e)&&(e=new Error(e));var i=this._ErrorEvent;b(i)&&(i=this._ErrorEvent=dt("$ErrorEventStatic")),i.dispatch("error",t,e,n)}},t.prototype._shouldLog=function(t){return g(t)||(t=this.INFO),this._level<t},t}();t.Log=e,Pt.injectable(Bt,e)}(t.debug||(t.debug={}));var zi=function(){function t(){this.__events={},this.__defineBooleans(),this.__defineMappedEvents(),this.__defineVendorDependencies(),this.__determineCss()}return t.prototype.hasEvent=function(t){var e=this.__events,n=e[t];if(C(n)){var i=this._document.createElement("div");n="input"===t&&9===this.IE?e[t]=!1:e[t]=!C(i["on"+t])}return n},t.prototype.__defineBooleans=function(){var t=this._window,e=t.navigator||{},n=(e.userAgent||"").toLowerCase(),i=this._history,r=t.define,o=t.MSApp,s=t.WinJS,l=(/android ((?:\d|\.)+)/.exec(n)||[])[1];if(_(l)&&!/iemobile/i.test(n)&&(l=parseInt(l.replace(/\./g,""),10)),this.isCompatible=y(Object.defineProperty)&&y(this._document.querySelector),this.cordova=!b(t.cordova),this.pushState=!(b(i)||b(i.pushState)),this.fileSupported=!(C(t.File)||C(t.FormData)),this.amd=y(r)&&!b(r.amd),this.msApp=a(o)&&y(o.execUnsafeLocalFunction),this.winJs=a(s)&&a(s.Application),this.indexedDb=!b(t.indexedDB),this.proto=a({}.__proto__),this.getProto=y(Object.getPrototypeOf),this.setProto=y(Object.setPrototypeOf),this.hasTouchEvents=!C(t.ontouchstart),this.hasPointerEvents=!!e.pointerEnabled,this.hasMsPointerEvents=!!e.msPointerEnabled,g(l))this.ANDROID=l;else{var u=parseInt((/msie (\d+)/.exec(n)||[])[1],10)||parseInt((/trident\/.*; rv:(\d+)/.exec(n)||[])[1],10);g(u)&&(this.IE=u)}},t.prototype.__defineMappedEvents=function(){this.hasPointerEvents?this.mappedEvents={$touchstart:"pointerdown",$touchend:"pointerup",$touchmove:"pointermove",$touchcancel:"pointercancel"}:this.hasMsPointerEvents?this.mappedEvents={$touchstart:"MSPointerDown",$touchend:"MSPointerUp",$touchmove:"MSPointerMove",$touchcancel:"MSPointerCancel"}:this.hasTouchEvents?this.mappedEvents={$touchstart:"touchstart",$touchend:"touchend",$touchmove:"touchmove",$touchcancel:"touchcancel"}:this.mappedEvents={$touchstart:"mousedown",$touchend:"mouseup",$touchmove:"mousemove",$touchcancel:null}},t.prototype.__defineVendorDependencies=function(){var t,e,n,i,r=this._window,o=this._document.documentElement,s=r.getComputedStyle(o,""),a=Array.prototype.slice.call(s).join("").match(/-(moz|webkit|ms)-/);x(a)&&a.length>1?(i=(t=x(a)&&a.length>1?a[1]:"")[0].toUpperCase()+t.slice(1),e="WebKit|Moz|MS".match(new RegExp("("+t+")","i"))[1],n="-"+t+"-"):C(s.OLink)?t=i=e=n="":(t="o",i=e="O",n="-o-"),this.vendorPrefix={dom:e,lowerCase:t,css:n,upperCase:i},this.requestAnimationFrame=r.requestAnimationFrame||r[t+"RequestAnimationFrame"],this.cancelAnimationFrame=r.cancelAnimationFrame||r[t+"CancelRequestAnimationFrame"]||r[t+"CancelAnimationFrame"];var l=o.style;!(C(this.ANDROID)||Math.floor(this.ANDROID/10)>=44)||C(l.animation)||C(l.transition)?(C(l[i+"Animation"])||C(l[i+"Transition"]))&&(C(l[t+"Animation"])||C(l[t+"Transition"]))&&(C(l[e+"Animation"])||C(l[e+"Transition"]))||(this.animationSupported=!0,this.animationEvents={$animation:t+"Animation",$animationStart:t+"AnimationStart",$animationEnd:t+"AnimationEnd",$animationIteration:t+"AnimationIteration",$transition:t+"Transition",$transitionStart:t+"TransitionStart",$transitionEnd:t+"TransitionEnd"}):(this.animationSupported=!0,this.animationEvents={$animation:"animation",$animationStart:"animationstart",$animationEnd:"animationend",$animationIteration:"animationiteration",$transition:"transition",$transitionStart:"transitionstart",$transitionEnd:"transitionend"})},t.prototype.__determineCss=function(){var t=this._document,e=t.head,n=t.createElement("div");n.setAttribute(cn,""),e.insertBefore(n,null);var i=this._window.getComputedStyle(n),r=i.display,o=i.visibility;this.platCss="none"===r||"hidden"===o,e.removeChild(n)},t._inject={_window:ee,_history:"$History",_document:zt},t}();t.Compat=zi,Pt.injectable(Mt,zi);var Bi=function(){function t(){}return t.prototype.noop=function(){},t.prototype.extend=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return r.apply(null,[!1,!1,t].concat(e))},t.prototype.deepExtend=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return r.apply(null,[!0,!1,t].concat(e))},t.prototype.clone=function(t,e){return o(t,e)},t.prototype.isObject=function(t){return a(t)},t.prototype.isWindow=function(t){return l(t)},t.prototype.isDocument=function(t){return u(t)},t.prototype.isNode=function(t){return c(t)},t.prototype.isDocumentFragment=function(t){return h(t)},t.prototype.isString=function(t){return _(t)},t.prototype.isRegExp=function(t){return f(t)},t.prototype.isPromise=function(t){return d(t)},t.prototype.isEmpty=function(t){return v(t)},t.prototype.isBoolean=function(t){return m(t)},t.prototype.isNumber=function(t){return g(t)},t.prototype.isFile=function(t){return p(t)},t.prototype.isFunction=function(t){return y(t)},t.prototype.isNull=function(t){return b(t)},t.prototype.isUndefined=function(t){return C(t)},t.prototype.isArray=function(t){return x(t)},t.prototype.isArrayLike=function(t){return E(t)},t.prototype.isDate=function(t){return w(t)},t.prototype.filter=function(t,e,n){return T(t,e,n)},t.prototype.where=function(t,e){return N(t,e)},t.prototype.forEach=function(t,e,n){return S(t,e,n)},t.prototype.map=function(t,e,n){return k(t,e,n)},t.prototype.mapAsync=function(t,e,n){return I(t,e,n)},t.prototype.mapAsyncInOrder=function(t,e,n){return j(t,e,n)},t.prototype.mapAsyncInDescendingOrder=function(t,e,n){return A(t,e,n)},t.prototype.pluck=function(t,e){return L(t,e)},t.prototype.some=function(t,e,n){return P(t,e,n)},t.prototype.postpone=function(t,e,n){return $(t,0,e,n)},t.prototype.defer=function(t,e,n,i){return $(t,e,n,i)},t.prototype.setInterval=function(t,e,n,i){return F(t,e,n,i)},t.prototype.requestAnimationFrame=function(t,e){return M(t,e)},t.prototype.uniqueId=function(t){return D(t)},t.prototype.camelCase=function(t){return z(t)},t.prototype.delimit=function(t,e){return B(t,e)},t}();t.Utils=Bi,Pt.injectable(Zt,Bi),t.Window=vt,Pt.injectable(ee,vt),t.Document=mt,Pt.injectable(zt,mt,[ee]);!function(t){var e=function(){function t(){this.markupRegex=new RegExp(Hn+"[\\S\\s]*"+Qn),this.argumentRegex=/\((.*)\)/,this.initialUrlRegex=/\/[^\/]*\.(?:html|htm)/,this.protocolRegex=/:\/\//,this.invalidVariableRegex=/[^a-zA-Z0-9@_$]/,this.fileNameRegex=/.*(?:\/|\\)/,this.shiftedKeyRegex=/[A-Z!@#$%^&*()_+}{":?><|~]/,this.fullUrlRegex=/^(?:[a-z0-9\-]+:)(?:\/\/)?|(?:\/\/)/i,this.validateEmail=new RegExp('^(([^<>()[\\]\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),this.validateTelephone=/^\+?[0-9\.\(\)\s-]*$/,this.dynamicSegmentsRegex=/^:([^\/]+)$/,this.splatSegmentRegex=/^\*([^\/]+)$/}return Object.defineProperty(t.prototype,"newLineRegex",{get:function(){return/\r|\n/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optionalRouteRegex",{get:function(){return/\((.*?)\)/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"namedParameterRouteRegex",{get:function(){return/(\(\?)?:\w+/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wildcardRouteRegex",{get:function(){return/\*\w*/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"escapeRouteRegex",{get:function(){return/[\-{}\[\]+?.,\\\^$|#\s]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"camelCaseRegex",{get:function(){return/([\-_\.\s])(\w+?)/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capitalCaseRegex",{get:function(){return/[A-Z]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpaceRegex",{get:function(){return/("[^"]*?"|'[^']*?')|[\s\r\n\t\v]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quotationRegex",{get:function(){return/'|"/g},enumerable:!0,configurable:!0}),t}();t.Regex=e,Pt.injectable(Ut,e);var n=function(){function t(){this.__previousChar="",this.__variableRegex=dt(Ut).invalidVariableRegex,this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]}return t.prototype.createTokens=function(t){if(b(t))return[];this._input=t;for(var e,n=t.length,i=0,r=!1,o=this._isSpace,s=this._isAlphaNumeric,a=0;a<n;a++)if(e=t[a],!o(e)){if(s(e))a=this.__handleAplhaNumeric(a,e);else if(gt(e))switch(e){case".":a=this.__handlePeriod(a,e);break;case"{":this.__handleLeftBrace(e);break;case"}":this.__handleRightBrace(e);break;case"[":this.__handleLeftBracket(e);break;case"]":this.__handleRightBracket(e);break;case"(":this.__handleLeftParenthesis(e);break;case")":this.__handleRightParenthesis(e);break;case",":this.__handleComma(e);break;case"'":case'"':a=this.__handleStringLiteral(a,e)}else if(bt(e))switch(e){case"?":r=!0,i++,this.__handleQuestion(e);break;case":":i=this.__handleColon(e,i);break;default:a=this.__handleOtherOperator(a,e)}else if(";"===e)return this._throwError("Unexpected semicolon"),[];this.__previousChar=e}if(r&&i>0)return this._throwError("Improper ternary expression"),[];if(this.__objArgCount.length>0)return this._throwError("Improper object literal"),[];this.__popRemainingOperators();var l=this.__outputQueue;return this._resetTokenizer(),l},t.prototype._checkType=function(t,e){return e?this._isNumeric(t):this._isAlphaNumeric(t)},t.prototype._lookAhead=function(t,e,n){for(var i,r=this._input,o=r.length;++e<o&&(i=r[e],this._checkType(i,n));)t+=i;return t},t.prototype._lookAheadForOperatorFn=function(t,e){for(var n,i=t,r=this._input,o=r.length;++e<o&&(n=r[e],i+=n,bt(i));)t=i;return t},t.prototype._lookAheadForDelimiter=function(t,e){for(var n,i="",r=this._input,o=r.length;++e<o&&(n=r[e])!==t;)i+=n;return i},t.prototype._popStackForVal=function(t,e,n){for(var i=this.__outputQueue,r=this.__operatorStack;t.val!==e;)if(i.push(r.shift()),t=r[0],0===r.length)return this._throwError(n)},t.prototype._isValEqual=function(t,e){return b(t)||b(t.val)?b(e):""===t.val?""===e:-1!==e.indexOf(t.val)},t.prototype._isValUnequal=function(t,e){return b(t)||b(t.val)?!b(e):""===t.val?""!==e:-1===e.indexOf(t.val)},t.prototype._resetTokenizer=function(){this._input=null,this.__previousChar="",this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]},t.prototype._throwError=function(t){this._log.error(new Error(t+" in "+this._input))},t.prototype._isNumeric=function(t){return"0"<=t&&t<="9"},t.prototype._isSpace=function(t){return" "===t||"\r"===t||"\n"===t||"\t"===t||"\v"===t||" "===t},t.prototype._isAlphaNumeric=function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||"@"===t||"_"===t||"$"===t},t.prototype._isStringValidVariable=function(t){return!this.__variableRegex.test(t)},t.prototype.__handleAplhaNumeric=function(t,e){var n=this._isNumeric(e),i=this._lookAhead(e,t,n);return this.__outputQueue.push(n?{val:Number(i),args:0}:{val:i,args:-1}),t+i.length-1},t.prototype.__handlePeriod=function(t,e){var n,i=this.__outputQueue,r=this.__operatorStack,o=i.length-1,s=this.__previousChar;return o<0||this._isSpace(s)||!b(Vi[s])||"("===s||","===s?(t+=(n=this._lookAhead(e,t,!0)).length-1,i.push({val:parseFloat(n),args:0})):this._isValEqual(r[0],e)?i.push({val:e,args:0}):b(i[o])||!g(Number(i[o].val))||this._isValEqual(i[o-1],e)?r.unshift({val:e,args:0}):(t+=(n=this._lookAhead(e,t,!0)).length-1,i[o].val+=parseFloat(n)),t},t.prototype.__handleLeftBrace=function(t){this.__operatorStack.unshift({val:t,args:0}),this.__objArgCount.push(0),this.__lastColonChar.push(t),this.__lastCommaChar.push(t)},t.prototype.__handleRightBrace=function(t){var e=this.__operatorStack,n=e[0],i=this.__objArgCount.pop();if(b(n))return this._throwError("Improper object literal");this._popStackForVal(n,"{","Improper object literal"),e.shift(),this.__lastColonChar.pop(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"{}",args:i})},t.prototype.__handleLeftBracket=function(t){var e=this.__previousChar,n=this.__operatorStack;this._isValEqual(n[0],".")&&this.__outputQueue.push(n.shift()),n.unshift({val:t,args:0}),this.__argCount.push({num:0,isArray:!("]"===e||")"===e||this._isAlphaNumeric(e))}),this.__lastCommaChar.push(t)},t.prototype.__handleRightBracket=function(t){var e=this.__operatorStack,n=e[0],i=this.__argCount.pop();if(b(n)||b(i))return this._throwError("Brackets mismatch");i.isArray||i.num--,this._popStackForVal(n,"[","Brackets mismatch"),e.shift(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"[]",args:"["===this.__previousChar?-1:i.num+1})},t.prototype.__handleLeftParenthesis=function(t){var e,n=this.__previousChar,i=this.__operatorStack;if(this._isAlphaNumeric(n)||"]"===n||")"===n){var r=this.__outputQueue,o=r[r.length-1],s=b(o)?void 0:o.val;"[]"===s?(i.unshift(r.pop()),i.unshift(r.pop())):"()"===s||this._isNumeric(s)||i.unshift(r.pop()),e=0}else e=-1;this.__argCount.push({num:e}),i.unshift({val:t,args:e}),this.__lastCommaChar.push(t)},t.prototype.__handleRightParenthesis=function(t){var e=this.__operatorStack,n=e[0],i=this.__argCount.pop();if(b(n))return this._throwError("Parentheses mismatch");if(this._popStackForVal(n,"(","Parentheses mismatch"),e.shift(),this.__lastCommaChar.pop(),!b(i)&&i.num>=0){var r=i.num;"("===this.__previousChar?this.__removeFnFromStack(r)&&this.__outputQueue.push({val:"()",args:0}):this.__removeFnFromStack(r+1)&&this.__outputQueue.push({val:"()",args:r+1})}},t.prototype.__handleComma=function(t){var e=this.__lastCommaChar,n=e[e.length-1];if("("===n||"["===n){var i=this.__argCount,r=i.length;if(!(r>0))return this._throwError("Mismatch with "+n);i[r-1].num++}var o=this.__operatorStack[0];if(b(o))return this._throwError("Unexpected comma");this._popStackForVal(o,n,"Unexpected comma")},t.prototype.__handleStringLiteral=function(t,e){var n=this._lookAheadForDelimiter(e,t),i=this.__operatorStack,r=i[0];return!b(r)&&("["===r.val||"("===r.val&&r.args>=0)?i.unshift({val:n,args:0}):this.__outputQueue.push({val:n,args:0}),t+n.length+1},t.prototype.__handleQuestion=function(t){this.__lastColonChar.push(t),this.__determinePrecedence(t)},t.prototype.__handleColon=function(t,e){var n=this.__lastColonChar,i=n[n.length-1],r=this.__outputQueue;if("?"===i){var o=this.__operatorStack,s=o[0];if(b(s))return void this._throwError("Ternary mismatch");e--,n.pop(),this._popStackForVal(s,"?","Ternary mismatch"),r.push(o.shift()),o.unshift({val:t,args:-2})}else{if("{"!==i)return void this._throwError("Unexpected colon");var a=this.__objArgCount,l=r.length-1;if(a[a.length-1]++,l<0)return void this._throwError("Unexpected colon");r[l].args=1}return e},t.prototype.__handleOtherOperator=function(t,e){var n=this._lookAheadForOperatorFn(e,t);return this.__determinePrecedence(n),t+n.length-1},t.prototype.__popRemainingOperators=function(){for(var t,e,n=this.__outputQueue,i=this.__operatorStack;i.length>0;){if(t=i.shift(),"("===(e=t.val)||")"===e)return this._throwError("Parentheses mismatch");n.push(t)}},t.prototype.__determineOperator=function(t){switch(t){case"+":case"-":if(0===this.__outputQueue.length||bt(this.__previousChar))return Vi["u"+t];default:return Vi[t]}},t.prototype.__determinePrecedence=function(t){var e,n,i=this.__determineOperator(t),r=i.precedence,o="ltr"===i.associativity,s=this.__operatorStack,a=this.__outputQueue;if(0!==s.length){do{if("."!==(n=s[0].val)){if(e=Vi[n],b(e)||!(e.precedence<r||o&&e.precedence===r))return void s.unshift({val:t,args:i.fn.length-2});a.push(s.shift())}else a.push(s.shift())}while(s.length>0);s.unshift({val:t,args:i.fn.length-2})}else s.unshift({val:t,args:i.fn.length-2})},t.prototype.__removeFnFromStack=function(t){for(var e,n=this.__outputQueue,i=this.__operatorStack,r=i[0],o=this._isValEqual,s=this._isValUnequal,a=!1;!b(r)&&s(r,"([")&&(this._isStringValidVariable(r.val)||o(r.val,".[]")||yt(r.val));)-1!==(e=i.shift()).args||o(e,".[]")||(e.args=-2),n.push(e),r=i[0],a=!0;return a||s(n[n.length-t-1],"()")||(a=!0),a},t._inject={_log:Bt},t}();t.Tokenizer=n,Pt.injectable("$Tokenizer",n);var i=function(){function t(){this._tokens=[],this.__cache={},this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={},this.__fnEvalConstant="var initialContext;return "}return t.prototype.parse=function(t){var e=this.__cache[t];if(!b(e))return{expression:e.expression,identifiers:e.identifiers.slice(0),aliases:e.aliases.slice(0),evaluate:e.evaluate};if(this._tokens=this._tokenizer.createTokens(t),0===(e=this._evaluate(t)).identifiers.length){var n=e.evaluate(null);e.evaluate=function(){return n}}return this.__cache[t]=e,e},t.prototype.clearCache=function(t){_(t)?U(this.__cache,t):this.__cache={}},t.prototype._evaluate=function(t){for(var e,n,i,r=this._tokens,o=r.length,s=this.__tempIdentifiers,a=this.__codeArray,l=!1,u=0;u<o;u++)if(e=r[u],n=e.val,i=e.args,yt(n))switch(n){case"()":l=this.__handleFunction(u,i,l);break;case"{}":a.push(this.__convertObject(i)),s.push(".");break;default:i<0?(a.push("[]"),s.push(".")):i>0?(a.push(this.__convertArrayLiteral(i)),s.push(".")):l=this.__indexIntoObject(u,n,l)}else if(bt(n))if(0===i)a.push(this.__convertPrimitive(u,n,i));else switch(n){case"?":this.__handleQuestion();break;case":":this.__handleColon();break;case"+":case"-":1===i&&(n="u"+n);default:this.__handleOperator(n,i)}else i<0?a.push(this.__convertFunction(u,n,l)):a.push(this.__convertPrimitive(u,n,i));this._popRemainingIdentifiers(),this._makeIdentifiersUnique();var c={evaluate:new Function("context","aliases",this.__fnEvalConstant+(0===a.length?'"'+t+'"':a.join(""))+";"),expression:t,identifiers:this.__identifiers.slice(0),aliases:Object.keys(this.__aliases)};return this._resetParser(),c},t.prototype._peek=function(t){return this._tokens[t+1]},t.prototype._lookBack=function(t){return this._tokens[t-1]},t.prototype._popRemainingIdentifiers=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers;n.length>0;)"."!==(t=n.pop())&&e.push(t)},t.prototype._makeIdentifiersUnique=function(){for(var t,e=this.__identifiers,n=[],i={};e.length>0;)i[t=e.pop()]||(i[t]=!0,n.push(t));this.__identifiers=n},t.prototype._isValEqual=function(t,e){return b(t)||b(t.val)?b(e):""===t.val?""===e:-1!==e.indexOf(t.val)},t.prototype._isValUnequal=function(t,e){return b(t)||b(t.val)?!b(e):""===t.val?""!==e:-1===e.indexOf(t.val)},t.prototype._resetParser=function(){this._tokens=[],this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={}},t.prototype._throwError=function(t){this._log.error(new Error(t))},t.prototype.__convertPrimitive=function(t,e,n){if(n>0)return this.__tempIdentifiers.push("."),e;var i=g(Number(e)),r=this._peek(t),o=!(b(r)||r.args>=1),s=this._isValEqual;return Ct(e)||_(e)&&(i||this._isValUnequal(r,"[]()")||s(r,"[]")&&!o)?(this.__tempIdentifiers.push("."),'"'+e+'"'):(!i||s(r,".[]")&&o?this.__tempIdentifiers.push(e):this.__tempIdentifiers.push("."),e)},t.prototype.__convertFunction=function(t,e,n){if("@"===e[0])this.__aliases[e.slice(1)]=!0;else if(Ct(e))return this.__tempIdentifiers.push("."),e;var i=this._peek(t),r=this._isValEqual;if(r(this._tokens[t-1],"()")&&r(i,".[]")?this.__tempIdentifiers.push("."):this.__tempIdentifiers.push(e),b(i))return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+e+'"))';switch(i.val){case".":case"()":return e;default:if(!n)return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+e+'"))'}},t.prototype.__convertObject=function(t){for(var e,n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="{";s++<t;)n=o.pop(),a+=',"'+o.pop()+'":'+n,r.length>1&&(e=r.pop(),r.pop(),"."!==e&&i.push(e));return a.replace(",","")+"}"},t.prototype.__convertArrayLiteral=function(t){for(var e,n=this.__identifiers,i=this.__tempIdentifiers,r=this.__codeArray,o=0,s="";o++<t;)s=r.pop()+","+s,i.length>0&&"."!==(e=i.pop())&&n.push(e);return"["+s.slice(0,-1)+"]"},t.prototype.__handleFunction=function(t,e,n){var i,r,o=this.__identifiers,s=this.__tempIdentifiers,a=this.__codeArray,l=0,u=this._lookBack(t),c=!b(u)&&(-2===u.args||this._isValEqual(u,".[]")),h="",p="",_="",f=!1;for(c&&(p=a.pop(),_=s.pop());l++<e;)h=a.pop()+","+h,s.length>0&&"."!==(i=s.pop())&&(o.push(i),f=!0);if(r=e>0?".call(initialContext || context,"+h.slice(0,h.length-1)+")":".call(initialContext || context)",n)if(n=!1,a.length>0){var d=a.pop(),m=s.length-1;m<0||"."===s[m]||""===_?""!==_&&f&&"["!==d[0]&&"]"!==d[d.length-1]&&(o[o.length-1]+="."+_):(s[m]+="."+_,o.push(s.pop())),r=v(p)?d+r:"(("+this.__indexIntoContext.toString()+")("+d+',"'+p+'") || (function () {}))'+r}else this._throwError("Improper expression or context");else c?(r="(initialContext = (("+this.__findInitialContext.toString()+')(context,aliases,"'+p+'") || (function () {}))'+r+")",o.push(p)):r=a.pop()+r;a.push(r);var g=s.length;return this._isValEqual(this._peek(t),"[]")&&g>0&&"."!==s[g-1]&&o.push(s.pop()),n},t.prototype.__indexIntoObject=function(t,e,n){var i=this._isValEqual;if(i(this._peek(t),"()"))return!0;var r,o=this.__codeArray,s=o.pop(),a=this.__identifiers,l=this.__tempIdentifiers,u=this._lookBack(t),c=l.pop(),h=!b(c);return h&&"@"===c[0]?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",a.push(c),l.length>0&&a.push(l.pop())):i(u,"++--()[]*/%?:>=<=&&||!===")?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",l.push(".")):"[]"!==e||b(u)||u.args>=0?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+',"'+s+'")',(r=l.length-1)>=0?"."!==l[r]&&(l[r]+="."+c):h&&"."!==c&&"."!==e&&a.push(c)):(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",(r=l.length-1)>=0&&"."!==l[r]&&a.push(l.pop()),a.push(c)),o.push(s),n},t.prototype.__handleQuestion=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o++)"."!==(t=n.pop())&&e.push(t);i.push(i.pop()+"?"+r)},t.prototype.__handleColon=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o++)"."!==(t=n.pop())&&e.push(t);i.push(i.pop()+":"+r)},t.prototype.__handleOperator=function(t,e){for(var n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="";s++<e;)a="function (context, aliases) { return "+o.pop()+"; },"+a,r.length>0&&"."!==(n=r.pop())&&i.push(n);r.push("."),o.push("("+Vi[t].fn.toString()+")(context, aliases,"+a.slice(0,a.length-1)+")")},t.prototype.__findInitialContext=function(t,e,n){return"@"===n[0]&&null!==e&&"object"==typeof e?e[n.slice(1)]:null!==t&&"object"==typeof t?t[n]:void 0},t.prototype.__indexIntoContext=function(t,e){if(null!==t&&"object"==typeof t)return t[e]},t._inject={_tokenizer:"$Tokenizer",_log:Bt},t}();t.Parser=i,Pt.injectable("$Parser",i)}(t.expressions||(t.expressions={}));!function(t){function e(t){return t.location}function n(){return i.config}t.Location=e,Pt.injectable("$Location",e,[ee]);var i=function(){function t(){this.uid=D(ie),this.__lastUrl=this._location.href,this.__protocol=this.urlUtils().protocol,this.__initializing=!1,this._EventManager.on(this.uid,un,this.initialize,this),this._compat.msApp&&(this._stack=[])}return t.prototype.initialize=function(){var t=this._compat;this._EventManager.dispose(this.uid),this.__initializing=!0,dt("$UrlUtilsInstance");var e=this.url(),n=e,i=this._urlChanged.bind(this),r=this._dom,o=this._window;n!==e&&this.url(n,!0),t.pushState&&r.addEventListener(o,"popstate",i,!1),r.addEventListener(o,"hashchange",i,!1),this.__initializing=!1},t.prototype.url=function(t,e){var n=this._location;return _(t)&&!this._isLastUrl(t)&&(!e&&x(this._stack)&&this._stack.push(n.href),this._setUrl(t,e)),this.__currentUrl||n.href},t.prototype.back=function(t){g(t)||(t=1);var e=this._stack;if(x(e)&&e.length>1)return this._stack=e=e.slice(0,e.length-(t-1)),this.url(e.pop()),void e.pop();this._history.go(-t)},t.prototype.forward=function(t){g(t)||(t=1),this._history.go(t)},t.prototype.urlUtils=function(e){e=e||this.url();var n=dt("$UrlUtilsInstance"),i=t.config;return i.routingType===i.HASH&&(e=e.replace(new RegExp("#"+(i.hashPrefix||"")+"/?"),"")),n.initialize(e),n},t.prototype.isCrossDomain=function(t){if(!_(t))return!1;var e=this.urlUtils(t),n=this.urlUtils();return e.protocol!==n.protocol||e.hostname!==n.hostname||e.port!==n.port},t.prototype.formatUrl=function(e){var n=t.config,i=n.baseUrl;if(!_(e))return"";if(e===i)return e;var r=!this._regex.fullUrlRegex.test(e)||e.indexOf(i)>-1;if("/"===e[0]&&(e=e.slice(1)),r){if(n.routingType===n.HASH){var o=0===e.indexOf(this.__protocol+":"),s="#"+(n.hashPrefix||""),a=new RegExp(s+"|#/");"/"!==e[e.length-1]&&-1===e.indexOf("?")&&(e+="/"),a.test(e)||(e=o?e+s+"/":s+("/"!==e[0]?"/":"")+e)}-1===e.indexOf(i)&&(e=i+e)}return e},t.prototype._urlChanged=function(){var t=this;if(!this.__initializing){this.__currentUrl=null;var e=this.urlUtils(),n=this._trimSlashes(e.href);if(this.__lastUrl!==n){this.__lastUrl=n;var i=this._EventManager;O(function(){i.dispatch("urlChanged",t,i.DIRECT,[e])})}}},t.prototype._setUrl=function(e,n){e=this.formatUrl(e);var i=this.urlUtils(e),r=t.config.baseUrl,o=this._history,s=this._location;if(-1!==i.href.indexOf(r))if(this._regex.fullUrlRegex.test(e)||"/"===e[0]||(e=r+e),this._compat.pushState){if(n){var l=o.state;a(l)||(l={}),o.replaceState({previousLocation:l.previousLocation},"",e)}else o.pushState({previousLocation:this.urlUtils().pathname},"",e);this.__initializing||this._urlChanged()}else this.__currentUrl=e,n?s.replace(e):s.href=e;else s.href=e},t.prototype._isLastUrl=function(t){var e=this.__lastUrl;return _(t)&&(v(t)&&(t="/"),t=this._trimSlashes(this.urlUtils(t).href)),t===e},t.prototype._trimSlashes=function(t){return _(t)&&"/"===t[t.length-1]?t.slice(0,-1):t},t._inject={_EventManager:"$EventManagerStatic",_compat:Mt,_regex:Ut,_window:ee,_location:"$Location",_history:"$History",_dom:"$Dom"},t.config={HASH:"hash",STATE:"state",routingType:"hash",hashPrefix:"!",baseUrl:""},t}();t.Browser=i,Pt.injectable("$Browser",i),t.IBrowserConfig=n,Pt.injectable("$BrowserConfig",n);var r=function(){function t(){var e=this._browserConfig,n=e.baseUrl;if(v(n)||!this._regex.fullUrlRegex.test(n)){var i=this._window.location.href.replace(this._regex.initialUrlRegex,"/");for(_(n)?0===n.indexOf("/")&&(n=n.slice(1)):n="",n=t.__getBaseUrl(i)+n;"/"===n[n.length-1];)n=n.slice(0,-1);e.baseUrl=n+"/"}}return t.__getQuery=function(t){return q(t)},t.__getBaseUrl=function(t){var e=dt(Ut),n=dt("$Location"),i=n.origin,r=n.protocol;n.host;return"file:"===r||r.indexOf("wmapp")>-1||r.indexOf("ms-appx")>-1?i=n.href:C(i)&&(i=n.protocol+"//"+n.host),(i=i.replace(e.initialUrlRegex,"")).split("?")[0].split("#")[0]+"/"},t.prototype.initialize=function(e){e=e||"";var n=t.__urlUtilsElement||(t.__urlUtilsElement=this._document.createElement("a")),i=this._browserConfig;"/"===e[0]&&0!==e.indexOf("//")&&(e=e.slice(1)),this._regex.fullUrlRegex.test(e)||(e=i.baseUrl+e),n.setAttribute("href",e),e=n.href,n.setAttribute("href",e),e=n.href,this.href=e,this.protocol=n.protocol?n.protocol.replace(/:$/,""):"",this.host=n.host,this.search=n.search?n.search.replace(/^\?/,""):"",this.hash=n.hash?n.hash.replace(/^#/,""):"",this.hostname=n.hostname,this.port=n.port;var r;r=(r=v(i.baseUrl)?"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname:e.replace(i.baseUrl,"/")).replace(this._regex.initialUrlRegex,"/"),this.pathname=r.split("?")[0].split("#")[0],this.query=t.__getQuery(this.search)},t.prototype.toString=function(){return this.href},t._inject={_EventManager:"$EventManagerStatic",_document:zt,_window:ee,_compat:Mt,_regex:Ut,_browserConfig:"$BrowserConfig"},t}();t.UrlUtils=r,Pt.injectable("$UrlUtilsInstance",r,null,Xn)}(t.web||(t.web={}));var Ui;!function(t){function n(){for(var t,e=0;e<l.length;e++)(0,(t=l[e])[0])(t[1]);l=[]}function i(t){return!b(t.Promise)&&y(t.Promise.all)&&y(t.Promise.race)&&y(t.Promise.resolve)&&y(t.Promise.reject)?t.Promise:f}function o(){return S.config}var s,l=[],u="undefined"!=typeof window?window:{},c=u.MutationObserver||u.WebKitMutationObserver,h=h;s=void 0!==h&&"[object process]"==={}.toString.call(h)?function(){h.nextTick(n)}:c?function(){var t=new c(n),e=dt(zt),i=dt(ee),r=e.createElement("div");return t.observe(r,{attributes:!0}),i.addEventListener("unload",function(){t.disconnect(),t=null},!1),function(){r.setAttribute("drainQueue","drainQueue")}}():function(){O(n)};var f=function(){function t(e){if(!y(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof t))throw new TypeError('Failed to construct "Promise": Please use the "new" operator, this object constructor cannot be called as a function.');this.__subscribers=[],t.__invokeResolveFunction(e,this)}return t.all=function(e){return x(e)?new t(function(t,n){function i(e,n){o[e]=n,0==--s&&t(o)}var r,o=[],s=e.length;0===s&&t([]);for(var a=0;a<e.length;a++)d(r=e[a])?r.then(function(t){return function(e){return i(t,e)}}(a),n):i(a,r)}):t.all([e])},t.race=function(e){return x(e)?new t(function(t,n){for(var i,r=0;r<e.length;r++)(i=e[r])&&"function"==typeof i.then?i.then(t,n):t(i)}):t.race([e])},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.__invokeResolveFunction=function(e,n){function i(e){t.__reject(n,e)}try{e(function(e){t.__resolve(n,e)},i)}catch(t){i(t)}},t.__invokeCallback=function(e,n,i,r){var o,s,a,l,u=y(i);if(u)try{o=i(r),a=!0}catch(t){l=!0,s=t}else o=r,a=!0;t.__handleThenable(n,o)||(u&&a?t.__resolve(n,o):l?t.__reject(n,s):e===m.FULFILLED?t.__resolve(n,o):e===m.REJECTED&&t.__reject(n,o))},t.__publish=function(e,n){for(var i,r,o=e.__subscribers,s=e.__detail,a=0;a<o.length;a+=3)i=o[a],r=o[a+n],t.__invokeCallback(n,i,r,s);e.__subscribers=null},t.__publishFulfillment=function(e){t.__publish(e,e.__state=m.FULFILLED)},t.__publishRejection=function(e){t.__publish(e,e.__state=m.REJECTED)},t.__reject=function(e,n){e.__state===m.PENDING&&(e.__state=m.SEALED,e.__detail=n,t.config.async(t.__publishRejection,e))},t.__fulfill=function(e,n){e.__state===m.PENDING&&(e.__state=m.SEALED,e.__detail=n,t.config.async(t.__publishFulfillment,e))},t.__resolve=function(e,n){e===n?t.__fulfill(e,n):t.__handleThenable(e,n)||t.__fulfill(e,n)},t.__handleThenable=function(e,n){var i;if(e===n)return t.__reject(e,new TypeError("A promises callback cannot return the same promise.")),!0;if(d(n))try{return n.then.call(n,function(r){if(i)return!0;i=!0,n!==r?t.__resolve(e,r):t.__fulfill(e,r)},function(n){if(i)return!0;i=!0,t.__reject(e,n)}),!0}catch(n){return!!i||(t.__reject(e,n),!0)}return!1},t.__subscribe=function(t,e,n,i){var r=t.__subscribers,o=r.length;r[o]=e,r[o+m.FULFILLED]=n,r[o+m.REJECTED]=i},t.prototype.then=function(n,i){var r=this,o=new this.constructor(e,this);if(this.__state){var s=arguments;t.config.async(function(){t.__invokeCallback(r.__state,o,s[r.__state-1],r.__detail)})}else t.__subscribe(this,o,n,i);return o},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.toString=function(){return"[object Promise]"},t.config={async:function(t,e){1===l.push([t,e])&&s()}},t}();t.Promise=f;var m;!function(t){t[t.PENDING=void 0]="PENDING",t[t.SEALED=0]="SEALED",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(m||(m={})),t.IPromise=i,Pt.injectable(Ft,i,[ee],Jn);var E=function(){function t(){var t=dt(Mt);this.__fileSupported=t.fileSupported}return t.prototype.initialize=function(t){this.__options=r(!1,!1,{},this._config,t)},t.prototype.execute=function(){var t=this.__options,e=t.url;if(!_(e)||v(e.trim()))return this._invalidOptions();t.url=this._browser.urlUtils(e).toString();var n=!1;return t.isCrossDomain||!1?n=!0:(this.xhr=new XMLHttpRequest,C(this.xhr.withCredentials)&&(n=this._browser.isCrossDomain(e))),n?(this.xhr=null,this.jsonpCallback=t.jsonpCallback||D("plat_callback"),this.executeJsonp()):this._sendXhrRequest()},t.prototype.executeJsonp=function(){var t=this,n=this.__options,i=n.url;if(!_(i)||v(i.trim()))return this._invalidOptions();n.url=this._browser.urlUtils(i).toString(),b(this.jsonpCallback)&&(this.jsonpCallback=n.jsonpCallback||D(sn));var r=new N(function(r,o){var s=t._window,a=t._document,l=a.createElement("script"),u=t.jsonpCallback,c=n.jsonpIdentifier||"callback";l.src=i+(i.indexOf("?")>-1?"&":"?")+c+"="+u;var h=s[u];s[u]=function(e){y(t.clearTimeout)&&t.clearTimeout(),a.head.removeChild(l),C(h)?U(s,u):s[u]=h,r({response:e,status:200})},a.head.appendChild(l);var p=n.timeout;g(p)&&p>0&&(t.clearTimeout=O(function(){t.clearTimeout=$(function(){o(new T({response:"Request timed out in "+p+"ms for "+i,status:408})),s[u]=e},p-1)}))});return r.initialize(this),r},t.prototype._xhrOnReadyStateChange=function(){var t=this.xhr;if(4===t.readyState){var e=t.status;if(0===e){var n=t.response;if(b(n))try{n=t.responseText}catch(t){}return!v(n)}return e>=200&&e<300||304===e}},t.prototype._sendXhrRequest=function(){var t=this,e=this.xhr,n=this.__options,i=n.method,r=n.url,o=new N(function(o,s){e.onreadystatechange=function(){var e=t._xhrOnReadyStateChange();if(!b(e)){var i=t._formatResponse(n.responseType,e);e?o(i):s(new T(i)),t.xhr=n=null}},_(i)||(t._log.info('AjaxOptions method was not of type string. Defaulting to "GET".'),i="GET"),e.open(i.toUpperCase(),r,!0,n.user,n.password);var l=n.responseType;if(t.__fileSupported||""===l||"text"===l||(l=""),"json"===l)try{e.responseType=l}catch(t){e.responseType=""}e.withCredentials=n.withCredentials;var u=n.overrideMimeType,c=n.data;if(_(u)&&!v(u)&&e.overrideMimeType(u),b(c)||""===c)t.__setHeaders(),e.send();else{var h=n.transforms||[],p=h.length,f=n.contentType,d=_(f)&&!v(f);if(p>0){for(var m=0;m<p;++m)c=h[m](c,e);d&&e.setRequestHeader("Content-Type",f),t.__setHeaders(),e.send(c)}else if(a(c))if(d){var y=f.toLowerCase();-1!==y.indexOf("x-www-form-urlencoded")?(c=t.__serializeFormData(),e.setRequestHeader("Content-Type",f),t.__setHeaders(),e.send(c)):-1!==y.indexOf("multipart/form-data")?t.__fileSupported?(c=t.__appendFormData(),t.__setHeaders(),e.send(c)):t.__submitFramedFormData().then(function(t){o(t)},function(){t.xhr=null}):(c=JSON.stringify(c),e.setRequestHeader("Content-Type",f),t.__setHeaders(),e.send(c))}else t.__setHeaders(),e.send(c);else d&&e.setRequestHeader("Content-Type",f),t.__setHeaders(),e.send(c)}var C=n.timeout;g(C)&&C>0&&(t.clearTimeout=O(function(){t.clearTimeout=$(function(){s(new T({response:"Request timed out in "+C+"ms for "+n.url,status:408,getAllResponseHeaders:function(){return e.getAllResponseHeaders()},xhr:e})),e.onreadystatechange=null,e.abort(),t.xhr=null},C-1)}))});return o.initialize(this),o},t.prototype._invalidOptions=function(){var t=this;return new N(function(e,n){t._log.warn("Attempting a request without specifying a url"),n(new T({response:"Attempting a request without specifying a url",status:null,getAllResponseHeaders:null,xhr:null}))})},t.prototype._formatResponse=function(t,e){var n=this.xhr,i=n.status,r=n.response;if(b(r))try{r=n.responseText}catch(t){}if(0===i&&(i=e?200:404),n.onreadystatechange=null,y(this.clearTimeout)&&this.clearTimeout(),"json"===t&&_(r))try{r=JSON.parse(r)}catch(t){}return{response:r,status:i,getAllResponseHeaders:function(){return n.getAllResponseHeaders()},xhr:n}},t.prototype.__setHeaders=function(){var t,e,n=this.__options.headers,i=Object.keys(n||{}),r=this.xhr,o=i.length;for(e=0;e<o;++e)t=i[e],r.setRequestHeader(t,n[t])},t.prototype.__serializeFormData=function(){for(var t,e,n=this.__options.data,i=Object.keys(n),r=[];i.length>0;)b(e=n[t=i.pop()])?e="":a(e)&&(w(e)?e=e.toISOString():p(e)?(this._log.warn('Invalid File entry with key "'+t+'"'),e="[object File]"):(this._log.warn('Invalid form entry with key "'+t+'" and value "'+e),e=JSON.stringify(e))),r.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return r.join("&").replace(/%20/g,"+")},t.prototype.__appendFormData=function(){for(var t,e,n=this.__options.data,i=new FormData,r=Object.keys(n);r.length>0;)b(e=n[t=r.pop()])?i.append(t,""):a(e)?w(e)?i.append(t,e.toISOString()):p(e)?i.append(t,e,e.name||e.fileName||"blob"):(this._log.warn('Invalid form entry with key "'+t+'" and value "'+e),i.append(t,JSON.stringify(e))):i.append(t,e);return i},t.prototype.__submitFramedFormData=function(){var t,e=this,n=this.__options,i=n.data,r=n.url,o=this._document,s=o.body,a=dt(Ft),l=o.createElement("form"),u=o.createElement("iframe"),c=D("iframe_target"),h=Object.keys(i);for(u.name=l.target=c,u.src="javascript:false;",l.enctype=l.encoding="multipart/form-data",l.action=r,l.method="POST",l.style.display="none";h.length>0;)t=h.pop(),l.insertBefore(this.__createInput(t,i[t]),null);return new a(function(t,n){e.xhr.abort=function(){u.onload=null,s.removeChild(l),s.removeChild(u),n()},u.onload=function(){var n=u.contentDocument.body.innerHTML;s.removeChild(l),s.removeChild(u),t({response:n,status:200,getAllResponseHeaders:function(){return""}}),e.xhr=u.onload=null},s.insertBefore(l,null),s.insertBefore(u,null),l.submit()})},t.prototype.__createInput=function(t,e){var n=this._document,i=n.createElement("input");if(i.type="hidden",i.name=t,b(e))i.value="";else if(a(e))if(!y(e.slice)||C(e.name)||C(e.path))this._log.info('Invalid form entry with key "'+t+'" and value "'+e),i.value=JSON.stringify(e);else{var r=n.querySelectorAll('input[type="file"][name="'+t+'"]'),o=r.length;if(0===o)this._log.info('Could not find input[type="file"] with [name="'+t+'"]. Stringifying data instead.'),i.value=JSON.stringify(e);else if(1===o){var s=(i=r[0]).cloneNode(!0);i.parentNode.insertBefore(s,i)}else{for(var l=void 0,u=e.path;o-- >0;)if((l=r[o]).value===u){var c=(i=l).cloneNode(!0);i.parentNode.insertBefore(c,i);break}-1===o&&(this._log.info('Could not find input[type="file"] with [name="'+t+'"] and [value="'+e.path+'"]. Stringifying data instead.'),i.value=JSON.stringify(e))}}else i.value=e;return i},t._inject={_browser:"$Browser",_window:ee,_document:zt,_config:"$HttpConfig",_log:Bt},t}();t.HttpRequest=E;var T=function(){function t(t){this.name="AjaxError",Error.apply(this),this.response=this.message=t.response,this.status=t.status,this.getAllResponseHeaders=t.getAllResponseHeaders,this.xhr=t.xhr}return t.prototype.toString=function(){var t=this.response,e=t;return a(t)&&!t.hasOwnProperty("toString")&&(e=JSON.stringify(t)),"Request failed with status: "+this.status+" and response: "+e},t}();t.AjaxError=T,T.prototype=Error.prototype;var N=function(t){function n(e,n){var i=t.call(this,e)||this;return i._window=dt(ee),b(n)||(i.__http=n.__http),i}return __extends(n,t),n.prototype.initialize=function(t){a(t)&&b(this.__http)&&(this.__http=t)},n.prototype.cancel=function(){var t=this.__http,n=t.xhr,i=t.jsonpCallback;y(t.clearTimeout)&&t.clearTimeout(),b(n)?b(i)||(this._window[i]=e):(n.onreadystatechange=null,n.abort(),t.xhr=null),this.__subscribers=[]},n.prototype.then=function(e,n){return t.prototype.then.call(this,e,n)},n.prototype.catch=function(e){return t.prototype.catch.call(this,e)},n}(f);t.AjaxPromise=N;var S=function(){function t(){this.responseType={DEFAULT:"",ARRAYBUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},this.contentType={ENCODED_FORM:"application/x-www-form-urlencoded;charset=utf-8",JSON:"application/json;charset=utf-8",MULTIPART_FORM:"multipart/form-data",OCTET_STREAM:"application/octet-stream;charset=utf-8",XML:"application/xml;charset=utf-8",PLAIN_TEXT:"text/plain",HTML:"text/html"}}return t.prototype.ajax=function(t){var e=dt("$HttpRequestInstance");return e.initialize(t),e.execute()},t.prototype.jsonp=function(t){var e=dt("$HttpRequestInstance");return e.initialize(t),e.executeJsonp()},t.prototype.json=function(t){var e=dt("$HttpRequestInstance");return e.initialize(r(!1,!1,{},t,{responseType:"json"})),e.execute()},t.config={url:null,method:"GET",responseType:"",transforms:[],headers:{},withCredentials:!1,timeout:null,jsonpIdentifier:"callback",contentType:"application/json;charset=utf-8"},t}();t.Http=S,Pt.injectable($t,S),Pt.injectable("$HttpRequestInstance",E,null,Xn),t.IHttpConfig=o,Pt.injectable("$HttpConfig",o)}(Ui=t.async||(t.async={}));!function(t){function e(){return o}function n(){return t.managerCache}var i={},r={},o=function(){function t(t,e){this.__uid=t,this.__options=e,this.__size=0,b(e)&&(this.__options={timeout:0}),r[t]={}}return t.create=function(e,n){var r=i[e];return b(r)&&(r=i[e]=new t(e,n)),r},t.fetch=function(t){return i[t]},t.clear=function(){for(var t=Object.keys(i),e=t.length,n=0;n<e;++n)i[t[n]].clear();i={}},t.prototype.info=function(){return{uid:this.__uid,size:this.__size,options:this.__options}},t.prototype.put=function(t,e){var n=r[this.__uid][t];r[this.__uid][t]=e,C(n)&&this.__size++;var i=this.__options.timeout;return g(i)&&i>0&&$(this.remove,i,[t],this),e},t.prototype.read=function(t){return r[this.__uid][t]},t.prototype.remove=function(t){U(r[this.__uid],t),this.__size--},t.prototype.clear=function(){r[this.__uid]={},this.__size=0},t.prototype.dispose=function(){this.clear(),U(i,this.__uid)},t}();t.Cache=o,t.ICacheFactory=e,Pt.injectable(Qt,e,null,Gn),t.managerCache=o.create("__managerCache"),t.IManagerCache=n,Pt.injectable(Wt,n);var s=function(t){function e(){return t.call(this,"__templateCache")||this}return __extends(e,t),e.prototype.put=function(e,n){var i=this._Promise;if(t.prototype.put.call(this,e,i.resolve(n)),h(n))n=n.cloneNode(!0);else if(c(n)){var r=document.createDocumentFragment();r.appendChild(n.cloneNode(!0)),n=r}else(_(n)||b(n))&&(n=nt(n));return i.resolve(n)},e.prototype.read=function(e){var n=this,i=t.prototype.read.call(this,e);return b(i)?this._Promise.reject(null):i.then(function(t){return n.put(e,t)},function(t){return n._log.warn("Error retrieving template, "+e+", from promise."),null})},e._inject={_Promise:Ft,_log:Bt},e}(o);t.TemplateCache=s,Pt.injectable(Yt,s);var a=function(){function t(t){var e=this;this._storage=t,S(function(t,n){e[n]=t},t)}return Object.defineProperty(t.prototype,"length",{get:function(){return this._storage.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._storage.clear()},t.prototype.getItem=function(t){return this._storage.getItem(t)},t.prototype.key=function(t){return this._storage.key(t)},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t.prototype.setItem=function(t,e){this._storage.setItem(t,e),this[t]=this.getItem(t)},t}();t.BaseStorage=a;var l=function(t){function e(){return t.call(this,dt(ee).localStorage)||this}return __extends(e,t),e}(a);t.LocalStorage=l,Pt.injectable("$LocalStorage",l);var u=function(t){function e(){return t.call(this,dt(ee).sessionStorage)||this}return __extends(e,t),e}(a);t.SessionStorage=u,Pt.injectable("$SessionStorage",u)}(t.storage||(t.storage={}));var Vi={"u+":{precedence:4,associativity:"rtl",fn:function(t,e,n){return+n(t,e)}},"+":{precedence:6,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)+i(t,e)}},"u-":{precedence:4,associativity:"rtl",fn:function(t,e,n){return-n(t,e)}},"-":{precedence:6,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)-i(t,e)}},"*":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)*i(t,e)}},"/":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)/i(t,e)}},"%":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)%i(t,e)}},"?":{precedence:15,associativity:"rtl",fn:function(){}},":":{precedence:15,associativity:"rtl",fn:function(){}},">":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>i(t,e)}},"<":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<i(t,e)}},"!":{precedence:4,associativity:"rtl",fn:function(t,e,n){return!n(t,e)}},"~":{precedence:4,associativity:"rtl",fn:function(t,e,n){return~n(t,e)}},"&":{precedence:10,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)&i(t,e)}},"|":{precedence:12,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)|i(t,e)}},">>":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>>i(t,e)}},"<<":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<<i(t,e)}},">>>":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>>>i(t,e)}},"&&":{precedence:13,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)&&i(t,e)}},"||":{precedence:14,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)||i(t,e)}},"==":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)==i(t,e)}},"===":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)===i(t,e)}},"!=":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)!=i(t,e)}},"!==":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)!==i(t,e)}},">=":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>=i(t,e)}},"<=":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<=i(t,e)}},"=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"++":{precedence:3,associativity:"",fn:function(t,e,n){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"--":{precedence:3,associativity:"",fn:function(t,e,n){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"+=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"-=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"*=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"/=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}},"%=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){plat.acquire(Bt).error(new Error("Assignment operators are not supported"))}}},qi={"()":{precedence:2,associativity:null,fn:null},"[]":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},"{}":{precedence:1,associativity:null,fn:null}},Hi={"{":{precedence:1,associativity:null,fn:null},"}":{precedence:1,associativity:null,fn:null},"[":{precedence:2,associativity:null,fn:null},"]":{precedence:2,associativity:null,fn:null},"(":{precedence:2,associativity:null,fn:null},")":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},",":{precedence:18,associativity:null,fn:null},"'":{precedence:0,associativity:null,fn:null},'"':{precedence:0,associativity:null,fn:null}},Qi={false:!1,true:!0,null:null,undefined:"undefined"};!function(t){function s(t){return u._log=t,u}var l=["push","pop","reverse","shift","sort","splice","unshift"],u=function(){function t(){this._compat=dt(Mt),this.__identifiers={},this.__identifierHash={},this.__lengthListeners={},this.__contextObjects={},this.__isArrayFunction=!1}return t.getManager=function(e){var n,i=t.__managers,r=e.uid,o=i[r];return b(o)?(n=i[r]=new t,n.context=e,n):n=o},t.dispose=function(e){if(!b(e)){var n=e.uid,i=t.__controls,r=i[n]||{},o=t.__managers,s=o[n];b(s)||(s.dispose(),U(o,n));for(var a,l=Object.keys(r);l.length>0;)for(a=r[l.shift()];a.length>0;)a.shift()();U(i,n),e.hasOwnContext&&!b(e.context)&&(t.unObserve(e.context),t.defineProperty(e,"context",e.context,!0,!0,!0))}},t.removeArrayListeners=function(e,n){var i=t.arrayChangeListeners[e];b(i)||U(i,n)},t.getContext=function(t,e){if(b(t))return t;for(e=e.slice(0);e.length>0;)if(t=t[e.shift()],b(t))return t;return t},t.defineProperty=function(t,e,i,r,o,s){n(t,e,i,r,o,s)},t.defineGetter=function(t,e,n,r,o){i(t,e,n,r,o)},t.pushRemoveListener=function(e,n,i){var r,o=t.__controls,s=o[n];b(s)&&(s=o[n]={}),b(r=s[e])&&(r=s[e]=[]),r.push(i)},t.spliceRemoveListener=function(e,n,i){var r,o=t.__controls[n];if(!b(o)&&(r=o[e],!b(r))){var s=r.indexOf(i);-1!==s&&(r.splice(s,1),0===r.length&&U(o,e))}},t.removeIdentifier=function(e,n){for(var i,r=e.length,o=t.__controls,s=0;s<r;++s)b(i=o[e[s]])||U(i,n)},t.createContext=function(e,n){var i=e.context;if(!a(i)){if(!b(i))return void t._log.warn("A child control is trying to create a child context that has a parent control with a primitive type context");i=e.context={}}for(var r,o,s=n.split(".");s.length>0;)b(o=i[r=s.shift()])&&(o=g(Number(s[0]))?i[r]=[]:i[r]={}),i=o;return i},t.unObserve=function(t){r(!0,!0,t)},t.prototype.getContext=function(t,e){return this._getContext(t.join("."),t,e)},t.prototype.observe=function(n,i){var r=this;if(v(n))return e;var o,s,l=n.split("."),u=l.pop(),c="length"===u,h=this._hasIdentifier(n),p=!b(i);if(l.length>0?(o=l.join("."),s=this._getContext(o,l,!0)):(o=u,s=this.context),!a(s))return p?(c&&(this.__lengthListeners[n]=i,t.pushRemoveListener(n,i.uid,function(){U(r.__lengthListeners,n)})),this._addObservableListener(n,i,c)):e;this.__observedIdentifier=null,this.__contextObjects[n]=s[u];var f=this.__observedIdentifier,d=!b(f),m=e;if(d&&(h=!0),p){var g=e,y=this._addObservableListener(n,i,c);d&&n!==f&&(g=this._addObservableListener(f,i,c)),m=function(){y(),g()}}var C=x(s),E=m,w=e,T=e,N=Number(u);if(C&&N>=s.length)w=this.observe(o+".length",{uid:i.uid,listener:function(t,e){N>=t||(w(),r._define(n,s,u))}}),m=function(){E(),w()};else if(!h)if(C&&c){var S=l.pop(),k=this.getContext(l,!1);if(this.__observedIdentifier=null,V(k,S),_(this.__observedIdentifier)&&(o=this.__observedIdentifier),p){var I=i.uid;w=this.observeArrayMutation(I,e,o,s,null),T=this.observe(o,{uid:I,listener:function(t,n){w(),w=r.observeArrayMutation(I,e,o,t,n)}})}m=function(){E(),T(),w()}}else this._define(n,s,u);return m},t.prototype.observeArrayMutation=function(t,n,i,r,o){if(x(o)&&this._restoreArray(o),b(r))return e;var s=i.split("."),a=s.pop(),l=this.getContext(s,!1);this.__observedIdentifier=null,V(l,a),_(this.__observedIdentifier)&&(i=this.__observedIdentifier);var u=[];return y(n)&&u.push(this._pushArrayListener(t,i,n)),this._overwriteArray(i,r),function(){for(;u.length>0;)u.pop()()}},t.prototype.dispose=function(){this.context=null,this.__identifiers={},this.__identifierHash={},this.__contextObjects={}},t.prototype._pushArrayListener=function(e,n,i){var r=t.arrayChangeListeners,o=r[n];b(o)&&(o=r[n]={});var s=o[e];b(s)&&(s=o[e]=[]);var a=!1,l=function(){if(!a){a=!0,t.spliceRemoveListener(n,e,l);var u=s.indexOf(i);-1!==u&&(s.splice(u,1),0===s.length&&(U(o,e),v(o)&&U(r,n)))}};return s.push(i),t.pushRemoveListener(n,e,l),l},t.prototype._restoreArray=function(t){var e=this._compat;if(e.setProto)Object.setPrototypeOf(t,Object.create(Array.prototype));else if(e.proto)t.__proto__=Object.create(Array.prototype);else for(var n=l.length,i=void 0,r=0;r<n;++r)t[i=l[r]]=Array.prototype[i]},t.prototype._overwriteArray=function(e,n){var i,r,o=this._compat,s=l.length;if(o.proto){var a=Object.create(Array.prototype);for(r=0;r<s;++r)a[i=l[r]]=this._overwriteArrayFunction(e,i);o.setProto?Object.setPrototypeOf(n,a):n.__proto__=a}else for(r=0;r<s;++r)i=l[r],t.defineProperty(n,i,this._overwriteArrayFunction(e,i),!1,!0,!0)},t.prototype._getContext=function(t,e,n){var i=this.__contextObjects[t];return b(i)&&(i=!0===n?this.__contextObjects[t]=this._observeImmediateContext(e,t):this._getImmediateContext(e)),i},t.prototype._getImmediateContext=function(t){for(var e=this.context;t.length>0&&(e=e[t.shift()],!b(e)););return e},t.prototype._observeImmediateContext=function(t,e){return b(this.__identifiers[e])&&this.observe(e,null),this._getImmediateContext(t)},t.prototype._getValues=function(t,e,n){for(var i,r=a(e),o=a(n);t.length>1&&(i=t.shift(),r&&b(e=e[i])&&(r=!1),o&&b(n=n[i])&&(o=!1),r||o););i=t[0];var s,l;return b(e)||(s=e[i]),b(n)||(l=n[i]),{newValue:s,oldValue:l}},t.prototype._notifyChildProperties=function(t,n,i,r){for(var o,s,l,u,c,h,p,f,d,m,g,y=this,C=(r=r||Object.keys(this.__identifierHash[t]||{})).length,E={},w=t.length+1,T=0;T<C;++T){if(o=r[T],s=o.slice(w),u=s.split("."),h=u.pop(),p="length"===h,l=u.join("."),v(l)){if(f=n,d=i,m=b(f)?void 0:f[h],g=b(d)?void 0:d[h],p&&!x(d)&&x(f)){var N=this.__lengthListeners[o];if(!b(N)){var S=N.uid,k=t.split("."),I=k.pop(),R=k.join("."),j=this._getContext(R,k,!1);this.__observedIdentifier=null,V(j,I),_(this.__observedIdentifier)&&(R=this.__observedIdentifier);var A=this.observeArrayMutation(S,e,R,f,null);this.observe(R,{uid:S,listener:function(t,n){A(),A=y.observeArrayMutation(S,e,R,t,n)}}),U(this.__lengthListeners,o)}}}else b(c=E[l])&&(c=E[l]=this._getValues(u,n,i)),f=c.newValue,d=c.oldValue,m=b(f)?f:f[h],g=b(d)?d:d[h];E[s]={newValue:m,oldValue:g},a(f)&&(!x(f)||f.length>h)&&this._define(o,f,h),this._execute(o,m,g)}E=null},t.prototype._addObservableListener=function(e,n,i){var r=this;if(!0===i){var o=e.split(".");o.pop();var s=o.pop(),l=this.getContext(o,!1);a(l)&&(this.__observedIdentifier=null,V(l,s),_(this.__observedIdentifier)&&(e=this.__observedIdentifier+(!0===i?".length":"")))}this.__add(e,n);var u=n.uid,c=function(){t.spliceRemoveListener(e,u,c),r._removeCallback(e,n)};return t.pushRemoveListener(e,u,c),c},t.prototype._define=function(t,e,n){a(e[n])?this.__defineObject(t,e,n):this.__definePrimitive(t,e,n)},t.prototype._overwriteArrayFunction=function(e,n){var i=t.arrayChangeListeners[e]||{},r=this;return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var l,u,c,h,p,_,f=this.length,d=o(this,!0),v="unshift"===n,m="shift"===n,g="splice"===n,y=m||v||g,b="sort"===n||"reverse"===n;y?(r.__isArrayFunction=!0,l=Array.prototype[n].apply(this,s),r.__isArrayFunction=!1,p=this.length,h=0,m?(c=0,_=f>0?[l]:[]):v?(c=s.length,_=[]):(c=s.length-2,h=s[0],_=l)):(l=Array.prototype[n].apply(this,s),p=this.length,b?u=d:"push"===n?(c=s.length,h=f,_=[]):"pop"===n&&(c=0,h=p,_=f>0?[l]:[])),(m||g||"pop"===n)&&t.unObserve(l);var C,x,E,w,T=Object.keys(i),N=T.length;for(E=0;E<N;++E)for(x=(C=i[T[E]]).length,w=0;w<x;++w)C[w]([{object:this,type:n,index:h,removed:_,addedCount:c,oldArray:u}]);return y?r._notifyChildProperties(e,this,d):r._execute(e+".length",p,f),l}},t.prototype._removeCallback=function(t,e){var n=this.__identifiers[t];if(!b(n)){var i=n.indexOf(e);-1!==i&&(n.splice(i,1),0===n.length&&U(this.__contextObjects,t))}},t.prototype._hasIdentifier=function(t){return!v(this.__identifiers[t])},t.prototype._execute=function(t,e,n){var i=this.__identifiers[t];if(C(e)?U(this.__contextObjects,t):this.__contextObjects[t]=e,e!==n&&!b(i))for(var r=i.slice(0),o=r.length,s=0;s<o;++s)r[s].listener(e,n)},t.prototype.__defineObject=function(e,n,i){var r=this,o=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=e,o},set:function(s){if(o!==s){var l=o;if(o=s,!r.__isArrayFunction){t.unObserve(l);var u,c=r.__identifierHash[e],h=!1;a(c)&&(h=(u=Object.keys(c)).length>0),r._execute(e,o,l),h?(r._notifyChildProperties(e,o,l,u),a(o)||r.__definePrimitive(e,n,i)):v(r.__identifiers[e])?t.defineProperty(n,i,o,!0,!0,!0):a(o)||r.__definePrimitive(e,n,i)}}}})},t.prototype.__definePrimitive=function(e,n,i){var r=this,o=n[i],s=!b(o);x(n)&&"length"===i||Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=e,o},set:function(l){if(o!==l){var u=o;if(o=l,!r.__isArrayFunction||!x(n)){var c,h=r.__identifierHash[e],p=!1;a(h)&&(p=(c=Object.keys(h)).length>0),r._execute(e,l,u),!p&&v(r.__identifiers[e])?t.defineProperty(n,i,o,!0,!0,!0):a(o)?(r.__defineObject(e,n,i),p&&r._notifyChildProperties(e,l,u,c)):s||(r.__definePrimitive(e,n,i),s=!0)}}}})},t.prototype.__add=function(t,e){var n=this.__identifiers[t],i=e.priority,r=!1;if(b(n)&&(n=this.__identifiers[t]=[]),g(i)){for(var o=n.length,s=0;s<o;++s)if(i>n[s].priority){n.splice(s,0,e),r=!0;break}}else e.priority=-1;r||n.push(e),this.__addHashValues(t)},t.prototype.__addHashValues=function(t){var e=this.__identifierHash;if(!a(e[t])){e[t]={};for(var n,i,r,o,s=t,l=[];-1!==(n=s.lastIndexOf("."));){for(i=e[s=s.slice(0,n)],o=l.length,b(i)&&(i=e[s]={}),i[t]=!0,r=0;r<o;++r)i[l[r]]=!0;l.push(s)}}},t.arrayChangeListeners={},t.__managers={},t.__controls={},t}();t.ContextManager=u,t.IContextManagerStatic=s,Pt.injectable(qt,s,[Bt],Wn),Pt.injectable("$ContextManagerInstance",u,null,Xn)}(t.observable||(t.observable={}));var Wi;!function(t){function e(){return o}function n(t,e,n,i,r){return s._log=t,s._compat=e,s._document=n,s._window=i,s._dom=r,s}function i(t){return a._EventManager=t,a}var r=function(){function t(){this.defaultPrevented=!1,this.stopped=!1}return t.prototype.initialize=function(t,e,n){this.name=t,this.direction=n||this._EventManager.UP,this.sender=e},t.prototype.preventDefault=function(){this.defaultPrevented||this._ContextManager.defineGetter(this,"defaultPrevented",!0)},t.prototype.stopPropagation=function(){this.direction===this._EventManager.UP&&(this.stopped=!0,this._EventManager.propagatingEvents[this.name]=!1)},t._inject={_EventManager:"$EventManagerStatic",_ContextManager:qt},t}();t.DispatchEvent=r,Pt.injectable("$DispatchEventInstance",r,null,Xn);var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.dispatch=function(t,e){var n=dt("$LifecycleEventInstance");return n.initialize(t,e),s.sendEvent(n),n},e.prototype.initialize=function(e,n){t.prototype.initialize.call(this,e,n,this._EventManager.DIRECT)},e}(r);t.LifecycleEvent=o,t.ILifecycleEventStatic=e,Pt.injectable("$LifecycleEventStatic",e,null,Wn),Pt.injectable("$LifecycleEventInstance",o,null,Xn);var s=function(){function t(){}return t.initialize=function(){if(!t.__initialized){t.__initialized=!0;for(var e,n=t.__lifecycleEventListeners,i=t._compat,r=t._document,s=t._window,a=t._dom,l=o.dispatch;n.length>0;)e=n.pop(),r.removeEventListener(e.name,e.value,!1);if(i.cordova){for(var u,c=["resume","online","offline"],h=i.winJs,p=c.length,_=function(e){return function(){l(e,t)}},f=void 0,d=0;d<p;++d)f=_(u=c[d]),n.push({name:u,value:f}),a.addEventListener(r,u,f,!1);f=_("suspend"),n.push({name:"pause",value:f}),a.addEventListener(r,"pause",f,!1),f=_("ready"),n.push({name:"deviceReady",value:f}),a.addEventListener(r,"deviceReady",f,!1),f=function(){return h||l("backbutton",t),!0},n.push({name:"backbutton",value:f}),a.addEventListener(r,"backbutton",f,!1),h&&(f=function(){return l("backbutton",t),!0},n.push({name:"backclick",value:f}),s.WinJS.Application.addEventListener("backclick",f,!1))}else{if(i.amd)return;a.addEventListener(s,"load",function(){l("ready",t)})}}},t.dispose=function(e){U(t.__eventsListeners,e)},t.on=function(e,n,i,r){var o=t.__eventsListeners[e];b(o)&&(o=t.__eventsListeners[e]={listeners:{},context:r});var s=o.listeners[n];return x(s)||(s=o.listeners[n]=[]),s.push(i),function(){var t=s.indexOf(i);-1!==t&&s.splice(t,1)}},t.dispatch=function(e,n,i,r){var o=dt("$DispatchEventInstance");return o.initialize(e,n,i),t.sendEvent(o,r),o},t.hasDirection=function(e){return e===t.UP||e===t.DOWN||e===t.DIRECT},t.sendEvent=function(e,n){var i=e.name,r=e.direction;switch(n=n||[],t.propagatingEvents[i]=!0,n=n||[],r){case t.UP:t._dispatchUp(e,n);break;case t.DOWN:t._dispatchDown(e,n);break;case t.DIRECT:t._dispatchDirect(e,n)}U(t.propagatingEvents,i)},t._dispatchUp=function(e,n){for(var i=e.name,r=e.sender;!b(r)&&t.propagatingEvents[i];)b(r.uid)?r=r.parent:(t.__executeEvent(r.uid,e,n),r=r.parent)},t._dispatchDown=function(e,n){var i,r=[],o=e.name;for(r.push(e.sender);r.length&&t.propagatingEvents[o];)b((i=r.pop()).uid)||(t.__executeEvent(i.uid,e,n),b(i.controls)||(r=r.concat(i.controls)))},t._dispatchDirect=function(e,n){for(var i,r=Object.keys(t.__eventsListeners),o=r.length,s=e.name,a=0;a<o&&t.propagatingEvents[s];++a)b(i=t.__eventsListeners[r[a]])||b(i.listeners[s])||t.__callListeners(i.context,e,i.listeners[s],n)},t.__executeEvent=function(e,n,i){var r=t.__eventsListeners[e];if(!b(r)){var o=r.context,s=r.listeners[n.name];b(s)||t.__callListeners(o,n,s,i)}},t.__callListeners=function(e,n,i,r){var o=n.name,s=i.length,a=-1;for(r=[n].concat(r);++a<s&&t.propagatingEvents[o];)try{i[a].apply(e,r)}catch(e){t._log.debug(e)}},t.UP="up",t.DOWN="down",t.DIRECT="direct",t.propagatingEvents={},t.__eventsListeners={},t.__lifecycleEventListeners=[],t.__initialized=!1,t}();t.EventManager=s,t.IEventManagerStatic=n,Pt.injectable("$EventManagerStatic",n,[Bt,Mt,zt,ee,"$Dom"],Wn);var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.dispatch=function(t,n,i,r){var o=dt(e);return o.initialize(t,n,null,i),o.logLevel=r,e._EventManager.sendEvent(o),o},e.prototype.initialize=function(e,n,i,r){t.prototype.initialize.call(this,e,n,this._EventManager.DIRECT),this.error=r},e}(r);t.ErrorEvent=a,t.IErrorEventStatic=i,Pt.injectable("$ErrorEventStatic",i,["$EventManagerStatic"],Wn)}(Wi=t.events||(t.events={}));var Yi=function(){function t(){this.uid=D(ie),this.priority=0,this.dom=t._dom,this.utils=dt(Zt),this._log=t._log}return t.getRootControl=function(e){if(b(e))return e;if(!b(e.root))return e.root;for(;!b(e.parent)&&!e.hasOwnContext;){if(!b(e.root))return e.root;e=e.parent}return!e.hasOwnContext&&a(e.context)&&t._log.debug("Root control: "+e.type+" found that sets its context to an Object but does not set the hasOwnContext flag to true. Please set the flag if the control intends to use its own context."),e},t.load=function(e){var n=t._Promise;if(b(e))return n.resolve();var i=e;if(_(i.absoluteContextPath)){y(i.contextChanged)&&(t._ContextManager.getManager(i.root).observe(i.absoluteContextPath,{uid:e.uid,priority:1e3,listener:function(t,n){Gi.TemplateControl.contextChanged(e,t,n)}}),y(i.zCC__plat)&&(i.zCC__plat(),U(i,"zCC__plat")));var r=i.element;c(r)&&y(r.removeAttribute)&&r.removeAttribute(cn)}return y(e.loaded)?n.resolve(e.loaded()):n.resolve()},t.dispose=function(e){var n=e;if(!b(n))if(C(n.templateControl)){if(n.hasOwnContext)Gi.ViewControl.dispose(n);else if(n.controls)Gi.TemplateControl.dispose(n);else if(y(e.dispose)&&e.dispose(),t.removeEventListeners(e),t._ContextManager.dispose(e),e.element=null,t.removeParent(e),e.__injectable__type===Wn){var i=ji[e.type];Pt.control(e.type,e.constructor,i.dependencies,!0)}}else Xi.dispose(n)},t.removeParent=function(t){if(!b(t)){var e=t.parent;if(!b(e)){var n=e.controls||[],i=n.indexOf(t);-1!==i&&n.splice(i,1),t.parent=null}}},t.removeEventListeners=function(e){if(!b(e)){var n=t.__eventListeners,i=e.uid,r=n[i];if(x(r)){for(var o=r.length;o-- >0;)r[o]();U(n,i)}}},t.getInstance=function(){return new t},t.__addRemoveListener=function(e,n){var i=t.__eventListeners;x(i[e])?i[e].push(n):i[e]=[n]},t.__spliceRemoveListener=function(e,n){var i=t.__eventListeners[e];if(x(i)){var r=i.indexOf(n);if(-1===r)return;i.splice(r,1)}},t.__getControls=function(e,n,i){var r,o=[],s=t.getRootControl(e);b(s)||s[n]!==i||o.push(s);var a=s.controls;if(b(a))return o;for(var l=[].concat(a);l.length>0;)(r=l.shift())[n]===i&&o.push(r),b(r.controls)||(l=l.concat(r.controls));return o},t.prototype.initialize=function(){},t.prototype.loaded=function(){},t.prototype.getControlsByName=function(e){return t.__getControls(this,"name",e)},t.prototype.getControlsByType=function(e){return _(e)?t.__getControls(this,"type",e):t.__getControls(this,"constructor",e)},t.prototype.addEventListener=function(n,i,r,o){if(!y(r))return this._log.warn('"Control.addEventListener" must take a function as the third argument.'),e;r=r.bind(this);var s=this.dom.addEventListener(n,i,r,o),a=this.uid;return t.__addRemoveListener(a,s),function(){s(),t.__spliceRemoveListener(a,s)}},t.prototype.observe=function(n,i){var r=this,o=a(this.context)?this:this.parent,s=t.getRootControl(o);if(b(o))return e;if(b(o.absoluteContextPath))return this._log.warn("Should not call plat.Control.observe prior to the control being loaded"),e;var l;if(v(i))l=o.absoluteContextPath;else if(_(i)){var u=(t._parser||dt("$Parser")).parse(i);u.identifiers.length>1&&this._log.warn("Only a single identifier can be observed when calling the function plat.Control.observe");var c=u.identifiers[0];if("@"===c[0]){var h=c.split("."),p=h.shift().slice(1),f=h.length>0?"."+h.join("."):"";l=p===li?"context"+f:p===ci?o.absoluteContextPath+f:o.absoluteContextPath+"."+c}else l=o.absoluteContextPath+"."+c}else l=o.absoluteContextPath+"."+i;return(t._ContextManager||dt(qt)).getManager(s).observe(l,{listener:function(t,e){n.call(r,t,e,i)},uid:this.uid})},t.prototype.observeArray=function(n,i){var r=a(this.context)?this:this.parent,o=r.context;if(b(r)||!a(o))return e;var s,l;if(v(i))s=o,l=r.absoluteContextPath;else if(_(i)){var u=(t._parser||dt("$Parser")).parse(i);s=u.evaluate(o),l=r.absoluteContextPath+"."+u.identifiers[0]}else s=o[i],l=r.absoluteContextPath+"."+i;if(!x(s))return e;if(!y(n))return e;n=n.bind(this);var c=(t._ContextManager||dt(qt)).getManager(t.getRootControl(r)),h=this.uid,p=function(t){n(t,i)},f=c.observeArrayMutation(h,p,l,s,null),d=c.observe(l,{listener:function(t,e){f(),f=c.observeArrayMutation(h,p,l,t,e)},uid:h});return function(){f(),d()}},t.prototype.observeExpression=function(n,i){var r=this;if(v(i))return e;if(_(i))i=(t._parser||dt("$Parser")).parse(i);else if(!y(i.evaluate))return e;var o=b(this.resources)?this.parent:this;if(b(o)||!_(o.absoluteContextPath))return e;var s,a,l,u,c=i.aliases,h=c.length,p={},f=(t._ContextManager||dt(qt)).getManager,d=Gi.TemplateControl,m=d.findResource,g=d.evaluateExpression;for(u=0;u<h;++u)s=c[u],b(a=m(o,s))||(l=a.resource.type)!==ni&&l!==si||(p[s]=f(a.control));var C,x,E=i.identifiers,w=f(t.getRootControl(o)),T=o.absoluteContextPath,N=T+".",S={};for(h=E.length,u=0;u<h;++u)x=(C=E[u]).split(".")[0],"@"!==C[0]?S[N+C]=w:(s=x.slice(1))===ci?S[T+C.replace(x,"")]=w:s===li?S[C.replace(x,"context")]=w:(C=C.replace(x,"resources."+s+".value"),b(p[s])||(S[C]=p[s]));h=(E=Object.keys(S)).length;var k=g(i,o),I=[],R=this.uid;for(u=0;u<h;++u)C=E[u],I.push(S[C].observe(C,{uid:R,listener:function(){var t=g(i,o);n.call(r,t,k,i.expression),k=t}}));return function(){for(var t=I.length,e=0;e<t;++e)I[e]()}},t.prototype.evaluateExpression=function(t,e){return Gi.TemplateControl.evaluateExpression(t,this.parent,e)},t.prototype.findProperty=function(e,n){var i,r=(t._parser||dt("$Parser")).parse(e);for(b(n)&&(n=this);!b(n);){if(i=r.evaluate(n),!b(i))return{expresssion:r,control:n,value:i};n=n.parent}},t.prototype.dispatchEvent=function(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=t._EventManager||dt("$EventManagerStatic");o.hasDirection(n)||(C(n)||i.unshift(n),n=o.UP);var s=this;b(s.templateControl)||(s=s.templateControl),o.dispatch(e,s,n,i)},t.prototype.on=function(e,n){return(t._EventManager||dt("$EventManagerStatic")).on(this.uid,e,n,this)},t.prototype.dispose=function(){},t.__eventListeners={},t}();t.Control=Yi,t.IControlFactory=xt,Pt.injectable(Dt,xt,["$Parser",qt,"$EventManagerStatic",Ft,"$Dom",Bt],Gn);var Xi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateControl=null,e}return __extends(e,t),e.dispose=function(t){U(t,"templateControl"),Yi.dispose(t)},e.getInstance=function(){return new e},e}(Yi);t.AttributeControl=Xi,t.IAttributeControlFactory=Et,Pt.injectable("$AttributeControlFactory",Et,null,Gn);var Gi;!function(t){function n(t,e,n,i,r,o,s,a){return f._ResourcesFactory=t,f._BindableTemplatesFactory=e,f._managerCache=n,f._templateCache=i,f._parser=r,f._http=o,f._Promise=s,f._log=a,f}function i(){return k}function s(){return I}function l(t,e,n){R._ContextManager=t,R._regex=e,R._log=n;var i={},r={};return i[ui]=i[ci]=i[ai]=i[li]=!0,r[ii]=r[ri]=r[ni]=r[oi]=r[si]=!0,R.__controlResources=i,R.__resourceTypes=r,R}function p(){return j.config}var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=100,e.context=null,e.absoluteContextPath=null,e.hasOwnContext=!1,e.replaceWith="any",e}return __extends(e,t),e.evaluateExpression=function(t,n,i){if(v(t))return t;if(_(t))t=e._parser.parse(t);else if(!y(t.evaluate))return t;if(b(n))return t.evaluate(null,i);if(!(t.aliases.length>0&&(i=e.getResources(n,t.aliases,i),v(i))))return t.evaluate(n.context,i)},e.getResources=function(t,n,i){if(b(t))return{};var r,o,s,a=n.length,l=e.__resourceCache[t.uid];b(l)&&(l=e.__resourceCache[t.uid]={}),i=i||{};for(var u=0;u<a;++u)if("@"===(r=n[u])[0]&&(r=r.slice(1)),r!==ci)if(r!==li){if(b(i[r])){if(b(l[r]))s=e.findResource(t,r);else{var c=l[r].control,h=c.resources;s=b(h)?e.findResource(t,r):{control:c,resource:h[r]}}if(b(s)){if(-1!==t.type.indexOf("-compiled"))continue;e._log.warn("Resource alias: "+r+" is not defined.")}else l[r]=s,o=s.resource,i[r]=b(o)?o:o.value}}else i[r]=Yi.getRootControl(t).context;else i[r]=t.context;return i},e.findResource=function(t,e){var n;if(!b(t)&&!b(t.resources)&&_(e)&&!v(e)){"@"===e[0]&&(e=e.slice(1));var i=e===li;if(i||e===ci||e===ui){if(i&&(t=Yi.getRootControl(t)),n=(t.resources||{})[e],b(n))return;return{resource:n,control:t}}for(;!b(t);){if(n=(t.resources||{})[e],!b(n))return{resource:n,control:t};t=t.parent}}},e.dispose=function(t){if(!b(t)){var n=t.uid,i=t.controls,r=i&&i.slice(0),o=Yi._ContextManager,s=o.defineProperty;if(!b(r))for(var a=r.length-1;a>=0;--a)Yi.dispose(r[a]);if(y(t.dispose)&&t.dispose(),Yi.removeEventListeners(t),e.removeElement(t),e._ResourcesFactory.dispose(t),e._BindableTemplatesFactory.dispose(t),U(e.__resourceCache,t.uid),o.dispose(t),Wi.EventManager.dispose(t.uid),e._managerCache.remove(n),Yi.removeParent(t),s(t,"resources",null,!0,!0,!0),t.attributes=null,t.bindableTemplates=null,t.controls=[],t.root=null,t.innerTemplate=null,t.__injectable__type===Wn){var l=ji[t.type];Pt.control(t.type,t.constructor,l.dependencies,!0)}}},e.loadControl=function(t){for(var n,i=t.controls,r=i.length,o=0;o<r;++o)b((n=i[o]).controls)?n.loaded():e.loadControl(n);t.loaded()},e.contextChanged=function(t,n,i){t.context=n,e.setContextResources(t),y(t.contextChanged)&&t.contextChanged(n,i)},e.setContextResources=function(t){var n=t.context;b(t.resources)&&(t.resources=e._ResourcesFactory.getInstance(),t.resources.initialize(t)),t.hasOwnContext&&(b(t.resources.rootContext)?t.resources.add({root:{type:ni,value:n}}):t.resources.rootContext.value=n),b(t.resources.context)?t.resources.add({context:{type:ni,value:n}}):t.resources.context.value=n},e.removeElement=function(t){if(!b(t)){var e,n=t.element;if(null===t.replaceWith||""===t.replaceWith||h(n))return rt(t.startNode,t.endNode),void(t.elementNodes=t.startNode=t.endNode=null);b(n)||(b(e=n.parentNode)||e.removeChild(n),t.element=null)}},e.setAbsoluteContextPath=function(t,e){Yi._ContextManager.defineGetter(t,"absoluteContextPath",e,!1,!0)},e.determineTemplate=function(t,n){var i=e._templateCache,r=t.dom,o=e._Promise;if(b(n)){if(b(t.templateUrl)){if(b(t.templateString))return o.reject(null);var s=t.type;return i.read(s).catch(function(e){return b(e)&&(e=t.templateString),i.put(s,e)})}n=t.templateUrl}else;return r.getTemplate(n)},e.detach=function(t){if(!b(t)&&!b(t.controls)){for(var n=t.controls.slice(0),i=n.length,r=0;r<i;++r)Yi.dispose(n[r]);Yi.removeEventListeners(t),e.removeElement(t),e._ResourcesFactory.dispose(t,!0),U(e.__resourceCache,t.uid),Yi._ContextManager.dispose(t),Wi.EventManager.dispose(t.uid),e._managerCache.remove(t.uid),Yi.removeParent(t),t.controls=[],t.attributes=null}},e.getInstance=function(){return new e},e.prototype.contextChanged=function(t,e){},e.prototype.setTemplate=function(){},e.prototype.getResources=function(t,n){return e.getResources(this,t,n)},e.prototype.findResource=function(t){return e.findResource(this,t)},e.prototype.evaluateExpression=function(t,n){return e.evaluateExpression(t,this,n)},e.__resourceCache={},e}(Yi);t.TemplateControl=f,t.ITemplateControlFactory=n,Pt.injectable(Kt,n,[Jt,Xt,Wt,Yt,"$Parser",$t,Ft,Bt],Gn),Pt.injectable("$TemplateControlInstance",f,null,Xn);var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=120,e._listeners=[],e}return __extends(e,t),e.prototype.onInput=function(t){var e=this._listeners;return e.push(t),function(){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},e.prototype.observeProperties=function(t){},e.prototype.inputChanged=function(t,e){if(t!==e)for(var n=this._listeners,i=n.length,r=0;r<i;++r)n[r](t,e)},e.prototype.dispose=function(){this._listeners=[]},e}(f);t.BindControl=w;var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasOwnContext=!0,e}return __extends(e,t),e.dispose=function(t){f.dispose(t)},e.getInstance=function(){return new e},e.prototype.canNavigateFrom=function(){},e.prototype.canNavigateTo=function(t,e){},e.prototype.navigatingFrom=function(){},e.prototype.navigatedTo=function(t,e){},e}(f);t.ViewControl=T;var N=function(){function t(){this._domEvents=dt(Gt)}return t.prototype.addEventListener=function(t,e,n,i){return this._domEvents.addEventListener(t,e,n,i)},t.prototype.appendChildren=function(t,e){return W(t,e)},t.prototype.cloneChildren=function(t,e){return W(t,e,!0)},t.prototype.clearNode=function(t){return Y(t)},t.prototype.clearNodeBlock=function(t,e){return X(t,e)},t.prototype.setInnerHtml=function(t,e){return K(t,e)},t.prototype.insertBefore=function(t,e,n){return Z(t,e,n)},t.prototype.replace=function(t){return tt(t)},t.prototype.replaceWith=function(t,e){return et(t,e)},t.prototype.serializeHtml=function(t){return nt(t)},t.prototype.removeBetween=function(t,e){return it(t,e)},t.prototype.removeAll=function(t,e){return rt(t,e)},t.prototype.addClass=function(t,e){return at(t,e)},t.prototype.removeClass=function(t,e){return lt(t,e)},t.prototype.toggleClass=function(t,e){return ut(t,e)},t.prototype.replaceClass=function(t,e,n){return ct(t,e,n)},t.prototype.hasClass=function(t,e){return ht(t,e)},t.prototype.getTemplate=function(t){return pt(t)},t.prototype.whenPresent=function(t,e){return _t(t,e)},t.prototype.whenVisible=function(t,e){return ft(t,e)},t._inject={_domEvents:Gt},t}();t.Dom=N,Pt.injectable("$Dom",N);var k=function(){function t(){this._ResourcesFactory=dt(Jt),this._ControlFactory=dt(Dt),this._TemplateControlFactory=dt(Kt),this._ContextManager=dt(qt),this._Promise=dt(Ft),this._managerCache=dt(Wt),this._document=dt(zt),this._ElementManagerFactory=dt(Ht),this._BindableTemplatesFactory=dt(Xt),this._log=dt(Bt),this.templates={},this.cache={},this.__compiledControls=[]}return t.create=function(e,n){var i=new t;return i.control=e,b(n)||(i.templates=n.templates,i.cache=n.cache),i},t.dispose=function(t){if(!b(t)){var e=t.bindableTemplates;!b(e)&&y(e.dispose)&&e.dispose()}},t.isBoundControl=function(t){if(b(t))return!1;var e=t.parent;return!b(e)&&0===t.type.indexOf(e.type+Zn)},t.prototype.once=function(t,e,n){var i,r=this;if(b(t))return this._Promise.resolve(this._document.createDocumentFragment());if(_(t))i=nt(t);else if(h(t))i=t;else if(i=this._document.createDocumentFragment(),c(t))i.appendChild(t);else{if(!E(t))return this._Promise.resolve(i);W(t,i)}if(b(e)||g(e)||_(e)){var o=this.control,s=this._managerCache.read(o.uid),a=this._ElementManagerFactory.getInstance(),l=this._createBoundControl("",i,e,n),u=this._createNodeMap(l,i,e);return o.controls.push(l),s.children=[],a.initialize(u,s),a.setUiControlTemplate(),a.fulfillAndLoad().then(function(){var t=r._document;return l.startNode=i.insertBefore(t.createComment(l.type+": start node"),i.firstChild),l.endNode=i.insertBefore(t.createComment(l.type+": end node"),null),i})}this._log.warn(this.control.type+" cannot bind template with relativeIdentifier: "+e+". Identifier must be either a string or number")},t.prototype.bind=function(t,e,n){return this._bind(t,e,n)},t.prototype.add=function(t,e,n){if(v(t))this._log.debug(this.control.type+" must use a valid key to add a template to BindableTemplates.");else if((b(this.templates[t])||n)&&!b(e))if(_(e))this._compile(t,nt(e));else if(h(e))this._compile(t,e);else{var i=this._document.createDocumentFragment();if(c(e))i.appendChild(e);else{if(!E(e))return;W(e,i)}this._compile(t,i)}},t.prototype.replace=function(e,n,i,r){var o=this.control.controls[e];if(!t.isBoundControl(o))return this._log.warn("The child control of "+this.control.type+" at the specified index: "+e+" is not a bound control and thus cannot be replaced by BindableTemplates."),this._Promise.resolve([]);var s=o.endNode;return c(s)&&c(s.parentNode)?this._bind(n,i,r,e):(this._log.warn("The child control of "+this.control.type+" at the specified index: "+e+" had either no placeholding comment nodes or its comment nodes had no parent and thus cannot be replaced by BindableTemplates."),this._Promise.resolve([]))},t.prototype.dispose=function(){for(var t=this._TemplateControlFactory.dispose,e=this.__compiledControls,n=e.length,i=0;i<n;++i)t(e[i]);this.__compiledControls=[],this.control=null,this.cache={},this.templates={}},t.prototype._bind=function(t,e,n,i){var r=this,o=this.templates[t],s=b(i);if(b(o))this._log.error(new Error(this.control.type+" cannot bind template, no template stored with key: "+t));else{if(b(e)||g(e)||_(e))return o=o.then(function(i){var o=i.cloneNode(!0),a=r._createBoundControl(t,o,e,n),l=r._createNodeMap(a,o,e);return s&&r.control.controls.push(a),r._bindTemplate(t,l)}),s?o.then(null,function(t){return O(function(){_(t)&&(t=new Error(t)),r._log.error(t)}),r._document.createDocumentFragment()}):o.then(function(t){var e=Array.prototype.slice.call(t.childNodes),n=r.control.controls[i],o=n.endNode,s=o.parentNode,a=o.nextSibling;return r._TemplateControlFactory.dispose(n),s.insertBefore(t,a),e}).then(null,function(t){return O(function(){_(t)&&(t=new Error(t)),r._log.error(t)}),r._document.createDocumentFragment()});this._log.warn(this.control.type+" cannot bind template with relativeIdentifier: "+e+". Identifier must be either a string or number")}},t.prototype._bindTemplate=function(t,n){var i=this,r=n.uiControlNode.control,o=!1,s=y(r.dispose)?r.dispose.bind(r):e;return r.dispose=function(){o=!0,s(),r.dispose=s},this._bindNodeMap(t,n).then(function(){var t=i._document,e=n.element;return o?t.createDocumentFragment():(r.startNode=e.insertBefore(t.createComment(r.type+": start node"),e.firstChild),r.endNode=e.insertBefore(t.createComment(r.type+": end node"),null),e)},function(t){return O(function(){_(t)&&(t=new Error(t)),i._log.error(t)}),null})},t.prototype._bindNodeMap=function(t,e){var n=this.cache[t],i=e.uiControlNode.control,r=e.element,o=this._managerCache;return n.clone(r,o.read(this.control.uid),e),o.read(i.uid).bindAndLoad()},t.prototype._compile=function(t,e){var n=this._createBoundControl(t+"-compiled",e),i=this._createNodeMap(n,e);this.__compiledControls.push(n),this._compileNodeMap(n,i,t)},t.prototype._compileNodeMap=function(t,e,n){var i=this,r=this._ElementManagerFactory.getInstance(),o=[];r.isClone=!0,r.initialize(e,null),r.setUiControlTemplate(),this.cache[n]=r,o.push(r.fulfillTemplate()),this.templates[n]=this._Promise.all(o).then(function(){var n=e.element,r=n.cloneNode(!0),o=i._document,s=t.startNode=o.createComment(t.type+": start node"),a=t.endNode=o.createComment(t.type+": end node");return n.insertBefore(s,n.firstChild),n.insertBefore(a,null),r})},t.prototype._createNodeMap=function(t,e,n){return{element:e,attributes:{},nodes:[],childContext:n,uiControlNode:{control:t,nodeName:t.type,expressions:[],injector:null}}},t.prototype._createBoundControl=function(t,e,n,i){var r=this._TemplateControlFactory.getInstance(),o=this._ResourcesFactory,s=this.control,l=this.cache[t],u=a(l),c=o.getInstance();if(u){var h=l.getUiControl();c.initialize(r,h.resources),c.add(i)}else c.initialize(r,i);if(r.resources=c,o.addControlResources(r),r.bindableTemplates=this._BindableTemplatesFactory.create(r,s.bindableTemplates),r.parent=s,r.controls=[],r.element=e,r.type=s.type+Zn+t,r.root=this._ControlFactory.getRootControl(r),u){var p=this._ContextManager.getManager(r.root);r.absoluteContextPath=s.absoluteContextPath||"context",b(n)||(r.absoluteContextPath+="."+n),r.context=p.getContext(r.absoluteContextPath.split("."),!1)}return r},t}();t.BindableTemplates=k,t.IBindableTemplatesFactory=i,Pt.injectable(Xt,i,null,Gn);var I=function(){function t(){this.__listeners={}}return t.getInstance=function(){return new t},t.prototype.initialize=function(t,e){this.__control=t;for(var n,i=Object.keys(e),r=this.__listeners,o=i.length,s=0;s<o;++s)this[n=i[s]]=e[n],r[n]=[]},t.prototype.observe=function(t,n){var i=this.__listeners[z(n)];return b(i)?e:(t=t.bind(this.__control),i.push(t),function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)})},t.prototype._attributeChanged=function(t,e,n){for(var i=this.__listeners[z(t)],r=i.length,o=0;o<r;++o)i[o](e,n)},t}();t.Attributes=I,t.IAttributesFactory=s,Pt.injectable("$AttributesInstance",I,null,Xn),Pt.injectable("$AttributesFactory",s,null,Gn);var R=function(){function t(){this.__resources={},this.__bound=!1}return t.create=function(n,i){if(b(i))return i;var r;switch(i.type.toLowerCase()){case ii:var o=Pi[i.value];b(o)||(i.value=o.inject());break;case ni:t._observeResource(n,i);break;case ri:_(r=i.value)&&(i.value=n.evaluateExpression(r));break;case si:break;case oi:_(r=i.value)&&(y(r=n[r])?i.value=r.bind(n):(t._log.warn('Attempted to create a "function" type Resource, but the function '+r+"cannot be found on your control."),i.value=e))}return i},t.addControlResources=function(e){e.resources.add({context:{value:e.context,type:ni},control:{value:e,type:ri}}),e.hasOwnContext&&t.__addRoot(e)},t.bindResources=function(e){var n=e.__resources;if(!b(n)){for(var i,r=e.__controlInstance,o=Object.keys(n),s=t.__controlResources,a=o.length,l=0;l<a;++l)!0!==s[i=o[l]]&&(e[i]=n[i]=t.create(r,e[i]));e.__bound=!0}},t.dispose=function(e,n){var i=e.resources;if(!b(i)){for(var r,s,a=Object.keys(i.__resources),l=a.length,u=t._ContextManager.defineProperty,c=0;c<l;++c)b(s=i[r=a[c]])||s.type!==ni&&s.type!==si||u(i,r,n?o(s,!0):null,!0,!0,!0);t._removeListeners(i.__controlInstance)}},t.parseElement=function(e){for(var n,i,r,o,s,a=Array.prototype.slice.call(e.children),l=t._regex,u=l.whiteSpaceRegex,c=l.quotationRegex,h={},p=t.__resourceTypes;a.length>0;)p[o=(n=a.pop()).nodeName.toLowerCase()]&&(i={},b(r=n.attributes.getNamedItem("alias"))||(i.alias=r.value,v(s=n.textContent.replace(u,"$1"))||(i.value=o===ii||o===si?s.replace(c,""):s,i.type=o,h[i.alias]=i)));return h},t.getInstance=function(){return new t},t._observeResource=function(e,n){var i=n.value,r=e.uid,o=t.__observableResourceRemoveListeners[r];if(b(o)&&(o=t.__observableResourceRemoveListeners[r]=[]),_(i)){b(n.initialValue)?n.initialValue=i:i=n.initialValue;var s=e.observeExpression(function(t){n.value=t},i);n.value=e.evaluateExpression(i),o.push(s)}},t._removeListeners=function(e){if(!b(e)){var n=e.uid,i=t.__observableResourceRemoveListeners[n];if(x(i))for(var r=i.length,o=0;o<r;++o)i[o]();U(t.__observableResourceRemoveListeners,n)}},t.__addRoot=function(t){t.resources.add({root:{value:t,type:ri,alias:ai},rootContext:{value:t.context,type:ni,alias:li}})},t.prototype.initialize=function(e,n){if(this.__controlInstance=e,!b(n)){c(n)?n=t.parseElement(n):a(n.resources)&&(n=n.resources),this.__resources=n;for(var i,r=Object.keys(n),o=r.length,s=0;s<o;++s)this[i=r[s]]=n[i]}},t.prototype.add=function(e){if(!b(e)){c(e)&&(e=t.parseElement(e));for(var n,i,r=Object.keys(e),o=r.length,s=this.__controlInstance,a=this.__bound,l=t.create,u=0;u<o;++u)(n=e[i=r[u]]).alias=i,this[i]=this.__resources[i]=a?l(s,n):n}},t.INJECTABLE=ii,t.OBJECT=ri,t.OBSERVABLE=ni,t.LITERAL=si,t.FUNCTION=oi,t.__observableResourceRemoveListeners={},t}();t.Resources=R,t.IResourcesFactory=l,Pt.injectable(Jt,l,[qt,Ut,Bt],Gn),Pt.injectable("$ResourcesInstance",R,null,Xn);var j=function(){function t(){this._gestures=t.gestures,this._androidVersion=C(this._compat.ANDROID)?-1:this._compat.ANDROID,this._android44orBelow=this._androidVersion>-1&&Math.floor(this._androidVersion/10)<=44,this._inMouse=!1,this._subscribers={},this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__hasMoved=!1,this.__hasRelease=!1,this.__detectingMove=!1,this.__tapCount=0,this.__touchCount=0,this.__cancelDeferredTap=e,this.__cancelDeferredHold=e,this.__cancelRegex=/cancel/i,this.__pointerEndRegex=/up|cancel/i,this.__haveSwipeSubscribers=!1,this.__blurRemover=e,this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__boundPreventDefaultClick=this.__preventDefaultClick.bind(this),this.__reverseMap={},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this.__pointerHash={},this.__pointerEvents=[],this.__listeners={},this.__getTypes(),this.initialize()}return t.prototype.addEventListener=function(t,e,n,i){var r=this,o=this._compat,s=o.mappedEvents[e],a=!b(s),l=this.__mappedCount,u=this._gestures,c=!1;if(a&&(this.__reverseMap[s]=e,this.__registerElement(t,e),l[e]++,o.hasTouchEvents&&!this.__cancelRegex.test(s)&&(s=s.replace("touch","mouse").replace("start","down").replace("end","up"),this.__reverseMap[s]=e)),t.addEventListener(e,n,i),!C(t["on"+e])||C(u[e])||a)return function(){c||(a&&(l[e]>0&&l[e]--,r.__unregisterElement(t,e)),c=!0,t.removeEventListener(e,n,i))};var h=u.$swipe,p=u.$track,_=e;if(-1!==e.indexOf(p)){var f=u.$trackend;_=e===f?f:p}else-1!==e.indexOf(h)&&(_=h);return this._gestureCount[_]++,this.__registerElement(t,e),function(){c||(c=!0,r.__removeEventListener(t,e,n,i))}},t.prototype.initialize=function(){var t=this._isActive;!0!==t&&(this.__registerTypes(),b(t)&&this.__appendGestureStyle(),this._isActive=!0)},t.prototype.dispose=function(){this.__unregisterTypes(),this.__blurRemover(),this.__blurRemover=e,this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this._isActive=!1,this._subscribers={},this.__pointerEvents=[],this.__pointerHash={},this.__reverseMap={},this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__tapCount=this.__touchCount=0,this.__detectingMove=this.__hasMoved=this.__hasRelease=this.__haveSwipeSubscribers=!1,this.__lastMoveEvent=this.__lastTouchDown=this.__lastTouchUp=null,this.__swipeOrigin=this.__capturedTarget=this.__focusedElement=this.__delayedClickRemover=null,this.__cancelDeferredHold=this.__cancelDeferredTap=e},t.prototype._onTouchStart=function(n){var i=this,r=n.type;if(this.__ignoreEvent[r])return this.__ignoreEvent[r]=!1,this.__delayedClickRemover[r](),n.target===this.__focusedElement||(!0===n.cancelable&&n.preventDefault(),!1);if(this.__touchCount++>0)return!0;if("mousedown"!==r)this._inTouch=!0;else{if(!0===this._inTouch)return n.preventDefault(),!1;this._compat.hasTouchEvents&&(this._inMouse=!0)}if(n=this.__standardizeEventObject(n),b(n))return!0;this.__lastMoveEvent=null,this.__hasMoved=!1;var o=n.clientX,s=n.clientY,a=n.timeStamp,l=n.target,u=this._gestures;this.__lastTouchDown={_buttons:n._buttons,clientX:o,clientY:s,timeStamp:a,target:l,identifier:n.identifier},this.__swipeOrigin={clientX:o,clientY:s,xTimestamp:a,yTimestamp:a,xTarget:l,yTarget:l},this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(l,[u.$swipe,u.$swipedown,u.$swipeleft,u.$swiperight,u.$swipeup]).length>0);var c=this._gestureCount,h=c.$hold<=0,p=c.$release<=0;if(h&&p)return this.__handleMappedEvents(r,n,n),this.__registerMove(r),!0;var _,f,d,v=t.config.intervals.holdInterval;if(h)return this.__hasRelease=!1,this.__cancelDeferredHold=$(function(){i.__hasRelease=!0},v),this.__handleMappedEvents(r,n,n),this.__registerMove(r),!0;p?(d=!b(_=this.__findFirstSubscriber(n.target,this._gestures.$hold)))&&(f=function(){_.trigger(n),i.__cancelDeferredHold=e}):(this.__hasRelease=!1,(d=!b(_=this.__findFirstSubscriber(n.target,this._gestures.$hold)))&&(f=function(){_.trigger(n),i.__hasRelease=!0,i.__cancelDeferredHold=e})),d&&(this.__cancelDeferredHold=$(f,v)),this.__handleMappedEvents(r,n,n),this.__registerMove(r)},t.prototype._onTouchMove=function(n){this.__cancelDeferredHold(),this.__cancelDeferredHold=e;var i=n.type;if(!0===this._inTouch&&"mousemove"===i)return!0;var r=this.__standardizeEventObject(n);if(b(r))return!0;var o=this._gestureCount,s=o.$track<=0,a=o.$swipe<=0,l=t.config,u=this.__swipeOrigin,c=r.clientX,h=r.clientY;if(!(this.__hasMoved||this.__getDistance(u.clientX,c,u.clientY,h)>=l.distances.minScrollDistance))return this.__handleMappedEvents(i,n,r),!0;if(this.__hasMoved=!0,s&&a)return this.__handleMappedEvents(i,n,r),!0;var p=this.__lastMoveEvent||u,_=r.direction=this.__getDirection(c-p.clientX,h-p.clientY);this.__handleOriginChange(_);var f=Math.abs(c-u.clientX),d=Math.abs(h-u.clientY);r.velocity=this.__getVelocity(f,d,r.timeStamp-u.xTimestamp,r.timeStamp-u.yTimestamp),!a&&this._android44orBelow&&this.__haveSwipeSubscribers&&n.preventDefault(),s||this.__handleTrack(r,n),this.__handleMappedEvents(i,n,r),this.__lastMoveEvent=r},t.prototype._onTouchEnd=function(e){var n=this,i=e.type;if(this.__ignoreEvent[i])return this.__ignoreEvent[i]=!1,this.__delayedClickRemover[i](),e.target===this.__focusedElement||(!0===e.cancelable&&e.preventDefault(),O(function(){var t=(n.__lastTouchUp||{}).target;n._document.body.contains(t)&&n.__handleInput(t)}),!1);var r=this.__hasMoved,o="mouseup"!==i;if(o){if("touchend"===i){if(r)!0===e.cancelable&&e.preventDefault();else{if(!0!==this._inTouch)return!0===e.cancelable&&e.preventDefault(),this.__preventClickFromTouch(),this.__touchCount=0,!0;e.target!==this.__focusedElement&&this.__handleInput(e.target)&&!0===e.cancelable&&e.preventDefault()}this.__preventClickFromTouch()}}else if(!C(this._inTouch)){if(!this._inMouse)return!0===e.cancelable&&e.preventDefault(),!1;this._inMouse=!1}if(this.__cancelRegex.test(i))return this.__handleCanceled(e),!0;if(this.__touchCount<=0?this.__touchCount=0:this.__touchCount--,e=this.__standardizeEventObject(e),b(e))return!0;o&&(this._inTouch=!1),this.__touchCount>0&&(this.__touchCount=e._touches.length),this.__clearTempStates(),this.__hasRelease&&this.__handleRelease(e),this.__handleSwipe();var s=t.config,a=s.intervals,l=e.timeStamp,u=this.__lastTouchDown;if(r)return this.__handleTrackEnd(e),this.__handleMappedEvents(i,e,e),this.__tapCount=0,this.__capturedTarget=null,!0;if(b(u)||l-u.timeStamp>a.tapInterval)return this.__handleMappedEvents(i,e,e),this.__tapCount=0,this.__capturedTarget=null,!0;var c=this.__lastTouchUp,h=e.clientX,p=e.clientY;this.__tapCount>0&&this.__getDistance(h,c.clientX,p,c.clientY)<=s.distances.maxDblTapDistance&&l-c.timeStamp<=a.dblTapInterval?this.__handleDbltap(e):this.__tapCount=0,this.__handleTap(e),this.__handleMappedEvents(i,e,e),this.__lastTouchUp=e,this.__capturedTarget=null},t.prototype.__clearTempStates=function(){this.__cancelDeferredHold(),this.__cancelDeferredHold=e,this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1)},t.prototype.__resetTouchEnd=function(){this.__tapCount=this.__touchCount=0,this._inTouch=this.__hasRelease=!1,this.__pointerHash={},this.__pointerEvents=[],this.__capturedTarget=null},t.prototype.__handleCanceled=function(t){var e=t.touches||this.__pointerEvents,n=this.__getTouchIndex(e),i=t.type;t=n>=0?e[n]:this.__standardizeEventObject(t),this._inTouch=!1,this.__clearTempStates(),this.__hasMoved&&(this._android44orBelow&&this.__handleSwipe(),this.__handleTrackEnd(t)),this.__handleMappedEvents(i,t,t),this.__resetTouchEnd()},t.prototype.__handleMappedEvents=function(t,e,n){var i=this.__reverseMap[t];if(this.__mappedCount[i]>0){var r=this.__findFirstSubscriber(e.target,i);b(r)||r.trigger(n)}},t.prototype.__handleTap=function(n){var i=this,r=n.target,o=this.__lastTouchDown||{},s=o.target;if(this.__tapCount++,!(this._gestureCount.$tap<=0||b(s)||s!==r&&y(s.contains)&&!s.contains(r)&&y(r.contains)&&!r.contains(s))){var a=this._gestures,l=this.__findFirstSubscriber(r,a.$tap);if(!b(l))return t.config.intervals.dblTapZoomDelay<=0||"mouse"===n.pointerType||"mouseup"===n.type?(n._buttons=o._buttons,void l.trigger(n)):void(this.__cancelDeferredTap=$(function(){n._buttons=o._buttons,l.trigger(n),i.__tapCount=0,i.__cancelDeferredTap=e},t.config.intervals.dblTapZoomDelay))}},t.prototype.__handleDbltap=function(t){if(this.__tapCount=0,this.__cancelDeferredTap(),this.__cancelDeferredTap=e,!(this._gestureCount.$dbltap<=0)){var n=this.__findFirstSubscriber(t.target,this._gestures.$dbltap);b(n)||(t._buttons=this.__lastTouchDown._buttons,n.trigger(t),this.__tapCount=-1)}},t.prototype.__handleRelease=function(t){var e=this.__findFirstSubscriber(t.target,this._gestures.$release);b(e)||e.trigger(t),this.__hasRelease=!1},t.prototype.__handleSwipe=function(){if(!(this._gestureCount.$swipe<=0)){var t=this.__lastMoveEvent;if(!b(t)){for(var e=this.__swipeOrigin,n=Math.abs(t.clientX-e.clientX),i=Math.abs(t.clientY-e.clientY),r=this.__getRegisteredSwipes(t.direction,t.velocity,n,i);r.length>0;)r.pop().trigger(t);this.__lastMoveEvent=null}}},t.prototype.__handleTrack=function(t,e){var n=this._gestures,i=n.$track,r=t.direction,o=this.__capturedTarget||t.target,s=this.__findFirstSubscribers(o,[i,i+r.x,i+r.y]);if(this._android44orBelow&&this.__findFirstSubscribers(o,[i,n.$trackdown,n.$trackup,n.$trackleft,n.$trackright,n.$trackend]).length>0&&e.preventDefault(),s.length>0)for(this._androidVersion>-1&&e.preventDefault();s.length>0;)s.pop().trigger(t)},t.prototype.__handleTrackEnd=function(t){if(!(this._gestureCount.$trackend<=0)){var e=this.__capturedTarget||t.target,n=this.__findFirstSubscriber(e,this._gestures.$trackend);b(n)||n.trigger(t)}},t.prototype.__getTypes=function(){var t,e,n,i=this._compat,r=i.mappedEvents,o=this.__listeners;if(i.hasPointerEvents)t=this._startEvents=r.$touchstart,e=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+" "+r.$touchcancel;else if(i.hasTouchEvents)t=this._startEvents=r.$touchstart+" mousedown",e=this._moveEvents=r.$touchmove+" mousemove",n=this._endEvents=r.$touchend+" mouseup "+r.$touchcancel;else{var s=r.$touchcancel;t=this._startEvents=r.$touchstart,e=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+(s?" "+s:"")}o[t]=this._onTouchStart.bind(this),o[e]=this._onTouchMove.bind(this),o[n]=this._onTouchEnd.bind(this)},t.prototype.__registerTypes=function(){this.__registerType(this._startEvents),this.__registerType(this._endEvents),this._document.addEventListener("dragstart",this.__preventDefault,!1)},t.prototype.__unregisterTypes=function(){this.__unregisterType(this._startEvents),this.__unregisterType(this._endEvents),this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1),this._document.removeEventListener("dragstart",this.__preventDefault,!1)},t.prototype.__registerType=function(t){for(var e=this.__listeners[t],n=this._document,i=t.split(" "),r=i.length;r-- >0;)n.addEventListener(i[r],e,!1)},t.prototype.__unregisterType=function(t){for(var e=this.__listeners[t],n=this._document,i=t.split(" "),r=i.length;r-- >0;)n.removeEventListener(i[r],e,!1)},t.prototype.__registerMove=function(t){var e=this._gestureCount;("touchstart"===t||this.__mappedCount.$touchmove>0||e.$track>0||e.$trackend>0||e.$swipe>0)&&(this.__registerType(this._moveEvents),this.__detectingMove=!0)},t.prototype.__registerElement=function(e,n){var i,r=e.__plat;b(r)?(i=D("domEvent_"),e.__plat=r={domEvent:i}):b(r.domEvent)&&(i=D("domEvent_"),r.domEvent=i);var o;if(b(i)){var s=this._subscribers[r.domEvent];return C(s[n])?(o=new L(e,n),s[n]=o):s[n].count++,void s.gestureCount++}var a={gestureCount:1};o=new L(e,n),a[n]=o,this._subscribers[i]=a,C(e.className)||at(e,t.config.styleConfig[0].className),this.__removeSelections(e)},t.prototype.__unregisterElement=function(t,e){var n=t.__plat;if(!b(n)&&!b(n.domEvent)){var i=n.domEvent,r=this._subscribers[i],o=r[e];b(o)||(o.count--,0===o.count&&U(r,e),r.gestureCount--,0===r.gestureCount&&(U(this._subscribers,i),this.__removeElement(t)))}},t.prototype.__setTouchPoint=function(t){var e=t.type,n=this._compat;n.hasPointerEvents||n.hasMsPointerEvents?this.__updatePointers(t,this.__pointerEndRegex.test(e)):t.pointerType=-1===e.indexOf("mouse")?"touch":"mouse"},t.prototype.__setCapture=function(t){b(this.__capturedTarget)&&!u(t)&&(this.__capturedTarget=t)},t.prototype.__updatePointers=function(t,e){var n,i=t.pointerId,r=this.__pointerHash,o=r[i];if(e)C(o)||((n=this.__pointerEvents.indexOf(o))>-1&&this.__pointerEvents.splice(n,1),U(this.__pointerHash,i));else{if(1===i&&!v(r))return;t.identifier=t.pointerId,C(o)||(n=this.__pointerEvents.indexOf(o))<0?this.__pointerEvents.push(t):this.__pointerEvents.splice(n,1,t),r[i]=t}},t.prototype.__findFirstSubscriber=function(t,e){if(!b(t)){var n,i,r;do{if(n=t.__plat,!C(n)&&!C(n.domEvent)&&(i=this._subscribers[n.domEvent],r=i[e],!C(r)))return r}while(!b(t=t.parentNode))}},t.prototype.__findFirstSubscribers=function(t,e){if(b(t))return[];var n,i,r,o,s,a=[];do{if(n=t.__plat,!C(n)&&!C(n.domEvent))for(i=this._subscribers[n.domEvent],r=Object.keys(i);r.length>0;)o=r.pop(),-1!==(s=e.indexOf(o))&&(a.push(i[o]),e.splice(s,1))}while(e.length>0&&!b(t=t.parentNode));return a},t.prototype.__removeEventListener=function(t,e,n,i){var r=this._gestures;t.removeEventListener(e,n,i);var o=r.$swipe,s=r.$track,a=e;if(-1!==e.indexOf(s)){var l=r.$trackend;a=e===l?l:s}else-1!==e.indexOf(o)&&(a=o);this._gestureCount[a]--,this.__unregisterElement(t,e)},t.prototype.__removeElement=function(e){this.__returnSelections(e),C(e.className)||lt(e,t.config.styleConfig[0].className);var n=e.__plat;U(n,"domEvent"),v(n)&&U(e,"__plat")},t.prototype.__standardizeEventObject=function(t){this.__setTouchPoint(t);var e,n=-1!==this._startEvents.indexOf(t.type),i=t.touches||this.__pointerEvents,r=t.changedTouches,o=!C(r),s=t.timeStamp;if(o)if(n)e=t.preventDefault.bind(t),(t=r[0]).preventDefault=e;else{var a=this.__getTouchIndex(r);if(a>=0)e=t.preventDefault.bind(t),(t=r[a]).preventDefault=e;else if(this.__getTouchIndex(i)>=0)return null}return n&&this.__setCapture(t.target),this.__normalizeButtons(t),t._touches=i,t.offset=this.__getOffset(t),(C(t.timeStamp)||s>t.timeStamp)&&(t.timeStamp=s),t},t.prototype.__normalizeButtons=function(t){var e;if(g(t.buttons)&&0!==t.buttons)e=t.buttons;else if(g(t.which)&&t.which>0)e=t.which;else switch(t.button){case-1:e=0;break;case 0:e=1;break;case 1:e=4;break;case 2:e=2;break;case 3:e=8;break;case 4:e=16;break;default:e=1}t._buttons=e},t.prototype.__getTouchIndex=function(t){for(var e=(this.__lastTouchDown||{}).identifier,n=t.length,i=0;i<n;++i)if(t[i].identifier===e)return i;return-1},t.prototype.__getOffset=function(t){var e=this.__capturedTarget||t.target;if(u(e))return{x:t.clientX,y:t.clientY};if(!C(t.offsetX)&&!C(t.offsetY)&&e===t.target)return{x:t.offsetX,y:t.offsetY};var n,i;if(y(e.getBoundingClientRect)){var r=e.getBoundingClientRect();n=r.left,i=r.top}else for(n=e.offsetLeft,i=e.offsetTop;!b(e=e.offsetParent);)n+=e.offsetLeft,i+=e.offsetTop;return{x:t.clientX-n,y:t.clientY-i}},t.prototype.__getDistance=function(t,e,n,i){var r=e-t,o=i-n;return Math.sqrt(r*r+o*o)},t.prototype.__getVelocity=function(t,e,n,i){var r=0,o=0;return n>0&&(r=t/n||0),i>0&&(o=e/i||0),{x:r,y:o}},t.prototype.__getDirection=function(t,e){var n=Math.abs(t),i=Math.abs(e),r=(this.__lastMoveEvent||{}).direction||{},o=0===t?r.x||"none":t<0?"left":"right",s=0===e?r.y||"none":e<0?"up":"down";return{x:o,y:s,primary:n===i?r.primary||"none":n>i?o:s}},t.prototype.__handleOriginChange=function(t){var e=this.__lastMoveEvent;if(!b(e)){var n=e.direction,i=n.x===t.x,r=n.y===t.y;if(!i||!r){var o=this.__swipeOrigin,s=this._gestures,a=[s.$swipe,s.$swipedown,s.$swipeleft,s.$swiperight,s.$swipeup];i||(o.clientX=e.clientX,o.xTimestamp=e.timeStamp,o.xTarget=e.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.xTarget,a).length>0)),r||(o.clientY=e.clientY,o.yTimestamp=e.timeStamp,o.yTarget=e.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.yTarget,a).length>0))}}},t.prototype.__getRegisteredSwipes=function(e,n,i,r){var o,s=this._gestures.$swipe,a=t.config.velocities.minSwipeVelocity,l=[s],u=this.__swipeOrigin||{};return i>r?(o=u.xTarget,n.x>=a&&l.push(s+e.x)):r>i&&(o=u.yTarget,n.y>=a&&l.push(s+e.y)),this.__findFirstSubscribers(o,l)},t.prototype.__isHorizontal=function(t){return"left"===t||"right"===t},t.prototype.__appendGestureStyle=function(){var e,n,i=this._document;if(!this._compat.platCss)if(!b(i.styleSheets)&&i.styleSheets.length>0){var r=i.styleSheets[0];for(n=(e=t.config.styleConfig).length;n-- >0;)r.insertRule(this.__createStyle(e[n]),0)}else{var o=i.head,s=i.createElement("style"),a="";for(s.type="text/css",n=(e=t.config.styleConfig).length;n-- >0;)a=this.__createStyle(e[n])+a;s.textContent=a,o.appendChild(s)}},t.prototype.__createStyle=function(t){var e=t.styles||[],n=e.length,i="."+t.className+" { ",r="";n=e.length;for(var o=0;o<n;++o)r+=e[o]+";";return i+=r+" } "},t.prototype.__blurFocusedElement=function(){var t=this.__focusedElement||{};y(t.blur)&&t.blur()},t.prototype.__waitForBlur=function(t){var n=this;this.__blurRemover=this.addEventListener(t,"blur",function(){n.__blurRemover(),n.__blurRemover=e,t===n.__focusedElement&&(n.__focusedElement=null)},!1)},t.prototype.__clickTarget=function(t){var e=this,n=!1,i=function(){n=!0,t.removeEventListener("click",i,!1)};t.addEventListener("click",i,!1),O(function(){n||(t.removeEventListener("click",i,!1),e._document.body.contains(t)&&y(t.click)&&t.click())})},t.prototype.__handleInput=function(t){this.__blurRemover();var e=t.nodeName;if(!_(e))return this.__focusedElement=null,void this.__blurFocusedElement();var n=!0;switch(e.toLowerCase()){case"input":switch(t.type){case"range":this.__blurFocusedElement();break;case"text":case"password":case"email":case"number":case"tel":case"search":case"url":t.focus(),this.__waitForBlur(t);break;default:this.__blurFocusedElement(),this.__clickTarget(t)}break;case"a":case"button":case"label":this.__blurFocusedElement(),this.__clickTarget(t);break;case"textarea":t.focus(),this.__waitForBlur(t);break;case"select":n=!1;break;default:this.__blurFocusedElement(),this.__clickTarget(t)}return this.__focusedElement=t,n},t.prototype.__preventClickFromTouch=function(){var e=this._document,n=this.__ignoreEvent,i=this.__boundPreventDefaultClick,r=t.config.intervals.delayedClickInterval;r<=0||(this.__delayedClickRemover={mousedown:$(function(){n.mousedown=!1},r),mouseup:$(function(){n.mouseup=!1},r),click:$(function(){e.removeEventListener("click",i,!0)},r)},n.mousedown=n.mouseup=!0,O(function(){e.addEventListener("click",i,!0)}))},t.prototype.__preventDefaultClick=function(t){return t.preventDefault(),t.stopImmediatePropagation(),this._document.removeEventListener("click",this.__boundPreventDefaultClick,!0),this.__delayedClickRemover.click(),!1},t.prototype.__removeSelections=function(t){c(t)&&(C(t.onselectstart)||t.addEventListener("selectstart",this.__preventDefault,!1),C(t.ondragstart)||t.addEventListener("dragstart",this.__preventDefault,!1))},t.prototype.__returnSelections=function(t){c(t)&&(C(t.onselectstart)||t.removeEventListener("selectstart",this.__preventDefault,!1),C(t.ondragstart)||t.removeEventListener("dragstart",this.__preventDefault,!1))},t.prototype.__preventDefault=function(t){var e=t.target.nodeName;return _(e)&&(e=e.toLowerCase()),"input"===e||"textarea"===e||(t.preventDefault(),!1)},t._inject={_document:zt,_compat:Mt},t.config={intervals:{tapInterval:300,dblTapInterval:300,holdInterval:400,dblTapZoomDelay:0,delayedClickInterval:400},distances:{minScrollDistance:3,maxDblTapDistance:10},velocities:{minSwipeVelocity:.645},styleConfig:[{className:"plat-gesture",styles:["-moz-user-select: none","-khtml-user-select: none","-webkit-touch-callout: none","-webkit-user-select: none","-webkit-user-drag: none","-webkit-tap-highlight-color: transparent","-webkit-overflow-scrolling: touch","-ms-user-select: none","-ms-touch-action: manipulation","touch-action: manipulation"]},{className:"plat-no-touch-action",styles:["-ms-touch-action: none","touch-action: none"]}]},t.gestures={$tap:bn,$dbltap:Cn,$hold:Nn,$release:Sn,$swipe:kn,$swipeleft:In,$swiperight:Rn,$swipeup:jn,$swipedown:An,$track:Ln,$trackleft:Pn,$trackright:On,$trackup:$n,$trackdown:Fn,$trackend:Mn},t}();t.DomEvents=j,Pt.injectable(Gt,j),t.IDomEventsConfig=p,Pt.injectable("$IDomEventsConfig",p);var A=function(){function t(){this._document=dt(zt)}return t.prototype.initialize=function(t,e,n){this.element=t,this.event=e,this.eventType=_(n)?n:"CustomEvent"},t.prototype.trigger=function(t,e,n){var i=this._document.createEvent(this.eventType);return a(t)&&r(!1,!1,i,t),i.initCustomEvent(this.event,!0,!0,b(e)?0:e),(n||this.element).dispatchEvent(i)},t}();t.DomEvent=A,Pt.injectable("$DomEventInstance",A,null,Xn);var L=function(t){function e(e,n){var i=t.call(this)||this;return i.count=0,i.element=e,i.event=n,i.count++,i}return __extends(e,t),e.prototype.trigger=function(t){var e=this._document.createEvent("CustomEvent"),n=this.element,i=t.target;this.__extendEventObject(e,t),e.initCustomEvent(this.event,!0,!0,0);var r=u(n)||n.contains(i)?i.dispatchEvent(e):n.dispatchEvent(e);return r||t.preventDefault(),r},e.prototype.__extendEventObject=function(t,e){var n=e.pointerType;t.clientX=e.clientX,t.clientY=e.clientY,t.offsetX=e.offset.x,t.offsetY=e.offset.y,t.direction=e.direction||{x:"none",y:"none",primary:"none"},t.touches=e._touches,t.velocity=e.velocity||{x:0,y:0},t.identifier=e.identifier||0,t.pointerType=g(n)?this.__convertPointerType(n,e.type):n,t.screenX=e.screenX,t.screenY=e.screenY,t.pageX=e.pageX,t.pageY=e.pageY,t.buttons=e._buttons},e.prototype.__convertPointerType=function(t,e){switch(t){case MSPointerEvent.MSPOINTER_TYPE_MOUSE:return"mouse";case MSPointerEvent.MSPOINTER_TYPE_PEN:return"pen";case MSPointerEvent.MSPOINTER_TYPE_TOUCH:return"touch"}return-1===e.indexOf("mouse")?"touch":"mouse"},e}(A);!function(t){var n=function(){function t(){this._animatedElements={}}return t.prototype.create=function(t,e,n){return this._create(t,e,n,{key:null})},t.prototype.animate=function(t,e,n){return this._animate(t,e,n,{key:null})},t.prototype.enter=function(t,e,n,i,r){return this._animate(t,e,r,{key:"enter",parent:n,refChild:i})},t.prototype.leave=function(t,e,n){return this._animate(t,e,n,{key:"leave"})},t.prototype.move=function(t,e,n,i,r){return this._animate(t,e,r,{key:"move",parent:n,refChild:i})},t.prototype.show=function(t,e,n){return this._animate(t,e,n,{key:"show"})},t.prototype.hide=function(t,e,n){return this._animate(t,e,n,{key:"hide"})},t.prototype.all=function(t){for(var n=this,r=t.length,o=[],s=new i(function(e){n._Promise.all(t).then(function(){e()})}),a=0;a<r;++a)o=o.concat(t[a].getInstances());return s.initialize(o),s.then(e)},t.prototype.resolve=function(){var t=new i(function(e){e(function(){return t})});return t},t.prototype._animate=function(t,e,n,i){var r=this._create(t,e,n,i),o=r.current;return r.previous.then(function(){M(function(){o.start()})}),o},t.prototype._create=function(t,n,r,o){var s,a=this,l=Fi[n],u=[],c=[];if((!this._compat.animationSupported||C(l))&&(l=Mi[n],C(l)))return t=this.__constructAnimatableElements(t,{inject:e},c,u),this._handlePreInitFunctionality(t,c,o),this._handlePostInitFunctionality(t,c,o),this._handleEndFunctionality(t,c,o),s=this.resolve(),{previous:s,current:s};t=this.__constructAnimatableElements(t,l,c,u);var h=c.length;if(0===h)return this._handlePreInitFunctionality(t,c,o),this._handlePostInitFunctionality(t,c,o),this._handleEndFunctionality(t,c,o),s=this.resolve(),{previous:s,current:s};this._handlePreInitFunctionality(t,c,o);var p,_=D("animation_"),f=this.__setAnimationId(_,c),v=new i(function(e){var n=a._Promise;p=n.all(f).then(function(){for(var i=[],s=0;s<h;++s)i.push(u[s].instantiate(c[s],r));a._handlePostInitFunctionality(t,c,o);var l=n.all(i),p=a.__isParentAnimating(c),f=a.__generateAnimatedElement(_,c,v);if(!b(p)){a._handleEndFunctionality(t,c,o),f.animationEnd(!0);var m=a._animatedElements[p],g=d(m.promise)?function(){return m.promise}:function(){return v};l.then(function(){e(g)})}a.__stopChildAnimations(c),f.promise=v,l.then(function(){a._handleEndFunctionality(t,c,o),f.animationEnd(),e(function(){return v})})})});return v.initialize(u),{previous:p,current:v}},t.prototype._handlePreInitFunctionality=function(t,e,n){switch(n.key){case"move":for(var i=0;i<length;++i)st(t[i])}},t.prototype._handlePostInitFunctionality=function(t,e,n){var i,r;switch(n.key){case"enter":case"move":var o,s=n.refChild;if(c(s)?o=s.parentNode:(o=n.parent,s=null),!c(o))break;for(i=t.length,r=0;r<i;++r)o.insertBefore(t[r],s);break;case"show":for(i=e.length,r=0;r<i;++r)e[r].removeAttribute(cn)}},t.prototype._handleEndFunctionality=function(t,e,n){var i,r;switch(n.key){case"leave":for(i=t.length,r=0;r<i;++r)st(t[r]);break;case"hide":for(i=e.length,r=0;r<i;++r)e[r].setAttribute(cn,"")}},t.prototype.__setAnimationId=function(t,e){for(var n,i,r,o=this._animatedElements,s=[],a=e.length,l=0;l<a;++l)C(i=(r=e[l]).__plat)?(r.__plat={animation:t},at(r,hn)):C(i.animation)?(i.animation=t,at(r,hn)):(C(n=o[i.animation])||(s.push(n.promise),n.animationEnd(!0)),i.animation=t);return s},t.prototype.__generateAnimatedElement=function(t,e,n){var i=this._animatedElements;return i[t]={animationEnd:function(r){var o,s,a,l=e.length;if(!0===r)return n.cancel(),void U(i,t);for(var u=0;u<l;++u)C(a=(o=(s=e[u]).__plat||{}).animation)||a!==t||(lt(s,hn),U(o,"animation"),v(o)&&U(s,"__plat"));U(i,t)}}},t.prototype.__isParentAnimating=function(t){for(var e,n=t[0];!u(n=n.parentNode)&&!b(n)&&n.nodeType===Node.ELEMENT_NODE;)if(ht(n,hn)){var i=n.__plat;if(e=(i||{}).animation,_(e)){if(!b(this._animatedElements[e]))return e;U(i,"animation"),v(i)&&U(n,"__plat"),lt(n,hn)}}},t.prototype.__stopChildAnimations=function(t){for(var e,n,i,r=this._animatedElements,o=Array.prototype.slice,s=0;s<t.length;++s)for(e=o.call(t[s].querySelectorAll("."+hn));e.length>0;)b(i=(e.pop().__plat||{}).animation)||y((n=r[i]||{}).animationEnd)&&n.animationEnd(!0)},t.prototype.__constructAnimatableElements=function(t,e,n,i){if(!x(t))if(h(t))t=Array.prototype.slice.call(t.childNodes);else if(E(t))t=Array.prototype.slice.call(t);else{if(!c(t)||t.nodeType!==Node.ELEMENT_NODE)return[];t=[t]}for(var r,o=t.length,s=0;s<o;++s)c(r=t[s])&&r.nodeType===Node.ELEMENT_NODE&&(n.push(r),i.push(e.inject()));return t},t._inject={_compat:Mt,_Promise:Ft,_document:zt},t}();t.Animator=n,Pt.injectable("$Animator",n);var i=function(t){function n(e,n){var i=t.call(this,e)||this;return i._Promise=dt(Ft),i.__animationState=0,i.__animationInstances=[],b(n)||(i.__animationInstances=n.__animationInstances,i.__animationState=n.__animationState),i}return __extends(n,t),n.prototype.initialize=function(t){v(this.__animationInstances)&&(x(t)?this.__animationInstances=t:a(t)&&(this.__animationInstances=[t]))},n.prototype.getInstances=function(){return this.__animationInstances},n.prototype.start=function(){if(!(this.__animationState>0)){for(var t,e=this.__animationInstances,n=e.length,i=0;i<n;++i)y((t=e[i]).start)&&t.start();this.__animationState=1}},n.prototype.pause=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var t,n=this.__animationInstances,i=[],r=n.length,o=0;o<r;++o)y((t=n[o]).pause)&&i.push(t.pause());return this._Promise.all(i).then(e)},n.prototype.resume=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var t,n=this.__animationInstances,i=[],r=n.length,o=0;o<r;++o)y((t=n[o]).resume)&&i.push(t.resume());return this._Promise.all(i).then(e)},n.prototype.cancel=function(){if(2===this.__animationState)return this;for(var t,e=this.__animationInstances,n=e.length,i=0;i<n;++i)y((t=e[i]).cancel)&&t.cancel(),y(t.end)&&t.end();return this.__animationState=2,this},n.prototype.isCanceled=function(){return 2===this.__animationState},n.prototype.then=function(e){return t.prototype.then.call(this,e)},n.prototype.catch=function(e){return t.prototype.catch.call(this,e)},n}(Ui.Promise);t.AnimationPromise=i;var r=function(){function t(){this.__eventListeners=[]}return t.prototype.initialize=function(){},t.prototype.start=function(){},t.prototype.end=function(){for(var t=this.__eventListeners;t.length>0;)t.pop()();y(this._resolve)&&(this._resolve(),this._resolve=null)},t.prototype.pause=function(){return this._Promise.resolve()},t.prototype.resume=function(){return this._Promise.resolve()},t.prototype.cancel=function(){this.end()},t.prototype.addEventListener=function(t,n,i){if(!y(n))return this._log.warn('An animation\'s "addEventListener" must take a function as the second argument.'),e;n=n.bind(this);var r=this.dom.addEventListener(this.element,t,function(t){t.stopPropagation(),n(t)},i),o=this.__eventListeners;return o.push(r),function(){r();var t=o.indexOf(r);-1!==t&&o.splice(t,1)}},t.prototype.instantiate=function(t,e){var n=this;this.element=t,this.options=e;var r=new i(function(t){n._resolve=t,n.initialize()});return r.initialize(this),r},t._inject={_window:ee,_compat:Mt,_log:Bt,_Promise:Ft,dom:"$Dom",utils:Zt},t}();t.BaseAnimation=r;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animationEvents=e._compat.animationEvents,e}return __extends(e,t),e.prototype.animationStart=function(t){return this.addEventListener(this._animationEvents.$animationStart,t,!1)},e.prototype.animationEnd=function(t){return this.addEventListener(this._animationEvents.$animationEnd,t,!1)},e.prototype.animationIteration=function(t){return this.addEventListener(this._animationEvents.$animationIteration,t,!1)},e.prototype.transitionStart=function(t){return this.addEventListener(this._animationEvents.$transitionStart,t,!1)},e.prototype.transitionEnd=function(t){return this.addEventListener(this._animationEvents.$transitionEnd,t,!1)},e}(r);t.CssAnimation=o;var s=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.className=pn,n._cancelAnimation=e,n}return __extends(n,t),n.prototype.initialize=function(){at(this.element,this.className+"-init")},n.prototype.start=function(){var t=this;this._cancelAnimation=M(function(){var e=t.element,n=t.className;if(null===e.offsetParent)return t._dispose(),void t.end();at(e,n);var i=t._animationEvents.$animation,r=t.options||{},o=t._window.getComputedStyle(e,r.pseudo),s=o[i+"Name"];if(""===s||"none"===s||"paused"===o[i+"PlayState"])return t._dispose(),void t.end();r.preserveInit||lt(e,n+"-init"),t._cancelAnimation=t.animationEnd(function(){t._cancelAnimation=M(function(){t._dispose(),t.end()})})})},n.prototype.pause=function(){var t=this;if(this._cancelAnimation===e)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(i){M(function(){t._cancelAnimation!==e&&(t.element.style[n.$animation+"PlayState"]="paused"),i()})})},n.prototype.resume=function(){var t=this;if(this._cancelAnimation===e)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(i){M(function(){t._cancelAnimation!==e&&(t.element.style[n.$animation+"PlayState"]="running"),i()})})},n.prototype.cancel=function(){this._cancelAnimation(),this._dispose(),this.end()},n.prototype._dispose=function(){var t=this.className;lt(this.element,t+" "+t+"-init"),this._cancelAnimation=e},n}(o);t.SimpleCssAnimation=s,Pt.animation(pn,s);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=mn,e}return __extends(e,t),e}(s);t.FadeIn=l,Pt.animation(mn,l);var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=gn,e}return __extends(e,t),e}(s);t.FadeOut=p,Pt.animation(gn,p);var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=fn,e}return __extends(e,t),e}(s);t.Enter=f,Pt.animation(fn,f);var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=dn,e}return __extends(e,t),e}(s);t.Leave=m,Pt.animation(dn,m);var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=vn,e}return __extends(e,t),e}(s);t.Move=g,Pt.animation(vn,g);var w=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.className=_n,n._animationCanceled=e,n._normalizeRegex=/-/g,n._nonNumRegex=/[^\-0-9\.]/g,n._normalizedKeys={},n._transitionCount=0,n._count=0,n._started=!1,n._usingCss=!1,n}return __extends(n,t),n.prototype.initialize=function(){at(this.element,this.className+"-init")},n.prototype.start=function(){var t=this;this._animationCanceled=M(function(){var e=t.element,n=t.className;null===e.offsetParent&&(t._animate(),t._dispose(),t.end()),at(e,n),t._started=!0;for(var i,r=t.utils,o=t._animationEvents.$transition,s=t.options||{},a=t._window.getComputedStyle(e,s.pseudo),l=t._properties=a[o+"Property"].split(","),u=a[o+"Duration"].split(","),c=l.length,h=c,p=!1;c-- >0;)""===(i=l[c])||"none"===i?l.splice(c,1):h>1&&"all"===i&&(t._log.debug('Improper transition declaration on class "'+e.className+'"'),l.splice(c,1));if(0===l.length)p=!0;else{for(c=u.length;c-- >0&&(""===(i=u[c])||"0s"===i););c<0&&(p=!0)}if(p)return t._animate(),t._dispose(),void t.end();r.isNumber(s.count)&&s.count>0&&(t._count=s.count),!1===s.preserveInit&&lt(e,n+"-init"),t._animationCanceled=t.transitionEnd(t._done),t._animate()||(r.isEmpty(s.properties)?t.__cssTransition(a,u):(t._dispose(),t.end()))})},n.prototype.cancel=function(){this._animationCanceled(),this._started||this._animate(),this._dispose(),this.end()},n.prototype._dispose=function(){var t=this.className;lt(this.element,t+" "+t+"-init"),this._animationCanceled=e},n.prototype._done=function(t){var e=t.propertyName;if(_(e)){var n=++this._transitionCount;if(e=e.replace(this._normalizeRegex,"").toLowerCase(),n<this._count||!this._usingCss&&!0===this._normalizedKeys[e]&&n<this._properties.length)return}this._dispose(),this.end()},n.prototype._animate=function(){for(var t,e,n,i=this.element.style||{},r=(this.options||{}).properties||{},o=Object.keys(r),s=o.length,a=this._normalizedKeys,l=this._normalizeRegex,u=0;o.length>0;)e=i[t=o.shift()],_(n=r[t])?(i[t]=n,e===i[t]?u++:a[t.replace(l,"").toLowerCase()]=!0):u++;return u<s},n.prototype.__cssTransition=function(t,n){var i,r,o,s,a=this,l=this._animationEvents.$transition,u=t[l+"Delay"].split(","),c=this._properties,h=c.length,p=this._normalizedKeys,_=this._normalizeRegex,f=0,d=0,v=!1,m=this.utils.defer.bind(this,function(n,i){a._animationCanceled!==e&&("all"!==n&&t[n]===i||(v=!0),++d<h||v||(a._dispose(),a.end()))});for(this._usingCss=!0,this._count=this._count||h;f<h;++f)i=c[f]=c[f].trim(),r=n.length>f?n[f].trim():n[n.length-1].trim(),o=u.length>f?u[f].trim():u[u.length-1].trim(),p[i.replace(_,"").toLowerCase()]=!0,s=t[i],m(this._toMs(r)+this._toMs(o),[i,s])},n.prototype._toMs=function(t){var e=this._nonNumRegex,n=t.match(e)[0],i=Number(t.replace(e,""));return this.utils.isNumber(i)?"s"===n?1e3*i:"ms"===n?i:0:0},n}(o);t.SimpleCssTransition=w,Pt.animation(_n,w)}(t.animations||(t.animations={}));!function(n){var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){var t=this._router=this._Router.currentRouter(),e=this._getParentViewport();b(e)||b(e._router)||(this._parentRouter=e._router).addChild(t),this._navigator.initialize(t)},e.prototype.loaded=function(){var t=this;(this._animate=a(this.options)&&!0===this.options.value.animate)&&this.dom.addClass(this.element,Ze+"-animate"),this._Promise.resolve(this._router.finishNavigating).then(function(){t._router.register(t)})},e.prototype.canNavigateTo=function(t){var e=this,n=this._Router.currentRouter,i=n(),r=!0,o=this._Injector.getDependency(t.delegate.view),s=o.inject(),l=t.parameters,u=n();if(!a(s))return this._Promise.resolve(null);if(i!==u){u.initialize(this._router);var c=dt(Vt);s.navigator=c,c.initialize(u)}else s.navigator=this._navigator;return y(s.canNavigateTo)&&(r=s.canNavigateTo(l,t.query)),this._Promise.resolve(r).then(function(t){return e._nextInjector=o,e._nextView=s,t})},e.prototype.canNavigateFrom=function(){var t=this.controls[0],e=!0;return a(t)&&y(t.canNavigateFrom)&&(e=t.canNavigateFrom()),this._Promise.resolve(e)},e.prototype.navigateTo=function(t){var e=this._nextInjector||this._Injector.getDependency(t.delegate.view),n=this._createNodeMap(e),i=this.element,r=n.element,o=(t.parameters,t.query),s=n.uiControlNode.control;if(this._nextInjector=this._nextView=void 0,this._animate){var a=this._animator,l=this.dom;this._navigator.isBackNavigation()?(l.addClass(r,yn),a.enter(r,fn,i).then(function(){l.removeClass(r,yn)})):a.enter(r,fn,i)}else i.insertBefore(r,null);var u=this._managerCache.read(this.uid),c=this._ElementManagerFactory.getInstance();return u.children=[],c.initialize(n,u),y(s.navigatedTo)&&s.navigatedTo(t.parameters,o),c.setUiControlTemplate(),s.hasOwnContext?c.observeRootContext(s,c.fulfillAndLoad):c.fulfillAndLoad()},e.prototype.navigateFrom=function(){var t=this,e=this.controls[0],n=a(e);return(n&&y(e.navigatingFrom)?this._Promise.resolve(e.navigatingFrom()):this._Promise.resolve()).catch(function(e){if(a(e))return _(e.message)?void t._log.debug(t.type+" error: "+e.message):void t._log.debug(t.type+" error: "+JSON.stringify(e));t._log.debug(e)}).then(function(){if(t._animate&&n){var i=e.element;t._navigator.isBackNavigation()&&t.dom.addClass(i,yn),t._animator.leave(i,dn).then(function(){Yi.dispose(e)})}else Yi.dispose(e)})},e.prototype.dispose=function(){this._router.unregister(this),this._navigator.dispose()},e.prototype._createNodeMap=function(t){var e=this._nextView||t.inject(),n=this._document,i=t.name,r=e.replaceWith,o=v(r)||"any"===r?n.createElement("div"):n.createElement(r);return o.setAttribute(tn,i),o.className=en,{element:o,attributes:{},nodes:[],uiControlNode:{control:e,nodeName:i,expressions:[],injector:t}}},e.prototype._getParentViewport=function(){for(var t=this.parent,e=this.type;!b(t)&&t.type!==e;)t=t.parent;return t},e._inject={_Router:te,_Promise:Ft,_Injector:ne,_ElementManagerFactory:Ht,_document:zt,_managerCache:Wt,_animator:"$Animator",_navigator:Vt},e}(f);n.Viewport=i,Pt.control(Ze,i);var r=function(t){function e(){var e=t.call(this)||this;e.replaceWith=null,e.__isFirst=!1;var n=dt(Qt);return e.__templateControlCache=n.create(an),e}return __extends(e,t),e.prototype.initialize=function(){var t=(this.options||{}).value||{},e=this._id=t.id;if(b(e))this._log.warn(this.type+" instantiated without an id option");else{this._url=t.templateUrl;var n=this.__templateControlCache.read(e);b(n)?(this.__isFirst=!0,this._initializeTemplate()):this.__templatePromise=n}},e.prototype.loaded=function(){this.__isFirst||this._waitForTemplateControl(this.__templatePromise)},e.prototype.dispose=function(){if(this.__isFirst){var t=this.__templateControlCache;t.remove(this._id),0===t.info().size&&t.dispose()}},e.prototype._initializeTemplate=function(){var t=this,e=this._id;if(!b(e)){var n,i=this.endNode.parentNode,r=this._url;b(r)?(n=this._document.createDocumentFragment(),W(this.elementNodes,n)):(n=this._templateCache.read(r),X(this.elementNodes,i)),this.elementNodes=[];var o;d(n)?o=n.catch(function(e){if(b(e))return f.determineTemplate(t,r)}).then(function(n){return t.bindableTemplates.add(e,n.cloneNode(!0)),t}):(this.bindableTemplates.add(e,n.cloneNode(!0)),o=this._Promise.resolve(this)),this.__templateControlCache.put(e,o)}},e.prototype._waitForTemplateControl=function(t){var e=this;d(t)&&t.then(function(t){return b(e._url)||e._url===t._url||e._log.warn("The specified url: "+e._url+" does not match the original "+e.type+' with id: "'+e._id+'". The original url will be loaded.'),e.__mapBindableTemplates(t),e.bindableTemplates.bind(e._id)}).then(function(t){var n=e.endNode;Z(n.parentNode,t,n)}).catch(function(t){O(function(){e._log.warn("Problem resolving "+e.type+" url: "+t.response)})})},e.prototype.__mapBindableTemplates=function(t){var e=this.bindableTemplates;e.cache=t.bindableTemplates.cache,e.templates=t.bindableTemplates.templates},e._inject={_Promise:Ft,_templateCache:Yt,_document:zt},e}(f);n.Template=r,Pt.control(Ke,r);var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setTemplate=function(){this.innerTemplate=W(this.element.childNodes)},e.prototype.loaded=function(){this.element.appendChild(this.innerTemplate.cloneNode(!0))},e}(f);n.Ignore=o,Pt.control(Ge,o);var s=function(t){function n(){var n=t.call(this)||this;return n.priority=120,n._aliases={index:Dn.index,even:Dn.even,odd:Dn.odd,first:Dn.first,last:Dn.last},n._blockLength=0,n._addQueue=[],n._itemLength=0,n.__listenerSet=!1,n.itemsLoaded=new n._Promise(function(t,e){n.__resolveFn=t,n.__rejectFn=e}).catch(e),n}return __extends(n,t),n.prototype.setTemplate=function(){this.bindableTemplates.add("item",this.element.childNodes)},n.prototype.contextChanged=function(t,e){x(t)?this._setListener():t=[],this._executeEvent([{object:t,type:"splice"}])},n.prototype.loaded=function(){var t=this.options,e=this._animate=a(t)&&!0===t.value.animate,n=this.context;if(this._container=this.element,e&&(this._animationQueue=[]),this._setAliases(),x(n)){var i=this._addQueue,r=n.length,o=this._addItems(0,r,0).then(function(){var t=i.indexOf(o);-1!==t&&i.splice(t,1)});i.push(o),this._setListener()}},n.prototype.dispose=function(){this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._animationQueue=this._addQueue=null},n.prototype._setAliases=function(){var t=this.options;if(!C(t)){var e=t.value.aliases;if(a(e))for(var n,i=this._aliases,r=Object.keys(i),o=r.length,s=0;s<o;++s)_(n=e[r[s]])&&(i[r[s]]=n)}},n.prototype._addItems=function(t,e,n){var i=this,r=+(t+e),o=[],s=t;for(this._itemLength+=e;t<r;)o.push(this._bindItem(t++));return o.length>0&&(this.itemsLoaded=this._Promise.all(o).then(function(t){if(i._setBlockLength(t),n>0)for(var e=t.length,r=i._container,o=0;o<e;++o)o<n?i._appendAnimatedItem(t[o]):r.insertBefore(t[o],null);else i._appendItems(t);i._updateResource(s-1),y(i.__resolveFn)&&(i.__resolveFn(),i.__resolveFn=i.__rejectFn=null)}).catch(function(t){O(function(){_(t)&&(t=new Error(t)),i._log.error(t)})})),this.itemsLoaded},n.prototype._appendItems=function(t){W(t,this._container)},n.prototype._appendAnimatedItem=function(t){if(c(t)){var e=this._animationQueue,n={animation:this._animator.enter(t,fn,this._container).then(function(){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}),op:null};e.push(n)}},n.prototype._removeItems=function(t,e){for(var n=f.dispose,i=this.controls,r=t+e;r-- >t;)n(i[r]);this._updateResource(i.length-1)},n.prototype._bindItem=function(t){return this.bindableTemplates.bind("item",t,this._getAliases(t))},n.prototype._setBlockLength=function(t){this._blockLength>0||0===t.length||(this._blockLength=t[0].childNodes.length)},n.prototype._updateResource=function(t){var e=this.controls;t<0||t>=e.length||e[t].resources.add(this._getAliases(t))},n.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},n.prototype._executeEvent=function(t){var e="_"+t[0].type;y(this[e])&&this[e](t)},n.prototype._getAliases=function(t){var e=0==(1&t),n={},i=this._aliases,r=si;return n[i.index]={value:t,type:r},n[i.even]={value:e,type:r},n[i.odd]={value:!e,type:r},n[i.first]={value:0===t,type:r},n[i.last]={value:t===this.context.length-1,type:r},n},n.prototype._push=function(t){var e=t[0],n=this._addQueue,i=e.addedCount,r=this._addItems(e.index,i,this._animate?i:0).then(function(){var t=n.indexOf(r);-1!==t&&n.splice(t,1)});n.push(r)},n.prototype._pop=function(t){var e=this,n=t[0],i=n.object.length;if(0!==n.removed.length){var r=n.object.length;this._itemLength>0&&this._itemLength--,this._Promise.all(this._addQueue).then(function(){e._animate?e._animateItems(i,1,dn,"leave",!1).then(function(){e._removeItems(r,1)}):e._removeItems(r,1)})}},n.prototype._unshift=function(t){var e=t[0],n=e.addedCount,i=this._addQueue;if(this._animate){var r=this._animationQueue,o=r.length;this._animateItems(0,n,fn,null,o>0&&"clone"===r[o-1].op)}var s=this._addItems(e.object.length-n,n,0).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1)});i.push(s)},n.prototype._shift=function(t){var e=this,n=this._addQueue,i=t[0];if(0!==i.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,dn,"clone",!0)]));var r=i.object.length;this._itemLength>0&&this._itemLength--,this._Promise.all(n).then(function(){e._removeItems(r,1)})}},n.prototype._splice=function(t){var e,n=this,i=t[0],r=i.addedCount,o=this._addQueue,s=this._itemLength,a=this._animate;if(b(r)){a&&this._cancelCurrentAnimations();var l=i.object.length,u=s-l;l>s?(e=this._addItems(s,-u,0).then(function(){var t=o.indexOf(e);-1!==t&&o.splice(t,1)}),o.push(e)):s>l&&(s>=u?this._itemLength-=u:this._itemLength=0,this._Promise.all(o).then(function(){n._removeItems(s-u,u)}))}else{var c=i.removed.length,h=this._animationQueue;if(r>c){var p=r-c,_=void 0;if(a){_=r;var f=h.length,d=i.index;s<r-d&&(_=s-d),this._animateItems(d,_,fn,null,f>0&&"clone"===h[f-1].op),_=r-_}else _=0;e=this._addItems(i.object.length-p,p,_).then(function(){var t=o.indexOf(e);-1!==t&&o.splice(t,1)}),o.push(e)}else if(c>r){var v=r>0;a&&!v&&0===o.length&&(o=o.concat([this._animateItems(i.index,c,dn,"clone",!0)]));var m=c-r;s>=m?this._itemLength-=m:this._itemLength=0,this._Promise.all(o).then(function(){if(a&&v){var t=h.length;n._animateItems(i.index,r,fn,null,t>0&&"clone"===h[t-1].op)}n._removeItems(s-m,m)})}}},n.prototype._calculateBlockLength=function(t,e){return this._blockLength},n.prototype._animateItems=function(t,e,n,i,r){var o=this._calculateBlockLength();if(0===o)return this._Promise.resolve();var s=t*o;switch(i){case"clone":return this._handleClonedContainerAnimation(s,e*o+s,n,!0===r);case"leave":return this._handleLeave(s,e*o+s,n);default:return this._handleSimpleAnimation(s,e*o+s,n,!0===r)}},n.prototype._handleSimpleAnimation=function(t,e,n,i){var r=this._container,o=Array.prototype.slice.call(r.childNodes,t,e);if(0===o.length)return this._Promise.resolve();var s=this._animationQueue,a=this._animator.create(o,n),l=a.current.then(function(){var t=s.indexOf(c);-1!==t&&s.splice(t,1)}),u=function(){return a.previous.then(function(){l.start()}),l},c={animation:l,op:null};if(i&&s.length>0){var h=this._cancelCurrentAnimations().then(u);return s.push(c),h}return s.push(c),u()},n.prototype._handleLeave=function(t,e,n){var i=this._container,r=Array.prototype.slice.call(i.childNodes,t,e);if(0===r.length)return this._Promise.resolve();var o=this._animationQueue,s=this._animator.leave(r,n).then(function(){var t=o.indexOf(a);-1!==t&&o.splice(t,1)}),a={animation:s,op:"leave"};return o.push(a),s},n.prototype._handleClonedContainerAnimation=function(t,e,n,i){var r=this._container,o=r.cloneNode(!0),s=Array.prototype.slice.call(o.childNodes,t,e);if(0===s.length)return this._Promise.resolve();var a,l=this._animationQueue,u=this._animator.create(s,n),c=u.current.then(function(){var t=l.indexOf(p);t>-1&&l.splice(t,1),b(a)||a.replaceChild(r,o)}),h=function(){return a=r.parentNode,b(a)||c.isCanceled()?c:(a.replaceChild(o,r),u.previous.then(function(){c.start()}),c)},p={animation:c,op:"clone"};if(i&&l.length>0){var _=this._cancelCurrentAnimations().then(h);return l.push(p),_}return l.push(p),h()},n.prototype._cancelCurrentAnimations=function(){for(var t=this._animationQueue,e=[],n=t.length,i=0;i<n;++i)e.push(t[i].animation.cancel());return this._Promise.all(e)},n._inject={_animator:"$Animator",_Promise:Ft},n}(f);n.ForEach=s,Pt.control(We,s);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith=ln,e._structuredDataElements=[],e}return __extends(e,t),e.prototype.initialize=function(){var t=this;this.on("navigating",function(){t._removeAllElements()})},e.prototype.setTemplate=function(){var t="meta";this.element.setAttribute("prefix","og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"),this._titleElement=this._createElement("title"),this._ogTitleElement=this._createElement(t,"og:title"),this._twitterTitleElement=this._createElement(t,"twitter:title"),this._descriptionElement=this._createElement(t,"description"),this._ogDescriptionElement=this._createElement(t,"og:description"),this._twitterDescriptionElement=this._createElement(t,"twitter:description"),this._ogUrlElement=this._createElement(t,"og:url"),this._twitterUrlElement=this._createElement(t,"twitter:url"),this._authorElement=this._createElement(t,"author"),this._googleAuthorElement=this._createElement("link","author"),this._fbAuthorElement=this._createElement(t,"article:author"),this._twitterCreatorElement=this._createElement(t,"twitter:creator"),this._ogTypeElement=this._createElement(t,"og:type")},e.prototype.title=function(t){return _(t)?(this._titleElement.innerText=t,this._setContent([this._ogTitleElement,this._twitterTitleElement],t),t):this._getContent(this._titleElement)},e.prototype.description=function(t){return _(t)?(this._setContent([this._descriptionElement,this._ogDescriptionElement,this._twitterDescriptionElement],t),t):this._getContent(this._descriptionElement)},e.prototype.url=function(t){return _(t)?(this._setContent([this._ogUrlElement,this._twitterUrlElement],t),t):this._getContent(this._ogUrlElement)},e.prototype.author=function(t){return _(t)?(this._setContent([this._authorElement],t),t):this._getContent(this._authorElement)},e.prototype.googleAuthor=function(t){return _(t)?(this._setContent([this._googleAuthorElement],t),t):this._getContent(this._googleAuthorElement)},e.prototype.fbAuthor=function(t){return _(t)?(this._setContent([this._fbAuthorElement],t),t):this._getContent(this._fbAuthorElement)},e.prototype.twitterCreator=function(t){return _(t)?(this._setContent([this._twitterCreatorElement],t),t):this._getContent(this._twitterCreatorElement)},e.prototype.fbType=function(t){return _(t)?(this._setContent([this._ogTypeElement],t),t):this._getContent(this._ogTypeElement)},e.prototype.images=function(t){var e=this;if(x(t)){var n,i,r=this.element;S(function(t){t=e._browser.urlUtils(t).href,2!==r.querySelectorAll('meta[content="'+t+'"]').length&&(n=e._createElement("meta","og:image",!0),i=e._createElement("meta","twitter:image",!0),e._setContent([n,i],t))},t)}},e.prototype.videos=function(t){var e=this;if(x(t)){var n,i=this._browser,r=this.element;S(function(t){t=i.urlUtils(t).href,1!==r.querySelectorAll('meta[content="'+t+'"]').length&&(n=e._createElement("meta","og:video",!0),e._setContent([n],t))},t)}},e.prototype.structuredData=function(t){if(!v(t)){var e=this._document.createElement("script"),n=this._titleElement.nextSibling;e.setAttribute("type","application/ld+json"),e.textContent=JSON.stringify(t),this._structuredDataElements.push(e),this.dom.insertBefore(this.element,e,n)}},e.prototype.blogPostings=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,i=t.length;n<i;++n)this.structuredData(t[n])},e.prototype.loaded=function(){this.url(this._browser.url())},e.prototype.navigated=function(t){this.url(t)},e.prototype._getContent=function(t){var e=t.nodeName.toLowerCase();return"title"===e?t.innerText:"meta"===e?t.getAttribute("content"):"link"===e?t.getAttribute("href"):void 0},e.prototype._setContent=function(t,e){for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=t.length,s=this._titleElement.nextSibling,a=this.dom,l=0;l<o;++l)"meta"===(n=t[l]).nodeName.toLowerCase()?n.setAttribute("content",e):n.setAttribute("href",e),-1===r.indexOf(n)&&a.insertBefore(i,n,s)},e.prototype._createElement=function(t,e,n){var i,r=_(e),o=!r||0!==e.indexOf("og:")&&0!==e.indexOf("article:")?"name":"property",s=this.element;return"link"===t&&(o="rel"),!n&&r?i=s.querySelector(t+"["+o+'="'+e+'"]'):n||(i=s.querySelector(t)),c(i)||(i=this._document.createElement(t)),r&&i.setAttribute(o,e),i},e.prototype._removeAllElements=function(){var t=Array.prototype.slice,e=this._document.head.querySelectorAll('meta[property^="og:"]'),n=this._document.head.querySelectorAll('meta[name^="twitter:"]');this._removeElements.apply(this,[this._descriptionElement,this._authorElement,this._googleAuthorElement].concat(t.call(e),t.call(n),t.call(this._structuredDataElements))),this._structuredDataElements=[]},e.prototype._removeElements=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=t.length,s=0;s<o;++s)n=t[s],-1!==r.indexOf(n)&&i.removeChild(n)},e._inject={_document:zt,_browser:"$Browser"},e}(t.TemplateControl);n.Head=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setTemplate=function(){this.dom.clearNode(this.element)},e.prototype.loaded=function(){var t=this.options;a(t)&&(this._onOptionsChanged(t.value),t.observe(this._onOptionsChanged))},e.prototype._onOptionsChanged=function(t,e){var n=this;if(t!==e)if(a(t)){var i=t.html;if(i!==this._html){this._html=i;var r=_(i);if(b(i)||r&&""===i.trim())this.controls.length>0?this._TemplateControlFactory.dispose(this.controls[0]):this.dom.clearNode(this.element);else if(r)if(!0!==t.compile)K(this.element,i);else{var o=this.controls.length>0;this.bindableTemplates.once(i).then(function(t){o?n._TemplateControlFactory.dispose(n.controls[0]):n.dom.clearNode(n.element),n.element.insertBefore(t,null)})}else this._log.debug("Trying to bind a non-string value to "+this.type+".")}}else this._log.debug("plat-options for "+this.type+" must be an object.")},e._inject={_TemplateControlFactory:Kt},e}(f);n.InnerHtml=u,Pt.control(Ye,u);var h=function(t){function n(){var n=t.call(this)||this;return n.replaceWith="select",n.priority=120,n.groups={},n.itemsLoaded=new n._Promise(function(t,e){n.__resolveFn=t,n.__rejectFn=e}).catch(e),n}return __extends(n,t),n.prototype.setTemplate=function(){this.bindableTemplates.add("option",this.element.childNodes);var t=(this.options||{}).value||{},e=t.default;if(a(e)){var n=this._document.createElement("option"),i=e.value,r=e.textContent;n.value=C(i)?r:i,n.textContent=C(r)?i:r,this.element.insertBefore(n,null)}if(b(t.group))this._isGrouped=!1;else{var o=this._group=t.group,s=this._document.createElement("optgroup");s.label=Hn+o+Qn,this.bindableTemplates.add("group",s),this._isGrouped=!0}},n.prototype.contextChanged=function(t,e){var n=this;if(!v(t)&&x(t)){var i=x(t)?t.length:0,r=x(e)?e.length:0;this._setListener(),i>r?this._addItems(i-r,r):i<r&&this._removeItems(r-i),this.itemsLoaded.then(this._observeChange.bind(this))}else v(e)||this.itemsLoaded.then(function(){n._removeItems(n.controls.length)}).then(this._observeChange.bind(this))},n.prototype.loaded=function(){if(C(this._isGrouped)){var t=(this.options||{}).value||{};this._isGrouped=!b(this._group=t.group)}this._defaultOption=this.element.firstElementChild;var e=this.context;x(e)&&(this._addItems(e.length,0),this._setListener())},n.prototype.dispose=function(){t.prototype.dispose.call(this),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._defaultOption=null},n.prototype.observeProperties=function(t){var e=this,n=this.element;if(this._binder=t,n.multiple){if(b(t.evaluate())){var i=[];this.inputChanged(i,this.__lastValue),this.__lastValue=i}t.observeProperty(this._setSelectedIndices),t.observeArrayChange(function(){e._setSelectedIndices(t.evaluate(),null,null)})}else t.observeProperty(this._setSelectedIndex);this.addEventListener(n,"change",this._observeChange,!1)},n.prototype._setSelectedIndex=function(t,e,n,i){var r=this,o=this.element,s=o.value;if(b(t))return!0!==i&&this._document.body.contains(o)?void(o.selectedIndex=-1):void this.itemsLoaded.then(function(){if(b(r._binder.evaluate())){var t=o.value;r.inputChanged(t,r.__lastValue),r.__lastValue=t}});_(t)||(g(t)?(this._propertyType="number",t=t.toString()):m(t)?(this._propertyType="boolean",t=t.toString()):(t=y(t.toString)?t.toString():Object.prototype.toString.call(t),this._log.info('Trying to bind the invalid value "'+t+'" to a '+this.type+"."))),s!==t&&this.itemsLoaded.then(function(){if(r._document.body.contains(o))o.value=r.__lastValue=t,o.value===t&&-1!==o.selectedIndex||(o.selectedIndex=-1);else{if(o.value=t,o.value!==t){o.value=s;var e=r._castValue(o.value);r.inputChanged(e,r.__lastValue),r.__lastValue=e}r.__lastValue=t}})},n.prototype._setSelectedIndices=function(t,e,n,i){var r=this;this.itemsLoaded.then(function(){var e,n=r.element.options,o=b(n)?0:n.length,s=b(t);if(!s&&x(t)){for(var a,l,u,c=1/0;o-- >0;)a=(e=n[o]).value,-1===t.indexOf(a)?g(l=Number(a))&&-1!==(u=t.indexOf(l))?(u<c&&(r._propertyType="number",c=u),e.selected=!0):"true"===a&&-1!==(u=t.indexOf(!0))||"false"===a&&-1!==(u=t.indexOf(!1))?(u<c&&(r._propertyType="boolean",c=u),e.selected=!0):e.selected=!1:e.selected=!0;r.__lastValue=t}else{if(!0===i&&b(r._binder.evaluate())){var h=r._getSelectedValues();r.inputChanged(h,r.__lastValue),r.__lastValue=h}for(;o-- >0;){if(e=n[o],!s&&e.value===""+t)return void(e.selected=!0);e.selected=!1}r.__lastValue=t}})},n.prototype._observeChange=function(){var t=this.element,e=t.multiple?this._getSelectedValues():this._castValue(t.value);e!==this.__lastValue&&(this.inputChanged(e,this.__lastValue),this.__lastValue=e)},n.prototype._getSelectedValues=function(){for(var t,e=this.element.options,n=e.length,i=[],r=0;r<n;++r)(t=e[r]).selected&&i.push(this._castValue(t.value));return i},n.prototype._castValue=function(t){var e=this._propertyType;if(b(e))return t;var n;switch(e){case"number":n=v(t)?null:Number(t);break;case"boolean":switch(t){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!t}break;default:n=t}return n},n.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},n.prototype._executeEvent=function(t){var e="_"+t[0].type;y(this[e])&&this[e](t)},n.prototype._addItems=function(t,e){for(var n=this,i=this.bindableTemplates,r=[],o=this._insertOption;t-- >0;)r.push(i.bind("option",e).then(o.bind(this,e++)));return r.length>0&&(this.itemsLoaded=this._Promise.all(r).then(function(){y(n.__resolveFn)&&(n.__resolveFn(),n.__resolveFn=n.__rejectFn=null)}).catch(function(t){O(function(){_(t)&&(t=new Error(t)),n._log.error(t)})})),this.itemsLoaded},n.prototype._insertOption=function(t,e){var n=this.element;if(this._isGrouped){var i=this.groups,r=(this.context[t]||{})[this._group],o=i[r];return b(o)?i[r]=this.bindableTemplates.bind("group",t).then(function(t){return(o=i[r]=t.childNodes[1]).insertBefore(e,null),n.insertBefore(t,null),o}):d(o)?o.then(function(t){t.insertBefore(e,null)}):(o.insertBefore(e,null),this._Promise.resolve())}return n.insertBefore(e,null),this._Promise.resolve()},n.prototype._removeItems=function(t){for(var e=f.dispose,n=this.controls;t-- >0;)e(n.pop())},n.prototype._removeItem=function(){this._isGrouped?this._resetSelect():this._removeItems(1)},n.prototype._resetSelect=function(){this._removeItems(this.controls.length),this.groups={},b(this._defaultOption)||this.element.insertBefore(this._defaultOption.cloneNode(!0),null),this._addItems(this.context.length,0)},n.prototype._push=function(t){var e=t[0];this._addItems(e.addedCount,e.index)},n.prototype._pop=function(t){var e=this;0!==t[0].removed.length&&this.itemsLoaded.then(function(){e._removeItem()})},n.prototype._unshift=function(t){if(this._isGrouped)this._resetSelect();else{var e=t[0],n=e.addedCount;this._addItems(n,e.object.length-n-1)}},n.prototype._shift=function(t){var e=this;0!==t[0].removed.length&&this.itemsLoaded.then(function(){e._removeItem()})},n.prototype._splice=function(t){var e=this;if(this._isGrouped)this._resetSelect();else{var n=t[0],i=n.addedCount,r=n.removed.length;i>r?this._addItems(i-r,n.object.length-i-1):r>i&&this.itemsLoaded.then(function(){e._removeItems(r-i)})}},n.prototype._sort=function(t){this._isGrouped&&this._resetSelect()},n.prototype._reverse=function(t){this._isGrouped&&this._resetSelect()},n._inject={_Promise:Ft,_document:zt},n}(w);n.Select=h,Pt.control(Je,h);var p=function(t){function n(){var e=t.call(this)||this;e._animate=!1,e.__condition=!0,e.__firstTime=!0,e.__isBound=!1;var n=e._document;return e.commentNode=n.createComment(Xe+Zn+"placeholder"),e.fragmentStore=n.createDocumentFragment(),e}return __extends(n,t),n.prototype.contextChanged=function(){var t=this.options.value;if(!v(t))return this._setter(t)},n.prototype.setTemplate=function(){this.bindableTemplates.add("template",Array.prototype.slice.call(this.element.childNodes))},n.prototype.loaded=function(){var t=this.options;a(t)?this._animate=!0===t.value.animate:(this._log.warn("No condition specified in "+pe+" for "+this.type+"."),this.options={value:{condition:!0},observe:e});var n=this.contextChanged();return this.__removeListener=this.options.observe(this._setter),n},n.prototype.dispose=function(){y(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null),y(this.__cancelFrame)&&(this.__cancelFrame(),this.__cancelFrame=null),this.commentNode=null,this.fragmentStore=null},n.prototype._setter=function(t){var e,n,i,r=this,o=!!t.condition;return o!==this.__condition||this.__firstTime?(o?(e=this.__leavePromise,n=function(){return r.__leavePromise=null,r._addItem()}):(e=this.__enterPromise,n=function(){return r.__enterPromise=null,r._removeItem()}),i=b(e)?n():this._animate&&y(e.cancel)?e.cancel().then(n):e.then(n),this.__firstTime=!1,this.__condition=o,i):this._Promise.resolve(null)},n.prototype._addItem=function(){var t=this,e=this.__isBound;return e&&!c(this.commentNode.parentNode)?this._Promise.resolve(null):e?b(this.__initialBind)?this._animate?this._animateEntrance():this._elementEntrance():this.__initialBind=this.__initialBind.then(function(){return t.__initialBind=null,t._animate?t._animateEntrance():t._elementEntrance()}):(this.__isBound=!0,this.__initialBind=this.bindableTemplates.bind("template").then(function(e){t.__initialBind=null;var n=t.element;return n.parentNode===t.fragmentStore||b(n.parentNode)?(n.insertBefore(e,null),t._animate?t._animateEntrance():t._elementEntrance()):t._animate?(t.__enterPromise=t._animator.animate(n,fn).then(function(){t.__enterPromise=null}),n.insertBefore(e,null),t.__enterPromise):void n.insertBefore(e,null)}))},n.prototype._elementEntrance=function(){var t=this,e=this.commentNode,n=e.parentNode;return c(n)?(this.__enterPromise=new this._Promise(function(i){t.__cancelFrame=M(function(){n.insertBefore(t.element,e),i()})}).then(function(){t.__enterPromise=null}),this.__enterPromise):this._Promise.resolve()},n.prototype._animateEntrance=function(){var t=this,n=this.commentNode,i=n.parentNode;return c(i)?(this.__enterPromise=this._animator.enter(this.element,fn,i,n).then(function(){t.__enterPromise=null}),this.__enterPromise):this._animator.resolve().then(e)},n.prototype._removeItem=function(){var t=this;return b(this.__initialBind)?this._animate?this._animateLeave():this._elementLeave():this.__initialBind=this.__initialBind.then(function(){return t.__initialBind=null,t._animate?t._animateLeave():t._elementLeave()})},n.prototype._elementLeave=function(){var t=this;return this.__leavePromise=new this._Promise(function(e){t.__cancelFrame=M(function(){var n=t.element,i=n.parentNode,r=n.nextSibling;c(i)?(c(t.commentNode.parentNode)||i.insertBefore(t.commentNode,r),t.fragmentStore.insertBefore(n,null),e()):e()})}).then(function(){t.__leavePromise=null}),this.__leavePromise},n.prototype._animateLeave=function(){var t=this,e=this.element;return this.__leavePromise=this._animator.leave(e,dn).then(function(){var n=e.parentNode,i=e.nextSibling;t.__leavePromise=null,c(t.commentNode.parentNode)||n.insertBefore(t.commentNode,i),t.fragmentStore.insertBefore(e,null)}),this.__leavePromise},n._inject={_animator:"$Animator",_Promise:Ft,_document:zt},n}(f);n.If=p,Pt.control(Xe,p);var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="a",e._router=e._Router.currentRouter(),e._allowClick=!1,e}return __extends(e,t),e.prototype.initialize=function(){this._removeClickListener=this.dom.addEventListener(this.element,"click",this._handleClick.bind(this),!1)},e.prototype.loaded=function(){var t=this.options,e=this.setHref.bind(this);if(!a(t))return this._log.warn("No options specified for "+this.type+". Please send in options of type plat.ui.controls.ILinkOptions."),t=this.options={},t.value={view:""},void this.setHref();a(t.value)||(t.value={view:""}),this.addEventListener(this.element,bn,this._handleTap,!1),e(),t.observe(e)},e.prototype.setHref=function(){var t=this.getHref();v(t)||(this.element.href=t)},e.prototype.getHref=function(){if(!b(this._router)){var t=this.options.value,e=t.view;if(!0!==t.isUrl){var n=t.parameters,i=t.query;if(v(e))return e;e=this._router.generate(e,n,i)}return this._browser.formatUrl(e)}},e.prototype._handleClick=function(t){if(this._allowClick)this._allowClick=!1;else{var e;if(g(t.buttons)&&0!==t.buttons)e=t.buttons;else if(g(t.which)&&t.which>0)e=t.which;else switch(t.button){case-1:e=0;break;case 0:e=1;break;case 1:e=4;break;case 2:e=2;break;case 3:e=8;break;case 4:e=16;break;default:e=1}1===e&&t.preventDefault()}},e.prototype._handleTap=function(t){var e=this;if(1===t.buttons){var n=this.getHref();if(!C(n)){var i=this.element.target;if(v(i)||"_self"===i)return t.preventDefault(),void M(function(){e._browser.url(n)});this._allowClick=!0,this.element.click()}}},e.prototype.dispose=function(){$(this._removeClickListener,3e3)},e._inject={_Router:te,_Injector:ne,_browser:"$Browser",_window:ee},e}(f);n.Link=E,Pt.control(Qe,E)}(t.controls||(t.controls={}))}(Gi=t.ui||(t.ui={}));!function(t){function n(t,e,n,i,r){return l._markupRegex=t.markupRegex,l._newLineRegex=t.newLineRegex,l._ContextManager=e,l._parser=n,l._TemplateControlFactory=i,l._log=r,l}function i(t,e,n,i,r,o){return u._document=t,u._managerCache=e,u._ResourcesFactory=n,u._AttributesFactory=i,u._BindableTemplatesFactory=r,u._log=o,u}function r(){return h}function o(){return p}var s=function(){function t(){}return t.prototype.compile=function(t,e){var n,i,r,o=t.childNodes,s=!b(e)?this._managerCache.read(e.uid):null,a=this._ElementManagerFactory.create;if(o=C(o)?y(t.push)?t:Array.prototype.slice.call(t):Array.prototype.slice.call(o),b(s)){n=o.length;for(var l=0;l<n;++l)(r=o[l]).nodeType===Node.ELEMENT_NODE&&(b(a(r))||this.compile(r)),l+=(i=o.length)-n,n=i}else this._compileNodes(o,s)},t.prototype._compileNodes=function(t,e){for(var n,i,r,o=t.length,s=this._ElementManagerFactory.create,a=this._CommentManagerFactory.create,l=this._TextManagerFactory.create,u=0;u<o;++u){switch((n=t[u]).nodeType){case Node.ELEMENT_NODE:b(i=s(n,e))||this._compileNodes(Array.prototype.slice.call(n.childNodes),i);break;case Node.TEXT_NODE:l(n,e);break;case Node.COMMENT_NODE:a(n,e)}u+=(r=t.length)-o,o=r}},t._inject={_ElementManagerFactory:Ht,_TextManagerFactory:"$TextManagerFactory",_CommentManagerFactory:"$CommentManagerFactory",_managerCache:Wt},t}();t.Compiler=s,Pt.injectable("$Compiler",s);var l=function(){function t(){this.isClone=!1}return t.hasMarkup=function(e){return t._markupRegex.test(e)},t.findMarkup=function(e){var n,i,r,o,s=Hn.length,a=Qn.length,l=Qn[a-1],u=[],c=t._wrapExpression,h=t._parser;for(e=e.replace(t._newLineRegex,"");-1!==(n=e.indexOf(Hn))&&-1!==(i=e.indexOf(Qn));){for(0!==n&&u.push(c(e.slice(0,n)));e[i++]!==l||e[i]===l;);"="===(r=e.slice(n+s,i-a))[0]?((o=h.parse(r.slice(1).trim())).oneTime=!0,u.push(o)):u.push(h.parse(r.trim())),e=e.slice(i)}return n>=0&&i>=0?u.push(c(e.slice(i))):""!==e&&u.push(c(e)),u},t.build=function(e,n){for(var i,r,o="",s=e.length,l={},u=t._TemplateControlFactory.evaluateExpression,c=0;c<s;++c)if(i=e[c],r=u(i,n,l),a(r))try{o+=JSON.stringify(r,null,4)}catch(e){b(e.description)||(e.description="Cannot stringify object: "+e.description),e.message="Cannot stringify object: "+e.message,t._log.warn(e)}else b(r)||(o+=r);return o},t.observeExpressions=function(e,n,i){for(var r,o,s,a,l=t.__findUniqueIdentifiers(e),u=l.identifiers,c=l.oneTimeIdentifiers,h={listener:i,uid:n.uid};u.length>0;)b(s=(o=t.__getObservationDetails(u.pop(),n)).manager)||s.observe(o.absoluteIdentifier,h);for(;c.length>0;)if(r=c.pop(),o=t.__getObservationDetails(r,n),s=o.manager,!b(s)&&!o.isDefined){a=o.absoluteIdentifier;var p=s.observe(a,h),_=s.observe(a,{uid:n.uid,listener:function(){p(),_()}})}},t._wrapExpression=function(t){return{evaluate:function(){return t},identifiers:[],aliases:[],expression:t}},t.__findUniqueIdentifiers=function(t){var e,n=t.length;if(1===n)return!0===(e=t[0]).oneTime?{identifiers:[],oneTimeIdentifiers:e.identifiers.slice(0)}:{identifiers:e.identifiers.slice(0),oneTimeIdentifiers:[]};for(var i,r,o,s,a,l={},u={},c=[],h=[],p=0;p<n;++p)for(a=(e=t[p]).oneTime,s=(i=e.identifiers).length,o=0;o<s;++o)if(r=i[o],a){if(!0===l[r])continue;u[r]||(u[r]=!0,h.push(r))}else l[r]||(l[r]=!0,c.push(r)),!0===u[r]&&(u[r]=!1,h.splice(h.indexOf(r),1));return{identifiers:c,oneTimeIdentifiers:h}},t.__getObservationDetails=function(e,n){var i,r=t._ContextManager,o=e.split("."),s="",a=!1;if("@"===e[0]){var l=void 0,u={},c=o.shift().slice(1);if(o.length>0&&(s="."+o.join(".")),l=u[c],b(l)&&(l=u[c]=n.findResource(c)),!b(l)&&!b(l.resource)){var h=l.resource.type;c===ci?(i=r.getManager(Yi.getRootControl(n)),s=n.absoluteContextPath+s):c===li?(i=r.getManager(u[c].control),s="context"+s):h!==ni&&h!==si||(i=r.getManager(u[c].control),s="resources."+c+".value"+s)}}else(a=!C(r.getContext(n.context,o)))||C(r.getContext(n,o))?(i=r.getManager(Yi.getRootControl(n)),s=n.absoluteContextPath+"."+e):i=null;return{absoluteIdentifier:s,manager:i,isDefined:a}},t.prototype.initialize=function(t,e){this.nodeMap=t,this.parent=e,b(e)||(this.isClone=e.isClone,e.children.push(this))},t.prototype.getParentControl=function(){for(var t,e=this.parent;b(t)&&!b(e);)t=e.getUiControl(),e=e.parent;return t},t.prototype.clone=function(t,e){return 1},t.prototype.bind=function(){},t}();t.NodeManager=l,t.INodeManagerStatic=n,Pt.injectable("$NodeManagerStatic",n,[Ut,qt,"$Parser",Kt,Bt],Wn);var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.children=[],e.type="element",e.replace=!1,e.hasOwnContext=!1,e}return __extends(e,t),e.create=function(t,n){var i,r=t.nodeName.toLowerCase(),o=r,s=ji[r]||Ai[r],a=!0,l=!1;if(b(s)&&(t.hasAttribute(tn)?(r=t.getAttribute(tn).toLowerCase(),s=ji[r]||Ai[r],a=!1):t.hasAttribute("data-"+tn)&&(r=t.getAttribute("data-"+tn).toLowerCase(),s=ji[r]||Ai[r],a=!1)),!b(s)){var u=s.inject();i={control:u,resourceElement:e.locateResources(t),nodeName:r,expressions:[],injector:s},l=!0,a&&t.setAttribute(tn,r);var c=u.replaceWith,h="any"===c&&a;if(!v(c)&&("any"!==c||h)&&c.toLowerCase()!==o){h&&(c="div");var p=e._document.createElement(c);p.nodeType===Node.ELEMENT_NODE&&(t=et(t,p))}}var f=e._collectAttributes(t.attributes),d=e.getInstance();return f.element=t,!l&&_(f.childContext)?(s=Pi.$TemplateControlInstance,l=!0,f.uiControlNode={control:s.inject(),resourceElement:null,nodeName:on,expressions:[],injector:s}):f.uiControlNode=i,d.initialize(f,n),f.hasControl||l?(d.setUiControlTemplate(),l?null:d):(d.bind=function(){return[]},d)},e.locateResources=function(t){for(var e,n,i=Array.prototype.slice.call(t.childNodes);i.length>0;)if(e=i.shift(),(n=e.nodeName.toLowerCase())===nn||n==="x-"+nn)return t.removeChild(e);return null},e.clone=function(t,n,i,r,o){b(o)&&(o=e._cloneNodeMap(t.nodeMap,i,n.getUiControl()||n.getParentControl(),r));var s=e.getInstance(),a=!b(r);return s.nodeMap=o,s.parent=n,b(n)||n.children.push(s),s.replace=t.replace,s.replaceNodeLength=t.replaceNodeLength,s.hasOwnContext=t.hasOwnContext,s.isClone=!0,o.hasControl||a||(s.bind=function(){return[]}),a&&e._managerCache.put(r.uid,s),s},e.cloneUiControl=function(t,n){var i=t.uiControlNode;if(!b(i)&&!b(i.injector)){var r=i.control,o=i.injector.inject(),s=e._ResourcesFactory.getInstance(),a=e._AttributesFactory.getInstance();return o.parent=n,n.controls.push(o),o.controls=[],a.initialize(o,t.attributes),o.attributes=a,s.initialize(o,r.resources),o.resources=s,e._ResourcesFactory.addControlResources(o),b(r.innerTemplate)||(o.innerTemplate=r.innerTemplate.cloneNode(!0)),o.type=r.type,o.bindableTemplates=e._BindableTemplatesFactory.create(o,r.bindableTemplates),o.replaceWith=r.replaceWith,o}},e.createAttributeControls=function(t,n,i,r,o){var s,a=t.nodes,l=!0===o?r:t.element;if(c(l)){if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0===o?e._copyAttributeNodes(a):[];s=l.attributes}var u,h,p,f,d,v,m=t.attributes,C=[],x=a.length;for(v=0;v<x;++v)d=(h=a[v]).nodeName,f=null,b(p=h.injector)||(f=p.inject(),h.control=f,f.parent=n,f.element=l,(u=e._AttributesFactory.getInstance()).initialize(f,m),f.attributes=u,f.type=d,_(f.uid)||(f.uid=D(ie)),f.templateControl=i),!0===o&&(C.push({control:f,expressions:h.expressions,node:s?s.getNamedItem(d)||s.getNamedItem("data-"+d):null,nodeName:d,injector:p}),b(f)||(b(n)||n.controls.push(f),y(f.initialize)&&f.initialize()));if(!o)for(a.sort(function(t,e){var n=t.control,i=e.control;if(b(n))return 1;if(b(i))return-1;var r=g(n.priority)?n.priority:0;return(g(i.priority)?i.priority:0)-r}),v=0;v<x;++v)b(f=(h=a[v]).control)||(b(n)||n.controls.push(f),y(f.initialize)&&f.initialize());return C},e.getInstance=function(){var t=new e;return t._Promise=dt(Ft),t._ContextManager=l._ContextManager,t._compiler=dt("$Compiler"),t._CommentManagerFactory=dt("$CommentManagerFactory"),t._ControlFactory=dt(Dt),t._TemplateControlFactory=l._TemplateControlFactory,t._BindableTemplatesFactory=e._BindableTemplatesFactory,t._log=e._log,t},e._collectAttributes=function(t){for(var n,i,r,o,s,a,u,c,h=[],p=l.hasMarkup,_=l.findMarkup,f=l._parser,d=!1,v=t.length,m={},g=0;g<v;++g)r=(n=t[g]).value,i=n.name.replace(/^data-/i,"").toLowerCase(),c=ji[i]||Ai[i],i===rn?""!==r&&(1!==(o=f.parse(r)).identifiers.length&&e._log.warn("Incorrect "+rn+": "+r+", must contain a single identifier."),s=o.identifiers[0]):i!==tn&&(u=(a=p(r))?_(r):[],d||!a&&b(c)||(d=!0),h.push({control:null,node:n,nodeName:i,expressions:u,injector:c})),m[z(i)]=r;return{element:null,attributes:m,nodes:h,childContext:s,hasControl:d}},e._copyAttributeNodes=function(t){for(var e,n=[],i=t.length,r=0;r<i;++r)e=t[r],n.push({expressions:e.expressions,nodeName:e.nodeName});return n},e._cloneNode=function(t,e,n){return{control:n,injector:t.injector,expressions:t.expressions,node:e,nodeName:t.nodeName}},e._cloneNodeMap=function(t,n,i,r){var o=t.hasControl,s={attributes:t.attributes,childContext:t.childContext,nodes:[],element:n,uiControlNode:b(t.uiControlNode)?null:e._cloneNode(t.uiControlNode,n,r),hasControl:o};return o&&(s.nodes=e.createAttributeControls(t,i,r,n,!0)),s},e.prototype.clone=function(t,n,i){var r,o,s,a,l=this.replace,u=this.children,c=b(i)?null:i.uiControlNode.control,h=!b(c);if(h||(h=!b(c=e.cloneUiControl(this.nodeMap,n.getUiControl()||n.getParentControl()))),l){var p=t.parentNode.childNodes,_=Array.prototype,f=_.indexOf.call(p,t);r=_.slice.call(p,f+1,f+this.replaceNodeLength),o=e.clone(this,n,null,c,i),c.elementNodes=r,c.startNode=t,c.endNode=r.pop(),s=u.shift(),a=u.shift(),s.clone(c.startNode,o),a.clone(c.endNode,o),y(c.initialize)&&c.initialize()}else r=Array.prototype.slice.call(t.childNodes),i=(o=e.clone(this,n,t,c,i)).nodeMap,h&&(c.element=t,y(c.initialize)&&c.initialize());for(var d=u.length,v=0,m=0;m<d;++m)v+=u[m].clone(r[v],o);return l?(u.unshift(a),u.unshift(s),v+2):1},e.prototype.initialize=function(n,i,r){t.prototype.initialize.call(this,n,i);var o,s=n.uiControlNode,a=!b(s);a&&(this._populateUiControl(),o=s.control,this.hasOwnContext=o.hasOwnContext),n.hasControl&&e.createAttributeControls(n,this.getParentControl(),o),!r&&a&&y(o.initialize)&&o.initialize()},e.prototype.bind=function(){var t=this,e=this.nodeMap,n=this.getParentControl(),i=e.uiControlNode,r=[];if(!b(i)){var o,s=i.control,l=e.childContext,u=this._ContextManager.getManager,c=b(n)?"context":n.absoluteContextPath,h=this._TemplateControlFactory,p=!s.hasOwnContext;if(r.push(s),p&&!b(l))if("@"===l[0]){var _=l.split("."),f=_.shift().slice(1),d=h.findResource(s,f);if(a(d)){var v=d.resource;l=_.length>0?"."+_.join("."):"",f===ci?c+=l:f===li?c="context"+l:v.type===ni||v.type===si?(c="resources."+f+".value"+l,s.root=d.control):this._log.warn('Only resources of type "observable" can be set as context.')}else this._log.warn("Could not set the context of "+s.type+' with the resource specified as "'+l+'".')}else c+="."+l;a(s.root)||(s.root=this._ControlFactory.getRootControl(s)||s),o=u(s.root);var m=!1;p?(s.context=o.getContext(c.split("."),!1),m=C(s.context)&&!this._BindableTemplatesFactory.isBoundControl(s)):c="context",m?this.contextPromise=new this._Promise(function(e,n){var i=o.observe(c,{uid:s.uid,listener:function(n,r){C(n)||(i(),s.context=n,t._beforeLoad(s,c),e())}})}):this._beforeLoad(s,c)}return this._observeControlIdentifiers(e.nodes,n,r,e.element),r},e.prototype.setUiControlTemplate=function(t){var e=this,n=this.nodeMap.uiControlNode;if(b(n))b(this.parent)&&this.bindAndLoad();else{var i=n.control;this.templatePromise=this._TemplateControlFactory.determineTemplate(i,t).then(function(t){e.templatePromise=null,e._initializeControl(i,t.cloneNode(!0))},function(t){if(e.templatePromise=null,b(t)){var n=t;e._BindableTemplatesFactory.isBoundControl(i)&&(n=W(i.element.childNodes)),e._initializeControl(i,n)}else O(function(){_(t)&&(t=new Error(t)),e._log.error(t)})})}},e.prototype.getUiControl=function(){var t=this.nodeMap.uiControlNode;if(!b(t))return t.control},e.prototype.fulfillTemplate=function(){var t=this;return b(this.templatePromise)?this._fulfillChildTemplates():this.templatePromise.then(function(){return t._fulfillChildTemplates()})},e.prototype.fulfillAndLoad=function(){var t=this;return this.fulfillTemplate().then(function(){return t.bindAndLoad()}).catch(function(e){O(function(){_(e)&&(e=new Error(e)),t._log.error(e)})})},e.prototype.bindAndLoad=function(){var t=this,e=this.bind();return(d(this.contextPromise)?this.contextPromise.then(function(){return t._bindChildren()}):this._bindChildren()).then(function(){return t._loadControls(e,t.getUiControl())}).catch(function(e){O(function(){_(e)&&(e=new Error(e)),t._log.error(e)})})},e.prototype.observeRootContext=function(t,e){var n=this;return e=e.bind(this),b(t.context)?new this._Promise(function(i){var r=n._ContextManager.getManager(t).observe("context",{listener:function(){r(),e().then(i)},uid:t.uid})}).catch(function(t){O(function(){_(t)&&(t=new Error(t)),n._log.error(t)})}):e()},e.prototype._beforeLoad=function(t,n){var i=this._ContextManager.getManager(t.root),r=this._TemplateControlFactory;t.zCC__plat=i.observe(n,{uid:t.uid,priority:1e3,listener:function(e,n){t.context=e}}),r.setAbsoluteContextPath(t,n),r.setContextResources(t),e._ResourcesFactory.bindResources(t.resources)},e.prototype._bindChildren=function(){for(var t,e=this.children,n=e.length,i=[],r=0;r<n;++r)(t=e[r]).hasOwnContext?this.isClone?i.push(t.observeRootContext(t.getUiControl(),t.bindAndLoad)):i.push(t.observeRootContext(t.getUiControl(),t.fulfillAndLoad)):C(t.children)?t.bind():i.push(t.bindAndLoad());return this._Promise.all(i)},e.prototype._loadControls=function(t,e){var n,i,r,o,s=t.length,a=this._ControlFactory.load,l=b(e);if(l)o=0;else{var u=e.priority;r=g(u)?u:100,o=1}for(;o<s;++o)(n=t[o]).templateControl=e,!l&&r>n.priority&&(l=!0,i=a(e)),a(n);return l||(i=a(e)),i},e.prototype._populateUiControl=function(){var t=this.nodeMap,n=this.getParentControl(),i=t.uiControlNode,r=i.control,o=r.uid,s=r.resources,l=t.element,u=Array.prototype.slice.call(l.childNodes),c=e._AttributesFactory.getInstance(),h=this.replace=null===r.replaceWith||""===r.replaceWith;_(o)||(o=r.uid=D(ie)),e._managerCache.put(o,this),b(n)||r.parent===n||(n.controls.push(r),r.parent=n),y(l.setAttribute)&&l.setAttribute(cn,""),r.element=l,r.controls=[],c.initialize(r,t.attributes),r.attributes=c,a(s)&&y(s.add)?s.add(i.resourceElement):((s=e._ResourcesFactory.getInstance()).initialize(r,i.resourceElement),r.resources=s),e._ResourcesFactory.addControlResources(r),r.type=i.nodeName,r.bindableTemplates=r.bindableTemplates||this._BindableTemplatesFactory.create(r),!(u.length>0)||v(r.templateString)&&v(r.templateUrl)||(r.innerTemplate=W(u)),h&&this._replaceElement(r,t)},e.prototype._replaceElement=function(t,n){var i=n.element,r=i.parentNode,o=e._document,s=t.type,a=t.uid,l=t.startNode=o.createComment(s+" "+a+": start node"),u=t.endNode=o.createComment(s+" "+a+": end node"),c=this._CommentManagerFactory.create;c(l,this),c(u,this),r.insertBefore(l,i),r.insertBefore(u,i.nextSibling),t.elementNodes=tt(i),t.element=n.element=null},e.prototype._initializeControl=function(t,n){var i,r=this.nodeMap.element,o=this.replace;if(!b(n)){var s=e.locateResources(n);b(s)||t.resources.add(e._ResourcesFactory.parseElement(s)),o?(i=t.endNode,t.elementNodes=Array.prototype.slice.call(n.childNodes),Z(i.parentNode,n,i)):Z(r,n,r.lastChild)}if(y(t.setTemplate)&&t.setTemplate(),o){this._compiler.compile(t.elementNodes,t);var a=t.startNode,l=a.parentNode,u=Array.prototype.slice.call(l.childNodes);i=t.endNode,t.elementNodes=u.slice(u.indexOf(a)+1,u.indexOf(i)),this.replaceNodeLength=t.elementNodes.length+2}else this._compiler.compile(r,t);b(t.parent)&&this.fulfillAndLoad()},e.prototype._observeControlIdentifiers=function(t,e,n,i){for(var r,o,s,a=t.length,u=!b(e),c=0,h=this.replace,p=[];c<a;++c)o=(r=t[c]).control,u&&r.expressions.length>0&&(s=f.getInstance(),p.push(s),s.initialize(i,r,e,n,h),l.observeExpressions(r.expressions,e,s.attributeChanged.bind(s))),b(o)||n.push(o);for(a=p.length,c=0;c<a;++c)p[c].attributeChanged()},e.prototype._fulfillChildTemplates=function(){for(var t,e=this,n=this.children,i=n.length,r=[],o=0;o<i;++o)C((t=n[o]).children)||r.push(t.fulfillTemplate());return this._Promise.all(r).catch(function(t){O(function(){_(t)&&(t=new Error(t)),e._log.error(t)})})},e._inject={_Promise:Ft,_ContextManager:qt,_compiler:"$Compiler",_CommentManagerFactory:"$CommentManagerFactory",_ControlFactory:Dt,_TemplateControlFactory:Kt,_BindableTemplatesFactory:Xt,_log:Bt},e}(l);t.ElementManager=u,t.IElementManagerFactory=i,Pt.injectable(Ht,i,[zt,Wt,Jt,"$AttributesFactory",Xt,Bt],Gn),Pt.injectable("$ElementManagerInstance",u,null,Xn);var h=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="text",e}return __extends(n,t),n.create=function(t,i){var r=t.nodeValue,o=new n;if(l.hasMarkup(r)){var s={nodes:[{node:t,expressions:l.findMarkup(r)}]};return o.initialize(s,i),o}return o.initialize(null,i),o.bind=e,o},n._cloneNodeMap=function(t,e){var n=t.nodes[0];return{nodes:[{expressions:n.expressions,nodeName:n.nodeName,node:e}]}},n._clone=function(t,i,r){var o=t.nodeMap,s=new n;return b(o)?(s.initialize(null,r),s.bind=e):s.initialize(n._cloneNodeMap(o,i),r),s},n.prototype.clone=function(t,e){return n._clone(this,t,e),1},n.prototype.bind=function(){var t=this.getParentControl(),e=this.nodeMap.nodes[0],n=e.node,i=e.expressions;l.observeExpressions(e.expressions,t,this._setText.bind(this,n,t,i)),this._setText(n,t,i)},n.prototype._setText=function(t,e,n){t.nodeValue=l.build(n,e||{})},n}(l);t.TextManager=h,t.ITextManagerFactory=r,Pt.injectable("$TextManagerFactory",r,null,Gn),Pt.injectable("$TextManagerInstance",h,null,Xn);var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="comment",e}return __extends(e,t),e.create=function(t,n){var i=new e;return i.initialize({nodes:[{node:t}]},n),i},e.prototype.clone=function(t,n){return e.create(t,n),1},e}(l);t.CommentManager=p,t.ICommentManagerFactory=o,Pt.injectable("$CommentManagerFactory",o,null,Gn),Pt.injectable("$CommentManagerInstance",p,null,Xn);var f=function(){function t(){this._lastValues={}}return t.getInstance=function(){var e=new t;return e._NodeManager=dt("$NodeManagerStatic"),e},t.prototype.initialize=function(t,e,n,i,r){this.element=t,this.node=e,this.parent=n,this._controls=i,this.replace=r,e.nodeName!==Jn?this.attributeChanged=this._staticAttributeChanged:this.attributeChanged=this._dynamicAttributeChanged},t.prototype._dynamicAttributeChanged=function(){var t,e,n=this.node,i=n.node,r=this._NodeManager,o=i.value,s=r.build(n.expressions,this.parent).trim().split(/\s+/),a=this._lastValues,l=this.element,u=s.length;if(r.hasMarkup(o)){for(var c=void 0,h=void 0,p=(Hn.length,Qn.length),_=Qn[p-1];-1!==(c=o.indexOf(Hn))&&-1!==(h=o.indexOf(Qn));){for(;o[h++]!==_||o[h]===_;);o=o.slice(0,c).trim()+" "+o.slice(h).trim()}i.value=o.trim()}for(e=0;e<u;++e)a[s[e]]=!0;for(u=(s=Object.keys(a)).length,e=0;e<u;++e)a[t=s[e]]?(at(l,t),a[t]=!1):(U(a,t),lt(l,t));this._notifyAttributes(n.nodeName,i.value)},t.prototype._staticAttributeChanged=function(){this._controls;var t=this.node,e=z(t.nodeName),n=this._NodeManager.build(t.expressions,this.parent);this._notifyAttributes(e,n),this.replace||(t.node.value=n)},t.prototype._notifyAttributes=function(t,e){for(var n,i,r=this._controls,o=r.length,s=0;s<o;++s)i=(n=r[s].attributes)[t],n[t]=e,n._attributeChanged(t,e,i)},t}();t.AttributeManager=f}(t.processing||(t.processing={}));!function(t){function n(t){return t.history}function i(t){return m._regex=t,m}function r(){return k}function s(){return L}var l=function(){function t(){this.uid=D(ie),this.isRoot=!1,this._removeUrlListener=e,this._ignoreOnce=!1,this._backNavigate=!1}return t.prototype.initialize=function(e){this._router=e,a(e)&&e.isRoot&&!a(t._root)&&(this.isRoot=!0,t._root=this,this._observeUrl())},t.prototype.navigate=function(t,e){var n=this;e=a(e)?e:{};var i;return this.finishNavigating().then(function(){if(i=e.isUrl?t:n._generate(t,e.parameters,e.query),!_(i)){var r=new Error("Cannot serialize url from input parameters, check your view reference.");n._log.error(r)}return n._navigate(i,e.replace)})},t.prototype.finishNavigating=function(){var n=t._root._router;return n.navigating?n.finishNavigating.catch(e):this._Promise.resolve()},t.prototype.goBack=function(e){var n=this;e=a(e)?e:{};var i=Number(e.length);return g(i)||(i=1),this.isRoot?this.finishNavigating().then(function(){return n._backNavigate=!0,n._goBack(i)}):t._root.goBack(e)},t.prototype.isBackNavigation=function(){return this.isRoot?this._backNavigate:t._root.isBackNavigation()},t.prototype.dispose=function(){this._removeUrlListener(),U(this,"router")},t.prototype._navigate=function(e,n){var i=this;return this.isRoot?new this._Promise(function(t,r){i._resolveNavigate=t,i._rejectNavigate=r,i._browser.url()===i._browser.url(e,n)&&i._resolveNavigate()}):t._root._navigate(e,n)},t.prototype._goBack=function(t){var e=this;return new this._Promise(function(n,i){e._resolveNavigate=n,e._rejectNavigate=i,e._browser.back(t)})},t.prototype._observeUrl=function(){var t=this;if(a(this._router)){var e,n=this._EventManager,i=dt(ln),r=a(i)&&y(i.navigated),o=function(n){t._previousUrl=e;var i=t._history,r=i.state;t._ignoreOnce=!0,b(r.previousLocation)||r.previousLocation===e?i.go(-1):i.go(1),t._backNavigate=!1,y(t._rejectNavigate)&&t._rejectNavigate(n),v(n)||t._log.warn(n)};this._previousUrl=this._browser.url(),n.dispose(this.uid),n.on(this.uid,"backbutton",function(){n.dispatch("backButtonPressed",t,n.DIRECT).defaultPrevented||t.goBack()}),n.on(this.uid,"urlChanged",function(s,a){if(t._ignoreOnce)return t._ignoreOnce=!1,void(y(t._resolveNavigate)&&(t._backNavigate=!1,t._resolveNavigate()));e=t._previousUrl,n.dispatch("beforeNavigate",t,n.DIRECT,[a]).defaultPrevented?o(new Error("Navigation prevented during beforeNavigate event")):t.finishNavigating().then(function(){return n.dispatch("navigating",t,n.DIRECT,[a]),t._router.navigate(a.pathname,a.query)}).then(function(){t._previousUrl=a.pathname,y(t._resolveNavigate)&&(t._backNavigate=!1,t._resolveNavigate()),r&&i.navigated(a.href),n.dispatch("navigated",t,n.DIRECT,[a])},o)})}},t.prototype._generate=function(t,e,n){if(!b(this._router))return v(t)?t:this._router.generate(t,e,n)},t._inject={_Promise:Ft,_Injector:ne,_browserConfig:"$BrowserConfig",_browser:"$Browser",_EventManager:"$EventManagerStatic",_window:ee,_log:Bt,_history:"$History"},t}();t.Navigator=l,Pt.injectable(Vt,l,null,Xn),t.History=n,Pt.injectable("$History",n,[ee]);var u,c=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],h=new RegExp("(\\"+c.join("|\\")+")","g"),p={},f={},d={},m=function(){function t(){this.type=zn,this.name="",this.regex=""}return t.parse=function(e,n,i){if(!(_(e)&&x(n)&&a(i)))return[];"/"===e[0]&&(e=e.slice(1));for(var r,o,s,l=e.split("/"),c=l.length,h=t.__findSegment,v=[],m=t._regex,g=0;g<c;++g)""===(r=l[g])?(a(u)||(u=dt("$BaseSegmentInstance")),v.push(u)):(s=r.match(m.dynamicSegmentsRegex))?(o=s[1],v.push(h(o,"$DynamicSegmentInstance",p)),n.push(o),i.dynamics++):(s=r.match(m.splatSegmentRegex))?(o=s[1],v.push(h(o,"$SplatSegmentInstance",f)),n.push(o),i.splats++):(v.push(h(r,"$StaticSegmentInstance",d)),i.statics++);return v},t.__findSegment=function(t,e,n){var i=n[t];return a(i)||(i=n[t]=dt(e)).initialize(t),i},t.prototype.initialize=function(t){this.name=t},t.prototype.reduceCharacters=function(t,e){return a(this._specification)&&(e=t(e,this._specification)),e},t.prototype.generate=function(t){return this.name},t}();t.BaseSegment=m,t.IBaseSegmentFactory=i,Pt.injectable("$BaseSegmentFactory",i,[Ut],Gn),Pt.injectable("$BaseSegmentInstance",m,null,Xn);var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Un,e}return __extends(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.regex=this.name.replace(h,"\\$1")},e.prototype.reduceCharacters=function(t,e){for(var n=this.name,i=n.length,r=e,o=0;o<i;++o)r=t(r,{validCharacters:n[o]});return r},e}(m);t.StaticSegment=E,Pt.injectable("$StaticSegmentInstance",E,null,Xn);var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Bn,e}return __extends(e,t),e.prototype.generate=function(t){if(a(t))return t[this.name]},e}(m);t.VariableSegment=w,Pt.injectable("$VariableSegmentInstance",w,null,Xn);var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Vn,e.regex="(.+)",e._specification={invalidCharacters:"",repeat:!0},e}return __extends(e,t),e}(w);t.SplatSegment=T,Pt.injectable("$SplatSegmentInstance",T,null,Xn);var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=qn,e.regex="([^/]+)",e._specification={invalidCharacters:"/",repeat:!0},e}return __extends(e,t),e}(w);t.DynamicSegment=N,Pt.injectable("$DynamicSegmentInstance",N,null,Xn);var k=function(){function t(){this.initialize()}return t.compile=function(t,e){return t.reduceCharacters(function(t,e){return t.add(e)},e)},t.link=function(t,e){for(var n,i,r,o,s,a=t.delegates,l=t.regex,u=a.length,c=e.match(l),h=1,p=[],_=0;_<u;++_){for(i={},r=0,o=(n=(s=a[_]).names).length;r<o;++r)i[n[r]]=c[h++];p.push({delegate:s.delegate,parameters:i,isDynamic:o>0})}return p},t.recognize=function(t,e){for(var n,i=[],r=e.length,o=0;o<r;++o)n=e[o],i=i.concat(n.match(t));return i},t.sort=function(t){if(!x(t))return t;var e,n,i,r,o,s,a,l;return t.sort(function(t,u){if(e=t.types,o=u.types,n=e.splats,s=o.splats,n!==s)return n-s;if(i=e.statics,r=e.dynamics,a=o.statics,l=o.dynamics,n>0){if(i!==a)return a-i;if(r!==l)return l-r}return r!==l?r-l:i!==a?a=i:0})},t.prototype.initialize=function(t){this.specification=t,this.nextStates=[]},t.prototype.add=function(e){var n=this._find(e);return a(n)?n:((n=dt(t)).initialize(e),this.nextStates.push(n),e.repeat&&n.nextStates.push(n),n)},t.prototype.match=function(t){var e,n,i=[];return this._someChildren(function(r){e=r.specification,_(n=e.validCharacters)&&n.indexOf(t)>-1?i.push(r):_(n=e.invalidCharacters)&&-1===n.indexOf(t)&&i.push(r)}),i},t.prototype._find=function(t){var e,n,i=t.validCharacters,r=t.invalidCharacters;return this._someChildren(function(t){if((e=t.specification).validCharacters===i&&e.invalidCharacters===r)return n=t,!0}),n},t.prototype._someChildren=function(t){for(var e=this.nextStates,n=e.length,i=0;i<n;++i)if(!0===t(e[i]))return!0;return!1},t}();t.State=k,t.IStateStatic=r,Pt.injectable("$StateStatic",r,null,Wn),Pt.injectable("$StateInstance",k,null,Xn);var R=function(){function t(){this._namedRoutes={}}return t.prototype.register=function(t,e){if(x(t)){for(var n,i=this._rootState,r=t.length,o=["^"],s={statics:0,dynamics:0,splats:0},l=[],u=[],c=0;c<r;++c)n=this._parse(t[c],l,s),u=u.concat(n),i=this._compile(n,i,o);(i=this._finalize(i,o)).delegates=l,i.regex=new RegExp(o.join("")+"$"),i.types=s,a(e)&&_(e.name)&&(this._namedRoutes[this._toLowerCase(e.name)]={segments:u,delegates:l})}},t.prototype.recognize=function(t){var e=!1,n=[];return t=this._addLeadingSlash(t),(e=this._hasTrailingSlash(t))&&(t=t.substr(0,t.length-1)),n=this._filter(this._findStates(t)),this._link(n[0],t,e)},t.prototype.generate=function(t,e){t=this._toLowerCase(t);var n,i,r=this._namedRoutes[t],o="";if(a(r)){i=(n=r.segments).length;for(var s=0;s<i;s++){var l=n[s];l.type!==zn&&(o+="/",o+=l.generate(e))}return o=this._addLeadingSlash(o)}},t.prototype.delegatesFor=function(t){t=this._toLowerCase(t);var e,n=this._namedRoutes[t];return a(n)?(e=n.delegates,x(e)?e.slice(0):[]):[]},t.prototype.exists=function(t){return a(this._namedRoutes[this._toLowerCase(t)])},t.prototype._toLowerCase=function(t){return _(t)?t.toLowerCase():t},t.prototype._finalize=function(t,e){return t===this._rootState&&(t=t.add({validCharacters:"/"}),e.push("/")),t},t.prototype._parse=function(t,e,n){var i=[];return e.push({delegate:t.delegate,names:i}),this._BaseSegmentFactory.parse(t.pattern,i,n)},t.prototype._compile=function(t,e,n){for(var i,r=t.length,o=this._State.compile,s=0;s<r;++s)(i=t[s]).type!==zn&&(e=o(i,e=e.add({validCharacters:"/"})),n.push("/"+i.regex));return e},t.prototype._addLeadingSlash=function(t){return"/"!==(t=decodeURI(t))[0]&&(t="/"+t),t},t.prototype._hasTrailingSlash=function(t){var e=t.length;return e>1&&"/"===t[e-1]},t.prototype._findStates=function(t){for(var e=[this._rootState],n=this._State.recognize,i=t.length,r=0;r<i&&0!==(e=n(t[r],e)).length;++r);return e},t.prototype._filter=function(t){for(var e,n=t.length,i=[],r=0;r<n;++r)x((e=t[r]).delegates)&&i.push(e);return this._State.sort(i)},t.prototype._link=function(t,e,n){if(a(t)&&x(t.delegates))return n&&this._isDynamic(t)&&(e+="/"),this._State.link(t,e)},t.prototype._isDynamic=function(t){return"(.+)$"===t.regex.source.slice(-5)},t._inject={_BaseSegmentFactory:"$BaseSegmentFactory",_State:"$StateStatic",_rootState:"$StateInstance"},t}();t.RouteRecognizer=R,Pt.injectable("$RouteRecognizerInstance",R,null,Xn);var A="/*childRoute".length,L=function(){function t(){this.navigating=!1,this.children=[],this.isRoot=!1,this._paramTransforms={},this._queryTransforms={},this._interceptors={},this._ports=[],this._resolve=this._Promise.resolve.bind(this._Promise),this._reject=this._Promise.reject.bind(this._Promise),this.uid=D(ie),this.isRoot=b(t.currentRouter()),t.currentRouter(this),this.initialize()}return t.currentRouter=function(e){return b(e)||(t.__currentRouter=e),t.__currentRouter},t.prototype.initialize=function(t){this.parent=t},t.prototype.addChild=function(t){return b(t)||this.children.indexOf(t)>-1?t:(t.initialize(this),this.children.push(t),t)},t.prototype.removeChild=function(e){var n=this.children,i=n.indexOf(e);i<0||(n.splice(i,1),t.currentRouter()===e&&t.currentRouter(this))},t.prototype.register=function(t){var n=this,i=this._ports;return b(t)||i.indexOf(t)>-1?this._resolve():(i.push(t),a(this.currentRouteInfo)?(this.navigating=!0,this._resolve(this.finishNavigating).catch(e).then(function(){var t=o(n.currentRouteInfo,!0);return n.finishNavigating=n._canNavigateTo(t).then(function(e){if(e)return n.currentRouteInfo=void 0,n._performNavigation(t)}).then(function(){n.navigating=!1,n.currentRouteInfo=t},function(){n.navigating=!1})})):this._resolve())},t.prototype.unregister=function(t){var e=this._ports,n=e.indexOf(t);n<0||(e.splice(n,1),0!==e.length||b(this.parent)||this.parent.removeChild(this))},t.prototype.configure=function(t,e){var n=this;return x(t)?S(function(t){n._configureRoute(t)},t):this._configureRoute(t),!1!==e?this._forceNavigate():this._resolve()},t.prototype.unknown=function(t){return this._unknownHandler=t,this},t.prototype.param=function(t,e,n){return this._addHandler(t,e,n,this._paramTransforms)},t.prototype.queryParam=function(t,e,n){return this._addHandler(t,e,n,this._queryTransforms)},t.prototype.intercept=function(t,e){C(e)&&(e="*");var n=e;"*"!==e&&(e=this._Injector.convertDependency(e)),e===ei&&(e=n);var i=this._interceptors[e];return x(i)||(i=this._interceptors[e]=[]),i.push(t),this},t.prototype.navigate=function(t,e,n,i){var r=this;!1===i&&(i=!a(this.currentRouteInfo)),a(e)||(e={});var s=this._resolve,l=H(e);if("/"===t&&(t=""),n=!0===n,!_(t)||this.navigating||!n&&t===this._previousUrl&&l===this._previousQuery)return this.navigating?this.finishNavigating.then(function(){return r.navigate(t,e,n)}):s();var u,c,h,p=this._recognizer,f=p.recognize(t),d=v(f);d||((u=f[0]).query=e);var m=this._isSameRoute(u);if(d||m){var g=t;if(m&&(h=p.generate(u.delegate.alias||u.delegate.view,u.parameters),g=g.replace(h,"")),"/"===g||""===g?(g="",P(function(t){return f=t._recognizer.recognize(g),!v(f)},this.children)):f=this._childRecognizer.recognize(g),v(f)){if(d){if(this._previousUrl=g,this._previousQuery=l,this.currentRouteInfo=u,y(this._unknownHandler)){var b={segment:t,view:void 0};return s(this._unknownHandler(b)).then(function(){var e=b.view;if(!C(e))return r.configure({pattern:t,view:e})})}return s()}f=p.recognize(t),(u=f[0]).query=e,c=u.delegate.pattern}else if(u=f[0],u.query=e,c=u.delegate.pattern,c=c.slice(0,c.length-A),!d||this._isSameRoute(u))return this.navigating=!0,this.finishNavigating=this._navigateChildren(u).then(function(){r._previousUrl=t,r._previousQuery=l,r.navigating=!1},function(t){throw r.navigating=!1,t})}else c=u.delegate.pattern;h=p.generate(u.delegate.alias||u.delegate.view,u.parameters);var x=this._previousSegment;this._previousSegment=h,this.navigating=!0;var E=this._nextRouteInfo=o(u,!0);return this.finishNavigating=this._canNavigate(u,i).then(function(e){if(!e)throw r.navigating=!1,new Error("Not cleared to navigate");return r._previousUrl=t,r._previousQuery=l,r._performNavigation(u)}).then(function(){r._previousPattern=c,r._previousSegment=h,r.currentRouteInfo=E,r.navigating=!1},function(t){throw r._previousSegment=x,r.navigating=!1,t})},t.prototype.generate=function(t,e,n){var i=t;(t=this._Injector.convertDependency(t))===ei&&(t=i);for(var r=this,o="";!b(r)&&!r._recognizer.exists(t);)r=r.parent;if(b(r))throw new Error("Route for "+t+" does not exist.");for(var s,a=r._recognizer.generate(t,e);!b(r=r.parent);)o=(s=b(s=r._previousSegment)||"/"===s?"":s)+o;return o+a+H(n)},t.prototype._configureRoute=function(t){var e=this._Injector.convertDependency(t.view),n=t.alias||e;if(e!==ei){t.view=e,t.alias=n||e;var i={pattern:t.pattern,delegate:t},r=t.pattern+"/*childRoute",o={pattern:r,delegate:{pattern:r,view:e,alias:n}};this._recognizer.register([i],{name:n}),this._childRecognizer.register([o])}},t.prototype._addHandler=function(t,e,n,i){C(n)&&(n="*");var r=n;if("*"!==n&&(n=this._Injector.convertDependency(n)),n===ei&&(n=r),v(n)||v(e))return this;var o=i[n];a(o)||(o=i[n]={});var s=o[e];return x(s)||(s=o[e]=[]),s.push(t),this},t.prototype._forceNavigate=function(){var t,e=this;this._resolve;if(this.navigating)return this.finishNavigating.then(function(){return e._forceNavigate()});if(this.isRoot&&v(this._previousUrl)){var n=this._browser.urlUtils();this._previousUrl=n.pathname,t=n.query}return v(this._previousQuery)||(t=q(this._previousQuery)),this.navigate(this._previousUrl,t,!0)},t.prototype._navigateChildren=function(t,n){void 0===n&&(n=!0);var i=this._getChildRoute(t);return b(i)?this._resolve():I(function(e){return e.navigate(i,t.query,void 0,n)},this.children).then(e)},t.prototype._getChildRoute=function(t){if(!b(t)){var e=t.parameters.childRoute;return _(e)||(e=""),"/"+e}},t.prototype._performNavigation=function(t){var e=this,n=this._isSameRoute(this._nextRouteInfo);return this._performNavigateFrom(n).then(function(){if(!n)return I(function(e){return e.navigateTo(t)},e._ports)}).then(function(){return e._navigateChildren(t,!1)})},t.prototype._performNavigateFrom=function(t){var n=this;return I(function(t){return t._performNavigateFrom()},this.children).then(function(){if(!t)return I(function(t){return t.navigateFrom()},n._ports)}).then(e)},t.prototype._canNavigate=function(t,e){var n=this;void 0===e&&(e=!0);var i=this._isSameRoute(this._nextRouteInfo);return e?this._canNavigateFrom(i).then(function(e){return e&&n._canNavigateTo(t,i)}):this._callAllHandlers(t.delegate.alias,t.parameters,t.query).then(function(){return n._callInterceptors(t)}).then(function(){return!0},function(){return!0})},t.prototype._canNavigateFrom=function(t){var e=this;return this._Promise.all(this.children.reduce(function(t,e){return t.concat(e._canNavigateFrom())},[])).then(Q).then(function(n){return!n||t?[n]:I(function(t){return t.canNavigateFrom()},e._ports)}).then(Q)},t.prototype._canNavigateTo=function(t,e){var n=this;return v(this._ports)?this._resolve(!0):this._callAllHandlers(t.delegate.alias,t.parameters,t.query).then(function(){return n._callInterceptors(t)}).then(function(i){return!1===i||e?[i]:I(function(e){return e.canNavigateTo(t)},n._ports)}).then(Q)},t.prototype._callAllHandlers=function(t,n,i){var r=this;return this._callHandlers(this._queryTransforms["*"],i,void 0,!0).then(function(){return r._callHandlers(r._queryTransforms[t],i,void 0,!0)}).then(function(){return r._callHandlers(r._paramTransforms["*"],n,i)}).then(function(){return r._callHandlers(r._paramTransforms[t],n,i)}).then(e)},t.prototype._callHandlers=function(t,n,i,r){var o=this._resolve;return a(n)||(n={}),I(function(t,e){return j(function(t){return!0!==r&&C(n[e])?o():o(t(n[e],n,i))},t)},t).then(e)},t.prototype._callInterceptors=function(t){var e=this,n=this._resolve;return j(function(e){return n(e(t))},this._interceptors["*"]).then(Q).then(function(i){return i?I(function(e){return n(e(t))},e._interceptors[t.delegate.alias]):[i]}).then(Q)},t.prototype._isSameRoute=function(t){var e=o(this.currentRouteInfo,!0);if(t=o(t,!0),this._sanitizeRouteInfo(e),this._sanitizeRouteInfo(t),!a(e)||!a(t))return!1;var n=e.delegate,i=t.delegate,r=H(e.parameters),s=H(t.parameters),l=H(e.query),u=H(t.query);return n.view===i.view&&n.alias===i.alias&&n.pattern===i.pattern&&r===s&&(l===u||this.children.length>0)},t.prototype._sanitizeRouteInfo=function(t){if(a(t)&&t.parameters.hasOwnProperty("childRoute")){var e=t.delegate,n=e.pattern;e.pattern=n.slice(0,n.length-A),U(t.parameters,"childRoute")}},t.prototype._clearInfo=function(){this._previousSegment=void 0,this._previousPattern=void 0,this._previousUrl=void 0,this._previousQuery=void 0,this.currentRouteInfo=void 0,this.navigating=!1,S(function(t){t._clearInfo()},this.children)},t._inject={_Promise:Ft,_Injector:ne,_EventManager:"$EventManagerStatic",_browser:"$Browser",_browserConfig:"$BrowserConfig",_recognizer:"$RouteRecognizerInstance",_childRecognizer:"$RouteRecognizerInstance"},t}();t.Router=L,Pt.injectable("$Router",L,null,Xn),t.IRouterStatic=s,Pt.injectable(te,s)}(t.routing||(t.routing={}));!function(t){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){var t=z(this.type),e=this.attributes[t];v(e)||this._isPrecompiled()||(this._label=e,this._define(e))},e.prototype.dispose=function(){for(var t=this._label,e=this.parent;!C(t)&&a(e);)a(e[t])&&c(e[t].element)&&e[t].element===this.element&&U(e,t),e=e.parent},e.prototype._define=function(t){var e=this.templateControl;b(e)||(e.name=t);for(var n=this.parent,i={element:this.element,control:e};a(n);)a(n[t])||(n[t]=i),n=n.parent},e.prototype._isPrecompiled=function(){for(var t=this.parent;!b(t);){if(-1!==t.type.indexOf("-compiled"))return!0;t=t.parent}return!1},e}(Xi);t.Name=n,Pt.control(he,n);var i=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._aliases=[],e}return __extends(n,t),n.prototype.loaded=function(){b(this.element)||(this.attribute=z(this.type),this._setListener())},n.prototype._setListener=function(){var t=this.attributes[this.attribute];v(this.event)||v(t)||(this._parseArgs(t),this._addEventListeners())},n.prototype._addEventListeners=function(){this.addEventListener(this.element,this.event,this._onEvent,!1)},n.prototype._buildExpression=function(){var t,n,i,r=this.parent,o=this.templateControl,s=this._listener,l=e;if(b(o)?b(r)||(n=r.getResources(this._aliases),i=r.context):(n=o.getResources(this._aliases),b(r)||(i=r.context)),"@"===s[0]){if(!b(n)){var u=s.split("."),c=n[u[0].slice(1)];if(a(c)){u.shift();for(var h=void 0;u.length>1&&(h=u.shift(),!b(c[h]));)c=c[h];1===u.length?y(c[h=u.shift()])&&(t=c,l=c[h]):this._log.warn('Invalid path for function "'+s+'"')}else y(c)&&(l=c)}}else{var p=this.findProperty(s,this.templateControl);if(b(p))return this._log.warn("Could not find property "+s+" on any associated control."),{fn:e,context:{},args:[]};var _=p.expresssion.identifiers;if(_.length>1)return this._log.warn("Cannot have more than one identifier in a "+this.type+"'s expression."),{fn:e,context:{},args:[]};var f=_[0].split("."),d=p.control;if(f.pop(),f.length>0)for(var v=void 0;f.length>0&&(v=f.shift(),!b(d[v]));)d=d[v];l=p.value,t=d}return{fn:l,context:t,args:b(this._args)?[]:this._args.evaluate(i,n)}},n.prototype._onEvent=function(t){var e=this._buildExpression(),n=e.fn;y(n)?n.apply(e.context,e.args.concat(t)):this._log.warn("Cannot find registered event method "+this._listener+" for control: "+this.type)},n.prototype._parseArgs=function(t){if(!v(t)){var e,n=this._regex.argumentRegex.exec(t),i=[];if(b(n))e=t;else if(e=t.slice(0,n.index),""!==n[1]){var r=this._parser.parse("["+n[1]+"]");i=r.aliases,this._args=r}if("@"===e[0]){var o=e.slice(1).split(".")[0];-1===i.indexOf(o)&&i.push(o)}this._listener=e,this._aliases=i}},n._inject={_parser:"$Parser",_regex:Ut},n}(Xi);t.SimpleEventControl=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=bn,e}return __extends(e,t),e}(i);t.Tap=r;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="blur",e}return __extends(e,t),e}(i);t.Blur=o;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="change",e}return __extends(e,t),e}(i);t.Change=s;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="copy",e}return __extends(e,t),e}(i);t.Copy=u;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="cut",e}return __extends(e,t),e}(i);t.Cut=h;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="paste",e}return __extends(e,t),e}(i);t.Paste=f;var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Cn,e}return __extends(e,t),e}(i);t.DblTap=E;var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="focus",e}return __extends(e,t),e}(i);t.Focus=T;var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=xn,e}return __extends(e,t),e}(i);t.TouchStart=N;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=En,e}return __extends(e,t),e}(i);t.TouchEnd=S;var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=wn,e}return __extends(e,t),e}(i);t.TouchMove=k;var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Tn,e}return __extends(e,t),e}(i);t.TouchCancel=I;var R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Nn,e}return __extends(e,t),e}(i);t.Hold=R;var j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Sn,e}return __extends(e,t),e}(i);t.Release=j;var A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=kn,e}return __extends(e,t),e}(i);t.Swipe=A;var L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=In,e}return __extends(e,t),e}(i);t.SwipeLeft=L;var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Rn,e}return __extends(e,t),e}(i);t.SwipeRight=P;var $=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=jn,e}return __extends(e,t),e}(i);t.SwipeUp=$;var F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=An,e}return __extends(e,t),e}(i);t.SwipeDown=F;var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Ln,e}return __extends(e,t),e}(i);t.Track=D;var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Pn,e}return __extends(e,t),e}(i);t.TrackLeft=B;var V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=On,e}return __extends(e,t),e}(i);t.TrackRight=V;var q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=$n,e}return __extends(e,t),e}(i);t.TrackUp=q;var H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Fn,e}return __extends(e,t),e}(i);t.TrackDown=H;var Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Mn,e}return __extends(e,t),e}(i);t.TrackEnd=Q;var W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="submit",e}return __extends(e,t),e.prototype._onEvent=function(e){this.element.hasAttribute("action")||e.preventDefault(),t.prototype._onEvent.call(this,e)},e}(i);t.Submit=W;var Y=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="input",t}return __extends(n,e),n.prototype._addEventListeners=function(){var e,n=this,i=this.element,r=this._compat,o=!1,s=!1,a=function(t){o||n._onEvent(t)},l=function(t){y(e)||(e=O(function(){a(t),e=null}))};C(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(t){o=!1,a(t)},!1)),this.addEventListener(i,"input",function(t){s=!0,a(t)},!1),this.addEventListener(i,"change",function(t){s?s=!1:a(t)},!1),r.hasEvent("input")||(this.addEventListener(i,"keydown",function(e){var n=e.keyCode,i=t.KeyCodes;n===i.lwk||n===i.rwk||n>=i.shift&&n<=i.escape||n>i.space&&n<=i.down||l(e)},!1),this.addEventListener(i,"cut",l,!1),this.addEventListener(i,"paste",l,!1))},n._inject={_compat:Mt},n}(i);t.React=Y,Pt.control(ye,r),Pt.control(be,o),Pt.control(Ce,s),Pt.control(xe,u),Pt.control(Ee,h),Pt.control(we,f),Pt.control(Te,E),Pt.control(Ne,T),Pt.control(Se,W),Pt.control(ke,N),Pt.control(Ie,S),Pt.control(Re,k),Pt.control(je,I),Pt.control(Ae,R),Pt.control(Le,j),Pt.control(Pe,A),Pt.control(Oe,L),Pt.control($e,P),Pt.control(Fe,$),Pt.control(Me,F),Pt.control(De,D),Pt.control(ze,B),Pt.control(Be,V),Pt.control(Ue,q),Pt.control(Ve,H),Pt.control(qe,Q),Pt.control(He,Y),t.KeyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,"caps lock":20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,"left arrow":37,up:38,"up arrow":38,right:39,"right arrow":39,down:40,"down arrow":40,insert:45,delete:46,0:48,zero:48,")":48,"right parenthesis":48,1:49,one:49,"!":49,exclamation:49,"exclamation point":49,2:50,two:50,"@":50,at:50,3:51,three:51,"#":51,"number sign":51,hash:51,pound:51,4:52,four:52,$:52,dollar:52,"dollar sign":52,5:53,five:53,"%":53,percent:53,"percent sign":53,6:54,six:54,"^":54,caret:54,7:55,seven:55,"&":55,ampersand:55,8:56,eight:56,"*":56,asterisk:56,9:57,nine:57,"(":57,"left parenthesis":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lwk:91,"left window key":91,rwk:92,"right window key":92,select:93,"select key":93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"num lock":144,"scroll lock":145,";":186,"semi-colon":186,":":186,colon:186,"=":187,equal:187,"equal sign":187,"+":187,plus:187,",":188,comma:188,"<":188,lt:188,"less than":188,"left angle bracket":188,"-":189,dash:189,_:189,underscore:189,".":190,period:190,">":190,gt:190,"greater than":190,"right angle bracket":190,"/":191,"forward slash":191,"?":191,"question mark":191,"`":192,"grave accent":192,"~":192,tilde:192,"[":219,"open bracket":219,"{":219,"open brace":219,"\\":220,"back slash":220,"|":220,pipe:220,"]":221,"close bracket":221,"}":221,"close brace":221,"'":222,"single quote":222,'"':222,"double quote":222};var X=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyCodes={},t}return __extends(n,e),n.prototype._setListener=function(){var t=this.attribute;if(!v(this.event)&&!v(t)){var n=this.attributes[t].trim();if("{"===n[0]){var i=this.evaluateExpression(n)||{method:""},r=this._filterArgs(i);return this._setKeyCodes(r),void this.addEventListener(this.element,this.event,this._onEvent,!1)}e.prototype._setListener.call(this)}},n.prototype._filterArgs=function(t){var e=t.key,n=t.keys;return this._parseArgs(t.method),x(n)?n:_(n)?[n]:x(e)?e:_(e)?[e]:void(b(t.char)&&b(t.chars)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},n.prototype._onEvent=function(t){this._compareKeys(t)&&e.prototype._onEvent.call(this,t)},n.prototype._compareKeys=function(t){var e=this.keyCodes,n=t.keyCode||t.which;return v(e)||!0===e[n]},n.prototype._setKeyCodes=function(e){x(e)||(e=[]);for(var n,i=e.length,r=this.keyCodes,o=0;o<i;++o)r[g(n=e[o])?n:t.KeyCodes[n.toLowerCase()]]=!0},n}(i);t.KeyCodeEventControl=X;var G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keydown",e}return __extends(e,t),e}(X);t.KeyDown=G;var J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keydown",e}return __extends(e,t),e.prototype._onEvent=function(e){var n=this,i=e.keyCode||e.which;if(t.prototype._compareKeys.call(this,e)&&(i>=48&&i<=90||i>=186||i>=96&&i<=111))var r=this.addEventListener(this.element,"keypress",function(e){r(),t.prototype._onEvent.call(n,e)},!1)},e.prototype._compareKeys=function(t){return!0},e}(X);t.KeyPress=J;var K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keyup",e}return __extends(e,t),e}(X);t.KeyUp=K;var Z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keypress",e}return __extends(e,t),e.prototype._filterArgs=function(t){var e=t.char,n=t.chars;return this._parseArgs(t.method),x(n)?n:_(n)?[n]:x(e)?e:_(e)?[e]:void(b(t.key)&&b(t.keys)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},e.prototype._onEvent=function(e){var n,i=this.keyCodes,r=e.charCode||e.which;if(r)n=String.fromCharCode(r);else if(!(n=e.key))return;(v(i)||!0===i[n])&&t.prototype._onEvent.call(this,e)},e.prototype._compareKeys=function(t){return!0},e.prototype._setKeyCodes=function(t){x(t)||(t=[]);for(var e,n=t.length,i=this.keyCodes,r=0;r<n;++r)i[g(e=t[r])?String.fromCharCode(e):e]=!0},e}(X);t.CharPress=Z,Pt.control(ae,G),Pt.control(le,J),Pt.control(ue,K),Pt.control(ce,Z);var tt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.property="",n._stopSetter=e,n}return __extends(n,t),n.prototype.loaded=function(){b(this.element)||(this.attribute=z(this.type),this.setter(),this.__removeListener=this.attributes.observe(this.setter,this.attribute))},n.prototype.contextChanged=function(){b(this.element)||this.setter()},n.prototype.dispose=function(){this._stopSetter(),y(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null)},n.prototype.setter=function(){var t=this;this._stopSetter(),this._stopSetter=M(function(){var e=t.element,n=t.property;if(c(e))switch(t.attributes[t.attribute]){case"false":case"0":case"null":case"":e.setAttribute(n,""),e[n]=!1,e.removeAttribute(n);break;default:e.setAttribute(n,n),e[n]=!0}})},n}(Xi);t.SetAttributeControl=tt;var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="checked",e}return __extends(e,t),e}(tt);t.Checked=et;var nt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="disabled",e}return __extends(e,t),e}(tt);t.Disabled=nt;var it=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="selected",e}return __extends(e,t),e}(tt);t.Selected=it;var rt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="readonly",e}return __extends(e,t),e}(tt);t.ReadOnly=rt;var ot=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="display",e.value="none",e.importance="important",e._initialValue="",e}return __extends(n,t),n.prototype.initialize=function(){var t=(this.element.style||{getPropertyValue:e}).getPropertyValue(this.property);this._setValue(this.value,this.importance),v(t)||"none"===t||(this._initialValue=t)},n.prototype.setter=function(){var t=this;this._stopSetter(),this._stopSetter=M(function(){if(c(t.element))switch(t.attributes[t.attribute]){case"false":case"0":case"null":case"":t._setValue(t.value,t.importance);break;default:t._setValue(t._initialValue)}})},n.prototype._setValue=function(t,n){var i=this.property,r=this.element.style||{setProperty:e,removeProperty:e,getPropertyValue:e,getPropertyPriority:e},o=r.getPropertyValue(i),s=r.getPropertyPriority(i);t===o&&n===s||(v(t)?r.removeProperty(i):r.setProperty(i,t,n))},n}(tt);t.Visible=ot;var st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="style",e._styleRegex=/(.*?):(.*)/,e._urlRegex=/url\([^\)]*\)/gi,e._urlReplace="[PLAT-STYLE-URL]",e.__addedStyles=[],e.__oldStyles={},e}return __extends(e,t),e.prototype.setter=function(){var t=this;this._stopSetter();var e=this.element,n=this.attributes[this.attribute];v(n)||b(e)||(this._stopSetter=M(function(){var i=[],r=t._urlReplace;n=n.replace(t._urlRegex,function(t){return i.push(t),r});var o,s,a,l,u=e.style,c=t.__addedStyles,h=t.__oldStyles,p=[],_=n.split(";"),f=_.length,d=t._styleRegex,v={};for(l=0;l<f;++l)b(a=d.exec(_[l]))||a.length<3||0===(o=a[1].trim()).length||C(u[o])||(-1===c.indexOf(o)&&(h[o]=u[o]),p.push(o),s=a[2].trim(),i.length>0&&-1!==s.indexOf(r)&&(s=s.replace(r,i.shift())),v[o]=s);for(f=c.length;f-- >0;)o=c[f],-1===p.indexOf(o)&&(v[o]=h[o],c.splice(f,1));var m=Object.keys(v);for(f=m.length;f-- >0;)u[o=m[f]]=v[o];t.__addedStyles=c.concat(p)}))},e}(tt);t.Style=st,Pt.control(_e,et),Pt.control(fe,nt),Pt.control(de,it),Pt.control(ve,rt),Pt.control(me,ot),Pt.control(ge,st);var at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setter=function(){var t=this.element,e=this.property,n=this.attributes[this.attribute];v(n)||b(t)||C(t[e])||(t[e]=n)},e}(tt);t.ElementPropertyControl=at;var lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="href",e}return __extends(e,t),e}(at);t.Href=lt;var ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="src",e}return __extends(e,t),e.prototype.setter=function(){var t=this.element,e=this.property,n=this.attributes[this.attribute];v(n)||b(t)||C(t[e])||(t[e]=this._browser.urlUtils(n))},e._inject={_browser:"$Browser"},e}(at);t.Src=ut,Pt.control(oe,lt),Pt.control(se,ut);var ct=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.priority=100,t._supportsTwoWayBinding=!1,t._dateRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/,t._dateTimeLocalRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])T(0[1-9]|1[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9])(?:\.([0-9]+))?)?/,t.__fileSupported=dt(Mt).fileSupported,t.__fileNameRegex=dt(Ut).fileNameRegex,t.__isSelf=!1,t}return __extends(i,n),i.prototype.initialize=function(){this._determineType()},i.prototype.loaded=function(){var t=this.parent;if(!b(t)&&!b(this.element)){var e=z(this.type),n=this._parser,i=this._expression=n.parse(this.attributes[e]),r=i.identifiers;if(1!==r.length)return this._log.warn("Only 1 identifier allowed in a "+this.type+" expression."),void(this._contextExpression=null);var o=r[0].split(".");if(this._property=o.pop(),i.aliases.length>0){var s=i.aliases[0],l=t.findResource(s),u=void 0;if(a(l)){if((u=l.resource.type)!==ni&&u!==si)return}else l={resource:{}};s===ci||s===li?this._contextExpression=n.parse(o.join(".")):(this._property="value",this._contextExpression={evaluate:function(){return l.resource},aliases:[],identifiers:[],expression:""})}else o.length>0?this._contextExpression=n.parse(o.join(".")):this._contextExpression={evaluate:function(){return t.context},aliases:[],identifiers:[],expression:""};this._supportsTwoWayBinding&&this.templateControl.observeProperties(this),this._watchExpression(),b(this._addEventType)||this._addEventType()}},i.prototype.contextChanged=function(){this._watchExpression()},i.prototype.dispose=function(){this._addEventType=null},i.prototype.evaluate=function(){var t=this._expression;if(!C(t))return this.evaluateExpression(t)},i.prototype.observeProperty=function(t,e,n){return this._observeProperty(t,e,n)},i.prototype.observeArrayChange=function(t,e){return this._observeProperty(t,e,!1,!0)},i.prototype._addTextEventListener=function(){var e,n=this,i=this.element,r=this._compat,o=!1,s=function(){o||n._propertyChanged()},a=function(){y(e)||(e=O(function(){s(),e=null}))};C(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(){o=!1,s()},!1)),r.hasEvent("input")?this.addEventListener(i,"input",s,!1):(this.addEventListener(i,"keydown",function(e){var n=e.keyCode||e.which,i=t.KeyCodes;n===i.lwk||n===i.rwk||n>=i.shift&&n<=i.escape||n>i.space&&n<=i.down||a()},!1),this.addEventListener(i,"cut",a,!1),this.addEventListener(i,"paste",a,!1)),this.addEventListener(i,"change",s,!1)},i.prototype._addChangeEventListener=function(){this.addEventListener(this.element,"change",this._propertyChanged,!1)},i.prototype._addButtonEventListener=function(){this.addEventListener(this.element,bn,this._propertyChanged,!1)},i.prototype._addRangeEventListener=function(){var t=this.element;this._compat.hasEvent("input")&&this.addEventListener(t,"input",this._propertyChanged,!1),this.addEventListener(t,"change",this._propertyChanged,!1)},i.prototype._getChecked=function(){return this.element.checked},i.prototype._getValue=function(){return this.element.value},i.prototype._getTextContent=function(){return this.element.textContent},i.prototype._getDate=function(){var t=this.element.value,e=this._dateRegex;if("string"!==this._propertyType&&e.test(t)){var n=e.exec(t);if(4===n.length)return new Date(Number(n[1]),Number(n[2])-1,Number(n[3]))}return t},i.prototype._getDateTimeLocal=function(){var t=this.element.value,e=this._dateTimeLocalRegex;if("string"!==this._propertyType&&e.test(t)){var n=e.exec(t);if(8===n.length)return b(n[6])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5])):b(n[7])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6])):new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6]),Number(n[7]))}return t},i.prototype._getFile=function(){var t=this.element,n=t.value;return this.__fileSupported?t.files.length>0?t.files[0]:null:{name:n.replace(this.__fileNameRegex,""),path:n,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:e,msClose:e,slice:function(){return{}}}},i.prototype._getFiles=function(){var t=this.element;if(this.__fileSupported)return Array.prototype.slice.call(t.files);for(var n,i=t.value.split(/,|;/g),r=i.length,o=[],s=0;s<r;++s)n=i[s],o.push({name:n.replace(this.__fileNameRegex,""),path:n,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:e,msClose:e,slice:function(){return{}}});return o},i.prototype._getSelectedValues=function(){for(var t,e=this.element.options,n=e.length,i=[],r=0;r<n;++r)(t=e[r]).selected&&i.push(t.value);return i},i.prototype._setText=function(t,e,n){if(!this.__isSelf)return b(t)&&(t="",!0===n)?(b(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},i.prototype._setRange=function(t,e,n){if(!this.__isSelf)return v(t)&&(t=""===t?"0":0,!0===n)?(v(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},i.prototype._setHidden=function(t,e,n){if(!this.__isSelf)return v(t)&&(t="",!0===n)?(v(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},i.prototype._setValue=function(t){var e=this.element;_(t)||(g(t)?(this._propertyType="number",t=t.toString()):m(t)&&(this._propertyType="boolean",t=t.toString())),e.value!==t&&(e.value=t)},i.prototype._setChecked=function(t,e,n){if(!this.__isSelf)return m(t)||(t=!!t,!0!==n)?void(this.element.checked=t):(this.element.checked=t,void this._propertyChanged())},i.prototype._setRadio=function(t){var e=this.element;this.__isSelf||(b(t)?e.checked&&this._propertyChanged():(_(t)||(g(t)?(this._propertyType="number",t=t.toString()):m(t)&&(this._propertyType="boolean",t=t.toString())),e.checked=e.value===t))},i.prototype._setDate=function(t,e,n){if(!this.__isSelf){if(!w(t))return this._dateRegex.test(t)?(this._propertyType="string",void this._setValue(t)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2);this._setValue(t.getFullYear()+"-"+r+"-"+i)}},i.prototype._setDateTimeLocal=function(t,e,n){if(!this.__isSelf){if(!w(t))return this._dateTimeLocalRegex.test(t)?(this._propertyType="string",void this._setValue(t)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2),o=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),a=("0"+t.getSeconds()).slice(-2),l=t.getMilliseconds();this._setValue(t.getFullYear()+"-"+r+"-"+i+"T"+o+":"+s+":"+a+"."+l)}},i.prototype._setSelectedIndex=function(t,e,n){if(!this.__isSelf){var i=this.element,r=i.value;if(b(t))return!0!==n&&this._document.body.contains(i)?void(i.selectedIndex=-1):void this._propertyChanged();if(_(t)||(g(t)?(this._propertyType="number",t=t.toString()):m(t)?(this._propertyType="boolean",t=t.toString()):this._log.info("Trying to bind an invalid value to a <select> element using a "+this.type+".")),r!==t){if(!this._document.body.contains(i))return i.value=t,void(i.value!==t&&(i.value=r,this._propertyChanged()));i.value=t,i.value===t&&-1!==i.selectedIndex||(i.selectedIndex=-1)}}},i.prototype._setSelectedIndices=function(t,e,n){if(!this.__isSelf){var i,r=this.element.options,o=b(r)?0:r.length,s=b(t);if(!s&&x(t))for(var a,l,u,c=1/0;o-- >0;)a=(i=r[o]).value,-1===t.indexOf(a)?g(l=Number(a))&&-1!==(u=t.indexOf(l))?(u<c&&(this._propertyType="number",c=u),i.selected=!0):"true"===a&&-1!==(u=t.indexOf(!0))||"false"===a&&-1!==(u=t.indexOf(!1))?(u<c&&(this._propertyType="boolean",c=u),i.selected=!0):i.selected=!1:i.selected=!0;else for(!0===n&&this._propertyChanged();o-- >0;){if(i=r[o],!s&&i.value===""+t)return void(i.selected=!0);i.selected=!1}}},i.prototype._determineType=function(){if(!this._observingBindableProperty()){var t=this.element;if(!b(t))switch(t.nodeName.toLowerCase()){case"input":switch(t.type){case"button":case"submit":case"reset":case"image":this._addEventType=this._addButtonEventListener,this._getter=this._getValue;break;case"checkbox":this._addEventType=this._addChangeEventListener,this._getter=this._getChecked,this._setter=this._setChecked;break;case"radio":this._initializeRadio();break;case"range":this._addEventType=this._addRangeEventListener,this._getter=this._getValue,this._setter=this._setRange;break;case"date":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDate,this._setter=this._setDate;break;case"datetime-local":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDateTimeLocal,this._setter=this._setDateTimeLocal;break;case"file":this._propertyType="nullable";var e=t.multiple;this._addEventType=this._addChangeEventListener,this._getter=e?this._getFiles:this._getFile;break;case"hidden":this._getter=this._getValue,this._setter=this._setHidden;break;case"number":this._propertyType="number";default:this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText}break;case"textarea":this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText;break;case"select":this._initializeSelect();break;case"button":this._addEventType=this._addButtonEventListener,this._getter=this._getTextContent}}},i.prototype._watchExpression=function(){var t=this,e=this._contextExpression,n=this.evaluateExpression(e);if(!a(n)){if(!(b(n)&&e.identifiers.length>0))return void this._log.warn(this.type+" is trying to index into a primitive type. "+this._contextExpression.expression+" is already defined and not an object when trying to evaluate "+this.type+'="'+this._expression.expression+'"');n=this._createContext(e.identifiers[0])}var i;if(y(this._setter)){this._setter===this._setSelectedIndices&&(b(n[i=this._property])&&(n[i]=[]),this.observeArray(function(e){t._setter(e[0].object,null,!0)},e+"."+i));var r=this._expression;this.observeExpression(function(e,n){t._setter(e,n)},r),this._setter(this.evaluateExpression(r),void 0,!0)}},i.prototype._createContext=function(t){var e=t.split("."),n=e.shift().slice(1),i=this.parent;return n===li?(t=e.join("."),i=this.parent.root):"context"===n&&(t=e.join(".")),this._ContextManager.createContext(i,t)},i.prototype._castProperty=function(t,e){var n;if(e=e||this._propertyType,b(e))return t;if(a(t))if(x(t)){var i=t.length;n=[];for(var r=0;r<i;++r)n.push(this._castProperty(t[r],e))}else if(w(t)||p(t)||d(t)||l(t)||c(t))n=t;else{var o=Object.keys(t),s=void 0;for(n={};o.length>0;)n[s=o.pop()]=t[s]}else switch(e){case"string":n=_(t)?t:y(t.toString)?t.toString():Object.prototype.toString.call(t);break;case"number":n=v(t)?null:Number(t);break;case"boolean":switch(t){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!t}break;case"nullable":v(t)&&(n=null);break;default:n=t}return n},i.prototype._propertyChanged=function(){if(!b(this._contextExpression)){var t=this.evaluateExpression(this._contextExpression);if(a(t)){var e=this._property,n=this._castProperty(this._getter());t[e]!==n&&(this.__isSelf=!0,t[e]=n,this.__isSelf=!1)}}},i.prototype._initializeRadio=function(){var t=this.element;if(this._addEventType=this._addChangeEventListener,this._getter=this._getValue,this._setter=this._setRadio,!t.hasAttribute("name")){var e=z(this.type),n=this.attributes[e];t.setAttribute("name",n)}t.hasAttribute("value")||t.setAttribute("value","")},i.prototype._initializeSelect=function(){var t,e=this.element,n=e.multiple,i=e.options,r=i.length;this._addEventType=this._addChangeEventListener,n?(this._getter=this._getSelectedValues,this._setter=this._setSelectedIndices):(this._getter=this._getValue,this._setter=this._setSelectedIndex);for(var o=0;o<r;++o)(t=i[o]).hasAttribute("value")||t.setAttribute("value",t.textContent)},i.prototype._observingBindableProperty=function(){var t=this,e=this.templateControl;return!!(a(e)&&y(e.onInput)&&y(e.observeProperties))&&(e.onInput(function(e){t._getter=function(){return e},t._propertyChanged()}),this._supportsTwoWayBinding=!0)},i.prototype._observeProperty=function(t,e,n,i){var r,o=this;if(v(e))r=this._expression.expression;else if(g(e))r=this._expression.expression+"."+e;else{var s=this._parser,l=s.parse(e).identifiers;if(1!==l.length)return void this._log.warn("Only 1 identifier path allowed when observing changes to a bound property's child with a control implementing observable.ISupportTwoWayBinding and working with "+this.type);var u=(r=s.parse(this._expression.expression+"."+l[0]).identifiers[0]).split(".");u.pop();var c=u.join("."),h=this.evaluateExpression(c);if(!a(h)){if(!b(h))return void this._log.warn("A control implementing observable.ISupportTwoWayBinding is trying to index into a primitive type when trying to evaluate "+this.type+'="'+this._expression.expression+'"');h=this._ContextManager.createContext(this.parent,c)}}t=t.bind(this.templateControl),n=!0===n;var p;if(!0===i)p=this.observeArray(function(n){t(n,e)},r);else{p=this.observe(function(i,r){o.__isSelf||i===r||(n&&(o._propertyType=o._getPropertyType(i)),t(i,r,e))},r);var _=this.evaluateExpression(r);n&&(this._propertyType=this._getPropertyType(_)),t(_,void 0,e,!0)}return p},i.prototype._getPropertyType=function(t){return a(t)?t:_(t)?"string":g(t)?"number":m(t)?"boolean":void 0},i._inject={_parser:"$Parser",_ContextManager:qt,_compat:Mt,_document:zt},i}(Xi);t.Bind=ct,Pt.control(re,ct);var ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="",e.priority=200,e._listeners=[],e._boundAddListener=e._addListener.bind(e),e}return __extends(e,t),e.prototype.initialize=function(){this.attribute=z(this.type),this._setProperty(this._getValue())},e.prototype.loaded=function(){this._observeProperty(),this._setProperty(this._getValue())},e.prototype.dispose=function(){y(this._removeListener)&&this._removeListener(),this._listeners=[]},e.prototype._setProperty=function(t,e){var n=this.templateControl;b(n)||(this._ContextManager.defineGetter(n,this.property,{value:t,observe:this._boundAddListener},!0,!0),this._callListeners(t,e))},e.prototype._callListeners=function(t,e){for(var n=this._listeners,i=n.length,r=0;r<i;++r)n[r](t,e)},e.prototype._addListener=function(t){var e=this._listeners;return t=t.bind(this.templateControl),e.push(t),function(){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},e.prototype._getValue=function(){if(!b(this.templateControl))return this.evaluateExpression(this.attributes[this.attribute])},e.prototype._observeProperty=function(){b(this.templateControl)||(this._removeListener=this.observeExpression(this._setProperty,this.attributes[this.attribute]))},e._inject={_ContextManager:qt},e}(Xi);t.ObservableAttributeControl=ht;var pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="options",e}return __extends(e,t),e}(ht);t.Options=pt,Pt.control(pe,pt)}(t.controls||(t.controls={}));var Ji=function(){function t(){this.uid=D(ie),this._log=t._log,(this.navigator=dt(Vt)).initialize(dt(te).currentRouter())}return t.start=function(){if(!t._compat.isCompatible)return t._log.error(new Error("PlatypusTS only supports modern browsers where Object.defineProperty is defined"));t.__addPlatCss();var e=t._EventManager;e.dispose("__app__"),e.on("__app__","ready",t.__ready),e.on("__app__","shutdown",t.__shutdown),e.initialize()},t.registerApp=function(e){!b(t.app)&&_(t.app.uid)&&t._EventManager.dispose(t.app.uid),t.__injector=e},t.load=function(e){var n=t._LifecycleEvent,i=t._compiler,r=t._document.body,o=t._document.head;return n.dispatch(un,t),b(e)?(r.setAttribute(cn,""),void O(function(){i.compile([o]),i.compile([r]),r.removeAttribute(cn)})):y(e.setAttribute)?(e.setAttribute(cn,""),void O(function(){i.compile([e]),e.removeAttribute(cn)})):void O(function(){i.compile([e])})},t.__ready=function(e){Di.Injector.initialize(),t.__registerAppEvents(e),e.defaultPrevented||t.load()},t.__shutdown=function(){var e=navigator.app,n=t._LifecycleEvent;if(!b(e)&&y(e.exitApp)){if(n.dispatch("exiting",t).defaultPrevented)return;e.exitApp()}},t.__registerAppEvents=function(e){var n=t.__injector;if(!b(n)&&y(n.inject)){var i=t.app=n.inject();i.on("suspend",i.suspend),i.on("resume",i.resume),i.on("online",i.online),i.on("offline",i.offline),i.on("error",i.error),i.on("exiting",i.exiting),y(i.ready)&&i.ready(e)}},t.__addPlatCss=function(){var e=t._document;if(!t._compat.platCss)if(!b(e.styleSheets)&&e.styleSheets.length>0)e.styleSheets[0].insertRule("[plat-hide] { display: none !important; }",0);else{var n=document.createElement("style");n.textContent="[plat-hide] { display: none !important; }",document.head.appendChild(n)}},t.prototype.suspend=function(t){},t.prototype.resume=function(t){},t.prototype.error=function(t){},t.prototype.ready=function(t){},t.prototype.exiting=function(t){},t.prototype.online=function(t){},t.prototype.offline=function(t){},t.prototype.dispatchEvent=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=t._EventManager||dt("$EventManagerStatic");r.dispatch(e,this,r.DIRECT,n)},t.prototype.on=function(e,n){return(t._EventManager||dt("$EventManagerStatic")).on(this.uid,e,n,this)},t.prototype.load=function(e){t.load(e)},t.prototype.exit=function(){this.dispatchEvent("shutdown")},t.app=null,t}();t.App=Ji,t.IAppStatic=wt,Pt.injectable(Ot,wt,[Mt,"$EventManagerStatic",zt,"$Compiler","$LifecycleEventStatic",Bt],Wn),t.IApp=Tt,Pt.injectable("$App",Tt,[Ot],Xn)}(plat||(plat={})),module.exports=plat;
