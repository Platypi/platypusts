"use strict";var plat,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(d){var s,a,t,r,m,g,y,b,W="context",u="$AppStatic",C="$Http",x="$HttpRequestInstance",E="$HttpConfig",w="$Promise",X="$Compat",T="$ControlFactory",G="$Document",l="$DispatchEventInstance",c="$ErrorEventStatic",N="$EventManagerStatic",h="$LifecycleEventStatic",p="$LifecycleEventInstance",k="$Log",J="$Parser",K="$Regex",o="$Tokenizer",S="$NavigatorInstance",Z="$ContextManagerStatic",_="$Compiler",f="$CommentManagerFactory",I="$ElementManagerFactory",v="$NodeManagerStatic",j="$TextManagerFactory",R="$CacheFactory",A="$ManagerCache",L="$TemplateCache",P="$Animator",O="$AttributesFactory",F="$BindableTemplatesFactory",M="$Dom",D="$DomEvents",$="$ResourcesFactory",z="$TemplateControlFactory",B="$TemplateControlInstance",U="$Utils",ee="$Browser",V="$BrowserConfig",q="$RouterStatic",H="$UrlUtilsInstance",Q="$Window",Y="$BaseSegmentFactory",te="$BaseSegmentInstance",ne="$StaticSegmentInstance",ie="$DynamicSegmentInstance",re="$SplatSegmentInstance",oe="$StateStatic",se="$StateInstance",ae="$RouteRecognizerInstance",le="$InjectorStatic",ue="$History",ce="$Location",he="plat-",pe=he+"bind",_e=he+"href",fe=he+"src",de=he+"keydown",ve=he+"keypress",me=he+"keyup",ge=he+"charpress",ye=he+"name",be=he+"options",Ce=he+"checked",xe=he+"disabled",Ee=he+"selected",we=he+"readonly",Te=he+"visible",Ne=he+"style",ke=he+"tap",Se=he+"blur",Ie=he+"change",je=he+"copy",Re=he+"cut",Ae=he+"paste",Le=he+"dbltap",Pe=he+"focus",Oe=he+"submit",Fe=he+"touchstart",Me=he+"touchend",De=he+"touchmove",$e=he+"touchcancel",ze=he+"hold",Be=he+"release",Ue=he+"swipe",Ve=he+"swipeleft",qe=he+"swiperight",He=he+"swipeup",Qe=he+"swipedown",Ye=he+"track",We=he+"trackleft",Xe=he+"trackright",Ge=he+"trackup",Je=he+"trackdown",Ke=he+"trackend",Ze=he+"react",et=he+"link",tt=he+"foreach",nt=he+"html",it=he+"if",rt=he+"ignore",ot=he+"select",st=he+"template",at=he+"viewport",lt=he+"control",ut=he+"viewcontrol",ct=he+"resources",ht=he+W,pt=st+"-"+W,_t=he+"callback",ft="data-",dt="__templateControlCache",vt="head",mt="meta",gt="link",yt="property",bt="image",Ct="article:",xt="og:",Et="twitter:",wt="content",Tt="ready",Nt="suspend",kt="offline",n="shutdown",i="exiting",St="beforeLoad",It="beforeNavigate",jt="navigating",Rt="urlChanged",At="deviceReady",Lt="backbutton",Pt="backclick",Ot=he+"hide",Ft=he+"animating",Mt=he+"animation",Dt=he+"transition",$t=he+"enter",zt=he+"leave",Bt=he+"move",Ut=he+"fadein",Vt=he+"fadeout",qt=he+"back-nav",Ht="$tap",Qt="$dbltap",Yt="$touchstart",Wt="$touchend",Xt="$touchmove",Gt="$touchcancel",Jt="$hold",Kt="$release",Zt="$swipe",en="$swipeleft",tn="$swiperight",nn="$swipeup",rn="$swipedown",on="$track",sn="$trackleft",an="$trackright",ln="$trackup",un="$trackdown",cn="$trackend",hn={index:"index",even:"even",odd:"odd",first:"first",last:"last"},pn="base",_n="variable",fn="static",dn="splat",vn="dynamic",mn="{{",gn="}}",yn="static",bn="singleton",Cn="instance",xn="factory",En="class",wn="-compiled",Tn="-@",Nn="-init",kn=": start node",Sn=": end node",In="noop",jn="__app__",Rn="observable",An="injectable",Ln="object",Pn="function",On="literal",Fn="root",Mn="rootContext",Dn="control",$n=W,zn="function"==typeof Array.isArray,Bn={},Un=Object.prototype.toString,e="[object ",Vn=e+"Error]",qn=e+"File]",Hn=e+"Array]",Qn=e+"Boolean]",Yn=e+"Date]",Wn=e+"Number]",Xn=e+"RegExp]",Gn=e+"String]",Jn=e+"Promise]";function Kn(){}function Zn(e,t,n,i,r,o){Object.defineProperty(e,t,{value:n,enumerable:!0===i,configurable:!0===r,writable:!0===o})}function ei(n,e,i){for(var r,o,t=[],s=3;s<arguments.length;s++)t[s-3]=arguments[s];return di(i)||(o=fi(e)?e:e?function(e,t,n){Zn(e,t,n,!0,!0,!0)}:function(e,t,n){e[t]=n},hi(t)&&t.push(i),Ci(function(t,e){ni(t)&&Ci(function(e){if(r=t[e],n){if(mi(r))return mi(i[e])||(i[e]=[]),void ei(n,o,i[e],r);if(yi(r))return void o(i,e,new Date(r.getTime()));if(ui(r))return void o(i,e,new RegExp(r));if(oi(r))return void o(i,e,r.cloneNode(!0));if(ai(r))return void o(i,e,r);if(ni(r))return ni(i[e])||(i[e]={}),ei(n,o,i[e],r),ni(a)||(a=d.acquire(X)),void(a.setProto?Object.setPrototypeOf(i[e],Object.getPrototypeOf(r)):r.toString!==Object.prototype.toString&&(i[e].toString=r.toString))}o(i,e,r)},Object.keys(t))},t)),i}function ti(e,t){if(!ni(e))return e;if(yi(e))return new Date(e.getTime());if(ui(e))return new RegExp(e);if(oi(e))return e.cloneNode(t);if(ai(e))return e;if(n=e,Un.call(n)===Vn)return new e.constructor(e.message);var n,i={};return mi(e)&&(i=[]),pi(t)&&t?ei(!0,!1,i,e):ei(!1,!1,i,e)}function ni(e){return null!=e&&"object"==typeof e}function ii(e){return!!(e&&e.document&&e.setInterval)}function ri(e){return!(!e||e.nodeType!==Node.DOCUMENT_NODE)}function oi(e){return!(!e||"number"!=typeof e.nodeType)}function si(e){return!(!e||e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)}function ai(e){return ni(e)&&Un.call(e)===qn}function li(e){return"string"==typeof e||ni(e)&&Un.call(e)===Gn}function ui(e){return ni(e)&&Un.call(e)===Xn}function ci(e){return ni(e)&&(Un.call(e)===Jn||fi(e.then))}function hi(e){return!!di(e)||(li(e)||mi(e)?0===e.length:!!ni(e)&&0===Object.keys(e).length)}function pi(e){return!0===e||!1===e||ni(e)&&Un.call(e)===Qn}function _i(e){return("number"==typeof e||ni(e)&&Un.call(e)===Wn)&&!isNaN(e)}function fi(e){return"function"==typeof e}function di(e){return null==e}function vi(e){return void 0===e}function mi(e){return zn?Array.isArray(e):Un.call(e)===Hn}function gi(e){return!(di(e)||ii(e)||fi(e))&&(li(e)||0<=e.length)}function yi(e){return"object"==typeof e&&Un.call(e)===Yn}function bi(i,e,t){var r=[];return di(e)?r:fi(e.filter)?e.filter(i,t):(Ci(function(e,t,n){i(e,t,n)&&r.push(e)},e),r)}function Ci(e,t,n){if(di(t)||!ni(t)&&!gi(t))return t;var i,r,o;if(fi(t.forEach))return t.forEach(e,n);if(gi(t))for(o=t.length,i=0;i<o;i+=1)e.call(n,t[i],i,t);else{var s=Object.keys(t);for(o=s.length;0<s.length;)r=s.shift(),e.call(n,t[r],r,t)}return t}function xi(n,i,r){var o=[];return di(i)?o:fi(i.map)?i.map(n,r):(Ci(function(e,t){o.push(n.call(r,e,t,i))},i),o)}function Ei(e,t,n){ni(s)||(s=d.acquire(w));var i=xi(e,t,n);return s.all(i)}function wi(o,e,t,n){ni(s)||(s=d.acquire(w));var i=s.resolve([]);if(!mi(e))return i;o=o.bind(t);var r=function(e,n,i,r){return e.then(function(t){return o(n,i,r).then(function(e){return t.concat(e)})})};return!0===n?e.reduceRight(r,i):e.reduce(r,i)}function Ti(e,t,n){return wi(e,t,n)}function Ni(e,t,n){if(di(t)||fi(t))return!1;var i,r,o;if(fi(t.some))return t.some(e,n);if(gi(t)){for(o=t.length,i=0;i<o;i+=1)if(!0===e.call(n,t[i],i,t))return!0}else{var s=Object.keys(t);for(o=s.length;0<s.length;)if(r=s.shift(),!0===e.call(n,t[r],r,t))return!0}return!1}function ki(e,t,n){return Si(e,0,t,n)}function Si(e,t,n,i){var r=setTimeout(function(){e.apply(i,n)},t);return function(){clearTimeout(r)}}function Ii(e,t,n,i){var r=setInterval(function(){e.apply(i,n)},t);return function(){clearInterval(r)}}function ji(e,t){ni(a)||(a=d.acquire(X));var n=a.requestAnimationFrame;if(vi(n))return ki(function(){e.call(t,Date.now())});var i=n(e.bind(t)),r=a.cancelAnimationFrame;return fi(r)||(r=Kn),function(){r(i)}}function Ri(e){di(e)&&(e="");var t=Bn[e];di(t)&&(t=Bn[e]=["0","/"]);for(var n,i=t.length;0<i;){if(57===(n=t[i-=1].charCodeAt(0)))return t[i]="A",r();if(90===n)return t[i]="a",r();if(122!==n)return t[i]=String.fromCharCode(n+1),r();t[i]="0"}function r(){return e+t.join("")}return t.unshift("0"),r()}function Ai(e){return!li(e)||hi(e)?e:(e=e.charAt(0).toLowerCase()+e.slice(1),ui(t)||(t=d.acquire(K).camelCaseRegex),e.replace(t,function(e,t,n,i){return _i(i)&&0<i?n.toUpperCase():n}))}function Li(e,t){return di(e)||delete e[t],e}function Pi(e,t){return di(e)?e:e[t]}function Oi(e){if(!hi(e)){for(var t,n=(e=e.replace(/^\?+/,"")).split("&"),i={},r=n.length,o=0;o<r;o+=1)i[(t=n[o].split("="))[0]]=t[1];return i}}function Fi(e){var t="";return hi(t+=xi(function(e,t){return t+"="+e},e).join("&"))||(t="?"+t),t}function Mi(e){return mi(e)?e.reduce(function(e,t){return e&&!1!==t},!0):!pi(e)||e}var Di=/<([\w:]+)/,$i=/\s+/g,zi=[1,'<select multiple="multiple">',"</select>"],Bi=[1,"<table>","</table>"],Ui=[3,"<table><tbody><tr>","</tr></tbody></table>"],Vi=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],qi=ei(!1,!1,{},{thead:Bi,tbody:Bi,tfoot:Bi,colgroup:Bi,caption:Bi,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:Ui,th:Ui},{option:zi,optgroup:zi,legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],text:Vi,circle:Vi,ellipse:Vi,line:Vi,path:Vi,polygon:Vi,polyline:Vi,rect:Vi,_default:[0,"",""]});function Hi(e,t,n){ni(m)||(m=d.acquire(G));var i=si(t),r=!oi(t),o=i?t:m.createDocumentFragment();r&&(t=o);var s,a=mi(e)?e:Array.prototype.slice.call(e),l=a.length;if(!0===n){var u=void 0;for(s=0;s<l;s+=1)u=a[s].cloneNode(!0),o.insertBefore(u,null)}else for(s=0;s<l;s+=1)o.insertBefore(a[s],null);return i||r||t.appendChild(o),t}function Qi(e){for(var t=Array.prototype.slice.call(e.childNodes);0<t.length;)e.removeChild(t.pop())}function Yi(e,t){if(fi(e.push)||(e=Array.prototype.slice.call(e)),di(t))for(var n;0<e.length;)di(t=(n=e.pop()).parentNode)||t.removeChild(n);else!function(e,t){for(;0<e.length;)t.removeChild(e.pop())}(e,t)}function Wi(e,t){if(Qi(e),!hi(t)){var n=function(e){ni(a)||(a=d.acquire(X)),ni(m)||(m=d.acquire(G));var t=Di.exec(e),n=m.createElement("div");if(di(t))return(n=tr(n,e)).removeChild(n.lastChild);e=e.trim();var i=t[1],r=qi[i];if(a.pushState&&vi(r))return tr(n,e);if("body"===i)return(n=tr(m.createElement("html"),e)).removeChild(n.lastChild);mi(r)||(r=qi._default);var o=r[0];for(n=tr(n,""+r[1]+e+r[2]);0<o;)o-=1,n=n.lastChild;return n}(t);return 0<n.childNodes.length?Hi(n.childNodes,e):e.insertBefore(n,null),e}}function Xi(e,t,n){if(!di(e)&&ni(t)){var i;if(vi(n)&&(n=null),oi(t))return i=t,t=Array.prototype.slice.call(i.childNodes),e.insertBefore(i,n),t;fi(t.push)||(t=Array.prototype.slice.call(t)),ni(m)||(m=d.acquire(G));var r=t.length;i=m.createDocumentFragment();for(var o=0;o<r;o+=1)i.insertBefore(t[o],null);return e.insertBefore(i,n),t}}function Gi(e){var t=e.parentNode,n=Xi(t,e.childNodes,e);return t.removeChild(e),n}function Ji(e,t){if(di(t))return t;if(e.nodeType===Node.ELEMENT_NODE)for(var n=e.attributes,i=n.length,r=void 0,o=0;o<i;o+=1)r=n[o],t.setAttribute(r.name,r.value);var s=e.parentNode;return Xi(t,e.childNodes),s.replaceChild(t,e),t}function Ki(e){ni(m)||(m=d.acquire(G));var t=m.createDocumentFragment();return hi(e)||Wi(t,e),t}function Zi(e,t){if(!di(e)){var n,i=e.nextSibling,r=e.parentNode;if(di(t)&&(t=null),!di(r)&&(di(t)||t.parentNode===r))for(;i!==t;)n=i.nextSibling,r.removeChild(i),i=n}}function er(e,t){di(e)||(Zi(e,t),nr(e),nr(t))}function tr(e,t){return ni(a)||(a=d.acquire(X)),a.msApp?MSApp.execUnsafeLocalFunction(function(){e.innerHTML=t}):e.innerHTML=t,e}function nr(e){if(oi(e)){var t=e.parentNode;di(t)||t.removeChild(e)}}function ir(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){if(hi(n))return void(e.className=t);for(;0<r.length;)""!==(i=r.shift())&&(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g").test(n)||(e.className+=" "+i))}else for(;0<r.length;)""!==(i=r.shift())&&e.classList.add(i)}}function rr(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){if(n===t)return void(e.className="");for(;0<r.length;)""!==(i=r.shift())&&(e.className=n=n.replace(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g"),""))}else for(;0<r.length;)""!==(i=r.shift())&&e.classList.remove(i)}}function or(e,t){ni(e)||(e={});var n=e.className;if(!li(n)||!li(t)||""===t)return!1;var i,r=t.split($i);if(vi(e.classList)){if(""===n)return!1;if(n===t)return!0;for(;0<r.length;)if(""!==(i=r.shift())&&!new RegExp("^"+i+"\\s|\\s"+i+"$|\\s"+i+"\\s","g").test(n))return!1;return!0}for(;0<r.length;)if(""!==(i=r.shift())&&!e.classList.contains(i))return!1;return!0}var sr,ar,lr,ur,cr,hr,pr,_r={},fr={},dr={},vr={},mr={},gr={},yr={},br={};function Cr(e){for(var t,n=mi(e),i=(t=n?ar.Injector.getDependencies(e):ar.Injector.getDependencies([e])).length,r=[],o=0;o<i;o+=1)r.push(t[o].inject());return n?r:r[0]}!function(a){function r(e,t,n,i,r,o){var s=e[t]=new ar.Injector(t,n,i,r);return!0===o&&(gr[t]=s),a}a.app=function(e,t,n){var i=Cr(le);return Cr(u).registerApp(new i(e,t,n)),a},a.control=function(e,t,n,i){if(!li(e))throw new Error("A Control must be registered with a string name");return"head"===(e=e.toLowerCase())&&(i=!0),r(_r,e,t,n,i?yn:void 0)},a.viewControl=function(e,t,n){if(!li(e))throw new Error("A ViewControl must be registered with a string name");return e=e.toLowerCase(),r(fr,e,t,n)},a.injectable=function(e,t,n,i){if(li(i)){if((i=i.toLowerCase())===xn||i===yn||i===En)return r(vr,e,t,n,i,!0);if(i!==bn&&i!==Cn)throw new Error("Invalid injectable type "+i+" during injectable registration.")}else i=bn;return r(vr,e,t,n,i,!1)},a.injectable.STATIC=yn,a.injectable.SINGLETON=bn,a.injectable.INSTANCE=Cn,a.injectable.FACTORY=xn,a.injectable.CLASS=En,a.animation=function(e,t,n,i){if(li(i)&&"css"!==(i=i.toLowerCase())&&"js"!==i)throw new Error('Invalid animationType "'+i+'" during animation registration.');return r("js"===i?br:yr,e,t,n,a.injectable.INSTANCE)},a.animation.CSS="css",a.animation.JS="js"}(sr=d.register||(d.register={})),lr=ar=d.dependency||(d.dependency={}),cr=function(){function h(e,t,n,i){void 0===i&&(i=null),this.type=null,this.name=e,this.Constructor=t,this.type=i;var r,o=this.dependencies=h.convertDependencies(n),s=o.indexOf(In);if(Object.defineProperty(t,"__injectorName",{value:e,enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(t,"__injectorDependencies",{value:o.slice(0),enumerable:!1,configurable:!0,writable:!0}),-1<s){var a=n[s];if(di(a))throw new TypeError("The dependency for "+e+" at index "+s+" is undefined, did you forget to include a file?");throw new TypeError("Could not resolve dependency "+a.slice(9,a.indexOf("("))+" for "+e+". Are you using a static injectable Type?")}if(li(r=h.__findCircularReferences(this)))throw new Error("Circular dependency detected from "+this.name+" to "+r+".");if(e===u){var l=this.inject();this.dependencies=o,l.start()}}return h.initialize=function(){for(var e=gr,t=Object.keys(e),n=t.length,i=0;i<n;i+=1)e[t[i]].inject();gr={}},h.getDependencies=function(e){if(di(e)||hi(e))return[];for(var t=[],n=e.length,i=0;i<n;i+=1)t.push(h.getDependency(e[i]));return t},h.getDependency=function(e){return di(e)||e===In?h.__noop():h.isInjector(e)?e:h.__locateInjector(e)},h.convertDependencies=function(e){if(!mi(e))return[];for(var t=h.convertDependency,n=[],i=e.length,r=0;r<i;r+=1)n.push(t(e[r]));return n},h.convertDependency=function(e){return di(e)?In:h.__getInjectorName(e)},h.isInjector=function(e){return fi(e.inject)&&!vi(e.type)&&!vi(e.name)&&!vi(e.Constructor)},h.__getInjectorName=function(e){if(di(e))return In;if(li(e))return e;var t=e,n=ni(t._inject)?t._inject:{};if(li(t.__injectorName)&&(e=t.__injectorName),!li(e))return new h(e,t,n.dependencies);var i=h.__findInjector(e,[vr,mr,gr,fr,_r,yr,br]);return!ni(i)&&li(e)&&(i=mr[e]=new h(e,t,t._inject.dependencies)),ni(i)?i.name:In},h.__construct=function(e,t,n){if(di(e)||di(e.prototype))return e;var i,r=Object.create(e.prototype),o=n===Cn;o&&(i=dr[e.__injectorName]),ni(i)||(i=h.__walk(r,Object.getPrototypeOf(r),{}),o&&(dr[e.__injectorName]=i));for(var s=Cr(xi(function(e){return e},i)),a=Object.keys(i),l=a.length,u=0;u<l;u+=1)r[a[u]]=s[u];var c=r.constructor.apply(r,t);return vi(c)?r:c},h.__walk=function(e,t,n){var i=t.constructor,r={};return ni(i._inject)&&i!==Object&&(r=h.__walk(e,Object.getPrototypeOf(t),n)),ei(!1,!1,{},n,r,ti(i._inject,!0))},h.__locateInjector=function(e){if(!di(e)){var t=e;li(e.__injectorName)&&(t=e.__injectorName);var n=h.__findInjector(t,[vr,mr,gr,fr,_r,yr,br]);return ni(n)||(fi(e)?(li(t)||(t=Ri(he)),n=new h(t,e,ni(e._inject)?e._injectorDependencies:[]),mr[t]=n):n=h.__wrap(e)),n}},h.__findInjector=function(e,t){if(!di(e)){if(e===h||e===le){var n=h.__wrap(h);return n.name=le,n}if(li(e))for(var i=0,r=t;i<r.length;i++){var o=r[i];if(!di(o[e]))return o[e];if(!di(o[e.toLowerCase()]))return o[e.toLowerCase()]}}},h.__wrap=function(e){return{inject:function(){return e},name:"wrapped",dependencies:[],Constructor:e}},h.__noop=function(){return{inject:Kn,type:In,name:In,dependencies:[],Constructor:Kn}},h.__findCircularReferences=function(e){if(ni(e)&&mi(e.dependencies))for(var t,n,i,r=e.name,o=e.dependencies,s=[{name:r,dependencies:o.slice(0)}],a=h.__locateInjector;0<s.length;){i=(o=(t=s.pop()).dependencies).length;for(var l=0;l<i;l+=1){if((n=o[l])===r)return t.name;ni(e=a(n))&&mi(e.dependencies)&&s.push({name:e.name,dependencies:e.dependencies.slice(0)})}}},h.prototype.inject=function(){for(var e,t,n=[],i=this.type,r=this.dependencies,o=r.length,s=0;s<o;s+=1)e=h.getDependency(r[s]),n.push(e.inject());return t=h.__construct(this.Constructor,n,i),li(i)&&i!==Cn&&this._wrapInjector(t),t.__injectable__type=i,t},h.prototype._wrapInjector=function(e){return this.inject=function(){return e},this},h}(),lr.Injector=cr,(ur=lr.injectors||(lr.injectors={})).control=_r,ur.viewControl=fr,ur.injectable=vr,ur.staticInjectable=gr,ur.animation=yr,ur.jsAnimation=br,vi(window)||(vi(window.plat)&&(window.plat=d),vi(window.module)&&(window.module={})),d.acquire=Cr,hr=d.debug||(d.debug={}),pr=function(){function i(){this.ERROR=5,this.WARN=4,this.INFO=3,this.DEBUG=2,this.TRACE=1,this._level=this.INFO}return i.prototype.error=function(e){throw this._log(e,this.ERROR),e},i.prototype.warn=function(e){this._log(e,this.WARN)},i.prototype.info=function(e){this._log(e,this.INFO)},i.prototype.debug=function(e){this._log(e,this.DEBUG)},i.prototype.trace=function(e){this._log(e,this.TRACE)},i.prototype.setLogLevel=function(e){switch(li(e)&&(e=this[e.toUpperCase()]),e){case this.ERROR:case this.WARN:case this.INFO:case this.DEBUG:case this.TRACE:this._level=e;break;default:this._level=this.INFO}},i.prototype._log=function(e,t){if(this._shouldLog(t)){li(e)&&(e=new Error(e));var n=this._ErrorEvent;di(n)&&(n=this._ErrorEvent=Cr(c)),n.dispatch("error",i,e,t)}},i.prototype._shouldLog=function(e){return _i(e)||(e=this.INFO),this._level<e},i}(),hr.Log=pr,sr.injectable(k,pr);var xr=function(){function e(){this.__events={},this.__defineBooleans(),this.__defineMappedEvents(),this.__defineVendorDependencies(),this.__determineCss()}return e.prototype.hasEvent=function(e){var t=this.__events,n=t[e];if(vi(n)){var i=this._document.createElement("div");n="input"===e&&9===this.IE?t[e]=!1:t[e]=!vi(i["on"+e])}return n},e.prototype.__defineBooleans=function(){var e=this._window,t=this._history,n=e.define,i=e.MSApp,r=e.WinJS,o=e.navigator;ni(o)||(o={});var s=o.userAgent;li(s)||(s=""),s=s.toLowerCase();var a=/android ((?:\d|\.)+)/.exec(s);gi(a)||(a=[]);var l=a[1];if(li(l)&&!/iemobile/i.test(s)&&(l=parseInt(l.replace(/\./g,""),10)),this.isCompatible=fi(Object.defineProperty)&&fi(this._document.querySelector),this.cordova=!di(e.cordova),this.pushState=!(di(t)||di(t.pushState)),this.fileSupported=!(vi(e.File)||vi(e.FormData)),this.amd=fi(n)&&!di(n.amd),this.msApp=ni(i)&&fi(i.execUnsafeLocalFunction),this.winJs=ni(r)&&ni(r.Application),this.indexedDb=!di(e.indexedDB),this.proto=ni({}.__proto__),this.getProto=fi(Object.getPrototypeOf),this.setProto=fi(Object.setPrototypeOf),this.hasTouchEvents=!vi(e.ontouchstart),this.hasPointerEvents=!!o.pointerEnabled,this.hasMsPointerEvents=!!o.msPointerEnabled,_i(l))this.ANDROID=l;else{var u=/msie (\d+)/.exec(s),c=/trident\/.*; rv:(\d+)/.exec(s);gi(u)||(u=[]),gi(c)||(c=[]);var h=parseInt(u[1],10);_i(h)||(h=parseInt(c[1],10)),_i(h)&&(this.IE=h)}},e.prototype.__defineMappedEvents=function(){this.hasPointerEvents?this.mappedEvents={$touchstart:"pointerdown",$touchend:"pointerup",$touchmove:"pointermove",$touchcancel:"pointercancel"}:this.hasMsPointerEvents?this.mappedEvents={$touchstart:"MSPointerDown",$touchend:"MSPointerUp",$touchmove:"MSPointerMove",$touchcancel:"MSPointerCancel"}:this.hasTouchEvents?this.mappedEvents={$touchstart:"touchstart",$touchend:"touchend",$touchmove:"touchmove",$touchcancel:"touchcancel"}:this.mappedEvents={$touchstart:"mousedown",$touchend:"mouseup",$touchmove:"mousemove",$touchcancel:null}},e.prototype.__defineVendorDependencies=function(){var e,t,n,i,r=this._window,o=this._document.documentElement,s=r.getComputedStyle(o,""),a=Array.prototype.slice.call(s).join("").match(/-(moz|webkit|ms)-/);mi(a)&&1<a.length?(i=(e=mi(a)&&1<a.length?a[1]:"")[0].toUpperCase()+e.slice(1),t="WebKit|Moz|MS".match(new RegExp("("+e+")","i"))[1],n="-"+e+"-"):vi(s.OLink)?e=i=t=n="":(e="o",i=t="O",n="-o-"),this.vendorPrefix={dom:t,lowerCase:e,css:n,upperCase:i},this.requestAnimationFrame=r.requestAnimationFrame,fi(this.requestAnimationFrame)||(this.requestAnimationFrame=r[e+"RequestAnimationFrame"]),this.cancelAnimationFrame=r.cancelAnimationFrame,fi(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[e+"CancelRequestAnimationFrame"]),fi(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[e+"CancelAnimationFrame"]);var l=o.style;!(vi(this.ANDROID)||44<=Math.floor(this.ANDROID/10))||vi(l.animation)||vi(l.transition)?(vi(l[i+"Animation"])||vi(l[i+"Transition"]))&&(vi(l[e+"Animation"])||vi(l[e+"Transition"]))&&(vi(l[t+"Animation"])||vi(l[t+"Transition"]))||(this.animationSupported=!0,this.animationEvents={$animation:e+"Animation",$animationStart:e+"AnimationStart",$animationEnd:e+"AnimationEnd",$animationIteration:e+"AnimationIteration",$transition:e+"Transition",$transitionStart:e+"TransitionStart",$transitionEnd:e+"TransitionEnd"}):(this.animationSupported=!0,this.animationEvents={$animation:"animation",$animationStart:"animationstart",$animationEnd:"animationend",$animationIteration:"animationiteration",$transition:"transition",$transitionStart:"transitionstart",$transitionEnd:"transitionend"})},e.prototype.__determineCss=function(){var e=this._document,t=e.head,n=e.createElement("div");n.setAttribute(Ot,""),t.insertBefore(n,null);var i=this._window.getComputedStyle(n),r=i.display,o=i.visibility;this.platCss="none"===r||"hidden"===o,t.removeChild(n)},e._inject={_window:Q,_history:ue,_document:G},e}();d.Compat=xr,sr.injectable(X,xr);var Er,wr=function(){function e(){}return e.prototype.noop=function(){},e.prototype.extend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ei.apply(null,[!1,!1,e].concat(t))},e.prototype.deepExtend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ei.apply(null,[!0,!1,e].concat(t))},e.prototype.clone=function(e,t){return ti(e,t)},e.prototype.isObject=function(e){return ni(e)},e.prototype.isWindow=function(e){return ii(e)},e.prototype.isDocument=function(e){return ri(e)},e.prototype.isNode=function(e){return oi(e)},e.prototype.isDocumentFragment=function(e){return si(e)},e.prototype.isString=function(e){return li(e)},e.prototype.isRegExp=function(e){return ui(e)},e.prototype.isPromise=function(e){return ci(e)},e.prototype.isEmpty=function(e){return hi(e)},e.prototype.isBoolean=function(e){return pi(e)},e.prototype.isNumber=function(e){return _i(e)},e.prototype.isFile=function(e){return ai(e)},e.prototype.isFunction=function(e){return fi(e)},e.prototype.isNull=function(e){return di(e)},e.prototype.isUndefined=function(e){return vi(e)},e.prototype.isArray=function(e){return mi(e)},e.prototype.isArrayLike=function(e){return gi(e)},e.prototype.isDate=function(e){return yi(e)},e.prototype.debounce=function(e,t,n){return function(r,o,s){if(!fi(r))throw new Error("Must pass a function into debounce");var a;return di(o)&&(o=500),pi(s)||(s=!1),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this,i=s&&!a;clearTimeout(a),a=setTimeout(function(){s||r.apply(n,e)},o),i&&r.apply(n,e)}}(e,t,n)},e.prototype.filter=function(e,t,n){return bi(e,t,n)},e.prototype.where=function(e,t){return i=e,bi(function(n){return!Ni(function(e,t){return n[t]!==e},i)},t);var i},e.prototype.forEach=function(e,t,n){return Ci(e,t,n)},e.prototype.map=function(e,t,n){return xi(e,t,n)},e.prototype.mapAsync=function(e,t,n){return Ei(e,t,n)},e.prototype.mapAsyncInOrder=function(e,t,n){return Ti(e,t,n)},e.prototype.mapAsyncInDescendingOrder=function(e,t,n){return wi(e,t,n,!0)},e.prototype.pluck=function(e,t){return n=e,xi(function(e){return e[n]},t);var n},e.prototype.some=function(e,t,n){return Ni(e,t,n)},e.prototype.postpone=function(e,t,n){return Si(e,0,t,n)},e.prototype.defer=function(e,t,n,i){return Si(e,t,n,i)},e.prototype.setInterval=function(e,t,n,i){return Ii(e,t,n,i)},e.prototype.requestAnimationFrame=function(e,t){return ji(e,t)},e.prototype.uniqueId=function(e){return Ri(e)},e.prototype.camelCase=function(e){return Ai(e)},e.prototype.delimit=function(e,t){return i=t,!li(n=e)||hi(n)?n:(di(i)&&(i=""),ui(r)||(r=d.acquire(K).capitalCaseRegex),n.replace(r,function(e,t){return _i(t)&&0<t?i+e.toLowerCase():e.toLowerCase()}));var n,i},e}();function Tr(){return window}function Nr(e){return e.document}d.Utils=wr,sr.injectable(U,wr),d.Window=Tr,sr.injectable(Q,Tr),d.Document=Nr,sr.injectable(G,Nr,[Q]),function(e){var t=function(){function e(){this.markupRegex=new RegExp(mn+"[\\S\\s]*"+gn),this.argumentRegex=/\((.*)\)/,this.initialUrlRegex=/\/[^\/]*\.(?:html|htm)/,this.protocolRegex=/:\/\//,this.invalidVariableRegex=/[^a-zA-Z0-9@_$]/,this.fileNameRegex=/.*(?:\/|\\)/,this.shiftedKeyRegex=/[A-Z!@#$%^&*()_+}{":?><|~]/,this.fullUrlRegex=/^(?:[a-z0-9\-]+:)(?:\/\/)?|(?:\/\/)/i,this.validateEmail=new RegExp('^(([^<>()[\\]\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),this.validateTelephone=/^\+?[0-9\.\(\)\s-]*$/,this.dynamicSegmentsRegex=/^:([^\/]+)$/,this.splatSegmentRegex=/^\*([^\/]+)$/}return Object.defineProperty(e.prototype,"newLineRegex",{get:function(){return/\r|\n/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optionalRouteRegex",{get:function(){return/\((.*?)\)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"namedParameterRouteRegex",{get:function(){return/(\(\?)?:\w+/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wildcardRouteRegex",{get:function(){return/\*\w*/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"escapeRouteRegex",{get:function(){return/[\-{}\[\]+?.,\\\^$|#\s]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"camelCaseRegex",{get:function(){return/([\-_\.\s])(\w+?)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capitalCaseRegex",{get:function(){return/[A-Z]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"whiteSpaceRegex",{get:function(){return/("[^"]*?"|'[^']*?')|[\s\r\n\t\v]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quotationRegex",{get:function(){return/'|"/g},enumerable:!0,configurable:!0}),e}();e.Regex=t,sr.injectable(K,t);var n=function(){function e(){this.__previousChar="",this.__variableRegex=Cr(K).invalidVariableRegex,this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]}return e.prototype.createTokens=function(e){if(di(e))return[];for(var t,n=(this._input=e).length,i=this._isSpace,r=this._isAlphaNumeric,o=0,s=!1,a=0;a<n;a+=1)if(!i(t=e[a])){if(r(t))a=this.__handleAlphaNumeric(a,t);else if(di(jr[t]))if(Lr(t))switch(t){case"?":s=!0,o+=1,this.__handleQuestion(t);break;case":":o=this.__handleColon(t,o);break;default:a=this.__handleOtherOperator(a,t)}else";"===t&&this._throwError("Unexpected semicolon");else switch(t){case".":a=this.__handlePeriod(a,t);break;case"{":this.__handleLeftBrace(t);break;case"}":this.__handleRightBrace(t);break;case"[":this.__handleLeftBracket(t);break;case"]":this.__handleRightBracket(t);break;case"(":this.__handleLeftParenthesis(t);break;case")":this.__handleRightParenthesis(t);break;case",":this.__handleComma(t);break;case"'":case'"':a=this.__handleStringLiteral(a,t)}this.__previousChar=t}s&&0<o?this._throwError("Improper ternary expression"):0<this.__objArgCount.length&&this._throwError("Improper object literal"),this.__popRemainingOperators();var l=this.__outputQueue;return this._resetTokenizer(),l},e.prototype._checkType=function(e,t){return t?this._isNumeric(e):this._isAlphaNumeric(e)},e.prototype._lookAhead=function(e,t,n){var i,r=this._input,o=r.length;for(t+=1;t<o&&(i=r[t],this._checkType(i,n));)e+=i,t+=1;return e},e.prototype._lookAheadForOperatorFn=function(e,t){var n=this._input,i=n.length,r=e;for(t+=1;t<i&&Lr(r+=n[t]);)e=r,t+=1;return e},e.prototype._lookAheadForDelimiter=function(e,t){var n,i=this._input,r=i.length,o="";for(n=i[t+=1];t<r&&n!==e;)o+=n,n=i[t+=1];return o},e.prototype._popStackForVal=function(e,t,n){for(var i=this.__outputQueue,r=this.__operatorStack;e.val!==t;)i.push(r.shift()),e=r[0],0===r.length&&this._throwError(n)},e.prototype._isValEqual=function(e,t){return di(e)||di(e.val)?di(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return di(e)||di(e.val)?!di(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetTokenizer=function(){this._input=null,this.__previousChar="",this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]},e.prototype._throwError=function(e){this._log.error(new Error(e+" in "+this._input))},e.prototype._isNumeric=function(e){return"0"<=e&&e<="9"},e.prototype._isSpace=function(e){return" "===e||"\r"===e||"\n"===e||"\t"===e||"\v"===e||" "===e},e.prototype._isAlphaNumeric=function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"0"<=e&&e<="9"||"@"===e||"_"===e||"$"===e},e.prototype._isStringValidVariable=function(e){return!this.__variableRegex.test(e)},e.prototype.__handleAlphaNumeric=function(e,t){var n=this._isNumeric(t),i=this._lookAhead(t,e,n);return this.__outputQueue.push(n?{val:Number(i),args:0}:{val:i,args:-1}),e+i.length-1},e.prototype.__handlePeriod=function(e,t){var n,i=this.__outputQueue,r=this.__operatorStack,o=i.length-1,s=this.__previousChar;return o<0||this._isSpace(s)||!di(Sr[s])||"("===s||","===s?(e+=(n=this._lookAhead(t,e,!0)).length-1,i.push({val:parseFloat(n),args:0})):this._isValEqual(r[0],t)?i.push({val:t,args:0}):di(i[o])||!_i(Number(i[o].val))||this._isValEqual(i[o-1],t)?r.unshift({val:t,args:0}):(e+=(n=this._lookAhead(t,e,!0)).length-1,i[o].val+=parseFloat(n)),e},e.prototype.__handleLeftBrace=function(e){this.__operatorStack.unshift({val:e,args:0}),this.__objArgCount.push(0),this.__lastColonChar.push(e),this.__lastCommaChar.push(e)},e.prototype.__handleRightBrace=function(e){var t=this.__operatorStack,n=t[0],i=this.__objArgCount.pop();di(n)&&this._throwError("Improper object literal"),this._popStackForVal(n,"{","Improper object literal"),t.shift(),this.__lastColonChar.pop(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"{}",args:i})},e.prototype.__handleLeftBracket=function(e){var t=this.__previousChar,n=this.__operatorStack;this._isValEqual(n[0],".")&&this.__outputQueue.push(n.shift()),n.unshift({val:e,args:0}),this.__argCount.push({num:0,isArray:!("]"===t||")"===t||this._isAlphaNumeric(t))}),this.__lastCommaChar.push(e)},e.prototype.__handleRightBracket=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();(di(n)||di(i))&&this._throwError("Brackets mismatch"),i.isArray||(i.num-=1),this._popStackForVal(n,"[","Brackets mismatch"),t.shift(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"[]",args:"["===this.__previousChar?-1:i.num+1})},e.prototype.__handleLeftParenthesis=function(e){var t,n=this.__previousChar,i=this.__operatorStack;if(this._isAlphaNumeric(n)||"]"===n||")"===n){var r=this.__outputQueue,o=r[r.length-1],s=di(o)?void 0:o.val;"[]"===s?(i.unshift(r.pop()),i.unshift(r.pop())):"()"===s||this._isNumeric(s)||i.unshift(r.pop()),t=0}else t=-1;this.__argCount.push({num:t}),i.unshift({val:e,args:t}),this.__lastCommaChar.push(e)},e.prototype.__handleRightParenthesis=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();if(di(n)&&this._throwError("Parentheses mismatch"),this._popStackForVal(n,"(","Parentheses mismatch"),t.shift(),this.__lastCommaChar.pop(),!di(i)&&0<=i.num){var r=i.num;"("===this.__previousChar?this.__removeFnFromStack(r)&&this.__outputQueue.push({val:"()",args:0}):this.__removeFnFromStack(r+1)&&this.__outputQueue.push({val:"()",args:r+1})}},e.prototype.__handleComma=function(e){var t=this.__lastCommaChar,n=t[t.length-1];if("("===n||"["===n){var i=this.__argCount,r=i.length;0<r?i[r-1].num+=1:this._throwError("Mismatch with "+n)}var o=this.__operatorStack[0];di(o)&&this._throwError("Unexpected comma"),this._popStackForVal(o,n,"Unexpected comma")},e.prototype.__handleStringLiteral=function(e,t){var n=this._lookAheadForDelimiter(t,e),i=this.__operatorStack,r=i[0];return!di(r)&&("["===r.val||"("===r.val&&0<=r.args)?i.unshift({val:n,args:0}):this.__outputQueue.push({val:n,args:0}),e+n.length+1},e.prototype.__handleQuestion=function(e){this.__lastColonChar.push(e),this.__determinePrecedence(e)},e.prototype.__handleColon=function(e,t){var n=this.__lastColonChar,i=n[n.length-1],r=this.__outputQueue;if("?"===i){var o=this.__operatorStack,s=o[0];di(s)&&this._throwError("Ternary mismatch"),t-=1,n.pop(),this._popStackForVal(s,"?","Ternary mismatch"),r.push(o.shift()),o.unshift({val:e,args:-2})}else if("{"===i){var a=this.__objArgCount,l=r.length-1;a[a.length-1]+=1,l<0&&this._throwError("Unexpected colon"),r[l].args=1}else this._throwError("Unexpected colon");return t},e.prototype.__handleOtherOperator=function(e,t){var n=this._lookAheadForOperatorFn(t,e);return this.__determinePrecedence(n),e+n.length-1},e.prototype.__popRemainingOperators=function(){for(var e,t,n=this.__outputQueue,i=this.__operatorStack;0<i.length;)"("!==(t=(e=i.shift()).val)&&")"!==t||this._throwError("Parentheses mismatch"),n.push(e)},e.prototype.__determineOperator=function(e){switch(e){case"+":case"-":if(0===this.__outputQueue.length||Lr(this.__previousChar))return Sr["u"+e];default:return Sr[e]}},e.prototype.__determinePrecedence=function(e){var t,n,i=this.__determineOperator(e),r=i.precedence,o="ltr"===i.associativity,s=this.__operatorStack,a=this.__outputQueue;if(0!==s.length){do{if("."!==(n=s[0].val)){if(di(t=Sr[n])||!(t.precedence<r||o&&t.precedence===r))return void s.unshift({val:e,args:i.fn.length-2});a.push(s.shift())}else a.push(s.shift())}while(0<s.length);s.unshift({val:e,args:i.fn.length-2})}else s.unshift({val:e,args:i.fn.length-2})},e.prototype.__removeFnFromStack=function(e){for(var t,n=this.__outputQueue,i=this.__operatorStack,r=i[0],o=this._isValEqual,s=this._isValUnequal,a=!1;!di(r)&&s(r,"([")&&(this._isStringValidVariable(r.val)||o(r.val,".[]")||Ar(r.val));)-1!==(t=i.shift()).args||o(t,".[]")||(t.args=-2),n.push(t),r=i[0],a=!0;return a||s(n[n.length-e-1],"()")||(a=!0),a},e._inject={_log:k},e}();e.Tokenizer=n,sr.injectable(o,n);var i=function(){function e(){this._tokens=[],this.__cache={},this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={},this.__fnEvalConstant="var initialContext;return "}return e.prototype.parse=function(e){var t=this.__cache[e];if(!di(t))return{expression:t.expression,identifiers:t.identifiers.slice(0),aliases:t.aliases.slice(0),evaluate:t.evaluate};if(this._tokens=this._tokenizer.createTokens(e),0===(t=this._evaluate(e)).identifiers.length){var n=t.evaluate(null);t.evaluate=function(){return n}}return this.__cache[e]=t},e.prototype.clearCache=function(e){li(e)?Li(this.__cache,e):this.__cache={}},e.prototype._evaluate=function(e){for(var t,n,i,r=this._tokens,o=r.length,s=this.__tempIdentifiers,a=this.__codeArray,l=!1,u=0;u<o;u+=1)if(n=(t=r[u]).val,i=t.args,Ar(n))switch(n){case"()":l=this.__handleFunction(u,i,l);break;case"{}":a.push(this.__convertObject(i)),s.push(".");break;default:i<0?(a.push("[]"),s.push(".")):0<i?(a.push(this.__convertArrayLiteral(i)),s.push(".")):l=this.__indexIntoObject(u,n,l)}else if(Lr(n))if(0===i)a.push(this.__convertPrimitive(u,n,i));else switch(n){case"?":this.__handleQuestion();break;case":":this.__handleColon();break;case"+":case"-":1===i&&(n="u"+n);default:this.__handleOperator(n,i)}else i<0?a.push(this.__convertFunction(u,n,l)):a.push(this.__convertPrimitive(u,n,i));this._popRemainingIdentifiers(),this._makeIdentifiersUnique();var c={evaluate:new Function(W,"aliases",""+this.__fnEvalConstant+(0===a.length?'"'+e+'"':a.join(""))+";"),expression:e,identifiers:this.__identifiers.slice(0),aliases:Object.keys(this.__aliases)};return this._resetParser(),c},e.prototype._peek=function(e){return this._tokens[e+1]},e.prototype._lookBack=function(e){return this._tokens[e-1]},e.prototype._popRemainingIdentifiers=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers;0<n.length;)"."!==(e=n.pop())&&t.push(e)},e.prototype._makeIdentifiersUnique=function(){for(var e,t=this.__identifiers,n=[],i={};0<t.length;)i[e=t.pop()]||(i[e]=!0,n.push(e));this.__identifiers=n},e.prototype._isValEqual=function(e,t){return di(e)||di(e.val)?di(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return di(e)||di(e.val)?!di(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetParser=function(){this._tokens=[],this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={}},e.prototype._throwError=function(e){this._log.error(new Error(e))},e.prototype.__convertPrimitive=function(e,t,n){if(0<n)return this.__tempIdentifiers.push("."),t;var i=_i(Number(t)),r=this._peek(e),o=!(di(r)||1<=r.args),s=this._isValEqual;return Pr(t)||li(t)&&(i||this._isValUnequal(r,"[]()")||s(r,"[]")&&!o)?(this.__tempIdentifiers.push("."),'"'+t+'"'):(!i||s(r,".[]")&&o?this.__tempIdentifiers.push(t):this.__tempIdentifiers.push("."),t)},e.prototype.__convertFunction=function(e,t,n){if("@"===t[0])this.__aliases[t.slice(1)]=!0;else if(Pr(t))return this.__tempIdentifiers.push("."),t;var i=this._peek(e),r=this._isValEqual;if(r(this._tokens[e-1],"()")&&r(i,".[]")?this.__tempIdentifiers.push("."):this.__tempIdentifiers.push(t),di(i))return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))';switch(i.val){case".":case"()":return t;default:if(!n)return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))'}},e.prototype.__convertObject=function(e){for(var t,n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="{";s<e;)s+=1,n=o.pop(),a+=',"'+o.pop()+'":'+n,1<r.length&&(t=r.pop(),r.pop(),"."!==t&&i.push(t));return a.replace(",","")+"}"},e.prototype.__convertArrayLiteral=function(e){for(var t,n=this.__identifiers,i=this.__tempIdentifiers,r=this.__codeArray,o=0,s="";o<e;)o+=1,s=r.pop()+","+s,0<i.length&&"."!==(t=i.pop())&&n.push(t);return"["+s.slice(0,-1)+"]"},e.prototype.__handleFunction=function(e,t,n){var i,r,o=this.__identifiers,s=this.__tempIdentifiers,a=this.__codeArray,l=this._lookBack(e),u=!di(l)&&(-2===l.args||this._isValEqual(l,".[]")),c=0,h="",p="",_="",f=!1;for(u&&(p=a.pop(),_=s.pop());c<t;)c+=1,h=a.pop()+","+h,0<s.length&&"."!==(i=s.pop())&&(o.push(i),f=!0);if(r=0<t?".call(initialContext || context,"+h.slice(0,h.length-1)+")":".call(initialContext || context)",n)if(n=!1,0<a.length){var d=a.pop(),v=s.length-1;v<0||"."===s[v]||""===_?""!==_&&f&&"["!==d[0]&&"]"!==d[d.length-1]&&(o[o.length-1]+="."+_):(s[v]+="."+_,o.push(s.pop())),r=hi(p)?d+r:"(("+this.__indexIntoContext.toString()+")("+d+',"'+p+'") || (function () {}))'+r}else this._throwError("Improper expression or context");else u?(r="(initialContext = (("+this.__findInitialContext.toString()+')(context,aliases,"'+p+'") || (function () {}))'+r+")",o.push(p)):r=a.pop()+r;a.push(r);var m=s.length;return this._isValEqual(this._peek(e),"[]")&&0<m&&"."!==s[m-1]&&o.push(s.pop()),n},e.prototype.__indexIntoObject=function(e,t,n){var i=this._isValEqual;if(i(this._peek(e),"()"))return!0;var r,o=this.__codeArray,s=this.__identifiers,a=this.__tempIdentifiers,l=this._lookBack(e),u=a.pop(),c=!di(u),h=o.pop();return c&&"@"===u[0]?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",s.push(u),0<a.length&&s.push(a.pop())):i(l,"++--()[]*/%?:>=<=&&||!===")?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",a.push(".")):"[]"!==t||di(l)||0<=l.args?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+',"'+h+'")',0<=(r=a.length-1)?"."!==a[r]&&(a[r]+="."+u):c&&"."!==u&&"."!==t&&s.push(u)):(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",0<=(r=a.length-1)&&"."!==a[r]&&s.push(a.pop()),s.push(u)),o.push(h),n},e.prototype.__handleQuestion=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&0<n.length;o+=1)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+"?"+r)},e.prototype.__handleColon=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&0<n.length;o+=1)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+":"+r)},e.prototype.__handleOperator=function(e,t){for(var n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="";s<t;)s+=1,a="function (context, aliases) { return "+o.pop()+"; },"+a,0<r.length&&"."!==(n=r.pop())&&i.push(n);r.push("."),o.push("("+Sr[e].fn.toString()+")(context, aliases,"+a.slice(0,a.length-1)+")")},e.prototype.__findInitialContext=function(e,t,n){return"@"===n[0]&&null!==t&&"object"==typeof t?t[n.slice(1)]:null!==e&&"object"==typeof e?e[n]:void 0},e.prototype.__indexIntoContext=function(e,t){if(null!==e&&"object"==typeof e)return e[t]},e._inject={_tokenizer:o,_log:k},e}();e.Parser=i,sr.injectable(J,i)}(d.expressions||(d.expressions={})),function(e){function t(e){return e.location}e.Location=t,sr.injectable(ce,t,[Q]);var n=function(){function l(){this.uid=Ri(he),this.__lastUrl=this._location.href,this.__protocol=this.urlUtils().protocol,this.__initializing=!1,this._EventManager.on(this.uid,St,this.initialize,this),this._compat.msApp&&(this._stack=[])}return l.prototype.initialize=function(){var e=this._compat;this._EventManager.dispose(this.uid),this.__initializing=!0,Cr(H);var t=this.url(),n=t,i=this._urlChanged.bind(this),r=this._dom,o=this._window;n!==t&&this.url(n,!0),e.pushState&&r.addEventListener(o,"popstate",i,!1),r.addEventListener(o,"hashchange",i,!1),this.__initializing=!1},l.prototype.url=function(e,t){var n=this._location;return li(e)&&!this._isLastUrl(e)&&(!t&&mi(this._stack)&&this._stack.push(n.href),this._setUrl(e,t)),hi(this.__currentUrl)?n.href:this.__currentUrl},l.prototype.back=function(e){_i(e)||(e=1);var t=this._stack;if(mi(t)&&1<t.length)return this._stack=t=t.slice(0,t.length-(e-1)),this.url(t.pop()),void t.pop();this._history.go(-e)},l.prototype.forward=function(e){_i(e)||(e=1),this._history.go(e)},l.prototype.urlUtils=function(e){li(e)||(e=this.url());var t=Cr(H),n=l.config,i=n.hashPrefix;return li(i)||(i=""),n.routingType===n.HASH&&(e=e.replace(new RegExp("#"+i+"/?"),"")),t.initialize(e),t},l.prototype.isCrossDomain=function(e){if(!li(e))return!1;var t=this.urlUtils(e),n=this.urlUtils();return t.protocol!==n.protocol||t.hostname!==n.hostname||t.port!==n.port},l.prototype.formatUrl=function(e){var t=l.config,n=t.baseUrl;if(!li(e))return"";if(e===n)return e;var i=!this._regex.fullUrlRegex.test(e)||-1<e.indexOf(n);if("/"===e[0]&&(e=e.slice(1)),i){if(t.routingType===t.HASH){var r=0===e.indexOf(this.__protocol+":"),o=t.hashPrefix;li(o)||(o="");var s="#"+o,a=new RegExp(s+"|#/");"/"!==e[e.length-1]&&-1===e.indexOf("?")&&(e+="/"),a.test(e)||(e=r?""+e+s+"/":s+("/"!==e[0]?"/":"")+e)}-1===e.indexOf(n)&&(e=n+e)}return e},l.prototype._urlChanged=function(){var e=this;if(!this.__initializing){this.__currentUrl=null;var t=this.urlUtils(),n=this._trimSlashes(t.href);if(this.__lastUrl!==n){this.__lastUrl=n;var i=this._EventManager;ki(function(){i.dispatch(Rt,e,i.DIRECT,[t])})}}},l.prototype._setUrl=function(e,t){e=this.formatUrl(e);var n=this.urlUtils(e),i=l.config.baseUrl,r=this._history,o=this._location;if(-1!==n.href.indexOf(i))if(this._regex.fullUrlRegex.test(e)||"/"===e[0]||(e=i+e),this._compat.pushState){if(t){var s=r.state;ni(s)||(s={}),r.replaceState({previousLocation:s.previousLocation},"",e)}else r.pushState({previousLocation:this.urlUtils().pathname},"",e);this.__initializing||this._urlChanged()}else this.__currentUrl=e,t?o.replace(e):o.href=e;else o.href=e},l.prototype._isLastUrl=function(e){var t=this.__lastUrl;return li(e)&&(hi(e)&&(e="/"),e=this._trimSlashes(this.urlUtils(e).href)),e===t},l.prototype._trimSlashes=function(e){return li(e)&&"/"===e[e.length-1]?e.slice(0,-1):e},l._inject={_EventManager:N,_compat:X,_regex:K,_window:Q,_location:ce,_history:ue,_dom:M},l.config={HASH:"hash",STATE:"state",routingType:"hash",hashPrefix:"!",baseUrl:""},l}();function i(){return n.config}e.Browser=n,sr.injectable(ee,n),e.IBrowserConfig=i,sr.injectable(V,i);var r=function(){function r(){var e=this._browserConfig,t=e.baseUrl;if(hi(t)||!this._regex.fullUrlRegex.test(t)){var n=this._window.location.href.replace(this._regex.initialUrlRegex,"/");for(li(t)?0===t.indexOf("/")&&(t=t.slice(1)):t="",t=r.__getBaseUrl(n)+t;"/"===t[t.length-1];)t=t.slice(0,-1);e.baseUrl=t+"/"}}return r.__getQuery=function(e){return Oi(e)},r.__getBaseUrl=function(e){var t=Cr(K),n=Cr(ce),i=n.protocol,r=(n.host,n.origin);return"file:"===i||-1<i.indexOf("wmapp")||-1<i.indexOf("ms-appx")?r=n.href:vi(r)&&(r=n.protocol+"//"+n.host),(r=r.replace(t.initialUrlRegex,"")).split("?")[0].split("#")[0]+"/"},r.prototype.initialize=function(e){li(e)||(e=""),oi(r.__urlUtilsElement)||(r.__urlUtilsElement=this._document.createElement("a"));var t,n=r.__urlUtilsElement,i=this._browserConfig;"/"===e[0]&&0!==e.indexOf("//")&&(e=e.slice(1)),this._regex.fullUrlRegex.test(e)||(e=i.baseUrl+e),n.setAttribute("href",e),e=n.href,n.setAttribute("href",e),e=n.href,this.href=e,this.protocol=li(n.protocol)?n.protocol.replace(/:$/,""):"",this.host=n.host,this.search=li(n.search)?n.search.replace(/^\?/,""):"",this.hash=li(n.hash)?n.hash.replace(/^#/,""):"",this.hostname=n.hostname,this.port=n.port,t=(t=hi(i.baseUrl)?"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname:e.replace(i.baseUrl,"/")).replace(this._regex.initialUrlRegex,"/"),this.pathname=t.split("?")[0].split("#")[0],this.query=r.__getQuery(this.search)},r.prototype.toString=function(){return this.href},r._inject={_EventManager:N,_document:G,_window:Q,_compat:X,_regex:K,_browserConfig:V},r}();e.UrlUtils=r,sr.injectable(H,r,null,Cn)}(d.web||(d.web={})),function(e){var n,t,i,r,o,s=[],a="undefined"!=typeof window?window:{},l=a.MutationObserver;ni(l)||(l=a.WebKitMutationObserver),"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?n=function(){process.nextTick(p)}:l?(t=Cr(G),i=Cr(Q),r=t.createElement("div"),(o=new l(p)).observe(r,{attributes:!0}),i.addEventListener("unload",function(){o.disconnect(),o=null},!1),n=function(){r.setAttribute("drainQueue","drainQueue")}):n=function(){ki(p)};var c,u,h=function(){function u(e){if(!fi(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof u))throw new TypeError('Failed to construct "Promise": Please use the "new" operator, this object constructor cannot be called as a function.');this.__subscribers=[],u.__invokeResolveFunction(e,this)}return u.all=function(l){return mi(l)?new u(function(n,e){var t,i=[],r=l.length;function o(t){return function(e){return s(t,e)}}function s(e,t){i[e]=t,0===(r-=1)&&n(i)}0===r&&n([]);for(var a=0;a<l.length;a+=1)ci(t=l[a])?t.then(o(a),e):s(a,t)}):u.all([l])},u.race=function(r){return mi(r)?new u(function(e,t){for(var n,i=0;i<r.length;i+=1)ni(n=r[i])&&"function"==typeof n.then?n.then(e,t):e(n)}):u.race([r])},u.resolve=function(n){return new u(function(e,t){e(n)})},u.reject=function(n){return new u(function(e,t){t(n)})},u.__invokeResolveFunction=function(e,t){function n(e){u.__reject(t,e)}try{e(function(e){u.__resolve(t,e)},n)}catch(e){n(e)}},u.__invokeCallback=function(e,t,n,i){var r,o,s,a,l=fi(n);if(l)try{r=n(i),s=!0}catch(e){a=!0,o=e}else r=i,s=!0;u.__handleThenable(t,r)||(l&&s?u.__resolve(t,r):a?u.__reject(t,o):e===c.FULFILLED?u.__resolve(t,r):e===c.REJECTED&&u.__reject(t,r))},u.__publish=function(e,t){for(var n,i,r=e.__subscribers,o=e.__detail,s=0;s<r.length;s+=3)n=r[s],i=r[s+t],u.__invokeCallback(t,n,i,o);e.__subscribers=null},u.__publishFulfillment=function(e){u.__publish(e,e.__state=c.FULFILLED)},u.__publishRejection=function(e){u.__publish(e,e.__state=c.REJECTED)},u.__reject=function(e,t){e.__state===c.PENDING&&(e.__state=c.SEALED,e.__detail=t,u.config.async(u.__publishRejection,e))},u.__fulfill=function(e,t){e.__state===c.PENDING&&(e.__state=c.SEALED,e.__detail=t,u.config.async(u.__publishFulfillment,e))},u.__resolve=function(e,t){e===t?u.__fulfill(e,t):u.__handleThenable(e,t)||u.__fulfill(e,t)},u.__handleThenable=function(t,n){var i;if(t===n)return u.__reject(t,new TypeError("A promises callback cannot return the same promise.")),!0;if(ci(n))try{return n.then.call(n,function(e){if(i)return!0;i=!0,n!==e?u.__resolve(t,e):u.__fulfill(t,e)},function(e){if(i)return!0;i=!0,u.__reject(t,e)}),!0}catch(e){return i||u.__reject(t,e),!0}return!1},u.__subscribe=function(e,t,n,i){var r=e.__subscribers,o=r.length;r[o]=t,r[o+c.FULFILLED]=n,r[o+c.REJECTED]=i},u.prototype.then=function(e,t){var n=this,i=new this.constructor(Kn,this);if(di(this.__state))u.__subscribe(this,i,e,t);else{var r=arguments;u.config.async(function(){u.__invokeCallback(n.__state,i,r[n.__state-1],n.__detail)})}return i},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.toString=function(){return"[object Promise]"},u.config={async:function(e,t){1===s.push([e,t])&&n()}},u}();function p(){for(var e=0,t=s;e<t.length;e++){var n=t[e];(0,n[0])(n[1])}s=[]}function _(e){return!di(e.Promise)&&fi(e.Promise.all)&&fi(e.Promise.race)&&fi(e.Promise.resolve)&&fi(e.Promise.reject)?e.Promise:h}e.Promise=h,(u=c||(c={}))[u.PENDING=void 0]="PENDING",u[u.SEALED=0]="SEALED",u[u.FULFILLED=1]="FULFILLED",u[u.REJECTED=2]="REJECTED",e.IPromise=_,sr.injectable(w,_,[Q],En);var f=function(){function e(){var e=Cr(X);this.__fileSupported=e.fileSupported}return e.prototype.initialize=function(e){this.__options=ei(!1,!1,{},this._config,e)},e.prototype.execute=function(){var e=this.__options,t=e.url;if(!li(t)||hi(t.trim()))return this._invalidOptions();e.url=this._browser.urlUtils(t).toString();var n=!1;return e.isCrossDomain||!1?n=!0:(this.xhr=new XMLHttpRequest,vi(this.xhr.withCredentials)&&(n=this._browser.isCrossDomain(t))),n?(this.xhr=null,this.jsonpCallback=e.jsonpCallback,di(this.jsonpCallback)&&(this.jsonpCallback=Ri("plat_callback")),this.executeJsonp()):this._sendXhrRequest()},e.prototype.executeJsonp=function(){var u=this,c=this.__options,h=c.url;if(!li(h)||hi(h.trim()))return this._invalidOptions();c.url=this._browser.urlUtils(h).toString(),di(this.jsonpCallback)&&(this.jsonpCallback=c.jsonpCallback,di(this.jsonpCallback)&&(this.jsonpCallback=Ri(_t)));var e=new g(function(t,e){var n=u._window,i=u._document,r=i.createElement("script"),o=u.jsonpCallback,s=c.jsonpIdentifier;li(s)||(s="callback"),r.src=h+(-1<h.indexOf("?")?"&":"?")+s+"="+o;var a=n[o];n[o]=function(e){fi(u.clearTimeout)&&u.clearTimeout(),i.head.removeChild(r),vi(a)?Li(n,o):n[o]=a,t({response:e,status:200})},i.head.appendChild(r);var l=c.timeout;_i(l)&&0<l&&(u.clearTimeout=ki(function(){u.clearTimeout=Si(function(){e(new m({response:"Request timed out in "+l+"ms for "+h,status:408})),n[o]=Kn},l-1)}))});return e.initialize(this),e},e.prototype._xhrOnReadyStateChange=function(){var e=this.xhr;if(4===e.readyState){var t=e.status;if(0===t){var n=e.response;if(di(n))try{n=e.responseText}catch(e){}return!hi(n)}return 200<=t&&t<300||304===t}},e.prototype._sendXhrRequest=function(){var p=this,_=this.xhr,f=this.__options,d=f.method,v=f.url,e=new g(function(n,i){_.onreadystatechange=function(){var e=p._xhrOnReadyStateChange();if(!di(e)){var t=p._formatResponse(f.responseType,e);e?n(t):i(new m(t)),p.xhr=f=null}},li(d)||(p._log.info('AjaxOptions method was not of type string. Defaulting to "GET".'),d="GET"),_.open(d.toUpperCase(),v,!0,f.user,f.password);var e=f.responseType;if(p.__fileSupported||""===e||"text"===e||(e=""),"json"===e)try{_.responseType=e}catch(e){_.responseType=""}_.withCredentials=f.withCredentials;var t=f.overrideMimeType,r=f.data;if(li(t)&&!hi(t)&&_.overrideMimeType(t),di(r)||""===r)p.__setHeaders(),_.send();else{var o=f.transforms;gi(o)||(o=[]);var s=o.length,a=f.contentType,l=li(a)&&!hi(a);if(0<s){for(var u=0;u<s;u+=1)r=o[u](r,_);l&&_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)}else if(ni(r))if(l){var c=a.toLowerCase();-1!==c.indexOf("x-www-form-urlencoded")?(r=p.__serializeFormData(),_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)):-1!==c.indexOf("multipart/form-data")?p.__fileSupported?(r=p.__appendFormData(),p.__setHeaders(),_.send(r)):p.__submitFramedFormData().then(function(e){n(e)},function(){p.xhr=null}):(r=JSON.stringify(r),_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r))}else p.__setHeaders(),_.send(r);else l&&_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)}var h=f.timeout;_i(h)&&0<h&&(p.clearTimeout=ki(function(){p.clearTimeout=Si(function(){i(new m({response:"Request timed out in "+h+"ms for "+f.url,status:408,getAllResponseHeaders:function(){return _.getAllResponseHeaders()},xhr:_})),_.onreadystatechange=null,_.abort(),p.xhr=null},h-1)}))});return e.initialize(this),e},e.prototype._invalidOptions=function(){var n=this;return new g(function(e,t){n._log.warn("Attempting a request without specifying a url"),t(new m({response:"Attempting a request without specifying a url",status:null,getAllResponseHeaders:null,xhr:null}))})},e.prototype._formatResponse=function(e,t){var n=this.xhr,i=n.status,r=n.response;if(di(r))try{r=n.responseText}catch(e){}if(0===i&&(i=t?200:404),n.onreadystatechange=null,fi(this.clearTimeout)&&this.clearTimeout(),"json"===e&&li(r))try{r=JSON.parse(r)}catch(e){}return{response:r,status:i,getAllResponseHeaders:function(){return n.getAllResponseHeaders()},xhr:n}},e.prototype.__setHeaders=function(){var e=this.__options.headers;ni(e)||(e={});var t,n,i=Object.keys(e),r=this.xhr,o=i.length;for(n=0;n<o;n+=1)t=i[n],r.setRequestHeader(t,e[t])},e.prototype.__serializeFormData=function(){for(var e,t,n=this.__options.data,i=Object.keys(n),r=[];0<i.length;)di(t=n[e=i.pop()])?t="":ni(t)&&(yi(t)?t=t.toISOString():ai(t)?(this._log.warn('Invalid File entry with key "'+e+'"'),t="[object File]"):(this._log.warn('Invalid form entry with key "'+e+'" and value "'+t+'"'),t=JSON.stringify(t))),r.push(encodeURIComponent(e)+"="+encodeURIComponent(t));return r.join("&").replace(/%20/g,"+")},e.prototype.__appendFormData=function(){for(var e,t,n=this.__options.data,i=new FormData,r=Object.keys(n);0<r.length;)if(di(t=n[e=r.pop()]))i.append(e,"");else if(ni(t))if(yi(t))i.append(e,t.toISOString());else if(ai(t)){var o=t.name;li(o)||(o=t.fileName),li(o)||(o="blob"),i.append(e,t,o)}else this._log.warn('Invalid form entry with key "'+e+'" and value "'+t+'"'),i.append(e,JSON.stringify(t));else i.append(e,t);return i},e.prototype.__submitFramedFormData=function(){var e,n=this,t=this.__options,i=t.data,r=t.url,o=this._document,s=o.body,a=Cr(w),l=o.createElement("form"),u=o.createElement("iframe"),c=Ri("iframe_target"),h=Object.keys(i);for(u.name=l.target=c,u.src="javascript:false;",l.enctype=l.encoding="multipart/form-data",l.action=r,l.method="POST",l.style.display="none";0<h.length;)e=h.pop(),l.insertBefore(this.__createInput(e,i[e]),null);return new a(function(t,e){n.xhr.abort=function(){u.onload=null,s.removeChild(l),s.removeChild(u),e()},u.onload=function(){var e=u.contentDocument.body.innerHTML;s.removeChild(l),s.removeChild(u),t({response:e,status:200,getAllResponseHeaders:function(){return""}}),n.xhr=u.onload=null},s.insertBefore(l,null),s.insertBefore(u,null),l.submit()})},e.prototype.__createInput=function(e,t){var n=this._document,i=n.createElement("input");if(i.type="hidden",i.name=e,di(t))i.value="";else if(ni(t))if(!fi(t.slice)||vi(t.name)||vi(t.path))this._log.info('Invalid form entry with key "'+e+'" and value "'+t+'"'),i.value=JSON.stringify(t);else{var r=n.querySelectorAll('input[type="file"][name="'+e+'"]'),o=r.length;if(0===o)this._log.info('Could not find input[type="file"] with [name="'+e+'"]. Stringifying data instead.'),i.value=JSON.stringify(t);else if(1===o){var s=(i=r[0]).cloneNode(!0);i.parentNode.insertBefore(s,i)}else{for(var a=void 0,l=t.path;0<o;)if((a=r[o-=1]).value===l){var u=(i=a).cloneNode(!0);i.parentNode.insertBefore(u,i);break}-1===o&&(this._log.info('Could not find input[type="file"] with [name="'+e+'"] and [value="'+t.path+'"]. Stringifying data instead.'),i.value=JSON.stringify(t))}}else i.value=t;return i},e._inject={_browser:ee,_window:Q,_document:G,_config:E,_log:k},e}();e.HttpRequest=f;var m=function(){function e(e){this.name="AjaxError",Error.apply(this),this.response=this.message=e.response,this.status=e.status,this.getAllResponseHeaders=e.getAllResponseHeaders,this.xhr=e.xhr}return e.prototype.toString=function(){var e=this.response,t=e;return ni(e)&&!e.hasOwnProperty("toString")&&(t=JSON.stringify(e)),"Request failed with status: "+this.status+" and response: "+t},e}();(e.AjaxError=m).prototype=Error.prototype;var g=function(i){function e(e,t){var n=i.call(this,e)||this;return n._window=Cr(Q),di(t)||(n.__http=t.__http),n}return __extends(e,i),e.prototype.initialize=function(e){ni(e)&&di(this.__http)&&(this.__http=e)},e.prototype.cancel=function(){var e=this.__http,t=e.xhr,n=e.jsonpCallback;fi(e.clearTimeout)&&e.clearTimeout(),di(t)?di(n)||(this._window[n]=Kn):(t.onreadystatechange=null,t.abort(),e.xhr=null),this.__subscribers=[]},e.prototype.then=function(e,t){return i.prototype.then.call(this,e,t)},e.prototype.catch=function(e){return i.prototype.catch.call(this,e)},e}(h);e.AjaxPromise=g;var d=function(){function e(){this.responseType={DEFAULT:"",ARRAYBUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},this.contentType={ENCODED_FORM:"application/x-www-form-urlencoded;charset=utf-8",JSON:"application/json;charset=utf-8",MULTIPART_FORM:"multipart/form-data",OCTET_STREAM:"application/octet-stream;charset=utf-8",XML:"application/xml;charset=utf-8",PLAIN_TEXT:"text/plain",HTML:"text/html"}}return e.prototype.ajax=function(e){var t=Cr(x);return t.initialize(e),t.execute()},e.prototype.jsonp=function(e){var t=Cr(x);return t.initialize(e),t.executeJsonp()},e.prototype.json=function(e){var t=Cr(x);return t.initialize(ei(!1,!1,{},e,{responseType:"json"})),t.execute()},e.config={url:null,method:"GET",responseType:"",transforms:[],headers:{},withCredentials:!1,timeout:null,jsonpIdentifier:"callback",contentType:"application/json;charset=utf-8"},e}();function v(){return d.config}e.Http=d,sr.injectable(C,d),sr.injectable(x,f,null,Cn),e.IHttpConfig=v,sr.injectable(E,v)}(Er=d.async||(d.async={})),function(e){var r={},o={},t=function(){function i(e,t){this.__uid=e,this.__options=t,this.__size=0,di(t)&&(this.__options={timeout:0}),o[e]={}}return i.create=function(e,t){var n=r[e];return di(n)&&(n=r[e]=new i(e,t)),n},i.fetch=function(e){return r[e]},i.clear=function(){for(var e=Object.keys(r),t=e.length,n=0;n<t;n+=1)r[e[n]].clear();r={}},i.prototype.info=function(){return{uid:this.__uid,size:this.__size,options:this.__options}},i.prototype.put=function(e,t){var n=o[this.__uid][e];o[this.__uid][e]=t,vi(n)&&(this.__size+=1);var i=this.__options.timeout;return _i(i)&&0<i&&Si(this.remove,i,[e],this),t},i.prototype.read=function(e){return o[this.__uid][e]},i.prototype.remove=function(e){Li(o[this.__uid],e),this.__size-=1},i.prototype.clear=function(){o[this.__uid]={},this.__size=0},i.prototype.dispose=function(){this.clear(),Li(r,this.__uid)},i}();function n(){return t}function i(){return e.managerCache}e.Cache=t,e.ICacheFactory=n,sr.injectable(R,n,null,xn),e.managerCache=t.create("__managerCache"),e.IManagerCache=i,sr.injectable(A,i);var s=function(r){function e(){return r.call(this,"__templateCache")||this}return __extends(e,r),e.prototype.put=function(e,t){var n=this._Promise;if(r.prototype.put.call(this,e,n.resolve(t)),si(t))t=t.cloneNode(!0);else if(oi(t)){var i=document.createDocumentFragment();i.appendChild(t.cloneNode(!0)),t=i}else(li(t)||di(t))&&(t=Ki(t));return n.resolve(t)},e.prototype.read=function(t){var n=this,e=r.prototype.read.call(this,t);return di(e)?this._Promise.reject(null):e.then(function(e){return n.put(t,e)},function(e){return n._log.warn("Error retrieving template, "+t+", from promise."),null})},e._inject={_Promise:w,_log:k},e}(t);e.TemplateCache=s,sr.injectable(L,s);var a=function(){function e(e){var n=this;Ci(function(e,t){n[t]=e},this._storage=e)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._storage.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._storage.clear()},e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.key=function(e){return this._storage.key(e)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t),this[e]=this.getItem(e)},e}(),l=function(e){function t(){return e.call(this,Cr(Q).localStorage)||this}return __extends(t,e),t}(e.BaseStorage=a);e.LocalStorage=l,sr.injectable("$LocalStorage",l);var u=function(e){function t(){return e.call(this,Cr(Q).sessionStorage)||this}return __extends(t,e),t}(a);e.SessionStorage=u,sr.injectable("$SessionStorage",u)}(d.storage||(d.storage={}));var kr,Sr={"u+":{precedence:4,associativity:"rtl",fn:function(e,t,n){return+n(e,t)}},"+":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)+i(e,t)}},"u-":{precedence:4,associativity:"rtl",fn:function(e,t,n){return-n(e,t)}},"-":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)-i(e,t)}},"*":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)*i(e,t)}},"/":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)/i(e,t)}},"%":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)%i(e,t)}},"?":{precedence:15,associativity:"rtl",fn:function(){}},":":{precedence:15,associativity:"rtl",fn:function(){}},">":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>i(e,t)}},"<":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<i(e,t)}},"!":{precedence:4,associativity:"rtl",fn:function(e,t,n){return!n(e,t)}},"~":{precedence:4,associativity:"rtl",fn:function(e,t,n){return~n(e,t)}},"&":{precedence:10,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&i(e,t)}},"|":{precedence:12,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)|i(e,t)}},">>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>i(e,t)}},"<<":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<<i(e,t)}},">>>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>>i(e,t)}},"&&":{precedence:13,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&&i(e,t)}},"||":{precedence:14,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)||i(e,t)}},"==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)==i(e,t)}},"===":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)===i(e,t)}},"!=":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!=i(e,t)}},"!==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!==i(e,t)}},">=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>=i(e,t)}},"<=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<=i(e,t)}},"=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"++":{precedence:3,associativity:"",fn:function(e,t,n){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"--":{precedence:3,associativity:"",fn:function(e,t,n){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"+=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"-=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"*=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"/=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"%=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}}},Ir={"()":{precedence:2,associativity:null,fn:null},"[]":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},"{}":{precedence:1,associativity:null,fn:null}},jr={"{":{precedence:1,associativity:null,fn:null},"}":{precedence:1,associativity:null,fn:null},"[":{precedence:2,associativity:null,fn:null},"]":{precedence:2,associativity:null,fn:null},"(":{precedence:2,associativity:null,fn:null},")":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},",":{precedence:18,associativity:null,fn:null},"'":{precedence:0,associativity:null,fn:null},'"':{precedence:0,associativity:null,fn:null}},Rr={false:!1,true:!0,null:null,undefined:"undefined"};function Ar(e){return!di(Ir[e])}function Lr(e){return!di(Sr[e])}function Pr(e){return!vi(Rr[e])}!function(e){var a=["push","pop","reverse","shift","sort","splice","unshift"],t=function(){function T(){this._compat=Cr(X),this.__identifiers={},this.__identifierHash={},this.__lengthListeners={},this.__contextObjects={},this.__isArrayFunction=!1}return T.getManager=function(e){var t,n=T.__managers,i=e.uid,r=n[i];return di(r)?((t=n[i]=new T).context=e,t):t=r},T.dispose=function(e){if(!di(e)){var t=e.uid,n=T.__controls,i=T.__managers,r=i[t],o=n[t];ni(o)||(o={}),di(r)||(r.dispose(),Li(i,t));for(var s,a=Object.keys(o);0<a.length;)for(s=o[a.shift()];0<s.length;)s.shift()();Li(n,t),e.hasOwnContext&&!di(e.context)&&(T.unObserve(e.context),T.defineProperty(e,W,e.context,!0,!0,!0))}},T.removeArrayListeners=function(e,t){var n=T.arrayChangeListeners[e];di(n)||Li(n,t)},T.getContext=function(e,t){if(di(e))return e;for(t=t.slice(0);0<t.length;)if(di(e=e[t.shift()]))return e;return e},T.defineProperty=function(e,t,n,i,r,o){Zn(e,t,n,i,r,o)},T.defineGetter=function(e,t,n,i,r){var o,s,a,l,u;o=e,s=t,a=n,l=i,u=r,Object.defineProperty(o,s,{get:function(){return a},enumerable:!0===l,configurable:!0===u})},T.pushRemoveListener=function(e,t,n){var i,r=T.__controls,o=r[t];di(o)&&(o=r[t]={}),di(i=o[e])&&(i=o[e]=[]),i.push(n)},T.spliceRemoveListener=function(e,t,n){var i,r=T.__controls[t];if(!di(r)&&!di(i=r[e])){var o=i.indexOf(n);-1!==o&&(i.splice(o,1),0===i.length&&Li(r,e))}},T.removeIdentifier=function(e,t){for(var n,i=e.length,r=T.__controls,o=0;o<i;o+=1)di(n=r[e[o]])||Li(n,t)},T.createContext=function(e,t){var n=e.context;if(!ni(n)){if(!di(n))return void T._log.warn("A child control is trying to create a child context that has a parent control with a primitive type context");n=e.context={}}for(var i,r,o=t.split(".");0<o.length;)di(r=n[i=o.shift()])&&(r=_i(Number(o[0]))?n[i]=[]:n[i]={}),n=r;return n},T.unObserve=function(e){ei(!0,!0,e)},T.prototype.getContext=function(e,t){return this._getContext(e.join("."),e,t)},T.prototype.observe=function(n,e){var i=this;if(hi(n))return Kn;var r,o,t=n.split("."),s=t.pop(),a="length"===s,l=!di(e),u=this._hasIdentifier(n);if(0<t.length?(r=t.join("."),o=this._getContext(r,t,!0)):(r=s,o=this.context),!ni(o))return l?(a&&(this.__lengthListeners[n]=e,T.pushRemoveListener(n,e.uid,function(){Li(i.__lengthListeners,n)})),this._addObservableListener(n,e,a)):Kn;this.__observedIdentifier=null,this.__contextObjects[n]=o[s];var c=this.__observedIdentifier,h=!di(c),p=Kn;if(h&&(u=!0),l){var _=this._addObservableListener(n,e,a),f=Kn;h&&n!==c&&(f=this._addObservableListener(c,e,a)),p=function(){_(),f()}}var d=mi(o),v=p,m=Number(s),g=Kn,y=Kn;if(d&&m>=o.length)g=this.observe(r+".length",{uid:e.uid,listener:function(e,t){e<=m||(g(),i._define(n,o,s))}}),p=function(){v(),g()};else if(!u)if(d&&a){var b=t.pop(),C=this.getContext(t,!1);if(this.__observedIdentifier=null,Pi(C,b),li(this.__observedIdentifier)&&(r=this.__observedIdentifier),l){var x=e.uid;g=this.observeArrayMutation(x,Kn,r,o,null),y=this.observe(r,{uid:x,listener:function(e,t){g(),g=i.observeArrayMutation(x,Kn,r,e,t)}})}p=function(){v(),y(),g()}}else this._define(n,o,s);return p},T.prototype.observeArrayMutation=function(e,t,n,i,r){if(mi(r)&&this._restoreArray(r),di(i))return Kn;var o=n.split("."),s=o.pop(),a=this.getContext(o,!1);this.__observedIdentifier=null,Pi(a,s),li(this.__observedIdentifier)&&(n=this.__observedIdentifier);var l=[];return fi(t)&&l.push(this._pushArrayListener(e,n,t)),this._overwriteArray(n,i),function(){for(;0<l.length;)l.pop()()}},T.prototype.dispose=function(){this.context=null,this.__identifiers={},this.__identifierHash={},this.__contextObjects={}},T.prototype._pushArrayListener=function(t,n,i){var r=T.arrayChangeListeners,o=r[n];di(o)&&(o=r[n]={});var s=o[t];di(s)&&(s=o[t]=[]);var a=!1,l=function(){if(!a){a=!0,T.spliceRemoveListener(n,t,l);var e=s.indexOf(i);-1!==e&&(s.splice(e,1),0===s.length&&(Li(o,t),hi(o)&&Li(r,n)))}};return s.push(i),T.pushRemoveListener(n,t,l),l},T.prototype._restoreArray=function(e){var t=this._compat;if(t.setProto)Object.setPrototypeOf(e,Object.create(Array.prototype));else if(t.proto)e.__proto__=Object.create(Array.prototype);else for(var n=a.length,i=void 0,r=0;r<n;r+=1)e[i=a[r]]=Array.prototype[i]},T.prototype._overwriteArray=function(e,t){var n,i,r=this._compat,o=a.length;if(r.proto){var s=Object.create(Array.prototype);for(i=0;i<o;i+=1)s[n=a[i]]=this._overwriteArrayFunction(e,n);r.setProto?Object.setPrototypeOf(t,s):t.__proto__=s}else for(i=0;i<o;i+=1)T.defineProperty(t,n=a[i],this._overwriteArrayFunction(e,n),!1,!0,!0)},T.prototype._getContext=function(e,t,n){var i=this.__contextObjects[e];return di(i)&&(i=!0===n?this.__contextObjects[e]=this._observeImmediateContext(t,e):this._getImmediateContext(t)),i},T.prototype._getImmediateContext=function(e){for(var t=this.context;0<e.length&&!di(t=t[e.shift()]););return t},T.prototype._observeImmediateContext=function(e,t){return di(this.__identifiers[t])&&this.observe(t,null),this._getImmediateContext(e)},T.prototype._getValues=function(e,t,n){for(var i,r,o,s=ni(t),a=ni(n);1<e.length&&(i=e.shift(),s&&di(t=t[i])&&(s=!1),a&&di(n=n[i])&&(a=!1),s||a););return i=e[0],di(t)||(r=t[i]),di(n)||(o=n[i]),{newValue:r,oldValue:o}},T.prototype._notifyChildProperties=function(l,u,c,h){var p=this;if(!ni(h)){var e=this.__identifierHash[l];ni(e)||(e={}),h=Object.keys(e)}for(var _,f,d,v,m,g,y,b,C,x,E,t=h.length,w=l.length+1,T={},n=function(e){if(b=h[e],C=b.slice(w),E=C.split("."),f=E.pop(),d="length"===f,hi(x=E.join("."))){if(m=c,g=di(v=u)?void 0:v[f],y=di(m)?void 0:m[f],d&&!mi(m)&&mi(v)){var t=N.__lengthListeners[b];if(!di(t)){var n=t.uid,i=l.split("."),r=i.pop(),o=i.join("."),s=N._getContext(o,i,!1);N.__observedIdentifier=null,Pi(s,r),li(N.__observedIdentifier)&&(o=N.__observedIdentifier);var a=N.observeArrayMutation(n,Kn,o,v,null);N.observe(o,{uid:n,listener:function(e,t){a(),a=p.observeArrayMutation(n,Kn,o,e,t)}}),Li(N.__lengthListeners,b)}}}else di(_=T[x])&&(_=T[x]=N._getValues(E,u,c)),v=_.newValue,m=_.oldValue,g=di(v)?v:v[f],y=di(m)?m:m[f];T[C]={newValue:g,oldValue:y},ni(v)&&(!mi(v)||v.length>Number(f))&&N._define(b,v,f),N._execute(b,g,y)},N=this,i=0;i<t;i+=1)n(i);T=null},T.prototype._addObservableListener=function(e,t,n){var i=this;if(!0===n){var r=e.split(".");r.pop();var o=r.pop(),s=this.getContext(r,!1);ni(s)&&(this.__observedIdentifier=null,Pi(s,o),li(this.__observedIdentifier)&&(e=this.__observedIdentifier+(!0===n?".length":"")))}this.__add(e,t);var a=t.uid,l=function(){T.spliceRemoveListener(e,a,l),i._removeCallback(e,t)};return T.pushRemoveListener(e,a,l),l},T.prototype._define=function(e,t,n){ni(t[n])?this.__defineObject(e,t,n):this.__definePrimitive(e,t,n)},T.prototype._overwriteArrayFunction=function(C,x){var E=this,w=T.arrayChangeListeners[C];return ni(w)||(w={}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,i,r,o,s,a,l=this.length,u=ti(this,!0),c="unshift"===x,h="shift"===x,p="splice"===x,_=h||c||p,f="sort"===x||"reverse"===x;_?(E.__isArrayFunction=!0,a=Array.prototype[x].apply(this,e),E.__isArrayFunction=!1,o=this.length,r=0,h?s=(i=0)<l?[a]:[]:c?(i=e.length,s=[]):(i=e.length-2,r=e[0],s=a)):(a=Array.prototype[x].apply(this,e),o=this.length,f?n=u:"push"===x?(i=e.length,r=l,s=[]):"pop"===x&&(r=o,s=(i=0)<l?[a]:[])),(h||p||"pop"===x)&&T.unObserve(a);var d,v,m,g,y=Object.keys(w),b=y.length;for(m=0;m<b;m+=1)for(v=(d=w[y[m]]).length,g=0;g<v;g+=1)d[g]([{object:this,type:x,index:r,removed:s,addedCount:i,oldArray:n}]);return _?E._notifyChildProperties(C,this,u):E._execute(C+".length",o,l),a}},T.prototype._removeCallback=function(e,t){var n=this.__identifiers[e];if(!di(n)){var i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&Li(this.__contextObjects,e))}},T.prototype._hasIdentifier=function(e){return!hi(this.__identifiers[e])},T.prototype._execute=function(e,t,n){var i=this.__identifiers[e];if(vi(t)?Li(this.__contextObjects,e):this.__contextObjects[e]=t,t!==n&&!di(i))for(var r=i.slice(0),o=r.length,s=0;s<o;s+=1)r[s].listener(t,n)},T.prototype.__defineObject=function(o,s,a){var l=this,u=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!0,get:function(){return l.__observedIdentifier=o,u},set:function(e){if(u!==e){var t=u;if(u=e,!l.__isArrayFunction){T.unObserve(t);var n,i=l.__identifierHash[o],r=!1;ni(i)&&(r=0<(n=Object.keys(i)).length),l._execute(o,u,t),r?(l._notifyChildProperties(o,u,t,n),ni(u)||l.__definePrimitive(o,s,a)):hi(l.__identifiers[o])?T.defineProperty(s,a,u,!0,!0,!0):ni(u)||l.__definePrimitive(o,s,a)}}}})},T.prototype.__definePrimitive=function(o,s,a){var l=this,u=s[a],c=!di(u);mi(s)&&"length"===a||Object.defineProperty(s,a,{configurable:!0,enumerable:!0,get:function(){return l.__observedIdentifier=o,u},set:function(e){if(u!==e){var t=u;if(u=e,!l.__isArrayFunction||!mi(s)){var n,i=l.__identifierHash[o],r=!1;ni(i)&&(r=0<(n=Object.keys(i)).length),l._execute(o,e,t),!r&&hi(l.__identifiers[o])?T.defineProperty(s,a,u,!0,!0,!0):ni(u)?(l.__defineObject(o,s,a),r&&l._notifyChildProperties(o,e,t,n)):c||(l.__definePrimitive(o,s,a),c=!0)}}}})},T.prototype.__add=function(e,t){var n=t.priority,i=this.__identifiers[e],r=!1;if(di(i)&&(i=this.__identifiers[e]=[]),_i(n)){for(var o=i.length,s=0;s<o;s+=1)if(n>i[s].priority){i.splice(s,0,t),r=!0;break}}else t.priority=-1;r||i.push(t),this.__addHashValues(e)},T.prototype.__addHashValues=function(e){var t=this.__identifierHash;if(!ni(t[e])){t[e]={};var n,i,r,o,s=[],a=e;for(n=a.lastIndexOf(".");-1!==n;){for(i=t[a=a.slice(0,n)],o=s.length,di(i)&&(i=t[a]={}),i[e]=!0,r=0;r<o;r+=1)i[s[r]]=!0;s.push(a),n=a.lastIndexOf(".")}}},T.arrayChangeListeners={},T.__managers={},T.__controls={},T}();function n(e){return t._log=e,t}e.ContextManager=t,e.IContextManagerStatic=n,sr.injectable(Z,n,[k],yn),sr.injectable("$ContextManagerInstance",t,null,Cn)}(d.observable||(d.observable={})),function(e){var t=function(){function e(){this.defaultPrevented=!1,this.stopped=!1}return e.prototype.initialize=function(e,t,n){this.name=e,li(n)?this.direction=n:this.direction=this._EventManager.UP,this.sender=t},e.prototype.preventDefault=function(){this.defaultPrevented||this._ContextManager.defineGetter(this,"defaultPrevented",!0)},e.prototype.stopPropagation=function(){this.direction===this._EventManager.UP&&(this.stopped=!0,this._EventManager.propagatingEvents[this.name]=!1)},e._inject={_EventManager:N,_ContextManager:Z},e}();e.DispatchEvent=t,sr.injectable(l,t,null,Cn);var d=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return __extends(e,n),e.dispatch=function(e,t){var n=Cr(p);return n.initialize(e,t),o.sendEvent(n),n},e.prototype.initialize=function(e,t){n.prototype.initialize.call(this,e,t,this._EventManager.DIRECT)},e}(t);function n(){return d}e.LifecycleEvent=d,e.ILifecycleEventStatic=n,sr.injectable(h,n,null,yn),sr.injectable(p,d,null,Cn);var o=function(){function f(){}return f.initialize=function(){if(!f.__initialized){f.__initialized=!0;for(var e,t=f.__lifecycleEventListeners,n=f._compat,i=f._document,r=f._window,o=f._dom,s=d.dispatch;0<t.length;)e=t.pop(),i.removeEventListener(e.name,e.value,!1);if(n.cordova){for(var a,l=["resume","online",kt],u=n.winJs,c=l.length,h=function(e){return function(){s(e,f)}},p=void 0,_=0;_<c;_+=1)p=h(a=l[_]),t.push({name:a,value:p}),o.addEventListener(i,a,p,!1);p=h(Nt),t.push({name:"pause",value:p}),o.addEventListener(i,"pause",p,!1),p=h(Tt),t.push({name:At,value:p}),o.addEventListener(i,At,p,!1),p=function(){return u||s(Lt,f),!0},t.push({name:Lt,value:p}),o.addEventListener(i,Lt,p,!1),u&&(p=function(){return s(Lt,f),!0},t.push({name:Pt,value:p}),r.WinJS.Application.addEventListener(Pt,p,!1))}else{if(n.amd)return;o.addEventListener(r,"load",function(){s(Tt,f)})}}},f.dispose=function(e){Li(f.__eventsListeners,e)},f.on=function(e,t,n,i){var r=f.__eventsListeners[e];di(r)&&(r=f.__eventsListeners[e]={listeners:{},context:i});var o=r.listeners[t];return mi(o)||(o=r.listeners[t]=[]),o.push(n),function(){var e=o.indexOf(n);-1!==e&&o.splice(e,1)}},f.dispatch=function(e,t,n,i){var r=Cr(l);return r.initialize(e,t,n),f.sendEvent(r,i),r},f.hasDirection=function(e){return e===f.UP||e===f.DOWN||e===f.DIRECT},f.sendEvent=function(e,t){var n=e.name,i=e.direction;switch(mi(t)||(t=[]),f.propagatingEvents[n]=!0,i){case f.UP:f._dispatchUp(e,t);break;case f.DOWN:f._dispatchDown(e,t);break;case f.DIRECT:f._dispatchDirect(e,t)}Li(f.propagatingEvents,n)},f._dispatchUp=function(e,t){for(var n=e.name,i=e.sender;!di(i)&&f.propagatingEvents[n];)di(i.uid)||f.__executeEvent(i.uid,e,t),i=i.parent},f._dispatchDown=function(e,t){var n,i=e.name,r=[];for(r.push(e.sender);!hi(r.length)&&f.propagatingEvents[i];)di((n=r.pop()).uid)||(f.__executeEvent(n.uid,e,t),di(n.controls)||(r=r.concat(n.controls)))},f._dispatchDirect=function(e,t){for(var n,i=Object.keys(f.__eventsListeners),r=i.length,o=e.name,s=0;s<r&&f.propagatingEvents[o];s+=1)di(n=f.__eventsListeners[i[s]])||di(n.listeners[o])||f.__callListeners(n.context,e,n.listeners[o],t)},f.__executeEvent=function(e,t,n){var i=f.__eventsListeners[e];if(!di(i)){var r=i.context,o=i.listeners[t.name];di(o)||f.__callListeners(r,t,o,n)}},f.__callListeners=function(e,t,n,i){var r=t.name,o=n.length,s=-1;for(i=[t].concat(i),s+=1;s<o&&f.propagatingEvents[r];){try{n[s].apply(e,i)}catch(e){f._log.debug(e)}s+=1}},f.UP="up",f.DOWN="down",f.DIRECT="direct",f.propagatingEvents={},f.__eventsListeners={},f.__lifecycleEventListeners=[],f.__initialized=!1,f}();function i(e,t,n,i,r){return o._log=e,o._compat=t,o._document=n,o._window=i,o._dom=r,o}e.EventManager=o,e.IEventManagerStatic=i,sr.injectable(N,i,[k,X,G,Q,M],yn);var r=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return __extends(o,r),o.dispatch=function(e,t,n,i){var r=Cr(o);return r.initialize(e,t,null,n),r.logLevel=i,o._EventManager.sendEvent(r),r},o.prototype.initialize=function(e,t,n,i){r.prototype.initialize.call(this,e,t,this._EventManager.DIRECT),this.error=i},o}(t);function s(e){return r._EventManager=e,r}e.ErrorEvent=r,e.IErrorEventStatic=s,sr.injectable(c,s,[N],yn)}(kr=d.events||(d.events={}));var Or=function(){function S(){this.uid=Ri(he),this.priority=0,this.dom=S._dom,this.utils=Cr(U),this._log=S._log}return S.getRootControl=function(e){if(di(e))return e;if(!di(e.root))return e.root;for(;!di(e.parent)&&!e.hasOwnContext;){if(!di(e.root))return e.root;e=e.parent}return!e.hasOwnContext&&ni(e.context)&&S._log.debug("Root control: "+e.type+" found that sets its context to an Object but does not set the this.hasOwnContext = true."),e},S.load=function(n){var e=S._Promise;if(di(n))return e.resolve();var t=n;if(li(t.absoluteContextPath)){if(fi(t.contextChanged))S._ContextManager.getManager(t.root).observe(t.absoluteContextPath,{uid:n.uid,priority:1e3,listener:function(e,t){Mr.TemplateControl.contextChanged(n,e,t)}}),fi(t.zCC__plat)&&(t.zCC__plat(),Li(t,"zCC__plat"));var i=t.element;oi(i)&&fi(i.removeAttribute)&&i.removeAttribute(Ot)}return fi(n.loaded)?e.resolve(n.loaded()):e.resolve()},S.dispose=function(e){var t=e;if(!di(t))if(vi(t.templateControl)){if(t.hasOwnContext)Mr.ViewControl.dispose(t);else if(t.controls)Mr.TemplateControl.dispose(t);else if(fi(e.dispose)&&e.dispose(),S.removeEventListeners(e),S._ContextManager.dispose(e),e.element=null,S.removeParent(e),e.__injectable__type===yn){var n=_r[e.type];sr.control(e.type,e.constructor,n.dependencies,!0)}}else Dr.dispose(t)},S.removeParent=function(e){if(!di(e)){var t=e.parent;if(!di(t)){var n=t.controls;mi(n)||(n=[]);var i=n.indexOf(e);-1!==i&&n.splice(i,1),e.parent=null}}},S.removeEventListeners=function(e){if(!di(e)){var t=S.__eventListeners,n=e.uid,i=t[n];if(mi(i)){for(var r=i.length;0<r;)i[r-=1]();Li(t,n)}}},S.getInstance=function(){return new S},S.__addRemoveListener=function(e,t){var n=S.__eventListeners;mi(n[e])?n[e].push(t):n[e]=[t]},S.__spliceRemoveListener=function(e,t){var n=S.__eventListeners[e];if(mi(n)){var i=n.indexOf(t);if(-1===i)return;n.splice(i,1)}},S.__getControls=function(e,t,n){var i,r=[],o=S.getRootControl(e);di(o)||o[t]!==n||r.push(o);var s=o.controls;if(di(s))return r;for(var a=[].concat(s);0<a.length;)(i=a.shift())[t]===n&&r.push(i),di(i.controls)||(a=a.concat(i.controls));return r},S.prototype.initialize=function(){},S.prototype.loaded=function(){},S.prototype.getControlsByName=function(e){return S.__getControls(this,"name",e)},S.prototype.getControlsByType=function(e){return li(e)?S.__getControls(this,"type",e):S.__getControls(this,"constructor",e)},S.prototype.addEventListener=function(e,t,n,i){if(!fi(n))return this._log.warn('"Control.addEventListener" must take a function as the third argument.'),Kn;n=n.bind(this);var r=this.dom.addEventListener(e,t,n,i),o=this.uid;return S.__addRemoveListener(o,r),function(){r(),S.__spliceRemoveListener(o,r)}},S.prototype.observe=function(n,i){var e,r=this,t=ni(this.context)?this:this.parent,o=S.getRootControl(t);if(di(t))return Kn;if(di(t.absoluteContextPath))return this._log.warn("Should not call plat.Control.observe prior to the control being loaded"),Kn;var s=S._parser;if(ni(s)||(s=Cr(J)),hi(i))e=t.absoluteContextPath;else if(li(i)){var a=s.parse(i);1<a.identifiers.length&&this._log.warn("Only a single identifier can be observed when calling the function plat.Control.observe");var l=a.identifiers[0];if("@"===l[0]){var u=l.split("."),c=u.shift().slice(1),h=0<u.length?"."+u.join("."):"";e=c===Mn?W+h:c===$n?t.absoluteContextPath+h:t.absoluteContextPath+"."+l}else e=t.absoluteContextPath+"."+l}else e=t.absoluteContextPath+"."+i;var p=S._ContextManager;return ni(p)||(p=Cr(Z)),p.getManager(o).observe(e,{listener:function(e,t){n.call(r,e,t,i)},uid:this.uid})},S.prototype.observeArray=function(t,n){var e,i,r=ni(this.context)?this:this.parent,o=r.context;if(di(r)||!ni(o))return Kn;var s=S._parser;if(ni(s)||(s=Cr(J)),hi(n))e=o,i=r.absoluteContextPath;else if(li(n)){var a=s.parse(n);e=a.evaluate(o),i=r.absoluteContextPath+"."+a.identifiers[0]}else e=o[n],i=r.absoluteContextPath+"."+n;if(!mi(e))return Kn;if(!fi(t))return Kn;t=t.bind(this);var l=S._ContextManager;ni(l)||(l=Cr(Z));var u=l.getManager(S.getRootControl(r)),c=this.uid,h=function(e){t(e,n)},p=u.observeArrayMutation(c,h,i,e,null),_=u.observe(i,{listener:function(e,t){p(),p=u.observeArrayMutation(c,h,i,e,t)},uid:c});return function(){p(),_()}},S.prototype.observeExpression=function(t,n){var i=this;if(hi(n))return Kn;var e=S._parser;if(ni(e)||(e=Cr(J)),li(n))n=e.parse(n);else if(!fi(n.evaluate))return Kn;var r=di(this.resources)?this.parent:this;if(di(r)||!li(r.absoluteContextPath))return Kn;var o=S._ContextManager;ni(o)||(o=Cr(Z));var s,a,l,u,c=n.aliases,h={},p=o.getManager,_=Mr.TemplateControl,f=_.findResource,d=_.evaluateExpression,v=c.length;for(u=0;u<v;u+=1)s=c[u],di(a=f(r,s))||(l=a.resource.type)!==Rn&&l!==On||(h[s]=p(a.control));var m,g,y=p(S.getRootControl(r)),b=r.absoluteContextPath,C=b+".",x={},E=n.identifiers;for(v=E.length,u=0;u<v;u+=1)g=(m=E[u]).split(".")[0],"@"!==m[0]?x[C+m]=y:(s=g.slice(1))===$n?x[b+m.replace(g,"")]=y:s===Mn?x[m.replace(g,"context")]=y:(m=m.replace(g,"resources."+s+".value"),di(h[s])||(x[m]=h[s]));v=(E=Object.keys(x)).length;var w=d(n,r),T=[],N=this.uid,k=function(){var e=d(n,r);t.call(i,e,w,n.expression),w=e};for(u=0;u<v;u+=1)m=E[u],T.push(x[m].observe(m,{uid:N,listener:k}));return function(){for(var e=T.length,t=0;t<e;t+=1)T[t]()}},S.prototype.evaluateExpression=function(e,t){return Mr.TemplateControl.evaluateExpression(e,this.parent,t)},S.prototype.findProperty=function(e,t){var n=S._parser;ni(n)||(n=Cr(J));var i,r=n.parse(e);for(di(t)&&(t=this);!di(t);){if(!di(i=r.evaluate(t)))return{expression:r,control:t,value:i};t=t.parent}},S.prototype.dispatchEvent=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=S._EventManager;ni(r)||(r=Cr(N)),r.hasDirection(t)||(vi(t)||n.unshift(t),t=r.UP);var o=this;di(o.templateControl)||(o=o.templateControl),r.dispatch(e,o,t,n)},S.prototype.on=function(e,t){var n=S._EventManager;return ni(n)||(n=Cr(N)),n.on(this.uid,e,t,this)},S.prototype.dispose=function(){},S.__eventListeners={},S}();function Fr(e,t,n,i,r,o){return Or._parser=e,Or._ContextManager=t,Or._EventManager=n,Or._Promise=i,Or._dom=r,Or._log=o,Or}d.Control=Or,d.IControlFactory=Fr,sr.injectable(T,Fr,[J,Z,N,w,M,k],xn);var Mr,Dr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateControl=null,e}return __extends(e,t),e.dispose=function(e){Li(e,"templateControl"),Or.dispose(e)},e.getInstance=function(){return new e},e}(Or);function $r(){return Dr}d.AttributeControl=Dr,d.IAttributeControlFactory=$r,sr.injectable("$AttributeControlFactory",$r,null,xn),function(e){var c=function(t){function h(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=100,e.context=null,e.absoluteContextPath=null,e.hasOwnContext=!1,e.replaceWith="any",e}return __extends(h,t),h.evaluateExpression=function(e,t,n){if(hi(e))return e;if(li(e))e=h._parser.parse(e);else if(!fi(e.evaluate))return e;return di(t)?e.evaluate(null,n):0<e.aliases.length&&hi(n=h.getResources(t,e.aliases,n))?void 0:e.evaluate(t.context,n)},h.getResources=function(e,t,n){if(di(e))return{};var i,r,o,s=t.length,a=h.__resourceCache[e.uid];di(a)&&(a=h.__resourceCache[e.uid]={}),ni(n)||(n={});for(var l=0;l<s;l+=1)if("@"===(i=t[l])[0]&&(i=i.slice(1)),i!==$n)if(i!==Mn){if(di(n[i])){if(di(a[i]))o=h.findResource(e,i);else{var u=a[i].control,c=u.resources;o=di(c)?h.findResource(e,i):{control:u,resource:c[i]}}if(di(o)){if(-1!==e.type.indexOf(wn))continue;h._log.warn("Resource alias: "+i+" is not defined.")}else r=(a[i]=o).resource,n[i]=di(r)?r:r.value}}else n[i]=Or.getRootControl(e).context;else n[i]=e.context;return n},h.findResource=function(e,t){var n;if(!di(e)&&!di(e.resources)&&li(t)&&!hi(t)){"@"===t[0]&&(t=t.slice(1));var i=t===Mn;if(i||t===$n||t===Dn){if(i&&(e=Or.getRootControl(e)),ni(e.resources)&&(n=e.resources[t]),di(n))return;return{resource:n,control:e}}for(;!di(e);){if(ni(e.resources)&&(n=e.resources[t]),!di(n))return{resource:n,control:e};e=e.parent}}},h.dispose=function(e){if(!di(e)){var t=e.uid,n=e.controls,i=mi(n)?n.slice(0):n,r=Or._ContextManager,o=r.defineProperty;if(!di(i))for(var s=i.length-1;0<=s;s-=1)Or.dispose(i[s]);if(fi(e.dispose)&&e.dispose(),Or.removeEventListeners(e),h.removeElement(e),h._ResourcesFactory.dispose(e),h._BindableTemplatesFactory.dispose(e),Li(h.__resourceCache,e.uid),r.dispose(e),kr.EventManager.dispose(e.uid),h._managerCache.remove(t),Or.removeParent(e),o(e,"resources",null,!0,!0,!0),e.attributes=null,e.bindableTemplates=null,e.controls=[],e.root=null,e.innerTemplate=null,e.__injectable__type===yn){var a=_r[e.type];sr.control(e.type,e.constructor,a.dependencies,!0)}}},h.loadControl=function(e){for(var t,n=e.controls,i=n.length,r=0;r<i;r+=1)di((t=n[r]).controls)?t.loaded():h.loadControl(t);e.loaded()},h.contextChanged=function(e,t,n){e.context=t,h.setContextResources(e),fi(e.contextChanged)&&e.contextChanged(t,n)},h.setContextResources=function(e){var t=e.context;di(e.resources)&&(e.resources=h._ResourcesFactory.getInstance(),e.resources.initialize(e)),e.hasOwnContext&&(di(e.resources.rootContext)?e.resources.add({root:{type:Rn,value:t}}):e.resources.rootContext.value=t),di(e.resources.context)?e.resources.add({context:{type:Rn,value:t}}):e.resources.context.value=t},h.removeElement=function(e){if(!di(e)){var t,n=e.element;if(null===e.replaceWith||""===e.replaceWith||si(n))return er(e.startNode,e.endNode),void(e.elementNodes=e.startNode=e.endNode=null);di(n)||(di(t=n.parentNode)||t.removeChild(n),e.element=null)}},h.setAbsoluteContextPath=function(e,t){Or._ContextManager.defineGetter(e,"absoluteContextPath",t,!1,!0)},h.determineTemplate=function(t,e){var n=h._templateCache,i=t.dom,r=h._Promise;if(di(e)){if(di(t.templateUrl)){if(di(t.templateString))return r.reject(null);var o=t.type;return n.read(o).catch(function(e){return di(e)&&(e=t.templateString),n.put(o,e)})}e=t.templateUrl}else;return i.getTemplate(e)},h.detach=function(e){if(!di(e)&&!di(e.controls)){for(var t=e.controls.slice(0),n=t.length,i=0;i<n;i+=1)Or.dispose(t[i]);Or.removeEventListeners(e),h.removeElement(e),h._ResourcesFactory.dispose(e,!0),Li(h.__resourceCache,e.uid),Or._ContextManager.dispose(e),kr.EventManager.dispose(e.uid),h._managerCache.remove(e.uid),Or.removeParent(e),e.controls=[],e.attributes=null}},h.getInstance=function(){return new h},h.prototype.contextChanged=function(e,t){},h.prototype.setTemplate=function(){},h.prototype.getResources=function(e,t){return h.getResources(this,e,t)},h.prototype.findResource=function(e){return h.findResource(this,e)},h.prototype.evaluateExpression=function(e,t){return h.evaluateExpression(e,this,t)},h.__resourceCache={},h}(Or);function t(e,t,n,i,r,o,s,a){return c._ResourcesFactory=e,c._BindableTemplatesFactory=t,c._managerCache=n,c._templateCache=i,c._parser=r,c._http=o,c._Promise=s,c._log=a,c}e.TemplateControl=c,e.ITemplateControlFactory=t,sr.injectable(z,t,[$,F,A,L,J,C,w,k],xn),sr.injectable(B,c,null,Cn);var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=120,e._listeners=[],e}return __extends(e,t),e.prototype.onInput=function(t){var n=this._listeners;return n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}},e.prototype.observeProperties=function(e){},e.prototype.inputChanged=function(e,t){if(e!==t)for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](e,t)},e.prototype.dispose=function(){this._listeners=[]},e}(c);e.BindControl=h;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasOwnContext=!0,e}return __extends(e,t),e.dispose=function(e){c.dispose(e)},e.getInstance=function(){return new e},e.prototype.canNavigateFrom=function(){},e.prototype.canNavigateTo=function(e,t){},e.prototype.navigatingFrom=function(){},e.prototype.navigatedTo=function(e,t){},e}(c);e.ViewControl=n;var i=function(){function e(){this._domEvents=Cr(D)}return e.prototype.addEventListener=function(e,t,n,i){return this._domEvents.addEventListener(e,t,n,i)},e.prototype.appendChildren=function(e,t){return Hi(e,t)},e.prototype.cloneChildren=function(e,t){return Hi(e,t,!0)},e.prototype.clearNode=function(e){Qi(e)},e.prototype.clearNodeBlock=function(e,t){Yi(e,t)},e.prototype.setInnerHtml=function(e,t){return Wi(e,t)},e.prototype.insertBefore=function(e,t,n){return Xi(e,t,n)},e.prototype.replace=function(e){return Gi(e)},e.prototype.replaceWith=function(e,t){return Ji(e,t)},e.prototype.serializeHtml=function(e){return Ki(e)},e.prototype.removeBetween=function(e,t){Zi(e,t)},e.prototype.removeAll=function(e,t){er(e,t)},e.prototype.addClass=function(e,t){ir(e,t)},e.prototype.removeClass=function(e,t){rr(e,t)},e.prototype.toggleClass=function(e,t){!function(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){var o=void 0;if(""===n)e.className=t;else if(n===t)return e.className="";for(;0<r.length;)if(""!==(i=r.shift())){if((o=new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g")).test(n)){e.className=n=n.replace(o,"");continue}e.className+=" "+i}}else for(;0<r.length;)""!==(i=r.shift())&&e.classList.toggle(i)}}(e,t)},e.prototype.replaceClass=function(e,t,n){!function(e,t,n){ni(e)||(e={});var i=e.className;if(li(i)&&li(n)&&""!==n)if(vi(e.classList)){var r=new RegExp("^"+t+"\\s+","g"),o=new RegExp("\\s+"+t+"\\s+","g"),s=new RegExp("\\s+"+t+"$","g");e.className=i.replace(r,n+" ").replace(o," "+n+" ").replace(s," "+n)}else e.classList.add(n),e.classList.remove(t)}(e,t,n)},e.prototype.hasClass=function(e,t){return or(e,t)},e.prototype.getTemplate=function(e){return n=e,ni(g)||(g=d.acquire(L)),ni(y)||(y=d.acquire(C)),g.put(n,g.read(n).catch(function(e){if(di(e))return y.ajax({url:n})}).then(function(e){if(si(e))return g.put(n,e);if(!ni(e)||!li(e.response))return ni(b)||(b=d.acquire(k)),b.warn("No template found at "+n),g.put(n);var t=e.response;return hi(t.trim())?g.put(n):g.put(n,t)}).catch(function(e){return ki(function(){ni(b)||(b=d.acquire(k)),b.error(new Error("Failure to get template from "+n+"."))}),e}));var n},e.prototype.whenPresent=function(e,t){return function(e,t){if(!oi(t))return ni(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check DOM presence of something that isn't a Node.")),Kn;ni(m)||(m=d.acquire(G));var n=m.body;if(oi(t.parentElement)&&n.contains(t))return e(),Kn;var i=Ii(function(){oi(t.parentElement)&&n.contains(t)&&(i(),e())},100);return i}(e,t)},e.prototype.whenVisible=function(e,t){return function(e,t){if(!oi(t))return ni(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check visibility of something that isn't a Node.")),Kn;var n=t.clientWidth,i=t.clientHeight;if(!_i(n)||!_i(i))return ni(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check visibility of something that isn't an Element.")),Kn;if(0<n&&0<i)return e(),Kn;var r=Ii(function(){0<t.clientWidth&&0<t.clientHeight&&(r(),e())},100);return r}(e,t)},e._inject={_domEvents:D},e}();e.Dom=i,sr.injectable(M,i);var r=function(){function s(){this._ResourcesFactory=Cr($),this._ControlFactory=Cr(T),this._TemplateControlFactory=Cr(z),this._ContextManager=Cr(Z),this._Promise=Cr(w),this._managerCache=Cr(A),this._document=Cr(G),this._ElementManagerFactory=Cr(I),this._BindableTemplatesFactory=Cr(F),this._log=Cr(k),this.templates={},this.cache={},this.__compiledControls=[]}return s.create=function(e,t){var n=new s;return n.control=e,di(t)||(n.templates=t.templates,n.cache=t.cache),n},s.dispose=function(e){if(!di(e)){var t=e.bindableTemplates;!di(t)&&fi(t.dispose)&&t.dispose()}},s.isBoundControl=function(e){if(di(e))return!1;var t=e.parent;return!di(t)&&0===e.type.indexOf(t.type+Tn)},s.prototype.once=function(e,t,n){var i,r=this;if(di(e))return this._Promise.resolve(this._document.createDocumentFragment());if(li(e))i=Ki(e);else if(si(e))i=e;else if(i=this._document.createDocumentFragment(),oi(e))i.appendChild(e);else{if(!gi(e))return this._Promise.resolve(i);Hi(e,i)}if(di(t)||_i(t)||li(t)){var o=this.control,s=this._managerCache.read(o.uid),a=this._ElementManagerFactory.getInstance(),l=this._createBoundControl("",i,t,n),u=this._createNodeMap(l,i,t);return o.controls.push(l),s.children=[],a.initialize(u,s),a.setUiControlTemplate(),a.fulfillAndLoad().then(function(){var e=r._document;return l.startNode=i.insertBefore(e.createComment(l.type+kn),i.firstChild),l.endNode=i.insertBefore(e.createComment(l.type+Sn),null),i})}this._log.warn(this.control.type+" using relativeIdentifier: "+t+", need a string or number")},s.prototype.bind=function(e,t,n){return this._bind(e,t,n)},s.prototype.add=function(e,t,n){if(hi(e))this._log.debug(this.control.type+" must use a valid key to add a template to BindableTemplates.");else if((di(this.templates[e])||n)&&!di(t))if(li(t))this._compile(e,Ki(t));else if(si(t))this._compile(e,t);else{var i=this._document.createDocumentFragment();if(oi(t))i.appendChild(t);else{if(!gi(t))return;Hi(t,i)}this._compile(e,i)}},s.prototype.replace=function(e,t,n,i){var r=this.control.controls[e];if(!s.isBoundControl(r))return this._log.warn("The child control of "+this.control.type+" at the specified index: "+e+" is not a bound control."),this._Promise.resolve([]);var o=r.endNode;return oi(o)&&oi(o.parentNode)?this._bind(t,n,i,e):(this._log.warn("The child control of "+this.control.type+" at the specified index: "+e+" needs place-holding comment nodes."),this._Promise.resolve([]))},s.prototype.dispose=function(){for(var e=this._TemplateControlFactory.dispose,t=this.__compiledControls,n=t.length,i=0;i<n;i+=1)e(t[i]);this.__compiledControls=[],this.control=null,this.cache={},this.templates={}},s.prototype._bind=function(r,o,s,a){var l=this,e=this.templates[r],u=di(a);if(di(e))this._log.error(new Error(this.control.type+" cannot bind template, no template stored with key: "+r));else{if(di(o)||_i(o)||li(o))return e=e.then(function(e){var t=e.cloneNode(!0),n=l._createBoundControl(r,t,o,s),i=l._createNodeMap(n,t,o);return u&&l.control.controls.push(n),l._bindTemplate(r,i)}),u?e.then(null,function(e){return ki(function(){li(e)&&(e=new Error(e)),l._log.error(e)}),l._document.createDocumentFragment()}):e.then(function(e){var t=Array.prototype.slice.call(e.childNodes),n=l.control.controls[a],i=n.endNode,r=i.parentNode,o=i.nextSibling;return l._TemplateControlFactory.dispose(n),r.insertBefore(e,o),t}).then(null,function(e){return ki(function(){li(e)&&(e=new Error(e)),l._log.error(e)}),l._document.createDocumentFragment()});this._log.warn(this.control.type+" trying to bind: "+o+". Identifier must be either a string or number")}},s.prototype._bindTemplate=function(e,n){var i=this,r=n.uiControlNode.control,o=!1,t=fi(r.dispose)?r.dispose.bind(r):Kn;return r.dispose=function(){o=!0,t(),r.dispose=t},this._bindNodeMap(e,n).then(function(){var e=i._document,t=n.element;return o?e.createDocumentFragment():(r.startNode=t.insertBefore(e.createComment(r.type+kn),t.firstChild),r.endNode=t.insertBefore(e.createComment(r.type+Sn),null),t)},function(e){return ki(function(){li(e)&&(e=new Error(e)),i._log.error(e)}),null})},s.prototype._bindNodeMap=function(e,t){var n=this.cache[e],i=t.uiControlNode.control,r=t.element,o=this._managerCache;return n.clone(r,o.read(this.control.uid),t),o.read(i.uid).bindAndLoad()},s.prototype._compile=function(e,t){var n=this._createBoundControl(e+wn,t),i=this._createNodeMap(n,t);this.__compiledControls.push(n),this._compileNodeMap(n,i,e)},s.prototype._compileNodeMap=function(o,s,e){var a=this,t=this._ElementManagerFactory.getInstance(),n=[];t.isClone=!0,t.initialize(s,null),t.setUiControlTemplate(),this.cache[e]=t,n.push(t.fulfillTemplate()),this.templates[e]=this._Promise.all(n).then(function(){var e=s.element,t=e.cloneNode(!0),n=a._document,i=o.startNode=n.createComment(o.type+kn),r=o.endNode=n.createComment(o.type+Sn);return e.insertBefore(i,e.firstChild),e.insertBefore(r,null),t})},s.prototype._createNodeMap=function(e,t,n){return{element:t,attributes:{},nodes:[],childContext:n,uiControlNode:{control:e,nodeName:e.type,expressions:[],injector:null}}},s.prototype._createBoundControl=function(e,t,n,i){var r=this._TemplateControlFactory.getInstance(),o=this._ResourcesFactory,s=this.control,a=this.cache[e],l=ni(a),u=o.getInstance();if(l){var c=a.getUiControl();u.initialize(r,c.resources),u.add(i)}else u.initialize(r,i);if(r.resources=u,o.addControlResources(r),r.bindableTemplates=this._BindableTemplatesFactory.create(r,s.bindableTemplates),r.parent=s,r.controls=[],r.element=t,r.type=s.type+Tn+e,r.root=this._ControlFactory.getRootControl(r),l){var h=this._ContextManager.getManager(r.root);r.absoluteContextPath=s.absoluteContextPath,li(r.absoluteContextPath)||(r.absoluteContextPath=W),di(n)||(r.absoluteContextPath+="."+n),r.context=h.getContext(r.absoluteContextPath.split("."),!1)}return r},s}();function o(){return r}e.BindableTemplates=r,e.IBindableTemplatesFactory=o,sr.injectable(F,o,null,xn);var s=function(){function e(){this.__listeners={}}return e.getInstance=function(){return new e},e.prototype.initialize=function(e,t){this.__control=e;for(var n,i=Object.keys(t),r=this.__listeners,o=i.length,s=0;s<o;s+=1)this[n=i[s]]=t[n],r[n]=[]},e.prototype.observe=function(t,e){var n=this.__listeners[Ai(e)];return di(n)?Kn:(t=t.bind(this.__control),n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)})},e.prototype._attributeChanged=function(e,t,n){for(var i=this.__listeners[Ai(e)],r=i.length,o=0;o<r;o+=1)i[o](t,n)},e}();function a(){return s}e.Attributes=s,e.IAttributesFactory=a,sr.injectable("$AttributesInstance",s,null,Cn),sr.injectable(O,a,null,xn);var l=function(){function p(){this.__resources={},this.__bound=!1}return p.create=function(e,t){if(di(t))return t;var n;switch(t.type.toLowerCase()){case An:var i=vr[t.value];di(i)||(t.value=i.inject());break;case Rn:p._observeResource(e,t);break;case Ln:li(n=t.value)&&(t.value=e.evaluateExpression(n));break;case On:break;case Pn:li(n=t.value)&&(fi(n=e[n])?t.value=n.bind(e):(p._log.warn('Attempted to create a "function" type Resource, but the function '+n+" cannot be found on your control."),t.value=Kn))}return t},p.addControlResources=function(e){e.resources.add({context:{value:e.context,type:Rn},control:{value:e,type:Ln}}),e.hasOwnContext&&p.__addRoot(e)},p.bindResources=function(e){var t=e.__resources;if(!di(t)){for(var n,i=e.__controlInstance,r=Object.keys(t),o=p.__controlResources,s=r.length,a=0;a<s;a+=1)!0!==o[n=r[a]]&&(e[n]=t[n]=p.create(i,e[n]));e.__bound=!0}},p.dispose=function(e,t){var n=e.resources;if(!di(n)){for(var i,r,o=Object.keys(n.__resources),s=o.length,a=p._ContextManager.defineProperty,l=0;l<s;l+=1)di(r=n[i=o[l]])||r.type!==Rn&&r.type!==On||a(n,i,t?ti(r,!0):null,!0,!0,!0);p._removeListeners(n.__controlInstance)}},p.parseElement=function(e){for(var t,n,i,r,o,s=Array.prototype.slice.call(e.children),a=p._regex,l=a.whiteSpaceRegex,u=a.quotationRegex,c={},h=p.__resourceTypes;0<s.length;)h[r=(t=s.pop()).nodeName.toLowerCase()]&&(n={},di(i=t.attributes.getNamedItem("alias"))||(n.alias=i.value,hi(o=t.textContent.replace(l,"$1"))||(n.value=r===An||r===On?o.replace(u,""):o,n.type=r,c[n.alias]=n)));return c},p.getInstance=function(){return new p},p._observeResource=function(e,t){var n=e.uid,i=t.value,r=p.__observableResourceRemoveListeners[n];if(di(r)&&(r=p.__observableResourceRemoveListeners[n]=[]),li(i)){di(t.initialValue)?t.initialValue=i:i=t.initialValue;var o=e.observeExpression(function(e){t.value=e},i);t.value=e.evaluateExpression(i),r.push(o)}},p._removeListeners=function(e){if(!di(e)){var t=e.uid,n=p.__observableResourceRemoveListeners[t];if(mi(n))for(var i=n.length,r=0;r<i;r+=1)n[r]();Li(p.__observableResourceRemoveListeners,t)}},p.__addRoot=function(e){e.resources.add({root:{value:e,type:Ln,alias:Fn},rootContext:{value:e.context,type:Rn,alias:Mn}})},p.prototype.initialize=function(e,t){if(this.__controlInstance=e,!di(t)){oi(t)?t=p.parseElement(t):ni(t.resources)&&(t=t.resources),this.__resources=t;for(var n,i=Object.keys(t),r=i.length,o=0;o<r;o+=1)this[n=i[o]]=t[n]}},p.prototype.add=function(e){if(!di(e)){oi(e)&&(e=p.parseElement(e));for(var t,n,i=Object.keys(e),r=i.length,o=this.__controlInstance,s=this.__bound,a=p.create,l=0;l<r;l+=1)this[(t=e[n=i[l]]).alias=n]=this.__resources[n]=s?a(o,t):t}},p.INJECTABLE=An,p.OBJECT=Ln,p.OBSERVABLE=Rn,p.LITERAL=On,p.FUNCTION=Pn,p.__observableResourceRemoveListeners={},p}();function u(e,t,n){l._ContextManager=e,l._regex=t,l._log=n;var i={},r={};return i[Dn]=i[$n]=i[Fn]=i[Mn]=!0,r[An]=r[Ln]=r[Rn]=r[Pn]=r[On]=!0,l.__controlResources=i,l.__resourceTypes=r,l}e.Resources=l,e.IResourcesFactory=u,sr.injectable($,u,[Z,K,k],xn),sr.injectable("$ResourcesInstance",l,null,Cn);var p=function(){function d(){this._gestures=d.gestures,this._androidVersion=vi(this._compat.ANDROID)?-1:this._compat.ANDROID,this._android44orBelow=-1<this._androidVersion&&Math.floor(this._androidVersion/10)<=44,this._inMouse=!1,this._subscribers={},this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__hasMoved=!1,this.__hasRelease=!1,this.__detectingMove=!1,this.__tapCount=0,this.__touchCount=0,this.__cancelDeferredTap=Kn,this.__cancelDeferredHold=Kn,this.__cancelRegex=/cancel/i,this.__pointerEndRegex=/up|cancel/i,this.__haveSwipeSubscribers=!1,this.__blurRemover=Kn,this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__boundPreventDefaultClick=this.__preventDefaultClick.bind(this),this.__reverseMap={},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this.__pointerHash={},this.__pointerEvents=[],this.__listeners={},this.__getTypes(),this.initialize()}return d.prototype.addEventListener=function(e,t,n,i){var r=this,o=this._compat,s=o.mappedEvents[t],a=!di(s),l=this.__mappedCount,u=this._gestures,c=!1;if(a&&(this.__reverseMap[s]=t,this.__registerElement(e,t),l[t]+=1,o.hasTouchEvents&&!this.__cancelRegex.test(s)&&(s=s.replace("touch","mouse").replace("start","down").replace("end","up"),this.__reverseMap[s]=t)),e.addEventListener(t,n,i),!vi(e["on"+t])||vi(u[t])||a)return function(){c||(a&&(0<l[t]&&(l[t]-=1),r.__unregisterElement(e,t)),c=!0,e.removeEventListener(t,n,i))};var h=u.$swipe,p=u.$track,_=t;if(-1!==t.indexOf(p)){var f=u.$trackend;_=t===f?f:p}else-1!==t.indexOf(h)&&(_=h);return this._gestureCount[_]+=1,this.__registerElement(e,t),function(){c||(c=!0,r.__removeEventListener(e,t,n,i))}},d.prototype.initialize=function(){var e=this._isActive;!0!==e&&(this.__registerTypes(),di(e)&&this.__appendGestureStyle(),this._isActive=!0)},d.prototype.dispose=function(){this.__unregisterTypes(),this.__blurRemover(),this.__blurRemover=Kn,this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this._isActive=!1,this._subscribers={},this.__pointerEvents=[],this.__pointerHash={},this.__reverseMap={},this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__tapCount=this.__touchCount=0,this.__detectingMove=this.__hasMoved=this.__hasRelease=this.__haveSwipeSubscribers=!1,this.__lastMoveEvent=this.__lastTouchDown=this.__lastTouchUp=null,this.__swipeOrigin=this.__capturedTarget=this.__focusedElement=this.__delayedClickRemover=null,this.__cancelDeferredHold=this.__cancelDeferredTap=Kn},d.prototype._onTouchStart=function(e){var t=this,n=e.type;if(this.__ignoreEvent[n])return this.__ignoreEvent[n]=!1,this.__delayedClickRemover[n](),e.target===this.__focusedElement||(!0===e.cancelable&&e.preventDefault(),!1);if(0<this.__touchCount)return this.__touchCount+=1,!0;if(this.__touchCount+=1,"mousedown"!==n)this._inTouch=!0;else{if(!0===this._inTouch)return e.preventDefault(),!1;this._compat.hasTouchEvents&&(this._inMouse=!0)}if(di(e=this.__standardizeEventObject(e)))return!0;this.__lastMoveEvent=null,this.__hasMoved=!1;var i=e.clientX,r=e.clientY,o=e.timeStamp,s=e.target,a=this._gestures;this.__lastTouchDown={_buttons:e._buttons,clientX:i,clientY:r,timeStamp:o,target:s,identifier:e.identifier},this.__swipeOrigin={clientX:i,clientY:r,xTimestamp:o,yTimestamp:o,xTarget:s,yTarget:s},this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(s,[a.$swipe,a.$swipedown,a.$swipeleft,a.$swiperight,a.$swipeup]).length);var l=this._gestureCount,u=l.$hold<=0,c=l.$release<=0;if(u&&c)return this.__handleMappedEvents(n,e,e),this.__registerMove(n),!0;var h,p,_,f=d.config.intervals.holdInterval;if(u)return this.__hasRelease=!1,this.__cancelDeferredHold=Si(function(){t.__hasRelease=!0},f),this.__handleMappedEvents(n,e,e),this.__registerMove(n),!0;c?(_=!di(h=this.__findFirstSubscriber(e.target,this._gestures.$hold)))&&(p=function(){h.trigger(e),t.__cancelDeferredHold=Kn}):(this.__hasRelease=!1,(_=!di(h=this.__findFirstSubscriber(e.target,this._gestures.$hold)))&&(p=function(){h.trigger(e),t.__hasRelease=!0,t.__cancelDeferredHold=Kn})),_&&(this.__cancelDeferredHold=Si(p,f)),this.__handleMappedEvents(n,e,e),this.__registerMove(n)},d.prototype._onTouchMove=function(e){this.__cancelDeferredHold(),this.__cancelDeferredHold=Kn;var t=e.type;if(!0===this._inTouch&&"mousemove"===t)return!0;var n=this.__standardizeEventObject(e);if(di(n))return!0;var i=this._gestureCount,r=i.$track<=0,o=i.$swipe<=0,s=d.config,a=this.__swipeOrigin,l=n.clientX,u=n.clientY,c=this.__hasMoved;if(c||(c=this.__getDistance(a.clientX,l,a.clientY,u)>=s.distances.minScrollDistance),!c)return this.__handleMappedEvents(t,e,n),!0;if(this.__hasMoved=!0,r&&o)return this.__handleMappedEvents(t,e,n),!0;var h=this.__lastMoveEvent;ni(h)||(h=a);var p=n.direction=this.__getDirection(l-h.clientX,u-h.clientY);this.__handleOriginChange(p);var _=Math.abs(l-a.clientX),f=Math.abs(u-a.clientY);n.velocity=this.__getVelocity(_,f,n.timeStamp-a.xTimestamp,n.timeStamp-a.yTimestamp),!o&&this._android44orBelow&&this.__haveSwipeSubscribers&&e.preventDefault(),r||this.__handleTrack(n,e),this.__handleMappedEvents(t,e,n),this.__lastMoveEvent=n},d.prototype._onTouchEnd=function(e){var n=this,t=e.type;if(this.__ignoreEvent[t])return this.__ignoreEvent[t]=!1,this.__delayedClickRemover[t](),e.target===this.__focusedElement||(!0===e.cancelable&&e.preventDefault(),ki(function(){var e=n.__lastTouchUp;ni(e)||(e={});var t=e.target;n._document.body.contains(t)&&n.__handleInput(t)}),!1);var i=this.__hasMoved,r="mouseup"!==t;if(r){if("touchend"===t){if(i)!0===e.cancelable&&e.preventDefault();else{if(!0!==this._inTouch)return!0===e.cancelable&&e.preventDefault(),this.__preventClickFromTouch(),!(this.__touchCount=0);e.target!==this.__focusedElement&&this.__handleInput(e.target)&&!0===e.cancelable&&e.preventDefault()}this.__preventClickFromTouch()}}else if(!vi(this._inTouch)){if(!this._inMouse)return!0===e.cancelable&&e.preventDefault(),!1;this._inMouse=!1}if(this.__cancelRegex.test(t))return this.__handleCanceled(e),!0;if(this.__touchCount<=0?this.__touchCount=0:this.__touchCount-=1,di(e=this.__standardizeEventObject(e)))return!0;r&&(this._inTouch=!1),0<this.__touchCount&&(this.__touchCount=e._touches.length),this.__clearTempStates(),this.__hasRelease&&this.__handleRelease(e),this.__handleSwipe();var o=d.config,s=o.intervals,a=e.timeStamp,l=this.__lastTouchDown;if(i)return this.__handleTrackEnd(e),this.__handleMappedEvents(t,e,e),this.__tapCount=0,!(this.__capturedTarget=null);if(di(l)||a-l.timeStamp>s.tapInterval)return this.__handleMappedEvents(t,e,e),this.__tapCount=0,!(this.__capturedTarget=null);var u=this.__lastTouchUp,c=e.clientX,h=e.clientY;0<this.__tapCount&&this.__getDistance(c,u.clientX,h,u.clientY)<=o.distances.maxDblTapDistance&&a-u.timeStamp<=s.dblTapInterval?this.__handleDbltap(e):this.__tapCount=0,this.__handleTap(e),this.__handleMappedEvents(t,e,e),this.__lastTouchUp=e,this.__capturedTarget=null},d.prototype.__clearTempStates=function(){this.__cancelDeferredHold(),this.__cancelDeferredHold=Kn,this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1)},d.prototype.__resetTouchEnd=function(){this.__tapCount=this.__touchCount=0,this._inTouch=this.__hasRelease=!1,this.__pointerHash={},this.__pointerEvents=[],this.__capturedTarget=null},d.prototype.__handleCanceled=function(e){var t=e.touches;ni(t)||(t=this.__pointerEvents);var n=this.__getTouchIndex(t),i=e.type;e=0<=n?t[n]:this.__standardizeEventObject(e),this._inTouch=!1,this.__clearTempStates(),this.__hasMoved&&(this._android44orBelow&&this.__handleSwipe(),this.__handleTrackEnd(e)),this.__handleMappedEvents(i,e,e),this.__resetTouchEnd()},d.prototype.__handleMappedEvents=function(e,t,n){var i=this.__reverseMap[e];if(0<this.__mappedCount[i]){var r=this.__findFirstSubscriber(t.target,i);di(r)||r.trigger(n)}},d.prototype.__handleTap=function(e){var t=this,n=e.target,i=this.__lastTouchDown;ni(i)||(i={});var r=i.target;if(this.__tapCount+=1,!(this._gestureCount.$tap<=0||di(r)||r!==n&&fi(r.contains)&&!r.contains(n)&&fi(n.contains)&&!n.contains(r))){var o=this._gestures,s=this.__findFirstSubscriber(n,o.$tap);if(!di(s))return d.config.intervals.dblTapZoomDelay<=0||"mouse"===e.pointerType||"mouseup"===e.type?(e._buttons=i._buttons,void s.trigger(e)):void(this.__cancelDeferredTap=Si(function(){e._buttons=i._buttons,s.trigger(e),t.__tapCount=0,t.__cancelDeferredTap=Kn},d.config.intervals.dblTapZoomDelay))}},d.prototype.__handleDbltap=function(e){if(this.__tapCount=0,this.__cancelDeferredTap(),this.__cancelDeferredTap=Kn,!(this._gestureCount.$dbltap<=0)){var t=this.__findFirstSubscriber(e.target,this._gestures.$dbltap);di(t)||(e._buttons=this.__lastTouchDown._buttons,t.trigger(e),this.__tapCount=-1)}},d.prototype.__handleRelease=function(e){var t=this.__findFirstSubscriber(e.target,this._gestures.$release);di(t)||t.trigger(e),this.__hasRelease=!1},d.prototype.__handleSwipe=function(){if(!(this._gestureCount.$swipe<=0)){var e=this.__lastMoveEvent;if(!di(e)){for(var t=this.__swipeOrigin,n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY),r=this.__getRegisteredSwipes(e.direction,e.velocity,n,i);0<r.length;)r.pop().trigger(e);this.__lastMoveEvent=null}}},d.prototype.__handleTrack=function(e,t){var n=this._gestures,i=n.$track,r=e.direction,o=this.__capturedTarget;ni(o)||(o=e.target);var s=this.__findFirstSubscribers(o,[i,i+r.x,i+r.y]);this._android44orBelow&&(0<this.__findFirstSubscribers(o,[i,n.$trackdown,n.$trackup,n.$trackleft,n.$trackright,n.$trackend]).length&&t.preventDefault());if(0<s.length)for(-1<this._androidVersion&&t.preventDefault();0<s.length;)s.pop().trigger(e)},d.prototype.__handleTrackEnd=function(e){if(!(this._gestureCount.$trackend<=0)){var t=this.__capturedTarget;ni(t)||(t=e.target);var n=this.__findFirstSubscriber(t,this._gestures.$trackend);di(n)||n.trigger(e)}},d.prototype.__getTypes=function(){var e,t,n,i=this._compat,r=i.mappedEvents,o=this.__listeners;if(i.hasPointerEvents)e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+" "+r.$touchcancel;else if(i.hasTouchEvents)e=this._startEvents=r.$touchstart+" mousedown",t=this._moveEvents=r.$touchmove+" mousemove",n=this._endEvents=r.$touchend+" mouseup "+r.$touchcancel;else{var s=r.$touchcancel;e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+(hi(s)?"":" "+s)}o[e]=this._onTouchStart.bind(this),o[t]=this._onTouchMove.bind(this),o[n]=this._onTouchEnd.bind(this)},d.prototype.__registerTypes=function(){this.__registerType(this._startEvents),this.__registerType(this._endEvents),this._document.addEventListener("dragstart",this.__preventDefault,!1)},d.prototype.__unregisterTypes=function(){this.__unregisterType(this._startEvents),this.__unregisterType(this._endEvents),this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1),this._document.removeEventListener("dragstart",this.__preventDefault,!1)},d.prototype.__registerType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;0<r;)r-=1,n.addEventListener(i[r],t,!1)},d.prototype.__unregisterType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;0<r;)r-=1,n.removeEventListener(i[r],t,!1)},d.prototype.__registerMove=function(e){var t=this._gestureCount;("touchstart"===e||0<this.__mappedCount.$touchmove||0<t.$track||0<t.$trackend||0<t.$swipe)&&(this.__registerType(this._moveEvents),this.__detectingMove=!0)},d.prototype.__registerElement=function(e,t){var n,i,r=e.__plat;if(di(r)?(n=Ri("domEvent_"),e.__plat=r={domEvent:n}):di(r.domEvent)&&(n=Ri("domEvent_"),r.domEvent=n),di(n)){var o=this._subscribers[r.domEvent];return vi(o[t])?(i=new v(e,t),o[t]=i):o[t].count+=1,void(o.gestureCount+=1)}var s={gestureCount:1};i=new v(e,t),s[t]=i,this._subscribers[n]=s,vi(e.className)||ir(e,d.config.styleConfig[0].className),this.__removeSelections(e)},d.prototype.__unregisterElement=function(e,t){var n=e.__plat;if(!di(n)&&!di(n.domEvent)){var i=n.domEvent,r=this._subscribers[i],o=r[t];di(o)||(o.count-=1,0===o.count&&Li(r,t),r.gestureCount-=1,0===r.gestureCount&&(Li(this._subscribers,i),this.__removeElement(e)))}},d.prototype.__setTouchPoint=function(e){var t=e.type,n=this._compat;n.hasPointerEvents||n.hasMsPointerEvents?this.__updatePointers(e,this.__pointerEndRegex.test(t)):e.pointerType=-1===t.indexOf("mouse")?"touch":"mouse"},d.prototype.__setCapture=function(e){di(this.__capturedTarget)&&!ri(e)&&(this.__capturedTarget=e)},d.prototype.__updatePointers=function(e,t){var n,i=e.pointerId,r=this.__pointerHash,o=r[i];if(t)vi(o)||(-1<(n=this.__pointerEvents.indexOf(o))&&this.__pointerEvents.splice(n,1),Li(this.__pointerHash,i));else{if(1===i&&!hi(r))return;e.identifier=e.pointerId,n=this.__pointerEvents.indexOf(o),vi(o)||n<0?this.__pointerEvents.push(e):this.__pointerEvents.splice(n,1,e),r[i]=e}},d.prototype.__findFirstSubscriber=function(e,t){var n,i;if(!di(e))do{if(!vi(n=e.__plat)&&!vi(n.domEvent)&&!vi(i=this._subscribers[n.domEvent][t]))return i}while(!di(e=e.parentNode))},d.prototype.__findFirstSubscribers=function(e,t){if(di(e))return[];var n,i,r,o,s,a=[];do{if(!vi(n=e.__plat)&&!vi(n.domEvent))for(i=this._subscribers[n.domEvent],r=Object.keys(i);0<r.length;)o=r.pop(),-1!==(s=t.indexOf(o))&&(a.push(i[o]),t.splice(s,1))}while(0<t.length&&!di(e=e.parentNode));return a},d.prototype.__removeEventListener=function(e,t,n,i){var r=this._gestures;e.removeEventListener(t,n,i);var o=r.$swipe,s=r.$track,a=t;if(-1!==t.indexOf(s)){var l=r.$trackend;a=t===l?l:s}else-1!==t.indexOf(o)&&(a=o);this._gestureCount[a]-=1,this.__unregisterElement(e,t)},d.prototype.__removeElement=function(e){this.__returnSelections(e),vi(e.className)||rr(e,d.config.styleConfig[0].className);var t=e.__plat;Li(t,"domEvent"),hi(t)&&Li(e,"__plat")},d.prototype.__standardizeEventObject=function(e){this.__setTouchPoint(e);var t,n=-1!==this._startEvents.indexOf(e.type),i=e.changedTouches,r=!vi(i),o=e.timeStamp,s=e.touches;if(ni(s)||(s=this.__pointerEvents),r)if(n)t=e.preventDefault.bind(e),(e=i[0]).preventDefault=t;else{var a=this.__getTouchIndex(i);if(0<=a)t=e.preventDefault.bind(e),(e=i[a]).preventDefault=t;else if(0<=this.__getTouchIndex(s))return null}return n&&this.__setCapture(e.target),this.__normalizeButtons(e),e._touches=s,e.offset=this.__getOffset(e),(vi(e.timeStamp)||o>e.timeStamp)&&(e.timeStamp=o),e},d.prototype.__normalizeButtons=function(e){var t;if(_i(e.buttons)&&0!==e.buttons)t=e.buttons;else if(_i(e.which)&&0<e.which)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}e._buttons=t},d.prototype.__getTouchIndex=function(e){var t=this.__lastTouchDown;ni(t)||(t={});for(var n=t.identifier,i=e.length,r=0;r<i;r+=1)if(e[r].identifier===n)return r;return-1},d.prototype.__getOffset=function(e){var t,n,i=this.__capturedTarget;if(ni(i)||(i=e.target),ri(i))return{x:e.clientX,y:e.clientY};if(!vi(e.offsetX)&&!vi(e.offsetY)&&i===e.target)return{x:e.offsetX,y:e.offsetY};if(fi(i.getBoundingClientRect)){var r=i.getBoundingClientRect();t=r.left,n=r.top}else for(t=i.offsetLeft,n=i.offsetTop;!di(i=i.offsetParent);)t+=i.offsetLeft,n+=i.offsetTop;return{x:e.clientX-t,y:e.clientY-n}},d.prototype.__getDistance=function(e,t,n,i){var r=t-e,o=i-n;return Math.sqrt(r*r+o*o)},d.prototype.__getVelocity=function(e,t,n,i){var r=0,o=0;return 0<n&&(r=e/n),0<i&&(o=t/i),isFinite(r)||(r=0),isFinite(o)||(o=0),{x:r,y:o}},d.prototype.__getDirection=function(e,t){var n=Math.abs(e),i=Math.abs(t),r=this.__lastMoveEvent;ni(r)||(r={});var o=r.direction;ni(o)||(o={x:"none",y:"none",primary:"none"});var s=o.x,a=o.y,l=o.primary;hi(s)&&(s="none"),hi(a)&&(a="none"),hi(l)&&(l="none");var u=0===e?s:e<0?"left":"right",c=0===t?a:t<0?"up":"down";return{x:u,y:c,primary:n===i?l:i<n?u:c}},d.prototype.__handleOriginChange=function(e){var t=this.__lastMoveEvent;if(!di(t)){var n=t.direction,i=n.x===e.x,r=n.y===e.y;if(!i||!r){var o=this.__swipeOrigin,s=this._gestures,a=[s.$swipe,s.$swipedown,s.$swipeleft,s.$swiperight,s.$swipeup];i||(o.clientX=t.clientX,o.xTimestamp=t.timeStamp,o.xTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(o.xTarget,a).length)),r||(o.clientY=t.clientY,o.yTimestamp=t.timeStamp,o.yTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(o.yTarget,a).length))}}},d.prototype.__getRegisteredSwipes=function(e,t,n,i){var r,o=this._gestures.$swipe,s=d.config.velocities.minSwipeVelocity,a=[o],l=this.__swipeOrigin;return ni(l)||(l={}),i<n?(r=l.xTarget,t.x>=s&&a.push(o+e.x)):n<i&&(r=l.yTarget,t.y>=s&&a.push(o+e.y)),this.__findFirstSubscribers(r,a)},d.prototype.__isHorizontal=function(e){return"left"===e||"right"===e},d.prototype.__appendGestureStyle=function(){var e,t,n=this._document;if(!this._compat.platCss)if(!di(n.styleSheets)&&0<n.styleSheets.length){var i=n.styleSheets[0];for(t=(e=d.config.styleConfig).length;0<t;)t-=1,i.insertRule(this.__createStyle(e[t]),0)}else{var r=n.head,o=n.createElement("style"),s="";for(o.type="text/css",t=(e=d.config.styleConfig).length;0<t;)t-=1,s=this.__createStyle(e[t])+s;o.textContent=s,r.appendChild(o)}},d.prototype.__createStyle=function(e){var t=e.styles;mi(t)||(t=[]);var n=t.length,i="."+e.className+" { ",r="";n=t.length;for(var o=0;o<n;o+=1)r+=t[o]+";";return i+=r+" } "},d.prototype.__blurFocusedElement=function(){var e=this.__focusedElement;ni(e)||(e={}),fi(e.blur)&&e.blur()},d.prototype.__waitForBlur=function(e){var t=this;this.__blurRemover=this.addEventListener(e,"blur",function(){t.__blurRemover(),t.__blurRemover=Kn,e===t.__focusedElement&&(t.__focusedElement=null)},!1)},d.prototype.__clickTarget=function(e){var t=this,n=!1,i=function(){n=!0,e.removeEventListener("click",i,!1)};e.addEventListener("click",i,!1),ki(function(){n||(e.removeEventListener("click",i,!1),t._document.body.contains(e)&&fi(e.click)&&e.click())})},d.prototype.__handleInput=function(e){this.__blurRemover();var t=e.nodeName;if(!li(t))return this.__focusedElement=null,void this.__blurFocusedElement();var n=!0;switch(t.toLowerCase()){case"input":switch(e.type){case"range":this.__blurFocusedElement();break;case"text":case"password":case"email":case"number":case"tel":case"search":case"url":e.focus(),this.__waitForBlur(e);break;default:this.__blurFocusedElement(),this.__clickTarget(e)}break;case"a":case"button":case"label":this.__blurFocusedElement(),this.__clickTarget(e);break;case"textarea":e.focus(),this.__waitForBlur(e);break;case"select":n=!1;break;default:this.__blurFocusedElement(),this.__clickTarget(e)}return this.__focusedElement=e,n},d.prototype.__preventClickFromTouch=function(){var e=this._document,t=this.__ignoreEvent,n=this.__boundPreventDefaultClick,i=d.config.intervals.delayedClickInterval;i<=0||(this.__delayedClickRemover={mousedown:Si(function(){t.mousedown=!1},i),mouseup:Si(function(){t.mouseup=!1},i),click:Si(function(){e.removeEventListener("click",n,!0)},i)},t.mousedown=t.mouseup=!0,ki(function(){e.addEventListener("click",n,!0)}))},d.prototype.__preventDefaultClick=function(e){return e.preventDefault(),e.stopImmediatePropagation(),this._document.removeEventListener("click",this.__boundPreventDefaultClick,!0),this.__delayedClickRemover.click(),!1},d.prototype.__removeSelections=function(e){oi(e)&&(vi(e.onselectstart)||e.addEventListener("selectstart",this.__preventDefault,!1),vi(e.ondragstart)||e.addEventListener("dragstart",this.__preventDefault,!1))},d.prototype.__returnSelections=function(e){oi(e)&&(vi(e.onselectstart)||e.removeEventListener("selectstart",this.__preventDefault,!1),vi(e.ondragstart)||e.removeEventListener("dragstart",this.__preventDefault,!1))},d.prototype.__preventDefault=function(e){var t=e.target.nodeName;return li(t)&&(t=t.toLowerCase()),"input"===t||"textarea"===t||(e.preventDefault(),!1)},d._inject={_document:G,_compat:X},d.config={intervals:{tapInterval:300,dblTapInterval:300,holdInterval:400,dblTapZoomDelay:0,delayedClickInterval:400},distances:{minScrollDistance:3,maxDblTapDistance:10},velocities:{minSwipeVelocity:.645},styleConfig:[{className:"plat-gesture",styles:["-moz-user-select: none","-khtml-user-select: none","-webkit-touch-callout: none","-webkit-user-select: none","-webkit-user-drag: none","-webkit-tap-highlight-color: transparent","-webkit-overflow-scrolling: touch","-ms-user-select: none","-ms-touch-action: manipulation","touch-action: manipulation"]},{className:"plat-no-touch-action",styles:["-ms-touch-action: none","touch-action: none"]}]},d.gestures={$tap:Ht,$dbltap:Qt,$hold:Jt,$release:Kt,$swipe:Zt,$swipeleft:en,$swiperight:tn,$swipeup:nn,$swipedown:rn,$track:on,$trackleft:sn,$trackright:an,$trackup:ln,$trackdown:un,$trackend:cn},d}();function _(){return p.config}e.DomEvents=p,sr.injectable(D,p),e.IDomEventsConfig=_,sr.injectable("$IDomEventsConfig",_);var f=function(){function e(){this._document=Cr(G)}return e.prototype.initialize=function(e,t,n){this.element=e,this.event=t,this.eventType=li(n)?n:"CustomEvent"},e.prototype.trigger=function(e,t,n){var i=this._document.createEvent(this.eventType);return ni(e)&&ei(!1,!1,i,e),i.initCustomEvent(this.event,!0,!0,di(t)?0:t),oi(n)||(n=this.element),n.dispatchEvent(i)},e}();e.DomEvent=f,sr.injectable("$DomEventInstance",f,null,Cn);var v=function(i){function e(e,t){var n=i.call(this)||this;return n.count=0,n.element=e,n.event=t,n.count+=1,n}return __extends(e,i),e.prototype.trigger=function(e){var t=this._document.createEvent("CustomEvent"),n=this.element,i=e.target;this.__extendEventObject(t,e),t.initCustomEvent(this.event,!0,!0,0);var r=ri(n)||n.contains(i)?i.dispatchEvent(t):n.dispatchEvent(t);return r||e.preventDefault(),r},e.prototype.__extendEventObject=function(e,t){var n=t.pointerType;e.clientX=t.clientX,e.clientY=t.clientY,e.offsetX=t.offset.x,e.offsetY=t.offset.y,e.direction=di(t.direction)?{x:"none",y:"none",primary:"none"}:t.direction,e.touches=t._touches,e.velocity=di(t.velocity)?{x:0,y:0}:t.velocity,e.identifier=di(t.identifier)?0:t.identifier,e.pointerType=_i(n)?this.__convertPointerType(n,t.type):n,e.screenX=t.screenX,e.screenY=t.screenY,e.pageX=t.pageX,e.pageY=t.pageY,e.buttons=t._buttons},e.prototype.__convertPointerType=function(e,t){switch(e){case MSPointerEvent.MSPOINTER_TYPE_MOUSE:return"mouse";case MSPointerEvent.MSPOINTER_TYPE_PEN:return"pen";case MSPointerEvent.MSPOINTER_TYPE_TOUCH:return"touch"}return-1===t.indexOf("mouse")?"touch":"mouse"},e}(f);!function(e){var t=function(){function e(){this._animatedElements={}}return e.prototype.create=function(e,t,n){return this._create(e,t,n,{key:null})},e.prototype.animate=function(e,t,n){return this._animate(e,t,n,{key:null})},e.prototype.enter=function(e,t,n,i,r){return this._animate(e,t,r,{key:"enter",parent:n,refChild:i})},e.prototype.leave=function(e,t,n){return this._animate(e,t,n,{key:"leave"})},e.prototype.move=function(e,t,n,i,r){return this._animate(e,t,r,{key:"move",parent:n,refChild:i})},e.prototype.show=function(e,t,n){return this._animate(e,t,n,{key:"show"})},e.prototype.hide=function(e,t,n){return this._animate(e,t,n,{key:"hide"})},e.prototype.all=function(t){for(var n=this,e=t.length,i=[],r=new s(function(e){n._Promise.all(t).then(function(){e()})}),o=0;o<e;o+=1)i=i.concat(t[o].getInstances());return r.initialize(i),r.then(Kn)},e.prototype.resolve=function(){var t=new s(function(e){e(function(){return t})});return t},e.prototype._animate=function(e,t,n,i){var r=this._create(e,t,n,i),o=r.current;return r.previous.then(function(){ji(function(){o.start()})}),o},e.prototype._create=function(u,e,c,h){var t,p=this,n=yr[e],_=[],f=[];if((!this._compat.animationSupported||vi(n))&&vi(n=br[e]))return u=this.__constructAnimatableElements(u,{inject:Kn},f,_),this._handlePreInitFunctionality(u,f,h),this._handlePostInitFunctionality(u,f,h),this._handleEndFunctionality(u,f,h),{previous:t=this.resolve(),current:t};u=this.__constructAnimatableElements(u,n,f,_);var d=f.length;if(0===d)return this._handlePreInitFunctionality(u,f,h),this._handlePostInitFunctionality(u,f,h),this._handleEndFunctionality(u,f,h),{previous:t=this.resolve(),current:t};this._handlePreInitFunctionality(u,f,h);var i,v=Ri("animation_"),r=this.__setAnimationId(v,f),m=new s(function(a){var l=p._Promise;i=l.all(r).then(function(){for(var e=[],t=0;t<d;t+=1)e.push(_[t].instantiate(f[t],c));p._handlePostInitFunctionality(u,f,h);var n=l.all(e),i=p.__isParentAnimating(f),r=p.__generateAnimatedElement(v,f,m);if(!di(i)){p._handleEndFunctionality(u,f,h),r.animationEnd(!0);var o=p._animatedElements[i],s=ci(o.promise)?function(){return o.promise}:function(){return m};n.then(function(){a(s)})}p.__stopChildAnimations(f),r.promise=m,n.then(function(){p._handleEndFunctionality(u,f,h),r.animationEnd(),a(function(){return m})})})});return m.initialize(_),{previous:i,current:m}},e.prototype._handlePreInitFunctionality=function(e,t,n){switch(n.key){case"move":for(var i=0;i<length;i+=1)nr(e[i])}},e.prototype._handlePostInitFunctionality=function(e,t,n){var i,r;switch(n.key){case"enter":case"move":var o,s=n.refChild;if(oi(s)?o=s.parentNode:(o=n.parent,s=null),!oi(o))break;for(i=e.length,r=0;r<i;r+=1)o.insertBefore(e[r],s);break;case"show":for(i=t.length,r=0;r<i;r+=1)t[r].removeAttribute(Ot)}},e.prototype._handleEndFunctionality=function(e,t,n){var i,r;switch(n.key){case"leave":for(i=e.length,r=0;r<i;r+=1)nr(e[r]);break;case"hide":for(i=t.length,r=0;r<i;r+=1)t[r].setAttribute(Ot,"")}},e.prototype.__setAnimationId=function(e,t){for(var n,i,r,o=this._animatedElements,s=[],a=t.length,l=0;l<a;l+=1)vi(i=(r=t[l]).__plat)?(r.__plat={animation:e},ir(r,Ft)):vi(i.animation)?(i.animation=e,ir(r,Ft)):(vi(n=o[i.animation])||(s.push(n.promise),n.animationEnd(!0)),i.animation=e);return s},e.prototype.__generateAnimatedElement=function(s,a,l){var u=this._animatedElements;return u[s]={animationEnd:function(e){var t,n,i,r=a.length;if(!0===e)return l.cancel(),void Li(u,s);for(var o=0;o<r;o+=1)ni(t=(n=a[o]).__plat)||(t={}),vi(i=t.animation)||i!==s||(rr(n,Ft),Li(t,"animation"),hi(t)&&Li(n,"__plat"));Li(u,s)}}},e.prototype.__isParentAnimating=function(e){for(var t,n=e[0];!ri(n=n.parentNode)&&!di(n)&&n.nodeType===Node.ELEMENT_NODE;)if(or(n,Ft)){var i=n.__plat;if(ni(i)||(i={}),li(t=i.animation)){if(!di(this._animatedElements[t]))return t;Li(i,"animation"),hi(i)&&Li(n,"__plat"),rr(n,Ft)}}},e.prototype.__stopChildAnimations=function(e){for(var t,n,i,r,o=this._animatedElements,s=Array.prototype.slice,a=e.length,l=0;l<a;l+=1)for(t=s.call(e[l].querySelectorAll("."+Ft));0<t.length;)ni(i=t.pop().__plat)||(i={}),di(r=i.animation)||(ni(n=o[r])||(n={}),fi(n.animationEnd)&&n.animationEnd(!0))},e.prototype.__constructAnimatableElements=function(e,t,n,i){if(!mi(e))if(si(e))e=Array.prototype.slice.call(e.childNodes);else if(gi(e))e=Array.prototype.slice.call(e);else{if(!oi(e)||e.nodeType!==Node.ELEMENT_NODE)return[];e=[e]}for(var r,o=e.length,s=0;s<o;s+=1)oi(r=e[s])&&r.nodeType===Node.ELEMENT_NODE&&(n.push(r),i.push(t.inject()));return e},e._inject={_compat:X,_Promise:w,_document:G},e}();e.Animator=t,sr.injectable(P,t);var s=function(i){function e(e,t){var n=i.call(this,e)||this;return n._Promise=Cr(w),n.__animationState=0,n.__animationInstances=[],di(t)||(n.__animationInstances=t.__animationInstances,n.__animationState=t.__animationState),n}return __extends(e,i),e.prototype.initialize=function(e){hi(this.__animationInstances)&&(mi(e)?this.__animationInstances=e:ni(e)&&(this.__animationInstances=[e]))},e.prototype.getInstances=function(){return this.__animationInstances},e.prototype.start=function(){if(!(0<this.__animationState)){for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;i+=1)fi((e=t[i]).start)&&e.start();this.__animationState=1}},e.prototype.pause=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;r+=1)fi((e=t[r]).pause)&&n.push(e.pause());return this._Promise.all(n).then(Kn)},e.prototype.resume=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;r+=1)fi((e=t[r]).resume)&&n.push(e.resume());return this._Promise.all(n).then(Kn)},e.prototype.cancel=function(){if(2===this.__animationState)return this;for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;i+=1)fi((e=t[i]).cancel)&&e.cancel(),fi(e.end)&&e.end();return this.__animationState=2,this},e.prototype.isCanceled=function(){return 2===this.__animationState},e.prototype.then=function(e,t){return i.prototype.then.call(this,e)},e.prototype.catch=function(e){return i.prototype.catch.call(this,e)},e}(Er.Promise);e.AnimationPromise=s;var n=function(){function e(){this.__eventListeners=[]}return e.prototype.initialize=function(){},e.prototype.start=function(){},e.prototype.end=function(){for(var e=this.__eventListeners;0<e.length;)e.pop()();fi(this._resolve)&&(this._resolve(),this._resolve=null)},e.prototype.pause=function(){return this._Promise.resolve()},e.prototype.resume=function(){return this._Promise.resolve()},e.prototype.cancel=function(){this.end()},e.prototype.addEventListener=function(e,t,n){if(!fi(t))return this._log.warn('An animation\'s "addEventListener" must take a function as the second argument.'),Kn;t=t.bind(this);var i=this.dom.addEventListener(this.element,e,function(e){e.stopPropagation(),t(e)},n),r=this.__eventListeners;return r.push(i),function(){i();var e=r.indexOf(i);-1!==e&&r.splice(e,1)}},e.prototype.instantiate=function(e,t){var n=this;this.element=e,this.options=t;var i=new s(function(e){n._resolve=e,n.initialize()});return i.initialize(this),i},e._inject={_window:Q,_compat:X,_log:k,_Promise:w,dom:M,utils:U},e}(),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animationEvents=e._compat.animationEvents,e}return __extends(e,t),e.prototype.animationStart=function(e){return this.addEventListener(this._animationEvents.$animationStart,e,!1)},e.prototype.animationEnd=function(e){return this.addEventListener(this._animationEvents.$animationEnd,e,!1)},e.prototype.animationIteration=function(e){return this.addEventListener(this._animationEvents.$animationIteration,e,!1)},e.prototype.transitionStart=function(e){return this.addEventListener(this._animationEvents.$transitionStart,e,!1)},e.prototype.transitionEnd=function(e){return this.addEventListener(this._animationEvents.$transitionEnd,e,!1)},e}(e.BaseAnimation=n),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=Mt,e._cancelAnimation=Kn,e}return __extends(e,t),e.prototype.initialize=function(){ir(this.element,this.className+Nn)},e.prototype.start=function(){var s=this;this._cancelAnimation=ji(function(){var e=s.element,t=s.className;if(null===e.offsetParent)return s._dispose(),void s.end();ir(e,t);var n=s._animationEvents.$animation,i=s.options;ni(i)||(i={});var r=s._window.getComputedStyle(e,i.pseudo),o=r[n+"Name"];if(""===o||"none"===o||"paused"===r[n+"PlayState"])return s._dispose(),void s.end();i.preserveInit||rr(e,t+Nn),s._cancelAnimation=s.animationEnd(function(){s._cancelAnimation=ji(function(){s._dispose(),s.end()})})})},e.prototype.pause=function(){var t=this;if(this._cancelAnimation===Kn)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(e){ji(function(){t._cancelAnimation!==Kn&&(t.element.style[n.$animation+"PlayState"]="paused"),e()})})},e.prototype.resume=function(){var t=this;if(this._cancelAnimation===Kn)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(e){ji(function(){t._cancelAnimation!==Kn&&(t.element.style[n.$animation+"PlayState"]="running"),e()})})},e.prototype.cancel=function(){this._cancelAnimation(),this._dispose(),this.end()},e.prototype._dispose=function(){var e=this.className;rr(this.element,e+" "+e+Nn),this._cancelAnimation=Kn},e}(e.CssAnimation=i);e.SimpleCssAnimation=r,sr.animation(Mt,r);var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=Ut,e}return __extends(e,t),e}(r);e.FadeIn=o,sr.animation(Ut,o);var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=Vt,e}return __extends(e,t),e}(r);e.FadeOut=a,sr.animation(Vt,a);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=$t,e}return __extends(e,t),e}(r);e.Enter=l,sr.animation($t,l);var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=zt,e}return __extends(e,t),e}(r);e.Leave=u,sr.animation(zt,u);var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=Bt,e}return __extends(e,t),e}(r);e.Move=c,sr.animation(Bt,c);var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className=Dt,e._animationCanceled=Kn,e._normalizeRegex=/-/g,e._nonNumRegex=/[^\-0-9\.]/g,e._normalizedKeys={},e._transitionCount=0,e._count=0,e._started=!1,e._usingCss=!1,e}return __extends(e,t),e.prototype.initialize=function(){ir(this.element,this.className+Nn)},e.prototype.start=function(){var p=this;this._animationCanceled=ji(function(){var e=p.element,t=p.className;null===e.offsetParent&&(p._animate(),p._dispose(),p.end()),ir(e,t),p._started=!0;var n=p.utils,i=p._animationEvents.$transition,r=p.options;ni(r)||(r={});for(var o,s=p._window.getComputedStyle(e,r.pseudo),a=p._properties=s[i+"Property"].split(","),l=s[i+"Duration"].split(","),u=a.length,c=u,h=!1;0<u;)""===(o=a[u-=1])||"none"===o?a.splice(u,1):1<c&&"all"===o&&(p._log.debug('Improper transition declaration on class "'+e.className+'"'),a.splice(u,1));if(0===a.length)h=!0;else{for(u=l.length;0<u&&(""===(o=l[u-=1])||"0s"===o););u<0&&(h=!0)}if(h)return p._animate(),p._dispose(),void p.end();n.isNumber(r.count)&&0<r.count&&(p._count=r.count),!1===r.preserveInit&&rr(e,t+Nn),p._animationCanceled=p.transitionEnd(p._done),p._animate()||(n.isEmpty(r.properties)?p.__cssTransition(s,l):(p._dispose(),p.end()))})},e.prototype.cancel=function(){this._animationCanceled(),this._started||this._animate(),this._dispose(),this.end()},e.prototype._dispose=function(){var e=this.className;rr(this.element,e+" "+e+Nn),this._animationCanceled=Kn},e.prototype._done=function(e){var t=e.propertyName;if(li(t)){this._transitionCount+=1;var n=this._transitionCount;if(t=t.replace(this._normalizeRegex,"").toLowerCase(),n<this._count||!this._usingCss&&!0===this._normalizedKeys[t]&&n<this._properties.length)return}this._dispose(),this.end()},e.prototype._animate=function(){var e=this._normalizedKeys,t=this._normalizeRegex,n=this.options;ni(n)||(n={});var i=this.options.properties;ni(i)||(i={});var r,o,s,a=Object.keys(i),l=a.length,u=0,c=this.element.style;for(ni(c)||(c={});0<a.length;)o=c[r=a.shift()],li(s=i[r])?(c[r]=s,o===c[r]?u+=1:e[r.replace(t,"").toLowerCase()]=!0):u+=1;return u<l},e.prototype._toMs=function(e){var t=this._nonNumRegex,n=e.match(t)[0],i=Number(e.replace(t,""));return this.utils.isNumber(i)?"s"===n?1e3*i:"ms"===n?i:0:0},e.prototype.__cssTransition=function(n,e){var t,i,r,o,s=this,a=this._animationEvents.$transition,l=n[a+"Delay"].split(","),u=this._properties,c=u.length,h=this._normalizedKeys,p=this._normalizeRegex,_=0,f=0,d=!1,v=this.utils.defer.bind(this,function(e,t){s._animationCanceled!==Kn&&("all"!==e&&n[e]===t||(d=!0),(f+=1)<c||d||(s._dispose(),s.end()))});for(this._usingCss=!0,isFinite(this._count)&&0!==this._count||(this._count=c);_<c;_+=1)i=u[_]=u[_].trim(),r=e.length>_?e[_].trim():e[e.length-1].trim(),o=l.length>_?l[_].trim():l[l.length-1].trim(),h[i.replace(p,"").toLowerCase()]=!0,t=n[i],v(this._toMs(r)+this._toMs(o),[i,t])},e}(i);e.SimpleCssTransition=h,sr.animation(Dt,h)}(e.animations||(e.animations={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=this._router=this._Router.currentRouter(),t=this._getParentViewport();di(t)||di(t._router)||(this._parentRouter=t._router).addChild(e),this._navigator.initialize(e)},t.prototype.loaded=function(){var e=this;(this._animate=ni(this.options)&&!0===this.options.value.animate)&&this.dom.addClass(this.element,at+"-animate"),this._Promise.resolve(this._router.finishNavigating).then(function(){e._router.register(e)})},t.prototype.canNavigateTo=function(e){var t=this,n=this._Router.currentRouter,i=n(),r=!0,o=this._Injector.getDependency(e.delegate.view),s=o.inject(),a=e.parameters,l=n();if(!ni(s))return this._Promise.resolve(null);if(i!==l){l.initialize(this._router);var u=Cr(S);(s.navigator=u).initialize(l)}else s.navigator=this._navigator;return fi(s.canNavigateTo)&&(r=s.canNavigateTo(a,e.query)),this._Promise.resolve(r).then(function(e){return t._nextInjector=o,t._nextView=s,e})},t.prototype.canNavigateFrom=function(){var e=this.controls[0],t=!0;return ni(e)&&fi(e.canNavigateFrom)&&(t=e.canNavigateFrom()),this._Promise.resolve(t)},t.prototype.navigateTo=function(e){var t=this._nextInjector;ni(t)||(t=this._Injector.getDependency(e.delegate.view));var n=this._createNodeMap(t),i=this.element,r=n.element,o=(e.parameters,e.query),s=n.uiControlNode.control;if(this._nextInjector=this._nextView=void 0,this._animate){var a=this._animator,l=this.dom;this._navigator.isBackNavigation()?(l.addClass(r,qt),a.enter(r,$t,i).then(function(){l.removeClass(r,qt)})):a.enter(r,$t,i)}else i.insertBefore(r,null);var u=this._managerCache.read(this.uid),c=this._ElementManagerFactory.getInstance();return u.children=[],c.initialize(n,u),fi(s.navigatedTo)&&s.navigatedTo(e.parameters,o),c.setUiControlTemplate(),s.hasOwnContext?c.observeRootContext(s,c.fulfillAndLoad):c.fulfillAndLoad()},t.prototype.navigateFrom=function(){var t=this,n=this.controls[0],i=ni(n);return(i&&fi(n.navigatingFrom)?this._Promise.resolve(n.navigatingFrom()):this._Promise.resolve()).catch(function(e){if(ni(e))return li(e.message)?void t._log.debug(t.type+" error: "+e.message):void t._log.debug(t.type+" error: "+JSON.stringify(e));t._log.debug(e)}).then(function(){if(t._animate&&i){var e=n.element;t._navigator.isBackNavigation()&&t.dom.addClass(e,qt),t._animator.leave(e,zt).then(function(){Or.dispose(n)})}else Or.dispose(n)})},t.prototype.dispose=function(){this._router.unregister(this),this._navigator.dispose()},t.prototype._createNodeMap=function(e){var t=this._nextView;ni(t)||(t=e.inject());var n=this._document,i=e.name,r=t.replaceWith,o=hi(r)||"any"===r?n.createElement("div"):n.createElement(r);return o.setAttribute(lt,i),o.className=ut,{element:o,attributes:{},nodes:[],uiControlNode:{control:t,nodeName:i,expressions:[],injector:e}}},t.prototype._getParentViewport=function(){for(var e=this.parent,t=this.type;!di(e)&&e.type!==t;)e=e.parent;return e},t._inject={_Router:q,_Promise:w,_Injector:le,_ElementManagerFactory:I,_document:G,_managerCache:A,_animator:P,_navigator:S},t}(c);e.Viewport=t,sr.control(at,t);var n=function(n){function e(){var e=n.call(this)||this;e.replaceWith=null,e.__isFirst=!1;var t=Cr(R);return e.__templateControlCache=t.create(dt),e}return __extends(e,n),e.prototype.initialize=function(){var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={});var n=this._id=t.id;if(di(n))this._log.warn(this.type+" instantiated without an id option");else{this._url=t.templateUrl;var i=this.__templateControlCache.read(n);di(i)?(this.__isFirst=!0,this._initializeTemplate()):this.__templatePromise=i}},e.prototype.loaded=function(){this.__isFirst||this._waitForTemplateControl(this.__templatePromise)},e.prototype.dispose=function(){if(this.__isFirst){var e=this.__templateControlCache;e.remove(this._id),0===e.info().size&&e.dispose()}},e.prototype._initializeTemplate=function(){var t=this,n=this._id;if(!di(n)){var e,i,r=this.endNode.parentNode,o=this._url;di(o)?(e=this._document.createDocumentFragment(),Hi(this.elementNodes,e)):(e=this._templateCache.read(o),Yi(this.elementNodes,r)),this.elementNodes=[],ci(e)?i=e.catch(function(e){if(di(e))return c.determineTemplate(t,o)}).then(function(e){return t.bindableTemplates.add(n,e.cloneNode(!0)),t}):(this.bindableTemplates.add(n,e.cloneNode(!0)),i=this._Promise.resolve(this)),this.__templateControlCache.put(n,i)}},e.prototype._waitForTemplateControl=function(e){var n=this;ci(e)&&e.then(function(e){return di(n._url)||n._url===e._url||n._log.warn("The specified url: "+n._url+" should match "+n.type+' with id: "'+n._id+'". Loading original url.'),n.__mapBindableTemplates(e),n.bindableTemplates.bind(n._id)}).then(function(e){var t=n.endNode;Xi(t.parentNode,e,t)}).catch(function(e){ki(function(){n._log.warn("Problem resolving "+n.type+" url: "+e.response)})})},e.prototype.__mapBindableTemplates=function(e){var t=this.bindableTemplates;t.cache=e.bindableTemplates.cache,t.templates=e.bindableTemplates.templates},e._inject={_Promise:w,_templateCache:L,_document:G},e}(c);e.Template=n,sr.control(st,n);var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.innerTemplate=Hi(this.element.childNodes)},t.prototype.loaded=function(){this.element.appendChild(this.innerTemplate.cloneNode(!0))},t}(c);e.Ignore=i,sr.control(rt,i);var r=function(e){function t(){var n=e.call(this)||this;return n.priority=120,n._aliases={index:hn.index,even:hn.even,odd:hn.odd,first:hn.first,last:hn.last},n._blockLength=0,n._addQueue=[],n._itemLength=0,n.__listenerSet=!1,n.itemsLoaded=new n._Promise(function(e,t){n.__resolveFn=e,n.__rejectFn=t}).catch(Kn),n}return __extends(t,e),t.prototype.setTemplate=function(){this.bindableTemplates.add("item",this.element.childNodes)},t.prototype.contextChanged=function(e,t){mi(e)?this._setListener():e=[],this._executeEvent([{object:e,type:"splice"}])},t.prototype.loaded=function(){var e=this.options,t=this._animate=ni(e)&&!0===e.value.animate,n=this.context;if(this._container=this.element,t&&(this._animationQueue=[]),this._setAliases(),mi(n)){var i=this._addQueue,r=n.length,o=this._addItems(0,r,0).then(function(){var e=i.indexOf(o);-1!==e&&i.splice(e,1)});i.push(o),this._setListener()}},t.prototype.dispose=function(){this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._animationQueue=this._addQueue=null},t.prototype._setAliases=function(){var e=this.options;if(!vi(e)){var t=e.value.aliases;if(ni(t))for(var n,i=this._aliases,r=Object.keys(i),o=r.length,s=0;s<o;s+=1)li(n=t[r[s]])&&(i[r[s]]=n)}},t.prototype._addItems=function(e,t,r){var o=this,n=+(e+t),i=[],s=e;for(this._itemLength+=t;e<n;)i.push(this._bindItem(e)),e+=1;return 0<i.length&&(this.itemsLoaded=this._Promise.all(i).then(function(e){if(o._setBlockLength(e),0<r)for(var t=e.length,n=o._container,i=0;i<t;i+=1)i<r?o._appendAnimatedItem(e[i]):n.insertBefore(e[i],null);else o._appendItems(e);o._updateResource(s-1),fi(o.__resolveFn)&&(o.__resolveFn(),o.__resolveFn=o.__rejectFn=null)}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),o._log.error(e)})})),this.itemsLoaded},t.prototype._appendItems=function(e){Hi(e,this._container)},t.prototype._appendAnimatedItem=function(e){if(oi(e)){var t=this._animationQueue,n={animation:this._animator.enter(e,$t,this._container).then(function(){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}),op:null};t.push(n)}},t.prototype._removeItems=function(e,t){for(var n=c.dispose,i=this.controls,r=e+t;e<r;)n(i[r-=1]);this._updateResource(i.length-1)},t.prototype._bindItem=function(e){return this.bindableTemplates.bind("item",e,this._getAliases(e))},t.prototype._setBlockLength=function(e){0<this._blockLength||0===e.length||(this._blockLength=e[0].childNodes.length)},t.prototype._updateResource=function(e){var t=this.controls;e<0||e>=t.length||t[e].resources.add(this._getAliases(e))},t.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},t.prototype._executeEvent=function(e){var t="_"+e[0].type;fi(this[t])&&this[t](e)},t.prototype._getAliases=function(e){var t=e%2==0,n={},i=this._aliases,r=On;return n[i.index]={value:e,type:r},n[i.even]={value:t,type:r},n[i.odd]={value:!t,type:r},n[i.first]={value:0===e,type:r},n[i.last]={value:e===this.context.length-1,type:r},n},t.prototype._push=function(e){var t=e[0],n=this._addQueue,i=t.addedCount,r=this._addItems(t.index,i,this._animate?i:0).then(function(){var e=n.indexOf(r);-1!==e&&n.splice(e,1)});n.push(r)},t.prototype._pop=function(e){var t=this,n=e[0],i=n.object.length;if(0!==n.removed.length){var r=n.object.length;0<this._itemLength&&(this._itemLength-=1),this._Promise.all(this._addQueue).then(function(){t._animate?t._animateItems(i,1,zt,"leave",!1).then(function(){t._removeItems(r,1)}):t._removeItems(r,1)})}},t.prototype._unshift=function(e){var t=e[0],n=t.addedCount,i=this._addQueue;if(this._animate){var r=this._animationQueue,o=r.length;this._animateItems(0,n,$t,null,0<o&&"clone"===r[o-1].op)}var s=this._addItems(t.object.length-n,n,0).then(function(){var e=i.indexOf(s);-1!==e&&i.splice(e,1)});i.push(s)},t.prototype._shift=function(e){var t=this,n=this._addQueue,i=e[0];if(0!==i.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,zt,"clone",!0)]));var r=i.object.length;0<this._itemLength&&(this._itemLength-=1),this._Promise.all(n).then(function(){t._removeItems(r,1)})}},t.prototype._splice=function(e){var t,n=this,i=e[0],r=i.addedCount,o=this._itemLength,s=this._animate,a=this._addQueue;if(di(r)){s&&this._cancelCurrentAnimations();var l=i.object.length,u=o-l;o<l?(t=this._addItems(o,-u,0).then(function(){var e=a.indexOf(t);-1!==e&&a.splice(e,1)}),a.push(t)):l<o&&(u<=o?this._itemLength-=u:this._itemLength=0,this._Promise.all(a).then(function(){n._removeItems(o-u,u)}))}else{var c=i.removed.length,h=this._animationQueue;if(c<r){var p=r-c,_=void 0;if(s){_=r;var f=h.length,d=i.index;o<r-d&&(_=o-d),this._animateItems(d,_,$t,null,0<f&&"clone"===h[f-1].op),_=r-_}else _=0;t=this._addItems(i.object.length-p,p,_).then(function(){var e=a.indexOf(t);-1!==e&&a.splice(e,1)}),a.push(t)}else if(r<c){var v=0<r;s&&!v&&0===a.length&&(a=a.concat([this._animateItems(i.index,c,zt,"clone",!0)]));var m=c-r;m<=o?this._itemLength-=m:this._itemLength=0,this._Promise.all(a).then(function(){if(s&&v){var e=h.length;n._animateItems(i.index,r,$t,null,0<e&&"clone"===h[e-1].op)}n._removeItems(o-m,m)})}}},t.prototype._calculateBlockLength=function(e,t){return this._blockLength},t.prototype._animateItems=function(e,t,n,i,r){var o=this._calculateBlockLength();if(0===o)return this._Promise.resolve();var s=e*o;switch(i){case"clone":return this._handleClonedContainerAnimation(s,t*o+s,n,!0===r);case"leave":return this._handleLeave(s,t*o+s,n);default:return this._handleSimpleAnimation(s,t*o+s,n,!0===r)}},t.prototype._handleSimpleAnimation=function(e,t,n,i){var r=this._container,o=Array.prototype.slice.call(r.childNodes,e,t);if(0===o.length)return this._Promise.resolve();var s=this._animationQueue,a=this._animator.create(o,n),l=a.current.then(function(){var e=s.indexOf(c);-1!==e&&s.splice(e,1)}),u=function(){return a.previous.then(function(){l.start()}),l},c={animation:l,op:null};if(i&&0<s.length){var h=this._cancelCurrentAnimations().then(u);return s.push(c),h}return s.push(c),u()},t.prototype._handleLeave=function(e,t,n){var i=this._container,r=Array.prototype.slice.call(i.childNodes,e,t);if(0===r.length)return this._Promise.resolve();var o=this._animationQueue,s=this._animator.leave(r,n).then(function(){var e=o.indexOf(a);-1!==e&&o.splice(e,1)}),a={animation:s,op:"leave"};return o.push(a),s},t.prototype._handleClonedContainerAnimation=function(e,t,n,i){var r,o=this._container,s=o.cloneNode(!0),a=Array.prototype.slice.call(s.childNodes,e,t);if(0===a.length)return this._Promise.resolve();var l=this._animationQueue,u=this._animator.create(a,n),c=u.current.then(function(){var e=l.indexOf(p);-1<e&&l.splice(e,1),di(r)||r.replaceChild(o,s)}),h=function(){return di(r=o.parentNode)||c.isCanceled()||(r.replaceChild(s,o),u.previous.then(function(){c.start()})),c},p={animation:c,op:"clone"};if(i&&0<l.length){var _=this._cancelCurrentAnimations().then(h);return l.push(p),_}return l.push(p),h()},t.prototype._cancelCurrentAnimations=function(){for(var e=this._animationQueue,t=[],n=e.length,i=0;i<n;i+=1)t.push(e[i].animation.cancel());return this._Promise.all(t)},t._inject={_animator:P,_Promise:w},t}(c);e.ForEach=r,sr.control(tt,r);var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith=vt,e._structuredDataElements=[],e}return __extends(e,t),e.prototype.initialize=function(){var e=this;this.on(jt,function(){e._removeAllElements()})},e.prototype.setTemplate=function(){var e=mt,t="title",n="author",i="description",r=xt,o=Et;this.element.setAttribute("prefix","og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"),this._titleElement=this._createElement(t),this._ogTitleElement=this._createElement(e,r+t),this._twitterTitleElement=this._createElement(e,o+t),this._descriptionElement=this._createElement(e,i),this._ogDescriptionElement=this._createElement(e,r+i),this._twitterDescriptionElement=this._createElement(e,o+i),this._ogUrlElement=this._createElement(e,"og:url"),this._twitterUrlElement=this._createElement(e,o+"url"),this._authorElement=this._createElement(e,n),this._googleAuthorElement=this._createElement("link",n),this._fbAuthorElement=this._createElement(e,"article:"+n),this._twitterCreatorElement=this._createElement(e,o+"creator"),this._ogTypeElement=this._createElement(e,"og:type")},e.prototype.title=function(e){return li(e)?(this._titleElement.innerText=e,this._setContent([this._ogTitleElement,this._twitterTitleElement],e),e):this._getContent(this._titleElement)},e.prototype.description=function(e){return li(e)?(this._setContent([this._descriptionElement,this._ogDescriptionElement,this._twitterDescriptionElement],e),e):this._getContent(this._descriptionElement)},e.prototype.url=function(e){return li(e)?(this._setContent([this._ogUrlElement,this._twitterUrlElement],e),e):this._getContent(this._ogUrlElement)},e.prototype.author=function(e){return li(e)?(this._setContent([this._authorElement],e),e):this._getContent(this._authorElement)},e.prototype.googleAuthor=function(e){return li(e)?(this._setContent([this._googleAuthorElement],e),e):this._getContent(this._googleAuthorElement)},e.prototype.fbAuthor=function(e){return li(e)?(this._setContent([this._fbAuthorElement],e),e):this._getContent(this._fbAuthorElement)},e.prototype.twitterCreator=function(e){return li(e)?(this._setContent([this._twitterCreatorElement],e),e):this._getContent(this._twitterCreatorElement)},e.prototype.fbType=function(e){return li(e)?(this._setContent([this._ogTypeElement],e),e):this._getContent(this._ogTypeElement)},e.prototype.images=function(e){var t=this;if(mi(e)){var n,i,r=mt,o=this.element;Ci(function(e){e=t._browser.urlUtils(e).href,2!==o.querySelectorAll(r+'[content="'+e+'"]').length&&(n=t._createElement(r,"og:"+bt,!0),i=t._createElement(r,"twitter:"+bt,!0),t._setContent([n,i],e))},e)}},e.prototype.videos=function(e){var t=this;if(mi(e)){var n,i=this._browser,r=this.element;Ci(function(e){e=i.urlUtils(e).href,1!==r.querySelectorAll('meta[content="'+e+'"]').length&&(n=t._createElement("meta","og:video",!0),t._setContent([n],e))},e)}},e.prototype.structuredData=function(e){if(!hi(e)){var t=this._document.createElement("script"),n=this._titleElement.nextSibling;t.setAttribute("type","application/ld+json"),t.textContent=JSON.stringify(e),this._structuredDataElements.push(t),this.dom.insertBefore(this.element,t,n)}},e.prototype.blogPostings=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.length,i=0;i<n;i+=1)this.structuredData(e[i])},e.prototype.loaded=function(){this.url(this._browser.url())},e.prototype.navigated=function(e){this.url(e)},e.prototype._getContent=function(e){var t=e.nodeName.toLowerCase();return"title"===t?e.innerText:t===mt?e.getAttribute(wt):t===gt?e.getAttribute("href"):void 0},e.prototype._setContent=function(e,t){for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=this._titleElement.nextSibling,a=this.dom,l=0;l<o;l+=1)(n=e[l]).nodeName.toLowerCase()===mt?n.setAttribute("content",t):n.setAttribute("href",t),-1===r.indexOf(n)&&a.insertBefore(i,n,s)},e.prototype._createElement=function(e,t,n){var i,r=li(t),o=this.element,s=!r||0!==t.indexOf(xt)&&0!==t.indexOf(Ct)?"name":yt;return e===gt&&(s="rel"),!n&&r?i=o.querySelector(e+"["+s+'="'+t+'"]'):n||(i=o.querySelector(e)),oi(i)||(i=this._document.createElement(e)),r&&i.setAttribute(s,t),i},e.prototype._removeAllElements=function(){var e=Array.prototype.slice,t=this._document.head.querySelectorAll('meta[property^="og:"]'),n=this._document.head.querySelectorAll('meta[name^="'+Et+'"]');this._removeElements.apply(this,[this._descriptionElement,this._authorElement,this._googleAuthorElement].concat(e.call(t),e.call(n),e.call(this._structuredDataElements))),this._structuredDataElements=[]},e.prototype._removeElements=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=0;s<o;s+=1)n=e[s],-1!==r.indexOf(n)&&i.removeChild(n)},e._inject={_document:G,_browser:ee},e}(c);e.Head=o;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.dom.clearNode(this.element)},t.prototype.loaded=function(){var e=this.options;ni(e)&&(this._onOptionsChanged(e.value),e.observe(this._onOptionsChanged))},t.prototype._onOptionsChanged=function(e,t){var n=this;if(e!==t)if(ni(e)){var i=e.html;if(i!==this._html){var r=li(this._html=i);if(di(i)||r&&""===i.trim())0<this.controls.length?this._TemplateControlFactory.dispose(this.controls[0]):this.dom.clearNode(this.element);else if(r)if(!0!==e.compile)Wi(this.element,i);else{var o=0<this.controls.length;this.bindableTemplates.once(i).then(function(e){o?n._TemplateControlFactory.dispose(n.controls[0]):n.dom.clearNode(n.element),n.element.insertBefore(e,null)})}else this._log.debug("Trying to bind a non-string value to "+this.type+".")}}else this._log.debug("plat-options for "+this.type+" must be an object.")},t._inject={_TemplateControlFactory:z},t}(c);e.InnerHtml=s,sr.control(nt,s);var a=function(e){function t(){var n=e.call(this)||this;return n.replaceWith="select",n.priority=120,n.groups={},n.itemsLoaded=new n._Promise(function(e,t){n.__resolveFn=e,n.__rejectFn=t}).catch(Kn),n}return __extends(t,e),t.prototype.setTemplate=function(){this.bindableTemplates.add("option",this.element.childNodes);var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={});var n=t.default;if(ni(n)){var i=this._document.createElement("option"),r=n.value,o=n.textContent;i.value=vi(r)?o:r,i.textContent=vi(o)?r:o,this.element.insertBefore(i,null)}if(di(t.group))this._isGrouped=!1;else{var s=this._group=t.group,a=this._document.createElement("optgroup");a.label=mn+s+gn,this.bindableTemplates.add("group",a),this._isGrouped=!0}},t.prototype.contextChanged=function(e,t){var n=this;if(!hi(e)&&mi(e)){var i=mi(e)?e.length:0,r=mi(t)?t.length:0;this._setListener(),r<i?this._addItems(i-r,r):i<r&&this._removeItems(r-i),this.itemsLoaded.then(this._observeChange.bind(this))}else hi(t)||this.itemsLoaded.then(function(){n._removeItems(n.controls.length)}).then(this._observeChange.bind(this))},t.prototype.loaded=function(){if(vi(this._isGrouped)){var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={}),this._group=t.group,this._isGrouped=!di(this._group)}this._defaultOption=this.element.firstElementChild;var n=this.context;mi(n)&&(this._addItems(n.length,0),this._setListener())},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._defaultOption=null},t.prototype.observeProperties=function(e){var t=this,n=this.element;if(this._binder=e,n.multiple){if(di(e.evaluate())){var i=[];this.inputChanged(i,this.__lastValue),this.__lastValue=i}e.observeProperty(this._setSelectedIndices),e.observeArrayChange(function(){t._setSelectedIndices(e.evaluate(),null,null)})}else e.observeProperty(this._setSelectedIndex);this.addEventListener(n,"change",this._observeChange,!1)},t.prototype._setSelectedIndex=function(t,e,n,i){var r=this,o=this.element,s=o.value;if(di(t))return!0!==i&&this._document.body.contains(o)?void(o.selectedIndex=-1):void this.itemsLoaded.then(function(){if(di(r._binder.evaluate())){var e=o.value;r.inputChanged(e,r.__lastValue),r.__lastValue=e}});li(t)||(_i(t)?(this._propertyType="number",t=t.toString()):pi(t)?(this._propertyType="boolean",t=t.toString()):(t=fi(t.toString)?t.toString():Object.prototype.toString.call(t),this._log.info('Trying to bind the invalid value "'+t+'" to a '+this.type+"."))),s!==t&&this.itemsLoaded.then(function(){if(r._document.body.contains(o))o.value=r.__lastValue=t,o.value===t&&-1!==o.selectedIndex||(o.selectedIndex=-1);else{if(o.value=t,o.value!==t){o.value=s;var e=r._castValue(o.value);r.inputChanged(e,r.__lastValue),r.__lastValue=e}r.__lastValue=t}})},t.prototype._setSelectedIndices=function(p,e,t,_){var f=this;this.itemsLoaded.then(function(){var e,t=f.element.options,n=di(p),i=di(t)?0:t.length;if(!n&&mi(p)){for(var r,o,s,a=1/0;0<i;)if(r=(e=t[i-=1]).value,-1===p.indexOf(r)){o=Number(r);var l=p.indexOf(o),u=p.indexOf(!0),c=p.indexOf(!1);_i(o)&&-1!==l?((s=l)<a&&(f._propertyType="number",a=s),e.selected=!0):"true"===r&&-1!==u||"false"===r&&-1!==c?((s=c<u?u:c)<a&&(f._propertyType="boolean",a=s),e.selected=!0):e.selected=!1}else e.selected=!0;f.__lastValue=p}else{if(!0===_&&di(f._binder.evaluate())){var h=f._getSelectedValues();f.inputChanged(h,f.__lastValue),f.__lastValue=h}for(;0<i;){if(e=t[i-=1],!n&&e.value===""+p)return void(e.selected=!0);e.selected=!1}f.__lastValue=p}})},t.prototype._observeChange=function(){var e=this.element,t=e.multiple?this._getSelectedValues():this._castValue(e.value);t!==this.__lastValue&&(this.inputChanged(t,this.__lastValue),this.__lastValue=t)},t.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).selected&&i.push(this._castValue(e.value));return i},t.prototype._castValue=function(e){var t,n=this._propertyType;if(di(n))return e;switch(n){case"number":t=hi(e)?null:Number(e);break;case"boolean":switch(e){case"true":t=!0;break;case"false":case"0":case"null":case"undefined":t=!1;break;default:t=!!e}break;default:t=e}return t},t.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},t.prototype._executeEvent=function(e){var t="_"+e[0].type;fi(this[t])&&this[t](e)},t.prototype._addItems=function(e,t){for(var n=this,i=this.bindableTemplates,r=[],o=this._insertOption;0<e;)e-=1,r.push(i.bind("option",t).then(o.bind(this,t))),t+=1;return 0<r.length&&(this.itemsLoaded=this._Promise.all(r).then(function(){fi(n.__resolveFn)&&(n.__resolveFn(),n.__resolveFn=n.__rejectFn=null)}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),n._log.error(e)})})),this.itemsLoaded},t.prototype._insertOption=function(e,t){var n=this.element;if(this._isGrouped){var i=this.groups,r=this.context[e];ni(r)||(r={});var o=r[this._group],s=i[o];return di(s)?i[o]=this.bindableTemplates.bind("group",e).then(function(e){return(s=i[o]=e.childNodes[1]).insertBefore(t,null),n.insertBefore(e,null),s}):ci(s)?s.then(function(e){e.insertBefore(t,null)}):(s.insertBefore(t,null),this._Promise.resolve())}return n.insertBefore(t,null),this._Promise.resolve()},t.prototype._removeItems=function(e){for(var t=c.dispose,n=this.controls;0<e;)e-=1,t(n.pop())},t.prototype._removeItem=function(){this._isGrouped?this._resetSelect():this._removeItems(1)},t.prototype._resetSelect=function(){this._removeItems(this.controls.length),this.groups={},di(this._defaultOption)||this.element.insertBefore(this._defaultOption.cloneNode(!0),null),this._addItems(this.context.length,0)},t.prototype._push=function(e){var t=e[0];this._addItems(t.addedCount,t.index)},t.prototype._pop=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},t.prototype._unshift=function(e){if(this._isGrouped)this._resetSelect();else{var t=e[0],n=t.addedCount;this._addItems(n,t.object.length-n-1)}},t.prototype._shift=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},t.prototype._splice=function(e){var t=this;if(this._isGrouped)this._resetSelect();else{var n=e[0],i=n.addedCount,r=n.removed.length;r<i?this._addItems(i-r,n.object.length-i-1):i<r&&this.itemsLoaded.then(function(){t._removeItems(r-i)})}},t.prototype._sort=function(e){this._isGrouped&&this._resetSelect()},t.prototype._reverse=function(e){this._isGrouped&&this._resetSelect()},t._inject={_Promise:w,_document:G},t}(h);e.Select=a,sr.control(ot,a);var l=function(n){function e(){var e=n.call(this)||this;e._animate=!1,e.__condition=!0,e.__firstTime=!0,e.__isBound=!1;var t=e._document;return e.commentNode=t.createComment(""+it+Tn+"placeholder"),e.fragmentStore=t.createDocumentFragment(),e}return __extends(e,n),e.prototype.contextChanged=function(){var e=this.options.value;if(!hi(e))return this._setter(e)},e.prototype.setTemplate=function(){this.bindableTemplates.add("template",Array.prototype.slice.call(this.element.childNodes))},e.prototype.loaded=function(){var e=this.options;ni(e)?this._animate=!0===e.value.animate:(this._log.warn("No condition specified in "+be+" for "+this.type+"."),this.options={value:{condition:!0},observe:Kn});var t=this.contextChanged();return this.__removeListener=this.options.observe(this._setter),t},e.prototype.dispose=function(){fi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null),fi(this.__cancelFrame)&&(this.__cancelFrame(),this.__cancelFrame=null),this.commentNode=null,this.fragmentStore=null},e.prototype._setter=function(e){var t,n,i,r=this,o=!!e.condition;return o!==this.__condition||this.__firstTime?(o?(t=this.__leavePromise,n=function(){return r.__leavePromise=null,r._addItem()}):(t=this.__enterPromise,n=function(){return r.__enterPromise=null,r._removeItem()}),i=di(t)?n():this._animate&&fi(t.cancel)?t.cancel().then(n):t.then(n),this.__firstTime=!1,this.__condition=o,i):this._Promise.resolve(null)},e.prototype._addItem=function(){var n=this,e=this.__isBound;return e&&!oi(this.commentNode.parentNode)?this._Promise.resolve(null):e?di(this.__initialBind)?this._animate?this._animateEntrance():this._elementEntrance():(this.__initialBind=this.__initialBind.then(function(){return n.__initialBind=null,n._animate?n._animateEntrance():n._elementEntrance()}),this.__initialBind):(this.__isBound=!0,this.__initialBind=this.bindableTemplates.bind("template").then(function(e){n.__initialBind=null;var t=n.element;return t.parentNode===n.fragmentStore||di(t.parentNode)?(t.insertBefore(e,null),n._animate?n._animateEntrance():n._elementEntrance()):n._animate?(n.__enterPromise=n._animator.animate(t,$t).then(function(){n.__enterPromise=null}),t.insertBefore(e,null),n.__enterPromise):void t.insertBefore(e,null)}))},e.prototype._elementEntrance=function(){var t=this,n=this.commentNode,i=n.parentNode;return oi(i)?(this.__enterPromise=new this._Promise(function(e){t.__cancelFrame=ji(function(){i.insertBefore(t.element,n),e()})}).then(function(){t.__enterPromise=null}),this.__enterPromise):this._Promise.resolve()},e.prototype._animateEntrance=function(){var e=this,t=this.commentNode,n=t.parentNode;return oi(n)?(this.__enterPromise=this._animator.enter(this.element,$t,n,t).then(function(){e.__enterPromise=null}),this.__enterPromise):this._animator.resolve().then(Kn)},e.prototype._removeItem=function(){var e=this;return di(this.__initialBind)?this._animate?this._animateLeave():this._elementLeave():(this.__initialBind=this.__initialBind.then(function(){return e.__initialBind=null,e._animate?e._animateLeave():e._elementLeave()}),this.__initialBind)},e.prototype._elementLeave=function(){var r=this;return this.__leavePromise=new this._Promise(function(i){r.__cancelFrame=ji(function(){var e=r.element,t=e.parentNode,n=e.nextSibling;oi(t)&&(oi(r.commentNode.parentNode)||t.insertBefore(r.commentNode,n),r.fragmentStore.insertBefore(e,null)),i()})}).then(function(){r.__leavePromise=null}),this.__leavePromise},e.prototype._animateLeave=function(){var n=this,i=this.element;return this.__leavePromise=this._animator.leave(i,zt).then(function(){var e=i.parentNode,t=i.nextSibling;n.__leavePromise=null,oi(n.commentNode.parentNode)||e.insertBefore(n.commentNode,t),n.fragmentStore.insertBefore(i,null)}),this.__leavePromise},e._inject={_animator:P,_Promise:w,_document:G},e}(c);e.If=l,sr.control(it,l);var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="a",e._router=e._Router.currentRouter(),e._allowClick=!1,e}return __extends(e,t),e.prototype.initialize=function(){this._removeClickListener=this.dom.addEventListener(this.element,"click",this._handleClick.bind(this),!1)},e.prototype.loaded=function(){var e=this.options,t=this.setHref.bind(this);if(!ni(e))return this._log.warn("No options specified for "+this.type+". Please send in options of type plat.ui.controls.ILinkOptions."),(e=this.options={}).value={view:""},void this.setHref();ni(e.value)||(e.value={view:""}),this.addEventListener(this.element,Ht,this._handleTap,!1),t(),e.observe(t)},e.prototype.setHref=function(){var e=this.getHref();hi(e)||(this.element.href=e)},e.prototype.getHref=function(){if(!di(this._router)){var e=this.options.value,t=e.view;if(!0!==e.isUrl){var n=e.parameters,i=e.query;if(hi(t))return t;t=this._router.generate(t,n,i)}return this._browser.formatUrl(t)}},e.prototype.dispose=function(){Si(this._removeClickListener,3e3)},e.prototype._handleClick=function(e){if(this._allowClick)this._allowClick=!1;else{var t;if(_i(e.buttons)&&0!==e.buttons)t=e.buttons;else if(_i(e.which)&&0<e.which)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}1===t&&e.preventDefault()}},e.prototype._handleTap=function(e){var t=this;if(1===e.buttons){var n=this.getHref();if(!vi(n)){var i=this.element.target;if(hi(i)||"_self"===i)return e.preventDefault(),void ji(function(){t._browser.url(n)});this._allowClick=!0,this.element.click()}}},e._inject={_Router:q,_Injector:le,_browser:ee,_window:Q},e}(c);e.Link=u,sr.control(et,u)}(e.controls||(e.controls={}))}(Mr=d.ui||(d.ui={})),function(e){var t=function(){function e(){}return e.prototype.compile=function(e,t){var n,i,r,o=!di(t)?this._managerCache.read(t.uid):null,s=this._ElementManagerFactory.create,a=e.childNodes;if(a=vi(a)?fi(e.push)?e:Array.prototype.slice.call(e):Array.prototype.slice.call(a),di(o)){n=a.length;for(var l=0;l<n;l+=1)(r=a[l]).nodeType===Node.ELEMENT_NODE&&(di(s(r))||this.compile(r)),l+=(i=a.length)-n,n=i}else this._compileNodes(a,o)},e.prototype._compileNodes=function(e,t){for(var n,i,r,o=this._ElementManagerFactory.create,s=this._CommentManagerFactory.create,a=this._TextManagerFactory.create,l=e.length,u=0;u<l;u+=1){switch((n=e[u]).nodeType){case Node.ELEMENT_NODE:di(i=o(n,t))||this._compileNodes(Array.prototype.slice.call(n.childNodes),i);break;case Node.TEXT_NODE:a(n,t);break;case Node.COMMENT_NODE:s(n,t)}u+=(r=e.length)-l,l=r}},e._inject={_ElementManagerFactory:I,_TextManagerFactory:j,_CommentManagerFactory:f,_managerCache:A},e}();e.Compiler=t,sr.injectable(_,t);var m=function(){function p(){this.isClone=!1}return p.hasMarkup=function(e){return p._markupRegex.test(e)},p.findMarkup=function(e){var t,n,i,r,o=mn.length,s=gn.length,a=gn[s-1],l=[],u=p._wrapExpression,c=p._parser;for(t=(e=e.replace(p._newLineRegex,"")).indexOf(mn),n=e.indexOf(gn);-1!==t&&-1!==n;){for(0!==t&&l.push(u(e.slice(0,t)));e[n]!==a||e[n+1]===a;)n+=1;n+=1,"="===(i=e.slice(t+o,n-s))[0]?((r=c.parse(i.slice(1).trim())).oneTime=!0,l.push(r)):l.push(c.parse(i.trim())),t=(e=e.slice(n)).indexOf(mn),n=e.indexOf(gn)}return 0<=t&&0<=n?l.push(u(e.slice(n))):""!==e&&l.push(u(e)),l},p.build=function(e,t){for(var n,i=e.length,r={},o=p._TemplateControlFactory.evaluateExpression,s="",a=0;a<i;a+=1)if(ni(n=o(e[a],t,r)))try{s+=JSON.stringify(n,null,4)}catch(e){di(e.description)||(e.description="Cannot stringify object: "+e.description),e.message="Cannot stringify object: "+e.message,p._log.warn(e)}else di(n)||(s+=n);return s},p.observeExpressions=function(e,n,t){for(var i,r,o,s,a=p.__findUniqueIdentifiers(e),l=a.identifiers,u=a.oneTimeIdentifiers,c={listener:t,uid:n.uid};0<l.length;)r=p.__getObservationDetails(l.pop(),n),di(o=r.manager)||o.observe(r.absoluteIdentifier,c);for(var h=function(){if(i=u.pop(),r=p.__getObservationDetails(i,n),!di(o=r.manager)&&!r.isDefined){s=r.absoluteIdentifier;var e=o.observe(s,c),t=o.observe(s,{uid:n.uid,listener:function(){e(),t()}})}};0<u.length;)h()},p._wrapExpression=function(e){return{evaluate:function(){return e},identifiers:[],aliases:[],expression:e}},p.__findUniqueIdentifiers=function(e){var t,n=e.length;if(1===n)return!0===(t=e[0]).oneTime?{identifiers:[],oneTimeIdentifiers:t.identifiers.slice(0)}:{identifiers:t.identifiers.slice(0),oneTimeIdentifiers:[]};for(var i,r,o,s,a,l={},u={},c=[],h=[],p=0;p<n;p+=1)for(a=(t=e[p]).oneTime,s=(i=t.identifiers).length,o=0;o<s;o+=1)if(r=i[o],a){if(!0===l[r])continue;u[r]||(u[r]=!0,h.push(r))}else l[r]||(l[r]=!0,c.push(r)),!0===u[r]&&(u[r]=!1,h.splice(h.indexOf(r),1));return{identifiers:c,oneTimeIdentifiers:h}},p.__getObservationDetails=function(e,t){var n,i=p._ContextManager,r=e.split("."),o="",s=!1;if("@"===e[0]){var a={},l=r.shift().slice(1),u=void 0;if(0<r.length&&(o="."+r.join(".")),di(u=a[l])&&(u=a[l]=t.findResource(l)),!di(u)&&!di(u.resource)){var c=u.resource.type;l===$n?(n=i.getManager(Or.getRootControl(t)),o=t.absoluteContextPath+o):l===Mn?(n=i.getManager(a[l].control),o="context"+o):c!==Rn&&c!==On||(n=i.getManager(a[l].control),o="resources."+l+".value"+o)}}else(s=!vi(i.getContext(t.context,r)))||vi(i.getContext(t,r))?(n=i.getManager(Or.getRootControl(t)),o=t.absoluteContextPath+"."+e):n=null;return{absoluteIdentifier:o,manager:n,isDefined:s}},p.prototype.initialize=function(e,t){this.nodeMap=e,di(this.parent=t)||(this.isClone=t.isClone,t.children.push(this))},p.prototype.getParentControl=function(){for(var e,t=this.parent;di(e)&&!di(t);)e=t.getUiControl(),t=t.parent;return e},p.prototype.clone=function(e,t){return 1},p.prototype.bind=function(){},p}();function n(e,t,n,i,r){return m._markupRegex=e.markupRegex,m._newLineRegex=e.newLineRegex,m._ContextManager=t,m._parser=n,m._TemplateControlFactory=i,m._log=r,m}e.NodeManager=m,e.INodeManagerStatic=n,sr.injectable(v,n,[K,Z,J,z,k],yn);var s=function(s){function g(){var e=null!==s&&s.apply(this,arguments)||this;return e.children=[],e.type="element",e.replace=!1,e.hasOwnContext=!1,e}return __extends(g,s),g.create=function(e,t){var n=e.nodeName.toLowerCase(),i=n,r=_r[n];ni(r)||(r=fr[n]);var o,s=!0,a=!1;if(di(r)&&(e.hasAttribute(lt)?(n=e.getAttribute(lt).toLowerCase(),ni(r=_r[n])||(r=fr[n]),s=!1):e.hasAttribute(ft+lt)&&(n=e.getAttribute(ft+lt).toLowerCase(),ni(r=_r[n])||(r=fr[n]),s=!1)),!di(r)){var l=r.inject();o={control:l,resourceElement:g.locateResources(e),nodeName:n,expressions:[],injector:r},a=!0,s&&e.setAttribute(lt,n);var u=l.replaceWith,c="any"===u&&s;if(!hi(u)&&("any"!==u||c)&&u.toLowerCase()!==i){c&&(u="div");var h=g._document.createElement(u);h.nodeType===Node.ELEMENT_NODE&&(e=Ji(e,h))}}var p=g._collectAttributes(e.attributes),_=g.getInstance();return p.element=e,!a&&li(p.childContext)?(r=vr[B],a=!0,p.uiControlNode={control:r.inject(),resourceElement:null,nodeName:pt,expressions:[],injector:r}):p.uiControlNode=o,_.initialize(p,t),p.hasControl||a?(_.setUiControlTemplate(),a?null:_):(_.bind=function(){return[]},_)},g.locateResources=function(e){for(var t,n,i=Array.prototype.slice.call(e.childNodes);0<i.length;)if((n=(t=i.shift()).nodeName.toLowerCase())===ct||n==="x-"+ct)return e.removeChild(t);return null},g.clone=function(e,t,n,i,r){if(di(r)){var o=t.getUiControl();ni(o)||(o=t.getParentControl()),r=g._cloneNodeMap(e.nodeMap,n,o,i)}var s=g.getInstance(),a=!di(i);return s.nodeMap=r,di(s.parent=t)||t.children.push(s),s.replace=e.replace,s.replaceNodeLength=e.replaceNodeLength,s.hasOwnContext=e.hasOwnContext,s.isClone=!0,r.hasControl||a||(s.bind=function(){return[]}),a&&g._managerCache.put(i.uid,s),s},g.cloneUiControl=function(e,t){var n=e.uiControlNode;if(!di(n)&&!di(n.injector)){var i=n.control,r=n.injector.inject(),o=g._ResourcesFactory.getInstance(),s=g._AttributesFactory.getInstance();return(r.parent=t).controls.push(r),r.controls=[],s.initialize(r,e.attributes),r.attributes=s,o.initialize(r,i.resources),r.resources=o,g._ResourcesFactory.addControlResources(r),di(i.innerTemplate)||(r.innerTemplate=i.innerTemplate.cloneNode(!0)),r.type=i.type,r.bindableTemplates=g._BindableTemplatesFactory.create(r,i.bindableTemplates),r.replaceWith=i.replaceWith,r}},g.createAttributeControls=function(e,t,n,i,r){var o,s=e.nodes,a=!0===r?i:e.element;if(oi(a)){if(a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0===r?g._copyAttributeNodes(s):[];o=a.attributes}var l,u,c,h,p,_,f=e.attributes,d=[],v=s.length;for(_=0;_<v;_+=1)if(p=(u=s[_]).nodeName,h=null,di(c=u.injector)||(h=c.inject(),(u.control=h).parent=t,h.element=a,(l=g._AttributesFactory.getInstance()).initialize(h,f),h.attributes=l,h.type=p,li(h.uid)||(h.uid=Ri(he)),h.templateControl=n),!0===r){var m=null;ni(o)&&(ni(m=o.getNamedItem(p))||(m=o.getNamedItem(ft+p))),d.push({control:h,expressions:u.expressions,node:m,nodeName:p,injector:c}),di(h)||(di(t)||t.controls.push(h),fi(h.initialize)&&h.initialize())}if(!r)for(s.sort(function(e,t){var n=e.control,i=t.control;if(di(n))return 1;if(di(i))return-1;var r=_i(n.priority)?n.priority:0;return(_i(i.priority)?i.priority:0)-r}),_=0;_<v;_+=1)di(h=(u=s[_]).control)||(di(t)||t.controls.push(h),fi(h.initialize)&&h.initialize());return d},g.getInstance=function(){var e=new g;return e._Promise=Cr(w),e._ContextManager=m._ContextManager,e._compiler=Cr(_),e._CommentManagerFactory=Cr(f),e._ControlFactory=Cr(T),e._TemplateControlFactory=m._TemplateControlFactory,e._BindableTemplatesFactory=g._BindableTemplatesFactory,e._log=g._log,e},g._collectAttributes=function(e){for(var t,n,i,r,o,s,a,l,u=[],c=m.hasMarkup,h=m.findMarkup,p=m._parser,_=e.length,f={},d=!1,v=0;v<_;v+=1)i=(t=e[v]).value,n=t.name.replace(/^data-/i,"").toLowerCase(),ni(l=_r[n])||(l=fr[n]),n===ht?""!==i&&(1!==(r=p.parse(i)).identifiers.length&&g._log.warn("Incorrect "+ht+": "+i+", must contain a single identifier."),o=r.identifiers[0]):n!==lt&&(a=(s=c(i))?h(i):[],d||!s&&di(l)||(d=!0),u.push({control:null,node:t,nodeName:n,expressions:a,injector:l})),f[Ai(n)]=i;return{element:null,attributes:f,nodes:u,childContext:o,hasControl:d}},g._copyAttributeNodes=function(e){for(var t,n=[],i=e.length,r=0;r<i;r+=1)t=e[r],n.push({expressions:t.expressions,nodeName:t.nodeName});return n},g._cloneNode=function(e,t,n){return{control:n,injector:e.injector,expressions:e.expressions,node:t,nodeName:e.nodeName}},g._cloneNodeMap=function(e,t,n,i){var r=e.hasControl,o={attributes:e.attributes,childContext:e.childContext,nodes:[],element:t,uiControlNode:di(e.uiControlNode)?null:g._cloneNode(e.uiControlNode,t,i),hasControl:r};return r&&(o.nodes=g.createAttributeControls(e,n,i,t,!0)),o},g.prototype.clone=function(e,t,n){var i,r,o,s,a=this.replace,l=this.children,u=di(n)?null:n.uiControlNode.control,c=!di(u);if(!c){var h=t.getUiControl();ni(h)||(h=t.getParentControl()),c=!di(u=g.cloneUiControl(this.nodeMap,h))}if(a){var p=e.parentNode.childNodes,_=Array.prototype,f=_.indexOf.call(p,e);i=_.slice.call(p,f+1,f+this.replaceNodeLength),r=g.clone(this,t,null,u,n),u.elementNodes=i,u.startNode=e,u.endNode=i.pop(),o=l.shift(),s=l.shift(),o.clone(u.startNode,r),s.clone(u.endNode,r),fi(u.initialize)&&u.initialize()}else i=Array.prototype.slice.call(e.childNodes),n=(r=g.clone(this,t,e,u,n)).nodeMap,c&&(u.element=e,fi(u.initialize)&&u.initialize());for(var d=l.length,v=0,m=0;m<d;m+=1)v+=l[m].clone(i[v],r);return a?(l.unshift(s),l.unshift(o),v+2):1},g.prototype.initialize=function(e,t,n){s.prototype.initialize.call(this,e,t);var i,r=e.uiControlNode,o=!di(r);o&&(this._populateUiControl(),i=r.control,this.hasOwnContext=i.hasOwnContext),e.hasControl&&g.createAttributeControls(e,this.getParentControl(),i),!n&&o&&fi(i.initialize)&&i.initialize()},g.prototype.bind=function(){var r=this,e=this.nodeMap,t=this.getParentControl(),n=e.uiControlNode,i=[];if(!di(n)){var o,s=n.control,a=this._TemplateControlFactory,l=!s.hasOwnContext,u=this._ContextManager.getManager,c=e.childContext,h=di(t)?W:t.absoluteContextPath;if(i.push(s),l&&!di(c))if("@"===c[0]){var p=c.split("."),_=p.shift().slice(1),f=a.findResource(s,_);if(ni(f)){var d=f.resource;c=0<p.length?"."+p.join("."):"",_===$n?h+=c:_===Mn?h=W+c:d.type===Rn||d.type===On?(h="resources."+_+".value"+c,s.root=f.control):this._log.warn('Only resources of type "observable" can be set as context.')}else this._log.warn("Could not set the context of "+s.type+' with the resource specified as "'+c+'".')}else h+="."+c;ni(s.root)||(s.root=this._ControlFactory.getRootControl(s),ni(s.root)||(s.root=s)),o=u(s.root);var v=!1;l?(s.context=o.getContext(h.split("."),!1),v=vi(s.context)&&!this._BindableTemplatesFactory.isBoundControl(s)):h=W,v?this.contextPromise=new this._Promise(function(n,e){var i=o.observe(h,{uid:s.uid,listener:function(e,t){vi(e)||(i(),s.context=e,r._beforeLoad(s,h),n())}})}):this._beforeLoad(s,h)}return this._observeControlIdentifiers(e.nodes,t,i,e.element),i},g.prototype.setUiControlTemplate=function(e){var n=this,t=this.nodeMap.uiControlNode;if(di(t))di(this.parent)&&this.bindAndLoad();else{var i=t.control;this.templatePromise=this._TemplateControlFactory.determineTemplate(i,e).then(function(e){n.templatePromise=null,n._initializeControl(i,e.cloneNode(!0))},function(e){if(n.templatePromise=null,di(e)){var t=e;n._BindableTemplatesFactory.isBoundControl(i)&&(t=Hi(i.element.childNodes)),n._initializeControl(i,t)}else ki(function(){li(e)&&(e=new Error(e)),n._log.error(e)})})}},g.prototype.getUiControl=function(){var e=this.nodeMap.uiControlNode;if(!di(e))return e.control},g.prototype.fulfillTemplate=function(){var e=this;return di(this.templatePromise)?this._fulfillChildTemplates():this.templatePromise.then(function(){return e._fulfillChildTemplates()})},g.prototype.fulfillAndLoad=function(){var t=this;return this.fulfillTemplate().then(function(){return t.bindAndLoad()}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),t._log.error(e)})})},g.prototype.bindAndLoad=function(){var t=this,e=this.bind();return(ci(this.contextPromise)?this.contextPromise.then(function(){return t._bindChildren()}):this._bindChildren()).then(function(){return t._loadControls(e,t.getUiControl())}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),t._log.error(e)})})},g.prototype.observeRootContext=function(n,i){var r=this;return i=i.bind(this),di(n.context)?new this._Promise(function(e){var t=r._ContextManager.getManager(n).observe(W,{listener:function(){t(),i().then(e)},uid:n.uid})}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),r._log.error(e)})}):i()},g.prototype._beforeLoad=function(n,e){var t=this._ContextManager.getManager(n.root),i=this._TemplateControlFactory;n.zCC__plat=t.observe(e,{uid:n.uid,priority:1e3,listener:function(e,t){n.context=e}}),i.setAbsoluteContextPath(n,e),i.setContextResources(n),g._ResourcesFactory.bindResources(n.resources)},g.prototype._bindChildren=function(){for(var e,t=this.children,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).hasOwnContext?this.isClone?i.push(e.observeRootContext(e.getUiControl(),e.bindAndLoad)):i.push(e.observeRootContext(e.getUiControl(),e.fulfillAndLoad)):vi(e.children)?e.bind():i.push(e.bindAndLoad());return this._Promise.all(i)},g.prototype._loadControls=function(e,t){var n,i,r,o,s=e.length,a=this._ControlFactory.load,l=di(t);if(l)o=0;else{var u=t.priority;r=_i(u)?u:100,o=1}for(;o<s;o+=1)(n=e[o]).templateControl=t,!l&&r>n.priority&&(l=!0,i=a(t)),a(n);return l||(i=a(t)),i},g.prototype._populateUiControl=function(){var e=this.nodeMap,t=this.getParentControl(),n=e.uiControlNode,i=n.control,r=e.element,o=Array.prototype.slice.call(r.childNodes),s=g._AttributesFactory.getInstance(),a=this.replace=null===i.replaceWith||""===i.replaceWith,l=i.uid,u=i.resources;li(l)||(l=i.uid=Ri(he)),g._managerCache.put(l,this),di(t)||i.parent===t||(t.controls.push(i),i.parent=t),fi(r.setAttribute)&&r.setAttribute(Ot,""),i.element=r,i.controls=[],s.initialize(i,e.attributes),i.attributes=s,ni(u)&&fi(u.add)?u.add(n.resourceElement):((u=g._ResourcesFactory.getInstance()).initialize(i,n.resourceElement),i.resources=u),g._ResourcesFactory.addControlResources(i),i.type=n.nodeName,ni(i.bindableTemplates)||(i.bindableTemplates=this._BindableTemplatesFactory.create(i)),!(0<o.length)||hi(i.templateString)&&hi(i.templateUrl)||(i.innerTemplate=Hi(o)),a&&this._replaceElement(i,e)},g.prototype._replaceElement=function(e,t){var n=t.element,i=n.parentNode,r=g._document,o=e.type,s=e.uid,a=e.startNode=r.createComment(o+" "+s+kn),l=e.endNode=r.createComment(o+" "+s+Sn),u=this._CommentManagerFactory.create;u(a,this),u(l,this),i.insertBefore(a,n),i.insertBefore(l,n.nextSibling),e.elementNodes=Gi(n),e.element=t.element=null},g.prototype._initializeControl=function(e,t){var n,i=this.nodeMap.element,r=this.replace;if(!di(t)){var o=g.locateResources(t);di(o)||e.resources.add(g._ResourcesFactory.parseElement(o)),r?(n=e.endNode,e.elementNodes=Array.prototype.slice.call(t.childNodes),Xi(n.parentNode,t,n)):Xi(i,t,i.lastChild)}if(fi(e.setTemplate)&&e.setTemplate(),r){this._compiler.compile(e.elementNodes,e);var s=e.startNode,a=s.parentNode,l=Array.prototype.slice.call(a.childNodes);n=e.endNode,e.elementNodes=l.slice(l.indexOf(s)+1,l.indexOf(n)),this.replaceNodeLength=e.elementNodes.length+2}else this._compiler.compile(i,e);di(e.parent)&&this.fulfillAndLoad()},g.prototype._observeControlIdentifiers=function(e,t,n,i){for(var r,o,s,a=!di(t),l=this.replace,u=[],c=e.length,h=0;h<c;h+=1)o=(r=e[h]).control,a&&0<r.expressions.length&&(s=p.getInstance(),u.push(s),s.initialize(i,r,t,n,l),m.observeExpressions(r.expressions,t,s.attributeChanged.bind(s))),di(o)||n.push(o);for(c=u.length,h=0;h<c;h+=1)u[h].attributeChanged()},g.prototype._fulfillChildTemplates=function(){for(var e,t=this,n=this.children,i=n.length,r=[],o=0;o<i;o+=1)vi((e=n[o]).children)||r.push(e.fulfillTemplate());return this._Promise.all(r).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),t._log.error(e)})})},g._inject={_Promise:w,_ContextManager:Z,_compiler:_,_CommentManagerFactory:f,_ControlFactory:T,_TemplateControlFactory:z,_BindableTemplatesFactory:F,_log:k},g}(m);function i(e,t,n,i,r,o){return s._document=e,s._managerCache=t,s._ResourcesFactory=n,s._AttributesFactory=i,s._BindableTemplatesFactory=r,s._log=o,s}e.ElementManager=s,e.IElementManagerFactory=i,sr.injectable(I,i,[G,A,$,O,F,k],xn),sr.injectable("$ElementManagerInstance",s,null,Cn);var r=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="text",e}return __extends(o,t),o.create=function(e,t){var n=e.nodeValue,i=new o;if(m.hasMarkup(n)){var r={nodes:[{node:e,expressions:m.findMarkup(n)}]};return i.initialize(r,t),i}return i.initialize(null,t),i.bind=Kn,i},o._cloneNodeMap=function(e,t){var n=e.nodes[0];return{nodes:[{expressions:n.expressions,nodeName:n.nodeName,node:t}]}},o._clone=function(e,t,n){var i=e.nodeMap,r=new o;return di(i)?(r.initialize(null,n),r.bind=Kn):r.initialize(o._cloneNodeMap(i,t),n),r},o.prototype.clone=function(e,t){return o._clone(this,e,t),1},o.prototype.bind=function(){var e=this.getParentControl(),t=this.nodeMap.nodes[0],n=t.node,i=t.expressions;m.observeExpressions(t.expressions,e,this._setText.bind(this,n,e,i)),this._setText(n,e,i)},o.prototype._setText=function(e,t,n){ni(t)||(t={}),e.nodeValue=m.build(n,t)},o}(m);function o(){return r}e.TextManager=r,e.ITextManagerFactory=o,sr.injectable(j,o,null,xn),sr.injectable("$TextManagerInstance",r,null,Cn);var a=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="comment",e}return __extends(i,t),i.create=function(e,t){var n=new i;return n.initialize({nodes:[{node:e}]},t),n},i.prototype.clone=function(e,t){return i.create(e,t),1},i}(m);function l(){return a}e.CommentManager=a,e.ICommentManagerFactory=l,sr.injectable(f,l,null,xn),sr.injectable("$CommentManagerInstance",a,null,Cn);var p=function(){function t(){this._lastValues={}}return t.getInstance=function(){var e=new t;return e._NodeManager=Cr(v),e},t.prototype.initialize=function(e,t,n,i,r){this.element=e,this.node=t,this.parent=n,this._controls=i,this.replace=r,t.nodeName!==En?this.attributeChanged=this._staticAttributeChanged:this.attributeChanged=this._dynamicAttributeChanged},t.prototype._dynamicAttributeChanged=function(){var e,t,n=this.node,i=n.node,r=this._NodeManager,o=this._lastValues,s=this.element,a=i.value,l=r.build(n.expressions,this.parent).trim().split(/\s+/),u=l.length;if(r.hasMarkup(a)){mn.length;for(var c=gn.length,h=gn[c-1],p=a.indexOf(mn),_=a.indexOf(gn);-1!==p&&-1!==_;){for(;a[_]!==h||a[_+1]===h;)_+=1;_+=1,p=(a=a.slice(0,p).trim()+" "+a.slice(_).trim()).indexOf(mn),_=a.indexOf(gn)}i.value=a.trim()}for(t=0;t<u;t+=1)o[l[t]]=!0;for(u=(l=Object.keys(o)).length,t=0;t<u;t+=1)o[e=l[t]]?(ir(s,e),o[e]=!1):(Li(o,e),rr(s,e));this._notifyAttributes(n.nodeName,i.value)},t.prototype._staticAttributeChanged=function(){this._controls;var e=this.node,t=Ai(e.nodeName),n=this._NodeManager.build(e.expressions,this.parent);this._notifyAttributes(t,n),this.replace||(e.node.value=n)},t.prototype._notifyAttributes=function(e,t){for(var n,i,r=this._controls,o=r.length,s=0;s<o;s+=1)i=(n=r[s].attributes)[e],n[e]=t,n._attributeChanged(e,t,i)},t}();e.AttributeManager=p}(d.processing||(d.processing={})),function(e){var t=function(){function o(){this.uid=Ri(he),this.isRoot=!1,this._removeUrlListener=Kn,this._ignoreOnce=!1,this._backNavigate=!1}return o.prototype.initialize=function(e){ni(this._router=e)&&e.isRoot&&!ni(o._root)&&(this.isRoot=!0,(o._root=this)._observeUrl())},o.prototype.navigate=function(t,n){var i,r=this;return n=ni(n)?n:{},this.finishNavigating().then(function(){if(!li(i=n.isUrl?t:r._generate(t,n.parameters,n.query))){var e=new Error("Cannot serialize url from input parameters, check your view reference.");r._log.error(e)}return r._navigate(i,n.replace)})},o.prototype.finishNavigating=function(){var e=o._root._router;return e.navigating?e.finishNavigating.catch(Kn):this._Promise.resolve()},o.prototype.goBack=function(e){var t=this;e=ni(e)?e:{};var n=Number(e.length);return _i(n)||(n=1),this.isRoot?this.finishNavigating().then(function(){return t._backNavigate=!0,t._goBack(n)}):o._root.goBack(e)},o.prototype.isBackNavigation=function(){return this.isRoot?this._backNavigate:o._root.isBackNavigation()},o.prototype.dispose=function(){this._removeUrlListener(),Li(this,"router")},o.prototype._navigate=function(n,i){var r=this;return this.isRoot?new this._Promise(function(e,t){r._resolveNavigate=e,r._rejectNavigate=t,r._browser.url()===r._browser.url(n,i)&&r._resolveNavigate()}):o._root._navigate(n,i)},o.prototype._goBack=function(n){var i=this;return new this._Promise(function(e,t){i._resolveNavigate=e,i._rejectNavigate=t,i._browser.back(n)})},o.prototype._observeUrl=function(){var i=this;if(ni(this._router)){var r,n=this._EventManager,o=Cr(vt),s=ni(o)&&fi(o.navigated),a=function(e){i._previousUrl=r;var t=i._history,n=t.state;i._ignoreOnce=!0,di(n.previousLocation)||n.previousLocation===r?t.go(-1):t.go(1),i._backNavigate=!1,fi(i._rejectNavigate)&&i._rejectNavigate(e),hi(e)||i._log.warn(e)};this._previousUrl=this._browser.url(),n.dispose(this.uid),n.on(this.uid,Lt,function(){n.dispatch("backButtonPressed",i,n.DIRECT).defaultPrevented||i.goBack()}),n.on(this.uid,Rt,function(e,t){if(i._ignoreOnce)return i._ignoreOnce=!1,void(fi(i._resolveNavigate)&&(i._backNavigate=!1,i._resolveNavigate()));r=i._previousUrl,n.dispatch(It,i,n.DIRECT,[t]).defaultPrevented?a(new Error("Navigation prevented during "+It+" event")):i.finishNavigating().then(function(){return n.dispatch(jt,i,n.DIRECT,[t]),i._router.navigate(t.pathname,t.query)}).then(function(){i._previousUrl=t.pathname,fi(i._resolveNavigate)&&(i._backNavigate=!1,i._resolveNavigate()),s&&o.navigated(t.href),n.dispatch("navigated",i,n.DIRECT,[t])},a)})}},o.prototype._generate=function(e,t,n){if(!di(this._router))return hi(e)?e:this._router.generate(e,t,n)},o._inject={_Promise:w,_Injector:le,_browserConfig:V,_browser:ee,_EventManager:N,_window:Q,_log:k,_history:ue},o}();function n(e){return e.history}e.Navigator=t,sr.injectable(S,t,null,Cn),e.History=n,sr.injectable(ue,n,[Q]);var _,i=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),f={},d={},v={},r=function(){function p(){this.type=pn,this.name="",this.regex=""}return p.parse=function(e,t,n){if(!(li(e)&&mi(t)&&ni(n)))return[];"/"===e[0]&&(e=e.slice(1));for(var i,r,o,s=e.split("/"),a=s.length,l=p.__findSegment,u=[],c=p._regex,h=0;h<a;h+=1)""!==(i=s[h])?ni(o=i.match(c.dynamicSegmentsRegex))?(r=o[1],u.push(l(r,ie,f)),t.push(r),n.dynamics+=1):ni(o=i.match(c.splatSegmentRegex))?(r=o[1],u.push(l(r,re,d)),t.push(r),n.splats+=1):(u.push(l(i,ne,v)),n.statics+=1):(ni(_)||(_=Cr(te)),u.push(_));return u},p.__findSegment=function(e,t,n){var i=n[e];return ni(i)||(i=n[e]=Cr(t)).initialize(e),i},p.prototype.initialize=function(e){this.name=e},p.prototype.reduceCharacters=function(e,t){return ni(this._specification)&&(t=e(t,this._specification)),t},p.prototype.generate=function(e){return this.name},p}();function o(e){return r._regex=e,r}e.BaseSegment=r,e.IBaseSegmentFactory=o,sr.injectable(Y,o,[K],xn),sr.injectable(te,r,null,Cn);var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=fn,e}return __extends(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.regex=this.name.replace(i,"\\$1")},e.prototype.reduceCharacters=function(e,t){for(var n=this.name,i=n.length,r=t,o=0;o<i;o+=1)r=e(r,{validCharacters:n[o]});return r},e}(r);e.StaticSegment=s,sr.injectable(ne,s,null,Cn);var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=_n,e}return __extends(e,t),e.prototype.generate=function(e){if(ni(e))return e[this.name]},e}(r);e.VariableSegment=a,sr.injectable("$VariableSegmentInstance",a,null,Cn);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=dn,e.regex="(.+)",e._specification={invalidCharacters:"",repeat:!0},e}return __extends(e,t),e}(a);e.SplatSegment=l,sr.injectable(re,l,null,Cn);var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=vn,e.regex="([^/]+)",e._specification={invalidCharacters:"/",repeat:!0},e}return __extends(e,t),e}(a);e.DynamicSegment=u,sr.injectable(ie,u,null,Cn);var c=function(){function n(){this.initialize()}return n.compile=function(e,t){return e.reduceCharacters(function(e,t){return e.add(t)},t)},n.link=function(e,t){for(var n,i,r,o,s,a=e.delegates,l=e.regex,u=a.length,c=t.match(l),h=[],p=1,_=0;_<u;_+=1){for(i={},o=(n=(s=a[_]).names).length,r=0;r<o;r+=1)i[n[r]]=c[p],p+=1;h.push({delegate:s.delegate,parameters:i,isDynamic:0<o})}return h},n.recognize=function(e,t){for(var n,i=[],r=t.length,o=0;o<r;o+=1)n=t[o],i=i.concat(n.match(e));return i},n.sort=function(e){return mi(e)?e.sort(function(e,t){if(n=e.types,s=t.types,i=n.splats,a=s.splats,i!==a)return i-a;if(r=n.statics,o=n.dynamics,l=s.statics,u=s.dynamics,0<i){if(r!==l)return l-r;if(o!==u)return u-o}return o!==u?o-u:r!==l?l=r:0}):e;var n,i,r,o,s,a,l,u},n.prototype.initialize=function(e){this.specification=e,this.nextStates=[]},n.prototype.add=function(e){var t=this._find(e);return ni(t)||((t=Cr(n)).initialize(e),this.nextStates.push(t),e.repeat&&t.nextStates.push(t)),t},n.prototype.match=function(t){var n,i,r=[];return this._someChildren(function(e){n=e.specification,li(i=n.validCharacters)&&-1<i.indexOf(t)?r.push(e):li(i=n.invalidCharacters)&&-1===i.indexOf(t)&&r.push(e)}),r},n.prototype._find=function(e){var t,n,i=e.validCharacters,r=e.invalidCharacters;return this._someChildren(function(e){if((t=e.specification).validCharacters===i&&t.invalidCharacters===r)return n=e,!0}),n},n.prototype._someChildren=function(e){for(var t=this.nextStates,n=t.length,i=0;i<n;i+=1)if(!0===e(t[i]))return!0;return!1},n}();function h(){return c}e.State=c,e.IStateStatic=h,sr.injectable(oe,h,null,yn),sr.injectable(se,c,null,Cn);var p=function(){function e(){this._namedRoutes={}}return e.prototype.register=function(e,t){if(mi(e)){for(var n,i=this._rootState,r=e.length,o=["^"],s={statics:0,dynamics:0,splats:0},a=[],l=[],u=0;u<r;u+=1)n=this._parse(e[u],a,s),l=l.concat(n),i=this._compile(n,i,o);(i=this._finalize(i,o)).delegates=a,i.regex=new RegExp(o.join("")+"$"),i.types=s,ni(t)&&li(t.name)&&(this._namedRoutes[this._toLowerCase(t.name)]={segments:l,delegates:a})}},e.prototype.recognize=function(e){var t,n;return e=this._addLeadingSlash(e),(t=this._hasTrailingSlash(e))&&(e=e.substr(0,e.length-1)),n=this._filter(this._findStates(e)),this._link(n[0],e,t)},e.prototype.generate=function(e,t){e=this._toLowerCase(e);var n,i,r=this._namedRoutes[e],o="";if(ni(r)){i=(n=r.segments).length;for(var s=0;s<i;s+=1){var a=n[s];a.type!==pn&&(o+="/",o+=a.generate(t))}return o=this._addLeadingSlash(o)}},e.prototype.delegatesFor=function(e){e=this._toLowerCase(e);var t,n=this._namedRoutes[e];return ni(n)&&mi(t=n.delegates)?t.slice(0):[]},e.prototype.exists=function(e){return ni(this._namedRoutes[this._toLowerCase(e)])},e.prototype._toLowerCase=function(e){return li(e)?e.toLowerCase():e},e.prototype._finalize=function(e,t){return e===this._rootState&&(e=e.add({validCharacters:"/"}),t.push("/")),e},e.prototype._parse=function(e,t,n){var i=[];return t.push({delegate:e.delegate,names:i}),this._BaseSegmentFactory.parse(e.pattern,i,n)},e.prototype._compile=function(e,t,n){for(var i,r=e.length,o=this._State.compile,s=0;s<r;s+=1)(i=e[s]).type!==pn&&(t=o(i,t=t.add({validCharacters:"/"})),n.push("/"+i.regex));return t},e.prototype._addLeadingSlash=function(e){return"/"!==(e=decodeURI(e))[0]&&(e="/"+e),e},e.prototype._hasTrailingSlash=function(e){var t=e.length;return 1<t&&"/"===e[t-1]},e.prototype._findStates=function(e){for(var t=[this._rootState],n=this._State.recognize,i=e.length,r=0;r<i&&0!==(t=n(e[r],t)).length;r+=1);return t},e.prototype._filter=function(e){for(var t,n=e.length,i=[],r=0;r<n;r+=1)mi((t=e[r]).delegates)&&i.push(t);return this._State.sort(i)},e.prototype._link=function(e,t,n){if(ni(e)&&mi(e.delegates))return n&&this._isDynamic(e)&&(t+="/"),this._State.link(e,t)},e.prototype._isDynamic=function(e){return"(.+)$"===e.regex.source.slice(-5)},e._inject={_BaseSegmentFactory:Y,_State:oe,_rootState:se},e}();e.RouteRecognizer=p,sr.injectable(ae,p,null,Cn);var m="/*childRoute",b=m.length,g=function(){function i(){this.navigating=!1,this.children=[],this.isRoot=!1,this._paramTransforms={},this._queryTransforms={},this._interceptors={},this._ports=[],this._resolve=this._Promise.resolve.bind(this._Promise),this._reject=this._Promise.reject.bind(this._Promise),this.uid=Ri(he),this.isRoot=di(i.currentRouter()),i.currentRouter(this),this.initialize()}return i.currentRouter=function(e){return di(e)||(i.__currentRouter=e),i.__currentRouter},i.prototype.initialize=function(e){this.parent=e},i.prototype.addChild=function(e){return di(e)||-1<this.children.indexOf(e)||(e.initialize(this),this.children.push(e)),e},i.prototype.removeChild=function(e){var t=this.children,n=t.indexOf(e);n<0||(t.splice(n,1),i.currentRouter()===e&&i.currentRouter(this))},i.prototype.register=function(e){var n=this,t=this._ports;return di(e)||-1<t.indexOf(e)?this._resolve():(t.push(e),ni(this.currentRouteInfo)?(this.navigating=!0,this._resolve(this.finishNavigating).catch(Kn).then(function(){var t=ti(n.currentRouteInfo,!0);return n.finishNavigating=n._canNavigateTo(t).then(function(e){if(e)return n.currentRouteInfo=void 0,n._performNavigation(t)}).then(function(){n.navigating=!1,n.currentRouteInfo=t},function(){n.navigating=!1})})):this._resolve())},i.prototype.unregister=function(e){var t=this._ports,n=t.indexOf(e);n<0||(t.splice(n,1),0!==t.length||di(this.parent)||this.parent.removeChild(this))},i.prototype.configure=function(e,t){var n=this;return mi(e)?Ci(function(e){n._configureRoute(e)},e):this._configureRoute(e),!1!==t?this._forceNavigate():this._resolve()},i.prototype.unknown=function(e){return this._unknownHandler=e,this},i.prototype.param=function(e,t,n){return this._addHandler(e,t,n,this._paramTransforms)},i.prototype.queryParam=function(e,t,n){return this._addHandler(e,t,n,this._queryTransforms)},i.prototype.intercept=function(e,t){vi(t)&&(t="*");var n=t;"*"!==t&&(t=this._Injector.convertDependency(t)),t===In&&(t=n);var i=this._interceptors[t];return mi(i)||(i=this._interceptors[t]=[]),i.push(e),this},i.prototype.navigate=function(t,e,n,i){var r=this;!1===i&&(i=!ni(this.currentRouteInfo)),ni(e)||(e={});var o=this._resolve,s=Fi(e);if("/"===t&&(t=""),n=!0===n,!li(t)||this.navigating||!n&&t===this._previousUrl&&s===this._previousQuery)return this.navigating?this.finishNavigating.then(function(){return r.navigate(t,e,n)}):o();var a,l,u,c=this._recognizer,h=c.recognize(t),p=hi(h);p||((a=h[0]).query=e);var _=this._isSameRoute(a);if(p||_){var f=t;if(_){var d=a.delegate.alias;hi(d)&&(d=a.delegate.view),u=c.generate(d,a.parameters),f=f.replace(u,"")}if("/"===f||""===f?(f="",Ni(function(e){return!hi(h=e._recognizer.recognize(f))},this.children)):h=this._childRecognizer.recognize(f),hi(h)){if(p){if(this._previousUrl=f,this._previousQuery=s,this.currentRouteInfo=a,fi(this._unknownHandler)){var v={segment:t,view:void 0};return o(this._unknownHandler(v)).then(function(){var e=v.view;if(!vi(e))return r.configure({pattern:t,view:e})})}return o()}h=c.recognize(t),(a=h[0]).query=e,l=a.delegate.pattern}else if((a=h[0]).query=e,l=(l=a.delegate.pattern).slice(0,l.length-b),!p||this._isSameRoute(a))return this.navigating=!0,this.finishNavigating=this._navigateChildren(a).then(function(){r._previousUrl=t,r._previousQuery=s,r.navigating=!1},function(e){throw r.navigating=!1,e})}else l=a.delegate.pattern;var m=a.delegate.alias;hi(m)&&(m=a.delegate.view),u=c.generate(m,a.parameters);var g=this._previousSegment;this._previousSegment=u,this.navigating=!0;var y=this._nextRouteInfo=ti(a,!0);return this.finishNavigating=this._canNavigate(a,i).then(function(e){if(!e)throw r.navigating=!1,new Error("Not cleared to navigate");return r._previousUrl=t,r._previousQuery=s,r._performNavigation(a)}).then(function(){r._previousPattern=l,r._previousSegment=u,r.currentRouteInfo=y,r.navigating=!1},function(e){throw r._previousSegment=g,r.navigating=!1,e})},i.prototype.generate=function(e,t,n){var i=e;(e=this._Injector.convertDependency(e))===In&&(e=i);for(var r=this,o="";!di(r)&&!r._recognizer.exists(e);)r=r.parent;if(di(r))throw new Error("Route for "+e+" does not exist.");for(var s,a=r._recognizer.generate(e,t);!di(r=r.parent);)o=(s=di(s=r._previousSegment)||"/"===s?"":s)+o;return o+a+Fi(n)},i.prototype._configureRoute=function(e){var t=this._Injector.convertDependency(e.view),n=e.alias;if(hi(n)&&(n=t),t!==In){e.view=t,hi(e.alias=n)&&(e.alias=t);var i={pattern:e.pattern,delegate:e},r=e.pattern+m,o={pattern:r,delegate:{pattern:r,view:t,alias:n}};this._recognizer.register([i],{name:n}),this._childRecognizer.register([o])}},i.prototype._addHandler=function(e,t,n,i){vi(n)&&(n="*");var r=n;if("*"!==n&&(n=this._Injector.convertDependency(n)),n===In&&(n=r),hi(n)||hi(t))return this;var o=i[n];ni(o)||(o=i[n]={});var s=o[t];return mi(s)||(s=o[t]=[]),s.push(e),this},i.prototype._forceNavigate=function(){var e,t=this;this._resolve;if(this.navigating)return this.finishNavigating.then(function(){return t._forceNavigate()});if(this.isRoot&&hi(this._previousUrl)){var n=this._browser.urlUtils();this._previousUrl=n.pathname,e=n.query}return hi(this._previousQuery)||(e=Oi(this._previousQuery)),this.navigate(this._previousUrl,e,!0)},i.prototype._navigateChildren=function(t,n){void 0===n&&(n=!0);var i=this._getChildRoute(t);return di(i)?this._resolve():Ei(function(e){return e.navigate(i,t.query,void 0,n)},this.children).then(Kn)},i.prototype._getChildRoute=function(e){if(!di(e)){var t=e.parameters.childRoute;return li(t)||(t=""),"/"+t}},i.prototype._performNavigation=function(t){var e=this,n=this._isSameRoute(this._nextRouteInfo);return this._performNavigateFrom(n).then(function(){if(!n)return Ei(function(e){return e.navigateTo(t)},e._ports)}).then(function(){return e._navigateChildren(t,!1)})},i.prototype._performNavigateFrom=function(e){var t=this;return Ei(function(e){return e._performNavigateFrom()},this.children).then(function(){if(!e)return Ei(function(e){return e.navigateFrom()},t._ports)}).then(Kn)},i.prototype._canNavigate=function(t,e){var n=this;void 0===e&&(e=!0);var i=this._isSameRoute(this._nextRouteInfo);return e?this._canNavigateFrom(i).then(function(e){return e?n._canNavigateTo(t,i):e}):this._callAllHandlers(t.delegate.alias,t.parameters,t.query).then(function(){return n._callInterceptors(t)}).then(function(){return!0},function(){return!0})},i.prototype._canNavigateFrom=function(t){var n=this;return this._Promise.all(this.children.reduce(function(e,t){return e.concat(t._canNavigateFrom())},[])).then(Mi).then(function(e){return!e||t?[e]:Ei(function(e){return e.canNavigateFrom()},n._ports)}).then(Mi)},i.prototype._canNavigateTo=function(t,n){var i=this;return hi(this._ports)?this._resolve(!0):this._callAllHandlers(t.delegate.alias,t.parameters,t.query).then(function(){return i._callInterceptors(t)}).then(function(e){return!1===e||n?[e]:Ei(function(e){return e.canNavigateTo(t)},i._ports)}).then(Mi)},i.prototype._callAllHandlers=function(e,t,n){var i=this;return this._callHandlers(this._queryTransforms["*"],n,void 0,!0).then(function(){return i._callHandlers(i._queryTransforms[e],n,void 0,!0)}).then(function(){return i._callHandlers(i._paramTransforms["*"],t,n)}).then(function(){return i._callHandlers(i._paramTransforms[e],t,n)}).then(Kn)},i.prototype._callHandlers=function(e,n,i,r){var o=this._resolve;return ni(n)||(n={}),Ei(function(e,t){return Ti(function(e){return!0!==r&&vi(n[t])?o():o(e(n[t],n,i))},e)},e).then(Kn)},i.prototype._callInterceptors=function(t){var n=this,i=this._resolve;return Ti(function(e){return i(e(t))},this._interceptors["*"]).then(Mi).then(function(e){return e?Ei(function(e){return i(e(t))},n._interceptors[t.delegate.alias]):[e]}).then(Mi)},i.prototype._isSameRoute=function(e){var t=ti(this.currentRouteInfo,!0);if(e=ti(e,!0),this._sanitizeRouteInfo(t),this._sanitizeRouteInfo(e),!ni(t)||!ni(e))return!1;var n=t.delegate,i=e.delegate,r=Fi(t.parameters),o=Fi(e.parameters),s=Fi(t.query),a=Fi(e.query);return n.view===i.view&&n.alias===i.alias&&n.pattern===i.pattern&&r===o&&(s===a||0<this.children.length)},i.prototype._sanitizeRouteInfo=function(e){if(ni(e)&&e.parameters.hasOwnProperty("childRoute")){var t=e.delegate,n=t.pattern;t.pattern=n.slice(0,n.length-b),Li(e.parameters,"childRoute")}},i.prototype._clearInfo=function(){this._previousSegment=void 0,this._previousPattern=void 0,this._previousUrl=void 0,this._previousQuery=void 0,this.currentRouteInfo=void 0,this.navigating=!1,Ci(function(e){e._clearInfo()},this.children)},i._inject={_Promise:w,_Injector:le,_EventManager:N,_browser:ee,_browserConfig:V,_recognizer:ae,_childRecognizer:ae},i}();function y(){return g}e.Router=g,sr.injectable("$Router",g,null,Cn),e.IRouterStatic=y,sr.injectable(q,y)}(d.routing||(d.routing={})),function(l){var e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=Ai(this.type),t=this.attributes[e];hi(t)||this._isPrecompiled()||(this._label=t,this._define(t))},t.prototype.dispose=function(){for(var e=this._label,t=this.parent;!vi(e)&&ni(t);)ni(t[e])&&oi(t[e].element)&&t[e].element===this.element&&Li(t,e),t=t.parent},t.prototype._define=function(e){var t=this.templateControl;di(t)||(t.name=e);for(var n={element:this.element,control:t},i=this.parent;ni(i);){ni(i[e])||(i[e]=n),i=i.parent}},t.prototype._isPrecompiled=function(){for(var e=this.parent;!di(e);){if(-1!==e.type.indexOf(wn))return!0;e=e.parent}return!1},t}(Dr);l.Name=e,sr.control(ye,e);var t=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._aliases=[],e}return __extends(e,t),e.prototype.loaded=function(){di(this.element)||(this.attribute=Ai(this.type),this._setListener())},e.prototype._setListener=function(){var e=this.attributes[this.attribute];hi(this.event)||hi(e)||(this._parseArgs(e),this._addEventListeners())},e.prototype._addEventListeners=function(){this.addEventListener(this.element,this.event,this._onEvent,!1)},e.prototype._buildExpression=function(){var e,t,n,i=this.parent,r=this.templateControl,o=this._listener,s=Kn;if(di(r)?di(i)||(t=i.getResources(this._aliases),n=i.context):(t=r.getResources(this._aliases),di(i)||(n=i.context)),"@"===o[0]){if(!di(t)){var a=o.split("."),l=t[a[0].slice(1)];if(ni(l)){a.shift();for(var u=void 0;1<a.length&&!di(l[u=a.shift()]);)l=l[u];1===a.length?fi(l[u=a.shift()])&&(s=(e=l)[u]):this._log.warn('Invalid path for function "'+o+'"')}else fi(l)&&(s=l)}}else{var c=this.findProperty(o,this.templateControl);if(di(c))return this._log.warn("Could not find property "+o+" on any associated control."),{fn:Kn,context:{},args:[]};var h=c.expression.identifiers;if(1<h.length)return this._log.warn("Cannot have more than one identifier in a "+this.type+"'s expression."),{fn:Kn,context:{},args:[]};var p=h[0].split("."),_=c.control;if(p.pop(),0<p.length)for(var f=void 0;0<p.length&&!di(_[f=p.shift()]);)_=_[f];s=c.value,e=_}return{fn:s,context:e,args:di(this._args)?[]:this._args.evaluate(n,t)}},e.prototype._onEvent=function(e){var t=this._buildExpression(),n=t.fn;fi(n)?n.apply(t.context,t.args.concat(e)):this._log.warn("Cannot find registered event method "+this._listener+" for control: "+this.type)},e.prototype._parseArgs=function(e){if(!hi(e)){var t,n=this._regex.argumentRegex.exec(e),i=[];if(di(n))t=e;else if(t=e.slice(0,n.index),""!==n[1]){var r=this._parser.parse("["+n[1]+"]");i=r.aliases,this._args=r}if("@"===t[0]){var o=t.slice(1).split(".")[0];-1===i.indexOf(o)&&i.push(o)}this._listener=t,this._aliases=i}},e._inject={_parser:J,_regex:K},e}(Dr),n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Ht,e}return __extends(e,t),e}(l.SimpleEventControl=t);l.Tap=n;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="blur",e}return __extends(e,t),e}(t);l.Blur=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="change",e}return __extends(e,t),e}(t);l.Change=r;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="copy",e}return __extends(e,t),e}(t);l.Copy=o;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="cut",e}return __extends(e,t),e}(t);l.Cut=s;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="paste",e}return __extends(e,t),e}(t);l.Paste=a;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Qt,e}return __extends(e,t),e}(t);l.DblTap=u;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="focus",e}return __extends(e,t),e}(t);l.Focus=c;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Yt,e}return __extends(e,t),e}(t);l.TouchStart=h;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Wt,e}return __extends(e,t),e}(t);l.TouchEnd=p;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Xt,e}return __extends(e,t),e}(t);l.TouchMove=_;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Gt,e}return __extends(e,t),e}(t);l.TouchCancel=f;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Jt,e}return __extends(e,t),e}(t);l.Hold=d;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Kt,e}return __extends(e,t),e}(t);l.Release=v;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=Zt,e}return __extends(e,t),e}(t);l.Swipe=m;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=en,e}return __extends(e,t),e}(t);l.SwipeLeft=g;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=tn,e}return __extends(e,t),e}(t);l.SwipeRight=y;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=nn,e}return __extends(e,t),e}(t);l.SwipeUp=b;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=rn,e}return __extends(e,t),e}(t);l.SwipeDown=C;var x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=on,e}return __extends(e,t),e}(t);l.Track=x;var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=sn,e}return __extends(e,t),e}(t);l.TrackLeft=E;var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=an,e}return __extends(e,t),e}(t);l.TrackRight=w;var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=ln,e}return __extends(e,t),e}(t);l.TrackUp=T;var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=un,e}return __extends(e,t),e}(t);l.TrackDown=N;var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event=cn,e}return __extends(e,t),e}(t);l.TrackEnd=k;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="submit",e}return __extends(e,t),e.prototype._onEvent=function(e){this.element.hasAttribute("action")||e.preventDefault(),t.prototype._onEvent.call(this,e)},e}(t);l.Submit=S;var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="input",e}return __extends(e,t),e.prototype._addEventListeners=function(){var t,n=this,e=this.element,i=this._compat,r=!1,o=!1,s=function(e){r||n._onEvent(e)},a=function(e){fi(t)||(t=ki(function(){s(e),t=null}))};vi(i.ANDROID)&&(this.addEventListener(e,"compositionstart",function(){r=!0},!1),this.addEventListener(e,"compositionend",function(e){r=!1,s(e)},!1)),this.addEventListener(e,"input",function(e){o=!0,s(e)},!1),this.addEventListener(e,"change",function(e){o?o=!1:s(e)},!1),i.hasEvent("input")||(this.addEventListener(e,"keydown",function(e){var t=e.keyCode,n=l.KeyCodes;t===n.lwk||t===n.rwk||t>=n.shift&&t<=n.escape||t>n.space&&t<=n.down||a(e)},!1),this.addEventListener(e,"cut",a,!1),this.addEventListener(e,"paste",a,!1))},e._inject={_compat:X},e}(t);l.React=I,sr.control(ke,n),sr.control(Se,i),sr.control(Ie,r),sr.control(je,o),sr.control(Re,s),sr.control(Ae,a),sr.control(Le,u),sr.control(Pe,c),sr.control(Oe,S),sr.control(Fe,h),sr.control(Me,p),sr.control(De,_),sr.control($e,f),sr.control(ze,d),sr.control(Be,v),sr.control(Ue,m),sr.control(Ve,g),sr.control(qe,y),sr.control(He,b),sr.control(Qe,C),sr.control(Ye,x),sr.control(We,E),sr.control(Xe,w),sr.control(Ge,T),sr.control(Je,N),sr.control(Ke,k),sr.control(Ze,I),l.KeyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,"caps lock":20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,"left arrow":37,up:38,"up arrow":38,right:39,"right arrow":39,down:40,"down arrow":40,insert:45,delete:46,0:48,zero:48,")":48,"right parenthesis":48,1:49,one:49,"!":49,exclamation:49,"exclamation point":49,2:50,two:50,"@":50,at:50,3:51,three:51,"#":51,"number sign":51,hash:51,pound:51,4:52,four:52,$:52,dollar:52,"dollar sign":52,5:53,five:53,"%":53,percent:53,"percent sign":53,6:54,six:54,"^":54,caret:54,7:55,seven:55,"&":55,ampersand:55,8:56,eight:56,"*":56,asterisk:56,9:57,nine:57,"(":57,"left parenthesis":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lwk:91,"left window key":91,rwk:92,"right window key":92,select:93,"select key":93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"num lock":144,"scroll lock":145,";":186,"semi-colon":186,":":186,colon:186,"=":187,equal:187,"equal sign":187,"+":187,plus:187,",":188,comma:188,"<":188,lt:188,"less than":188,"left angle bracket":188,"-":189,dash:189,_:189,underscore:189,".":190,period:190,">":190,gt:190,"greater than":190,"right angle bracket":190,"/":191,"forward slash":191,"?":191,"question mark":191,"`":192,"grave accent":192,"~":192,tilde:192,"[":219,"open bracket":219,"{":219,"open brace":219,"\\":220,"back slash":220,"|":220,pipe:220,"]":221,"close bracket":221,"}":221,"close brace":221,"'":222,"single quote":222,'"':222,"double quote":222};var j=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.keyCodes={},e}return __extends(e,r),e.prototype._setListener=function(){var e=this.attribute;if(!hi(this.event)&&!hi(e)){var t=this.attributes[e].trim();if("{"===t[0]){var n=this.evaluateExpression(t);ni(n)||(n={method:""});var i=this._filterArgs(n);return this._setKeyCodes(i),void this.addEventListener(this.element,this.event,this._onEvent,!1)}r.prototype._setListener.call(this)}},e.prototype._filterArgs=function(e){var t=e.key,n=e.keys;return this._parseArgs(e.method),mi(n)?n:li(n)?[n]:mi(t)?t:li(t)?[t]:void(di(e.char)&&di(e.chars)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},e.prototype._onEvent=function(e){this._compareKeys(e)&&r.prototype._onEvent.call(this,e)},e.prototype._compareKeys=function(e){var t=this.keyCodes,n=e.keyCode;return(di(n)||0===n)&&(n=e.which),hi(t)||!0===t[n]},e.prototype._setKeyCodes=function(e){mi(e)||(e=[]);for(var t,n=e.length,i=this.keyCodes,r=0;r<n;r+=1)i[_i(t=e[r])?t:l.KeyCodes[t.toLowerCase()]]=!0},e}(t),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keydown",e}return __extends(e,t),e}(l.KeyCodeEventControl=j);l.KeyDown=R;var A=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.event="keydown",e}return __extends(e,r),e.prototype._onEvent=function(e){var t=this,n=e.keyCode;if((di(n)||0===n)&&(n=e.which),r.prototype._compareKeys.call(this,e)&&(48<=n&&n<=90||186<=n||96<=n&&n<=111))var i=this.addEventListener(this.element,"keypress",function(e){i(),r.prototype._onEvent.call(t,e)},!1)},e.prototype._compareKeys=function(e){return!0},e}(j);l.KeyPress=A;var L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="keyup",e}return __extends(e,t),e}(j);l.KeyUp=L;var P=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.event="keypress",e}return __extends(e,r),e.prototype._filterArgs=function(e){var t=e.char,n=e.chars;return this._parseArgs(e.method),mi(n)?n:li(n)?[n]:mi(t)?t:li(t)?[t]:void(di(e.key)&&di(e.keys)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},e.prototype._onEvent=function(e){var t,n=this.keyCodes,i=e.charCode;if((di(i)||0===i)&&(i=e.which),di(i)||0===i){if(!li(t=e.key))return}else t=String.fromCharCode(i);(hi(n)||!0===n[t])&&r.prototype._onEvent.call(this,e)},e.prototype._compareKeys=function(e){return!0},e.prototype._setKeyCodes=function(e){mi(e)||(e=[]);for(var t,n=e.length,i=this.keyCodes,r=0;r<n;r+=1)i[_i(t=e[r])?String.fromCharCode(t):t]=!0},e}(j);l.CharPress=P,sr.control(de,R),sr.control(ve,A),sr.control(me,L),sr.control(ge,P);var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="",e._stopSetter=Kn,e}return __extends(e,t),e.prototype.loaded=function(){di(this.element)||(this.attribute=Ai(this.type),this.setter(),this.__removeListener=this.attributes.observe(this.setter,this.attribute))},e.prototype.contextChanged=function(){di(this.element)||this.setter()},e.prototype.dispose=function(){this._stopSetter(),fi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null)},e.prototype.setter=function(){var n=this;this._stopSetter(),this._stopSetter=ji(function(){var e=n.element,t=n.property;if(oi(e))switch(n.attributes[n.attribute]){case"false":case"0":case"null":case"":e.setAttribute(t,""),e[t]=!1,e.removeAttribute(t);break;default:e.setAttribute(t,t),e[t]=!0}})},e}(Dr),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="checked",e}return __extends(e,t),e}(l.SetAttributeControl=O);l.Checked=F;var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="disabled",e}return __extends(e,t),e}(O);l.Disabled=M;var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="selected",e}return __extends(e,t),e}(O);l.Selected=D;var $=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="readonly",e}return __extends(e,t),e}(O);l.ReadOnly=$;var z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="display",e.value="none",e.importance="important",e._initialValue="",e}return __extends(e,t),e.prototype.initialize=function(){var e=this.element.style;ni(e)||(e={getPropertyValue:Kn});var t=e.getPropertyValue(this.property);this._setValue(this.value,this.importance),hi(t)||"none"===t||(this._initialValue=t)},e.prototype.setter=function(){var e=this;this._stopSetter(),this._stopSetter=ji(function(){if(oi(e.element))switch(e.attributes[e.attribute]){case"false":case"0":case"null":case"":e._setValue(e.value,e.importance);break;default:e._setValue(e._initialValue)}})},e.prototype._setValue=function(e,t){var n=this.property,i=this.element.style;ni(i)||(i={setProperty:Kn,removeProperty:Kn,getPropertyValue:Kn,getPropertyPriority:Kn});var r=i.getPropertyValue(n),o=i.getPropertyPriority(n);e===r&&t===o||(hi(e)?i.removeProperty(n):i.setProperty(n,e,t))},e}(O);l.Visible=z;var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="style",e._styleRegex=/(.*?):(.*)/,e._urlRegex=/url\([^\)]*\)/gi,e._urlReplace="[PLAT-STYLE-URL]",e.__addedStyles=[],e.__oldStyles={},e}return __extends(e,t),e.prototype.setter=function(){var d=this;this._stopSetter();var v=this.element,m=this.attributes[this.attribute];hi(m)||di(v)||(this._stopSetter=ji(function(){var t=[],n=d._urlReplace;m=m.replace(d._urlRegex,function(e){return t.push(e),n});var e,i,r,o,s=v.style,a=d.__addedStyles,l=d.__oldStyles,u=[],c=m.split(";"),h={},p=d._styleRegex,_=c.length;for(o=0;o<_;o+=1)di(r=p.exec(c[o]))||r.length<3||0===(e=r[1].trim()).length||vi(s[e])||(-1===a.indexOf(e)&&(l[e]=s[e]),u.push(e),i=r[2].trim(),0<t.length&&-1!==i.indexOf(n)&&(i=i.replace(n,t.shift())),h[e]=i);for(_=a.length;0<_;)e=a[_-=1],-1===u.indexOf(e)&&(h[e]=l[e],a.splice(_,1));var f=Object.keys(h);for(_=f.length;0<_;)s[e=f[_-=1]]=h[e];d.__addedStyles=a.concat(u)}))},e}(O);l.Style=B,sr.control(Ce,F),sr.control(xe,M),sr.control(Ee,D),sr.control(we,$),sr.control(Te,z),sr.control(Ne,B);var U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];hi(n)||di(e)||vi(e[t])||(e[t]=n)},t}(O),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="href",e}return __extends(e,t),e}(l.ElementPropertyControl=U);l.Href=V;var q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="src",e}return __extends(e,t),e.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];hi(n)||di(e)||vi(e[t])||(e[t]=this._browser.urlUtils(n))},e._inject={_browser:ee},e}(U);l.Src=q,sr.control(_e,V),sr.control(fe,q);var H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=100,e._supportsTwoWayBinding=!1,e._dateRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/,e._dateTimeLocalRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])T(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9])(?:\.([0-9]+))?)?/,e.__fileSupported=Cr(X).fileSupported,e.__fileNameRegex=Cr(K).fileNameRegex,e.__isSelf=!1,e}return __extends(e,t),e.prototype.initialize=function(){this._determineType()},e.prototype.loaded=function(){var e=this.parent;if(!di(e)&&!di(this.element)){var t=Ai(this.type),n=this._parser,i=this._expression=n.parse(this.attributes[t]),r=i.identifiers;if(1!==r.length)return this._log.warn("Only 1 identifier allowed in a "+this.type+" expression."),void(this._contextExpression=null);var o=r[0].split(".");if(this._property=o.pop(),0<i.aliases.length){var s=i.aliases[0],a=e.findResource(s),l=void 0;if(ni(a)){if((l=a.resource.type)!==Rn&&l!==On)return}else a={resource:{}};s===$n||s===Mn?this._contextExpression=n.parse(o.join(".")):(this._property="value",this._contextExpression={evaluate:function(){return a.resource},aliases:[],identifiers:[],expression:""})}else 0<o.length?this._contextExpression=n.parse(o.join(".")):this._contextExpression={evaluate:function(){return e.context},aliases:[],identifiers:[],expression:""};this._supportsTwoWayBinding&&this.templateControl.observeProperties(this),this._watchExpression(),di(this._addEventType)||this._addEventType()}},e.prototype.contextChanged=function(){this._watchExpression()},e.prototype.dispose=function(){this._addEventType=null},e.prototype.evaluate=function(){var e=this._expression;if(!vi(e))return this.evaluateExpression(e)},e.prototype.observeProperty=function(e,t,n){return this._observeProperty(e,t,n)},e.prototype.observeArrayChange=function(e,t){return this._observeProperty(e,t,!1,!0)},e.prototype._addTextEventListener=function(){var e,t=this,n=this.element,i=this._compat,r=!1,o=function(){r||t._propertyChanged()},s=function(){fi(e)||(e=ki(function(){o(),e=null}))};vi(i.ANDROID)&&(this.addEventListener(n,"compositionstart",function(){r=!0},!1),this.addEventListener(n,"compositionend",function(){r=!1,o()},!1)),i.hasEvent("input")?this.addEventListener(n,"input",o,!1):(this.addEventListener(n,"keydown",function(e){var t=l.KeyCodes,n=e.keyCode;(di(n)||0===n)&&(n=e.which),n===t.lwk||n===t.rwk||n>=t.shift&&n<=t.escape||n>t.space&&n<=t.down||s()},!1),this.addEventListener(n,"cut",s,!1),this.addEventListener(n,"paste",s,!1)),this.addEventListener(n,"change",o,!1)},e.prototype._addChangeEventListener=function(){this.addEventListener(this.element,"change",this._propertyChanged,!1)},e.prototype._addButtonEventListener=function(){this.addEventListener(this.element,Ht,this._propertyChanged,!1)},e.prototype._addRangeEventListener=function(){var e=this.element;this._compat.hasEvent("input")&&this.addEventListener(e,"input",this._propertyChanged,!1),this.addEventListener(e,"change",this._propertyChanged,!1)},e.prototype._getChecked=function(){return this.element.checked},e.prototype._getValue=function(){return this.element.value},e.prototype._getTextContent=function(){return this.element.textContent},e.prototype._getDate=function(){var e=this.element.value,t=this._dateRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(4===n.length)return new Date(Number(n[1]),Number(n[2])-1,Number(n[3]))}return e},e.prototype._getDateTimeLocal=function(){var e=this.element.value,t=this._dateTimeLocalRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(8===n.length)return di(n[6])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5])):di(n[7])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6])):new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6]),Number(n[7]))}return e},e.prototype._getFile=function(){var e=this.element,t=e.value;return this.__fileSupported?0<e.files.length?e.files[0]:null:{name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:Kn,msClose:Kn,slice:function(){return{}}}},e.prototype._getFiles=function(){var e=this.element;if(this.__fileSupported)return Array.prototype.slice.call(e.files);for(var t,n=e.value.split(/,|;/g),i=n.length,r=[],o=function(){return{}},s=0;s<i;s+=1)t=n[s],r.push({name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:Kn,msClose:Kn,slice:o});return r},e.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).selected&&i.push(e.value);return i},e.prototype._setText=function(e,t,n){if(!this.__isSelf)return di(e)&&!(e="")===n?(di(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},e.prototype._setRange=function(e,t,n){if(!this.__isSelf)return hi(e)&&(e=""===e?"0":0,!0===n)?(hi(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},e.prototype._setHidden=function(e,t,n){if(!this.__isSelf)return hi(e)&&!(e="")===n?(hi(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},e.prototype._setValue=function(e){var t=this.element;li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)&&(this._propertyType="boolean",e=e.toString())),t.value!==e&&(t.value=e)},e.prototype._setChecked=function(e,t,n){if(!this.__isSelf)return pi(e)||(e=!!e,!0!==n)?void(this.element.checked=e):(this.element.checked=e,void this._propertyChanged())},e.prototype._setRadio=function(e){var t=this.element;this.__isSelf||(di(e)?t.checked&&this._propertyChanged():(li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)&&(this._propertyType="boolean",e=e.toString())),t.checked=t.value===e))},e.prototype._setDate=function(e,t,n){if(!this.__isSelf){if(!yi(e))return this._dateRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2);this._setValue(e.getFullYear()+"-"+r+"-"+i)}},e.prototype._setDateTimeLocal=function(e,t,n){if(!this.__isSelf){if(!yi(e))return this._dateTimeLocalRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2),o=("0"+e.getHours()).slice(-2),s=("0"+e.getMinutes()).slice(-2),a=("0"+e.getSeconds()).slice(-2),l=e.getMilliseconds();this._setValue(e.getFullYear()+"-"+r+"-"+i+"T"+o+":"+s+":"+a+"."+l)}},e.prototype._setSelectedIndex=function(e,t,n){if(!this.__isSelf){var i=this.element,r=i.value;if(di(e))return!0!==n&&this._document.body.contains(i)?void(i.selectedIndex=-1):void this._propertyChanged();if(li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)?(this._propertyType="boolean",e=e.toString()):this._log.info("Trying to bind an invalid value to a <select> element using a "+this.type+".")),r!==e){if(!this._document.body.contains(i))return i.value=e,void(i.value!==e&&(i.value=r,this._propertyChanged()));i.value=e,i.value===e&&-1!==i.selectedIndex||(i.selectedIndex=-1)}}},e.prototype._setSelectedIndices=function(e,t,n){if(!this.__isSelf){var i,r=di(e),o=this.element.options,s=di(o)?0:o.length;if(!r&&mi(e))for(var a,l,u,c=1/0;0<s;)if(a=(i=o[s-=1]).value,-1===e.indexOf(a)){l=Number(a),u=e.indexOf(l);var h=e.indexOf(!0),p=e.indexOf(!1);_i(l)&&-1!==u?(u<c&&(this._propertyType="number",c=u),i.selected=!0):"true"===a&&-1!==h||"false"===a&&-1!==p?((u=-1!==h?h:p)<c&&(this._propertyType="boolean",c=u),i.selected=!0):i.selected=!1}else i.selected=!0;else for(!0===n&&this._propertyChanged();0<s;){if(i=o[s-=1],!r&&i.value===""+e)return void(i.selected=!0);i.selected=!1}}},e.prototype._determineType=function(){if(!this._observingBindableProperty()){var e=this.element;if(!di(e))switch(e.nodeName.toLowerCase()){case"input":switch(e.type){case"button":case"submit":case"reset":case"image":this._addEventType=this._addButtonEventListener,this._getter=this._getValue;break;case"checkbox":this._addEventType=this._addChangeEventListener,this._getter=this._getChecked,this._setter=this._setChecked;break;case"radio":this._initializeRadio();break;case"range":this._addEventType=this._addRangeEventListener,this._getter=this._getValue,this._setter=this._setRange;break;case"date":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDate,this._setter=this._setDate;break;case"datetime-local":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDateTimeLocal,this._setter=this._setDateTimeLocal;break;case"file":this._propertyType="nullable";var t=e.multiple;this._addEventType=this._addChangeEventListener,this._getter=t?this._getFiles:this._getFile;break;case"hidden":this._getter=this._getValue,this._setter=this._setHidden;break;case"number":this._propertyType="number";default:this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText}break;case"textarea":this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText;break;case"select":this._initializeSelect();break;case"button":this._addEventType=this._addButtonEventListener,this._getter=this._getTextContent}}},e.prototype._watchExpression=function(){var e,n=this,t=this._contextExpression,i=this.evaluateExpression(t);if(!ni(i)){if(!(di(i)&&0<t.identifiers.length))return void this._log.warn("Cannot index into a non-object type: "+this.type+'="'+this._expression.expression+'"');i=this._createContext(t.identifiers[0])}if(fi(this._setter)){this._setter===this._setSelectedIndices&&(di(i[e=this._property])&&(i[e]=[]),this.observeArray(function(e){n._setter(e[0].object,null,!0)},t+"."+e));var r=this._expression;this.observeExpression(function(e,t){n._setter(e,t)},r),this._setter(this.evaluateExpression(r),void 0,!0)}},e.prototype._createContext=function(e){var t=e.split("."),n=t.shift().slice(1),i=this.parent;return n===Mn?(e=t.join("."),i=this.parent.root):n===W&&(e=t.join(".")),this._ContextManager.createContext(i,e)},e.prototype._castProperty=function(e,t){var n;if(di(t)&&(t=this._propertyType),di(t))return e;if(ni(e))if(mi(e)){var i=e.length;n=[];for(var r=0;r<i;r+=1)n.push(this._castProperty(e[r],t))}else if(yi(e)||ai(e)||ci(e)||ii(e)||oi(e))n=e;else{var o=Object.keys(e),s=void 0;for(n={};0<o.length;)n[s=o.pop()]=e[s]}else switch(t){case"string":n=li(e)?e:fi(e.toString)?e.toString():Object.prototype.toString.call(e);break;case"number":n=hi(e)?null:Number(e);break;case"boolean":switch(e){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!e}break;case"nullable":hi(e)&&(n=null);break;default:n=e}return n},e.prototype._propertyChanged=function(){if(!di(this._contextExpression)){var e=this.evaluateExpression(this._contextExpression);if(ni(e)){var t=this._property,n=this._castProperty(this._getter());e[t]!==n&&(this.__isSelf=!0,e[t]=n,this.__isSelf=!1)}}},e.prototype._initializeRadio=function(){var e=this.element;if(this._addEventType=this._addChangeEventListener,this._getter=this._getValue,this._setter=this._setRadio,!e.hasAttribute("name")){var t=Ai(this.type),n=this.attributes[t];e.setAttribute("name",n)}e.hasAttribute("value")||e.setAttribute("value","")},e.prototype._initializeSelect=function(){var e,t=this.element,n=t.multiple,i=t.options,r=i.length;this._addEventType=this._addChangeEventListener,n?(this._getter=this._getSelectedValues,this._setter=this._setSelectedIndices):(this._getter=this._getValue,this._setter=this._setSelectedIndex);for(var o=0;o<r;o+=1)(e=i[o]).hasAttribute("value")||e.setAttribute("value",e.textContent)},e.prototype._observingBindableProperty=function(){var t=this,e=this.templateControl;return!!(ni(e)&&fi(e.onInput)&&fi(e.observeProperties))&&(e.onInput(function(e){t._getter=function(){return e},t._propertyChanged()}),this._supportsTwoWayBinding=!0)},e.prototype._observeProperty=function(n,i,r,e){var t,o,s=this;if(hi(i))t=this._expression.expression;else if(_i(i))t=this._expression.expression+"."+i;else{var a=this._parser,l=a.parse(i).identifiers;if(1!==l.length)return void this._log.warn("Only 1 identifier path allowed with "+this.type);var u=(t=a.parse(this._expression.expression+"."+l[0]).identifiers[0]).split(".");u.pop();var c=u.join("."),h=this.evaluateExpression(c);if(!ni(h)){if(!di(h))return void this._log.warn("Cannot index a primitive type: "+this.type+'="'+this._expression.expression+'"');h=this._ContextManager.createContext(this.parent,c)}}if(n=n.bind(this.templateControl),r=!0===r,!0===e)o=this.observeArray(function(e){n(e,i)},t);else{o=this.observe(function(e,t){s.__isSelf||e===t||(r&&(s._propertyType=s._getPropertyType(e)),n(e,t,i))},t);var p=this.evaluateExpression(t);r&&(this._propertyType=this._getPropertyType(p)),n(p,void 0,i,!0)}return o},e.prototype._getPropertyType=function(e){return ni(e)?e:li(e)?"string":_i(e)?"number":pi(e)?"boolean":void 0},e._inject={_parser:J,_ContextManager:Z,_compat:X,_document:G},e}(Dr);l.Bind=H,sr.control(pe,H);var Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="",e.priority=200,e._listeners=[],e._boundAddListener=e._addListener.bind(e),e}return __extends(e,t),e.prototype.initialize=function(){this.attribute=Ai(this.type),this._setProperty(this._getValue())},e.prototype.loaded=function(){this._observeProperty(),this._setProperty(this._getValue())},e.prototype.dispose=function(){fi(this._removeListener)&&this._removeListener(),this._listeners=[]},e.prototype._setProperty=function(e,t){var n=this.templateControl;di(n)||(this._ContextManager.defineGetter(n,this.property,{value:e,observe:this._boundAddListener},!0,!0),this._callListeners(e,t))},e.prototype._callListeners=function(e,t){for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](e,t)},e.prototype._addListener=function(t){var n=this._listeners;return t=t.bind(this.templateControl),n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}},e.prototype._getValue=function(){if(!di(this.templateControl))return this.evaluateExpression(this.attributes[this.attribute])},e.prototype._observeProperty=function(){di(this.templateControl)||(this._removeListener=this.observeExpression(this._setProperty,this.attributes[this.attribute]))},e._inject={_ContextManager:Z},e}(Dr),Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.property="options",e}return __extends(e,t),e}(l.ObservableAttributeControl=Q);l.Options=Y,sr.control(be,Y)}(d.controls||(d.controls={}));var zr=function(){function o(){this.uid=Ri(he),this._log=o._log,(this.navigator=Cr(S)).initialize(Cr(q).currentRouter())}return o.start=function(){if(o._compat.isCompatible){o.__addPlatCss();var e=o._EventManager;e.dispose(jn),e.on(jn,Tt,o.__ready),e.on(jn,n,o.__shutdown),e.initialize()}else o._log.error(new Error("PlatypusTS only supports modern browsers where Object.defineProperty is defined"))},o.registerApp=function(e){!di(o.app)&&li(o.app.uid)&&o._EventManager.dispose(o.app.uid),o.__injector=e},o.load=function(e){var t=o._LifecycleEvent,n=o._compiler,i=o._document.body,r=o._document.head;return t.dispatch(St,o),di(e)?(i.setAttribute(Ot,""),void ki(function(){n.compile([r]),n.compile([i]),i.removeAttribute(Ot)})):fi(e.setAttribute)?(e.setAttribute(Ot,""),void ki(function(){n.compile([e]),e.removeAttribute(Ot)})):void ki(function(){n.compile([e])})},o.__ready=function(e){ar.Injector.initialize(),o.__registerAppEvents(e),e.defaultPrevented||o.load()},o.__shutdown=function(){var e=navigator.app,t=o._LifecycleEvent;if(!di(e)&&fi(e.exitApp)){if(t.dispatch(i,o).defaultPrevented)return;e.exitApp()}},o.__registerAppEvents=function(e){var t=o.__injector;if(!di(t)&&fi(t.inject)){var n=o.app=t.inject();n.on(Nt,n.suspend),n.on("resume",n.resume),n.on("online",n.online),n.on(kt,n.offline),n.on("error",n.error),n.on(i,n.exiting),fi(n.ready)&&n.ready(e)}},o.__addPlatCss=function(){var e=o._document;if(!o._compat.platCss)if(!di(e.styleSheets)&&0<e.styleSheets.length)e.styleSheets[0].insertRule("[plat-hide] { display: none !important; }",0);else{var t=document.createElement("style");t.textContent="[plat-hide] { display: none !important; }",document.head.appendChild(t)}},o.prototype.suspend=function(e){},o.prototype.resume=function(e){},o.prototype.error=function(e){},o.prototype.ready=function(e){},o.prototype.exiting=function(e){},o.prototype.online=function(e){},o.prototype.offline=function(e){},o.prototype.dispatchEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=o._EventManager;ni(i)||(i=Cr(N)),i.dispatch(e,this,i.DIRECT,t)},o.prototype.on=function(e,t){var n=o._EventManager;return ni(n)||(n=Cr(N)),n.on(this.uid,e,t,this)},o.prototype.load=function(e){o.load(e)},o.prototype.exit=function(){this.dispatchEvent(n)},o.app=null,o}();function Br(e,t,n,i,r,o){return zr._compat=e,zr._EventManager=t,zr._document=n,zr._compiler=i,zr._LifecycleEvent=r,zr._log=o,zr}function Ur(e){return e.app}d.App=zr,d.IAppStatic=Br,sr.injectable(u,Br,[X,N,G,_,h,k],yn),d.IApp=Ur,sr.injectable("$App",Ur,[u],Cn)}(plat||(plat={})),module.exports=plat;