"use strict";var plat,__extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(d){var s,a,e,r,m,g,y,b,W="context",u="$AppStatic",C="$Http",x="$HttpRequestInstance",E="$HttpConfig",w="$Promise",X="$Compat",T="$ControlFactory",G="$Document",l="$DispatchEventInstance",c="$ErrorEventStatic",N="$EventManagerStatic",h="$LifecycleEventStatic",p="$LifecycleEventInstance",k="$Log",J="$Parser",K="$Regex",o="$Tokenizer",S="$NavigatorInstance",Z="$ContextManagerStatic",_="$Compiler",f="$CommentManagerFactory",I="$ElementManagerFactory",v="$NodeManagerStatic",j="$TextManagerFactory",R="$CacheFactory",A="$ManagerCache",L="$TemplateCache",P="$Animator",O="$AttributesFactory",F="$BindableTemplatesFactory",M="$Dom",D="$DomEvents",$="$ResourcesFactory",z="$TemplateControlFactory",B="$TemplateControlInstance",U="$Utils",tt="$Browser",V="$BrowserConfig",q="$RouterStatic",H="$UrlUtilsInstance",Q="$Window",Y="$BaseSegmentFactory",et="$BaseSegmentInstance",nt="$StaticSegmentInstance",it="$DynamicSegmentInstance",rt="$SplatSegmentInstance",ot="$StateStatic",st="$StateInstance",at="$RouteRecognizerInstance",lt="$InjectorStatic",ut="$History",ct="$Location",ht="plat-",pt=ht+"options",_t=ht+"if",ft=ht+"template",dt=ht+"viewport",vt=ht+"control",mt=ht+"resources",gt=ht+W,yt="data-",bt="meta",Ct="link",xt="property",Et="image",wt="article:",Tt="og:",Nt="twitter:",kt="content",St="ready",It="suspend",jt="offline",n="shutdown",i="exiting",Rt="beforeLoad",At="beforeNavigate",Lt="navigating",Pt="urlChanged",Ot="deviceReady",Ft="backbutton",Mt="backclick",Dt=ht+"hide",$t=ht+"animating",zt=ht+"animation",Bt=ht+"transition",Ut=ht+"enter",Vt=ht+"leave",qt=ht+"move",Ht=ht+"fadein",Qt=ht+"fadeout",Yt=ht+"back-nav",Wt="$tap",Xt="$dbltap",Gt="$release",Jt="$swipeleft",Kt="$swiperight",Zt="$swipeup",te="$swipedown",ee="$trackleft",ne="$trackright",ie="$trackup",re="$trackdown",oe="$trackend",se="index",ae="even",le="odd",ue="first",ce="last",he="base",pe="{{",_e="}}",fe="static",de="singleton",ve="instance",me="factory",ge="class",ye="-compiled",be="-init",Ce=": start node",xe=": end node",Ee="noop",we="__app__",Te="observable",Ne="injectable",ke="object",Se="function",Ie="literal",je="rootContext",Re="control",Ae=W,Le="function"==typeof Array.isArray,Pe={},Oe=Object.prototype.toString,t="[object ",Fe=t+"Error]",Me=t+"File]",De=t+"Array]",$e=t+"Boolean]",ze=t+"Date]",Be=t+"Number]",Ue=t+"RegExp]",Ve=t+"String]";function qe(){}function He(t,e,n,i,r,o){Object.defineProperty(t,e,{value:n,enumerable:!0===i,configurable:!0===r,writable:!0===o})}function Qe(n,t,i){for(var r,o,e=[],s=3;s<arguments.length;s++)e[s-3]=arguments[s];return ln(i)||(o=an(t)?t:t?function(t,e,n){He(t,e,n,!0,!0,!0)}:function(t,e,n){t[e]=n},rn(e)&&e.push(i),fn(function(e,t){We(e)&&fn(function(t){if(r=e[t],n){if(cn(r))return cn(i[t])||(i[t]=[]),void Qe(n,o,i[t],r);if(pn(r))return void o(i,t,new Date(r.getTime()));if(en(r))return void o(i,t,new RegExp(r));if(Je(r))return void o(i,t,r.cloneNode(!0));if(Ze(r))return void o(i,t,r);if(We(r))return We(i[t])||(i[t]={}),Qe(n,o,i[t],r),We(a)||(a=d.acquire(X)),void(a.setProto?Object.setPrototypeOf(i[t],Object.getPrototypeOf(r)):r.toString!==Object.prototype.toString&&(i[t].toString=r.toString))}o(i,t,r)},Object.keys(e))},e)),i}function Ye(t,e){if(!We(t))return t;if(pn(t))return new Date(t.getTime());if(en(t))return new RegExp(t);if(Je(t))return t.cloneNode(e);if(Ze(t))return t;if(n=t,Oe.call(n)===Fe)return new t.constructor(t.message);var n,i={};return cn(t)&&(i=[]),on(e)&&e?Qe(!0,!1,i,t):Qe(!1,!1,i,t)}function We(t){return null!=t&&"object"==typeof t}function Xe(t){return!!(t&&t.document&&t.setInterval)}function Ge(t){return!(!t||t.nodeType!==Node.DOCUMENT_NODE)}function Je(t){return!(!t||"number"!=typeof t.nodeType)}function Ke(t){return!(!t||t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)}function Ze(t){return We(t)&&Oe.call(t)===Me}function tn(t){return"string"==typeof t||We(t)&&Oe.call(t)===Ve}function en(t){return We(t)&&Oe.call(t)===Ue}function nn(t){return We(t)&&("[object Promise]"===Oe.call(t)||an(t.then))}function rn(t){return!!ln(t)||(tn(t)||cn(t)?0===t.length:!!We(t)&&0===Object.keys(t).length)}function on(t){return!0===t||!1===t||We(t)&&Oe.call(t)===$e}function sn(t){return("number"==typeof t||We(t)&&Oe.call(t)===Be)&&!isNaN(t)}function an(t){return"function"==typeof t}function ln(t){return null==t}function un(t){return void 0===t}function cn(t){return Le?Array.isArray(t):Oe.call(t)===De}function hn(t){return!(ln(t)||Xe(t)||an(t))&&(tn(t)||0<=t.length)}function pn(t){return"object"==typeof t&&Oe.call(t)===ze}function _n(i,t,e){var r=[];return ln(t)?r:an(t.filter)?t.filter(i,e):(fn(function(t,e,n){i(t,e,n)&&r.push(t)},t),r)}function fn(t,e,n){if(ln(e)||!We(e)&&!hn(e))return e;var i,r,o;if(an(e.forEach))return e.forEach(t,n);if(hn(e))for(o=e.length,i=0;i<o;i+=1)t.call(n,e[i],i,e);else{var s=Object.keys(e);for(o=s.length;0<s.length;)r=s.shift(),t.call(n,e[r],r,e)}return e}function dn(n,i,r){var o=[];return ln(i)?o:an(i.map)?i.map(n,r):(fn(function(t,e){o.push(n.call(r,t,e,i))},i),o)}function vn(t,e,n){We(s)||(s=d.acquire(w));var i=dn(t,e,n);return s.all(i)}function mn(o,t,e,n){We(s)||(s=d.acquire(w));var i=s.resolve([]);if(!cn(t))return i;o=o.bind(e);var r=function(t,n,i,r){return t.then(function(e){return o(n,i,r).then(function(t){return e.concat(t)})})};return!0===n?t.reduceRight(r,i):t.reduce(r,i)}function gn(t,e,n){return mn(t,e,n)}function yn(t,e,n){if(ln(e)||an(e))return!1;var i,r,o;if(an(e.some))return e.some(t,n);if(hn(e)){for(o=e.length,i=0;i<o;i+=1)if(!0===t.call(n,e[i],i,e))return!0}else{var s=Object.keys(e);for(o=s.length;0<s.length;)if(r=s.shift(),!0===t.call(n,e[r],r,e))return!0}return!1}function bn(t,e,n){return Cn(t,0,e,n)}function Cn(t,e,n,i){var r=setTimeout(function(){t.apply(i,n)},e);return function(){clearTimeout(r)}}function xn(t,e,n,i){var r=setInterval(function(){t.apply(i,n)},e);return function(){clearInterval(r)}}function En(t,e){We(a)||(a=d.acquire(X));var n=a.requestAnimationFrame;if(un(n))return bn(function(){t.call(e,Date.now())});var i=n(t.bind(e)),r=a.cancelAnimationFrame;return an(r)||(r=qe),function(){r(i)}}function wn(t){ln(t)&&(t="");var e=Pe[t];ln(e)&&(e=Pe[t]=["0","/"]);for(var n,i=e.length;0<i;){if(57===(n=e[i-=1].charCodeAt(0)))return e[i]="A",r();if(90===n)return e[i]="a",r();if(122!==n)return e[i]=String.fromCharCode(n+1),r();e[i]="0"}function r(){return t+e.join("")}return e.unshift("0"),r()}function Tn(t){return!tn(t)||rn(t)?t:(t=t.charAt(0).toLowerCase()+t.slice(1),en(e)||(e=d.acquire(K).camelCaseRegex),t.replace(e,function(t,e,n,i){return sn(i)&&0<i?n.toUpperCase():n}))}function Nn(t,e){return ln(t)||delete t[e],t}function kn(t,e){return ln(t)?t:t[e]}function Sn(t){if(!rn(t)){for(var e,n=(t=t.replace(/^\?+/,"")).split("&"),i={},r=n.length,o=0;o<r;o+=1)i[(e=n[o].split("="))[0]]=e[1];return i}}function In(t){var e="";return rn(e+=dn(function(t,e){return e+"="+t},t).join("&"))||(e="?"+e),e}function jn(t){return cn(t)?t.reduce(function(t,e){return t&&!1!==e},!0):!on(t)||t}var Rn=/<([\w:]+)/,An=/\s+/g,Ln=[1,'<select multiple="multiple">',"</select>"],Pn=[1,"<table>","</table>"],On=[3,"<table><tbody><tr>","</tr></tbody></table>"],Fn=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],Mn=Qe(!1,!1,{},{thead:Pn,tbody:Pn,tfoot:Pn,colgroup:Pn,caption:Pn,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:On,th:On},{option:Ln,optgroup:Ln,legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],text:Fn,circle:Fn,ellipse:Fn,line:Fn,path:Fn,polygon:Fn,polyline:Fn,rect:Fn,_default:[0,"",""]});function Dn(t,e,n){We(m)||(m=d.acquire(G));var i=Ke(e),r=!Je(e),o=i?e:m.createDocumentFragment();r&&(e=o);var s,a=cn(t)?t:Array.prototype.slice.call(t),l=a.length;if(!0===n){var u=void 0;for(s=0;s<l;s+=1)u=a[s].cloneNode(!0),o.insertBefore(u,null)}else for(s=0;s<l;s+=1)o.insertBefore(a[s],null);return i||r||e.appendChild(o),e}function $n(t){for(var e=Array.prototype.slice.call(t.childNodes);0<e.length;)t.removeChild(e.pop())}function zn(t,e){if(an(t.push)||(t=Array.prototype.slice.call(t)),ln(e))for(var n;0<t.length;)ln(e=(n=t.pop()).parentNode)||e.removeChild(n);else!function(t,e){for(;0<t.length;)e.removeChild(t.pop())}(t,e)}function Bn(t,e){if($n(t),!rn(e)){var n=function(t){We(a)||(a=d.acquire(X)),We(m)||(m=d.acquire(G));var e=Rn.exec(t),n=m.createElement("div");if(ln(e))return(n=Wn(n,t)).removeChild(n.lastChild);t=t.trim();var i=e[1],r=Mn[i];if(a.pushState&&un(r))return Wn(n,t);if("body"===i)return(n=Wn(m.createElement("html"),t)).removeChild(n.lastChild);cn(r)||(r=Mn._default);var o=r[0];for(n=Wn(n,""+r[1]+t+r[2]);0<o;)o-=1,n=n.lastChild;return n}(e);return 0<n.childNodes.length?Dn(n.childNodes,t):t.insertBefore(n,null),t}}function Un(t,e,n){if(!ln(t)&&We(e)){var i;if(un(n)&&(n=null),Je(e))return i=e,e=Array.prototype.slice.call(i.childNodes),t.insertBefore(i,n),e;an(e.push)||(e=Array.prototype.slice.call(e)),We(m)||(m=d.acquire(G));var r=e.length;i=m.createDocumentFragment();for(var o=0;o<r;o+=1)i.insertBefore(e[o],null);return t.insertBefore(i,n),e}}function Vn(t){var e=t.parentNode,n=Un(e,t.childNodes,t);return e.removeChild(t),n}function qn(t,e){if(ln(e))return e;if(t.nodeType===Node.ELEMENT_NODE)for(var n=t.attributes,i=n.length,r=void 0,o=0;o<i;o+=1)r=n[o],e.setAttribute(r.name,r.value);var s=t.parentNode;return Un(e,t.childNodes),s.replaceChild(e,t),e}function Hn(t){We(m)||(m=d.acquire(G));var e=m.createDocumentFragment();return rn(t)||Bn(e,t),e}function Qn(t,e){if(!ln(t)){var n,i=t.nextSibling,r=t.parentNode;if(ln(e)&&(e=null),!ln(r)&&(ln(e)||e.parentNode===r))for(;i!==e;)n=i.nextSibling,r.removeChild(i),i=n}}function Yn(t,e){ln(t)||(Qn(t,e),Xn(t),Xn(e))}function Wn(t,e){return We(a)||(a=d.acquire(X)),a.msApp?MSApp.execUnsafeLocalFunction(function(){t.innerHTML=e}):t.innerHTML=e,t}function Xn(t){if(Je(t)){var e=t.parentNode;ln(e)||e.removeChild(t)}}function Gn(t,e){We(t)||(t={});var n=t.className;if(tn(n)&&tn(e)&&""!==e){var i,r=e.split(An);if(un(t.classList)){if(rn(n))return void(t.className=e);for(;0<r.length;)""!==(i=r.shift())&&(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g").test(n)||(t.className+=" "+i))}else for(;0<r.length;)""!==(i=r.shift())&&t.classList.add(i)}}function Jn(t,e){We(t)||(t={});var n=t.className;if(tn(n)&&tn(e)&&""!==e){var i,r=e.split(An);if(un(t.classList)){if(n===e)return void(t.className="");for(;0<r.length;)""!==(i=r.shift())&&(t.className=n=n.replace(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g"),""))}else for(;0<r.length;)""!==(i=r.shift())&&t.classList.remove(i)}}function Kn(t,e){We(t)||(t={});var n=t.className;if(!tn(n)||!tn(e)||""===e)return!1;var i,r=e.split(An);if(un(t.classList)){if(""===n)return!1;if(n===e)return!0;for(;0<r.length;)if(""!==(i=r.shift())&&!new RegExp("^"+i+"\\s|\\s"+i+"$|\\s"+i+"\\s","g").test(n))return!1;return!0}for(;0<r.length;)if(""!==(i=r.shift())&&!t.classList.contains(i))return!1;return!0}var Zn,ti,ei,ni,ii,ri,oi,si={},ai={},li={},ui={},ci={},hi={},pi={},_i={};function fi(t){for(var e,n=cn(t),i=(e=n?ti.Injector.getDependencies(t):ti.Injector.getDependencies([t])).length,r=[],o=0;o<i;o+=1)r.push(e[o].inject());return n?r:r[0]}!function(a){function r(t,e,n,i,r,o){var s=t[e]=new ti.Injector(e,n,i,r);return!0===o&&(hi[e]=s),a}a.app=function(t,e,n){var i=fi(lt);return fi(u).registerApp(new i(t,e,n)),a},a.control=function(t,e,n,i){if(!tn(t))throw new Error("A Control must be registered with a string name");return"head"===(t=t.toLowerCase())&&(i=!0),r(si,t,e,n,i?fe:void 0)},a.viewControl=function(t,e,n){if(!tn(t))throw new Error("A ViewControl must be registered with a string name");return t=t.toLowerCase(),r(ai,t,e,n)},a.injectable=function(t,e,n,i){if(tn(i)){if((i=i.toLowerCase())===me||i===fe||i===ge)return r(ui,t,e,n,i,!0);if(i!==de&&i!==ve)throw new Error("Invalid injectable type "+i+" during injectable registration.")}else i=de;return r(ui,t,e,n,i,!1)},a.injectable.STATIC=fe,a.injectable.SINGLETON=de,a.injectable.INSTANCE=ve,a.injectable.FACTORY=me,a.injectable.CLASS=ge,a.animation=function(t,e,n,i){if(tn(i)&&"css"!==(i=i.toLowerCase())&&"js"!==i)throw new Error('Invalid animationType "'+i+'" during animation registration.');return r("js"===i?_i:pi,t,e,n,a.injectable.INSTANCE)},a.animation.CSS="css",a.animation.JS="js"}(Zn=d.register||(d.register={})),ei=ti=d.dependency||(d.dependency={}),ii=function(){function h(t,e,n,i){void 0===i&&(i=null),this.type=null,this.name=t,this.Constructor=e,this.type=i;var r,o=this.dependencies=h.convertDependencies(n),s=o.indexOf(Ee);if(Object.defineProperty(e,"__injectorName",{value:t,enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(e,"__injectorDependencies",{value:o.slice(0),enumerable:!1,configurable:!0,writable:!0}),-1<s){var a=n[s];if(ln(a))throw new TypeError("The dependency for "+t+" at index "+s+" is undefined, did you forget to include a file?");throw new TypeError("Could not resolve dependency "+a.slice(9,a.indexOf("("))+" for "+t+". Are you using a static injectable Type?")}if(tn(r=h.__findCircularReferences(this)))throw new Error("Circular dependency detected from "+this.name+" to "+r+".");if(t===u){var l=this.inject();this.dependencies=o,l.start()}}return h.initialize=function(){for(var t=hi,e=Object.keys(t),n=e.length,i=0;i<n;i+=1)t[e[i]].inject();hi={}},h.getDependencies=function(t){if(ln(t)||rn(t))return[];for(var e=[],n=t.length,i=0;i<n;i+=1)e.push(h.getDependency(t[i]));return e},h.getDependency=function(t){return ln(t)||t===Ee?h.__noop():h.isInjector(t)?t:h.__locateInjector(t)},h.convertDependencies=function(t){if(!cn(t))return[];for(var e=h.convertDependency,n=[],i=t.length,r=0;r<i;r+=1)n.push(e(t[r]));return n},h.convertDependency=function(t){return ln(t)?Ee:h.__getInjectorName(t)},h.isInjector=function(t){return an(t.inject)&&!un(t.type)&&!un(t.name)&&!un(t.Constructor)},h.__getInjectorName=function(t){if(ln(t))return Ee;if(tn(t))return t;var e=t,n=We(e._inject)?e._inject:{};if(tn(e.__injectorName)&&(t=e.__injectorName),!tn(t))return new h(t,e,n.dependencies);var i=h.__findInjector(t,[ui,ci,hi,ai,si,pi,_i]);return!We(i)&&tn(t)&&(i=ci[t]=new h(t,e,e._inject.dependencies)),We(i)?i.name:Ee},h.__construct=function(t,e,n){if(ln(t)||ln(t.prototype))return t;var i,r=Object.create(t.prototype),o=n===ve;o&&(i=li[t.__injectorName]),We(i)||(i=h.__walk(r,Object.getPrototypeOf(r),{}),o&&(li[t.__injectorName]=i));for(var s=fi(dn(function(t){return t},i)),a=Object.keys(i),l=a.length,u=0;u<l;u+=1)r[a[u]]=s[u];var c=r.constructor.apply(r,e);return un(c)?r:c},h.__walk=function(t,e,n){var i=e.constructor,r={};return We(i._inject)&&i!==Object&&(r=h.__walk(t,Object.getPrototypeOf(e),n)),Qe(!1,!1,{},n,r,Ye(i._inject,!0))},h.__locateInjector=function(t){if(!ln(t)){var e=t;tn(t.__injectorName)&&(e=t.__injectorName);var n=h.__findInjector(e,[ui,ci,hi,ai,si,pi,_i]);return We(n)||(an(t)?(tn(e)||(e=wn(ht)),n=new h(e,t,We(t._inject)?t._injectorDependencies:[]),ci[e]=n):n=h.__wrap(t)),n}},h.__findInjector=function(t,e){if(!ln(t)){if(t===h||t===lt){var n=h.__wrap(h);return n.name=lt,n}if(tn(t))for(var i=0,r=e;i<r.length;i++){var o=r[i];if(!ln(o[t]))return o[t];if(!ln(o[t.toLowerCase()]))return o[t.toLowerCase()]}}},h.__wrap=function(t){return{inject:function(){return t},name:"wrapped",dependencies:[],Constructor:t}},h.__noop=function(){return{inject:qe,type:Ee,name:Ee,dependencies:[],Constructor:qe}},h.__findCircularReferences=function(t){if(We(t)&&cn(t.dependencies))for(var e,n,i,r=t.name,o=t.dependencies,s=[{name:r,dependencies:o.slice(0)}],a=h.__locateInjector;0<s.length;){i=(o=(e=s.pop()).dependencies).length;for(var l=0;l<i;l+=1){if((n=o[l])===r)return e.name;We(t=a(n))&&cn(t.dependencies)&&s.push({name:t.name,dependencies:t.dependencies.slice(0)})}}},h.prototype.inject=function(){for(var t,e,n=[],i=this.type,r=this.dependencies,o=r.length,s=0;s<o;s+=1)t=h.getDependency(r[s]),n.push(t.inject());return e=h.__construct(this.Constructor,n,i),tn(i)&&i!==ve&&this._wrapInjector(e),e.__injectable__type=i,e},h.prototype._wrapInjector=function(t){return this.inject=function(){return t},this},h}(),ei.Injector=ii,(ni=ei.injectors||(ei.injectors={})).control=si,ni.viewControl=ai,ni.injectable=ui,ni.staticInjectable=hi,ni.animation=pi,ni.jsAnimation=_i,un(window)||(un(window.plat)&&(window.plat=d),un(window.module)&&(window.module={})),d.acquire=fi,ri=d.debug||(d.debug={}),oi=function(){function i(){this.ERROR=5,this.WARN=4,this.INFO=3,this.DEBUG=2,this.TRACE=1,this._level=this.INFO}return i.prototype.error=function(t){throw this._log(t,this.ERROR),t},i.prototype.warn=function(t){this._log(t,this.WARN)},i.prototype.info=function(t){this._log(t,this.INFO)},i.prototype.debug=function(t){this._log(t,this.DEBUG)},i.prototype.trace=function(t){this._log(t,this.TRACE)},i.prototype.setLogLevel=function(t){switch(tn(t)&&(t=this[t.toUpperCase()]),t){case this.ERROR:case this.WARN:case this.INFO:case this.DEBUG:case this.TRACE:this._level=t;break;default:this._level=this.INFO}},i.prototype._log=function(t,e){if(this._shouldLog(e)){tn(t)&&(t=new Error(t));var n=this._ErrorEvent;ln(n)&&(n=this._ErrorEvent=fi(c)),n.dispatch("error",i,t,e)}},i.prototype._shouldLog=function(t){return sn(t)||(t=this.INFO),this._level<t},i}(),ri.Log=oi,Zn.injectable(k,oi);var di=function(){function t(){this.__events={},this.__defineBooleans(),this.__defineMappedEvents(),this.__defineVendorDependencies(),this.__determineCss()}return t.prototype.hasEvent=function(t){var e=this.__events,n=e[t];if(un(n)){var i=this._document.createElement("div");n="input"===t&&9===this.IE?e[t]=!1:e[t]=!un(i["on"+t])}return n},t.prototype.__defineBooleans=function(){var t=this._window,e=this._history,n=t.define,i=t.MSApp,r=t.WinJS,o=t.navigator;We(o)||(o={});var s=o.userAgent;tn(s)||(s=""),s=s.toLowerCase();var a=/android ((?:\d|\.)+)/.exec(s);hn(a)||(a=[]);var l=a[1];if(tn(l)&&!/iemobile/i.test(s)&&(l=parseInt(l.replace(/\./g,""),10)),this.isCompatible=an(Object.defineProperty)&&an(this._document.querySelector),this.cordova=!ln(t.cordova),this.pushState=!(ln(e)||ln(e.pushState)),this.fileSupported=!(un(t.File)||un(t.FormData)),this.amd=an(n)&&!ln(n.amd),this.msApp=We(i)&&an(i.execUnsafeLocalFunction),this.winJs=We(r)&&We(r.Application),this.indexedDb=!ln(t.indexedDB),this.proto=We({}.__proto__),this.getProto=an(Object.getPrototypeOf),this.setProto=an(Object.setPrototypeOf),this.hasTouchEvents=!un(t.ontouchstart),this.hasPointerEvents=!!o.pointerEnabled,this.hasMsPointerEvents=!!o.msPointerEnabled,sn(l))this.ANDROID=l;else{var u=/msie (\d+)/.exec(s),c=/trident\/.*; rv:(\d+)/.exec(s);hn(u)||(u=[]),hn(c)||(c=[]);var h=parseInt(u[1],10);sn(h)||(h=parseInt(c[1],10)),sn(h)&&(this.IE=h)}},t.prototype.__defineMappedEvents=function(){this.hasPointerEvents?this.mappedEvents={$touchstart:"pointerdown",$touchend:"pointerup",$touchmove:"pointermove",$touchcancel:"pointercancel"}:this.hasMsPointerEvents?this.mappedEvents={$touchstart:"MSPointerDown",$touchend:"MSPointerUp",$touchmove:"MSPointerMove",$touchcancel:"MSPointerCancel"}:this.hasTouchEvents?this.mappedEvents={$touchstart:"touchstart",$touchend:"touchend",$touchmove:"touchmove",$touchcancel:"touchcancel"}:this.mappedEvents={$touchstart:"mousedown",$touchend:"mouseup",$touchmove:"mousemove",$touchcancel:null}},t.prototype.__defineVendorDependencies=function(){var t,e,n,i,r=this._window,o=this._document.documentElement,s=r.getComputedStyle(o,""),a=Array.prototype.slice.call(s).join("").match(/-(moz|webkit|ms)-/);cn(a)&&1<a.length?(i=(t=cn(a)&&1<a.length?a[1]:"")[0].toUpperCase()+t.slice(1),e="WebKit|Moz|MS".match(new RegExp("("+t+")","i"))[1],n="-"+t+"-"):un(s.OLink)?t=i=e=n="":(t="o",i=e="O",n="-o-"),this.vendorPrefix={dom:e,lowerCase:t,css:n,upperCase:i},this.requestAnimationFrame=r.requestAnimationFrame,an(this.requestAnimationFrame)||(this.requestAnimationFrame=r[t+"RequestAnimationFrame"]),this.cancelAnimationFrame=r.cancelAnimationFrame,an(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[t+"CancelRequestAnimationFrame"]),an(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[t+"CancelAnimationFrame"]);var l=o.style;!(un(this.ANDROID)||44<=Math.floor(this.ANDROID/10))||un(l.animation)||un(l.transition)?(un(l[i+"Animation"])||un(l[i+"Transition"]))&&(un(l[t+"Animation"])||un(l[t+"Transition"]))&&(un(l[e+"Animation"])||un(l[e+"Transition"]))||(this.animationSupported=!0,this.animationEvents={$animation:t+"Animation",$animationStart:t+"AnimationStart",$animationEnd:t+"AnimationEnd",$animationIteration:t+"AnimationIteration",$transition:t+"Transition",$transitionStart:t+"TransitionStart",$transitionEnd:t+"TransitionEnd"}):(this.animationSupported=!0,this.animationEvents={$animation:"animation",$animationStart:"animationstart",$animationEnd:"animationend",$animationIteration:"animationiteration",$transition:"transition",$transitionStart:"transitionstart",$transitionEnd:"transitionend"})},t.prototype.__determineCss=function(){var t=this._document,e=t.head,n=t.createElement("div");n.setAttribute(Dt,""),e.insertBefore(n,null);var i=this._window.getComputedStyle(n),r=i.display,o=i.visibility;this.platCss="none"===r||"hidden"===o,e.removeChild(n)},t._inject={_window:Q,_history:ut,_document:G},t}();d.Compat=di,Zn.injectable(X,di);var vi,mi=function(){function t(){}return t.prototype.noop=function(){},t.prototype.extend=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qe.apply(null,[!1,!1,t].concat(e))},t.prototype.deepExtend=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Qe.apply(null,[!0,!1,t].concat(e))},t.prototype.clone=function(t,e){return Ye(t,e)},t.prototype.isObject=function(t){return We(t)},t.prototype.isWindow=function(t){return Xe(t)},t.prototype.isDocument=function(t){return Ge(t)},t.prototype.isNode=function(t){return Je(t)},t.prototype.isDocumentFragment=function(t){return Ke(t)},t.prototype.isString=function(t){return tn(t)},t.prototype.isRegExp=function(t){return en(t)},t.prototype.isPromise=function(t){return nn(t)},t.prototype.isEmpty=function(t){return rn(t)},t.prototype.isBoolean=function(t){return on(t)},t.prototype.isNumber=function(t){return sn(t)},t.prototype.isFile=function(t){return Ze(t)},t.prototype.isFunction=function(t){return an(t)},t.prototype.isNull=function(t){return ln(t)},t.prototype.isUndefined=function(t){return un(t)},t.prototype.isArray=function(t){return cn(t)},t.prototype.isArrayLike=function(t){return hn(t)},t.prototype.isDate=function(t){return pn(t)},t.prototype.debounce=function(t,e,n){return function(r,o,s){if(!an(r))throw new Error("Must pass a function into debounce");var a;return ln(o)&&(o=500),on(s)||(s=!1),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this,i=s&&!a;clearTimeout(a),a=setTimeout(function(){s||r.apply(n,t)},o),i&&r.apply(n,t)}}(t,e,n)},t.prototype.filter=function(t,e,n){return _n(t,e,n)},t.prototype.where=function(t,e){return i=t,_n(function(n){return!yn(function(t,e){return n[e]!==t},i)},e);var i},t.prototype.forEach=function(t,e,n){return fn(t,e,n)},t.prototype.map=function(t,e,n){return dn(t,e,n)},t.prototype.mapAsync=function(t,e,n){return vn(t,e,n)},t.prototype.mapAsyncInOrder=function(t,e,n){return gn(t,e,n)},t.prototype.mapAsyncInDescendingOrder=function(t,e,n){return mn(t,e,n,!0)},t.prototype.pluck=function(t,e){return n=t,dn(function(t){return t[n]},e);var n},t.prototype.some=function(t,e,n){return yn(t,e,n)},t.prototype.postpone=function(t,e,n){return Cn(t,0,e,n)},t.prototype.defer=function(t,e,n,i){return Cn(t,e,n,i)},t.prototype.setInterval=function(t,e,n,i){return xn(t,e,n,i)},t.prototype.requestAnimationFrame=function(t,e){return En(t,e)},t.prototype.uniqueId=function(t){return wn(t)},t.prototype.camelCase=function(t){return Tn(t)},t.prototype.delimit=function(t,e){return i=e,!tn(n=t)||rn(n)?n:(ln(i)&&(i=""),en(r)||(r=d.acquire(K).capitalCaseRegex),n.replace(r,function(t,e){return sn(e)&&0<e?i+t.toLowerCase():t.toLowerCase()}));var n,i},t}();function gi(){return window}function yi(t){return t.document}d.Utils=mi,Zn.injectable(U,mi),d.Window=gi,Zn.injectable(Q,gi),d.Document=yi,Zn.injectable(G,yi,[Q]),function(t){var e=function(){function t(){this.markupRegex=new RegExp("{{[\\S\\s]*}}"),this.argumentRegex=/\((.*)\)/,this.initialUrlRegex=/\/[^\/]*\.(?:html|htm)/,this.protocolRegex=/:\/\//,this.invalidVariableRegex=/[^a-zA-Z0-9@_$]/,this.fileNameRegex=/.*(?:\/|\\)/,this.shiftedKeyRegex=/[A-Z!@#$%^&*()_+}{":?><|~]/,this.fullUrlRegex=/^(?:[a-z0-9\-]+:)(?:\/\/)?|(?:\/\/)/i,this.validateEmail=new RegExp('^(([^<>()[\\]\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),this.validateTelephone=/^\+?[0-9\.\(\)\s-]*$/,this.dynamicSegmentsRegex=/^:([^\/]+)$/,this.splatSegmentRegex=/^\*([^\/]+)$/}return Object.defineProperty(t.prototype,"newLineRegex",{get:function(){return/\r|\n/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optionalRouteRegex",{get:function(){return/\((.*?)\)/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"namedParameterRouteRegex",{get:function(){return/(\(\?)?:\w+/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wildcardRouteRegex",{get:function(){return/\*\w*/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"escapeRouteRegex",{get:function(){return/[\-{}\[\]+?.,\\\^$|#\s]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"camelCaseRegex",{get:function(){return/([\-_\.\s])(\w+?)/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capitalCaseRegex",{get:function(){return/[A-Z]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpaceRegex",{get:function(){return/("[^"]*?"|'[^']*?')|[\s\r\n\t\v]/g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quotationRegex",{get:function(){return/'|"/g},enumerable:!0,configurable:!0}),t}();t.Regex=e,Zn.injectable(K,e);var n=function(){function t(){this.__previousChar="",this.__variableRegex=fi(K).invalidVariableRegex,this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]}return t.prototype.createTokens=function(t){if(ln(t))return[];for(var e,n=(this._input=t).length,i=this._isSpace,r=this._isAlphaNumeric,o=0,s=!1,a=0;a<n;a+=1)if(!i(e=t[a])){if(r(e))a=this.__handleAlphaNumeric(a,e);else if(ln(Ei[e]))if(Ni(e))switch(e){case"?":s=!0,o+=1,this.__handleQuestion(e);break;case":":o=this.__handleColon(e,o);break;default:a=this.__handleOtherOperator(a,e)}else";"===e&&this._throwError("Unexpected semicolon");else switch(e){case".":a=this.__handlePeriod(a,e);break;case"{":this.__handleLeftBrace(e);break;case"}":this.__handleRightBrace(e);break;case"[":this.__handleLeftBracket(e);break;case"]":this.__handleRightBracket(e);break;case"(":this.__handleLeftParenthesis(e);break;case")":this.__handleRightParenthesis(e);break;case",":this.__handleComma(e);break;case"'":case'"':a=this.__handleStringLiteral(a,e)}this.__previousChar=e}s&&0<o?this._throwError("Improper ternary expression"):0<this.__objArgCount.length&&this._throwError("Improper object literal"),this.__popRemainingOperators();var l=this.__outputQueue;return this._resetTokenizer(),l},t.prototype._checkType=function(t,e){return e?this._isNumeric(t):this._isAlphaNumeric(t)},t.prototype._lookAhead=function(t,e,n){var i,r=this._input,o=r.length;for(e+=1;e<o&&(i=r[e],this._checkType(i,n));)t+=i,e+=1;return t},t.prototype._lookAheadForOperatorFn=function(t,e){var n=this._input,i=n.length,r=t;for(e+=1;e<i&&Ni(r+=n[e]);)t=r,e+=1;return t},t.prototype._lookAheadForDelimiter=function(t,e){var n,i=this._input,r=i.length,o="";for(n=i[e+=1];e<r&&n!==t;)o+=n,n=i[e+=1];return o},t.prototype._popStackForVal=function(t,e,n){for(var i=this.__outputQueue,r=this.__operatorStack;t.val!==e;)i.push(r.shift()),t=r[0],0===r.length&&this._throwError(n)},t.prototype._isValEqual=function(t,e){return ln(t)||ln(t.val)?ln(e):""===t.val?""===e:-1!==e.indexOf(t.val)},t.prototype._isValUnequal=function(t,e){return ln(t)||ln(t.val)?!ln(e):""===t.val?""!==e:-1===e.indexOf(t.val)},t.prototype._resetTokenizer=function(){this._input=null,this.__previousChar="",this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]},t.prototype._throwError=function(t){this._log.error(new Error(t+" in "+this._input))},t.prototype._isNumeric=function(t){return"0"<=t&&t<="9"},t.prototype._isSpace=function(t){return" "===t||"\r"===t||"\n"===t||"\t"===t||"\v"===t||"Â "===t},t.prototype._isAlphaNumeric=function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||"@"===t||"_"===t||"$"===t},t.prototype._isStringValidVariable=function(t){return!this.__variableRegex.test(t)},t.prototype.__handleAlphaNumeric=function(t,e){var n=this._isNumeric(e),i=this._lookAhead(e,t,n);return this.__outputQueue.push(n?{val:Number(i),args:0}:{val:i,args:-1}),t+i.length-1},t.prototype.__handlePeriod=function(t,e){var n,i=this.__outputQueue,r=this.__operatorStack,o=i.length-1,s=this.__previousChar;return o<0||this._isSpace(s)||!ln(Ci[s])||"("===s||","===s?(t+=(n=this._lookAhead(e,t,!0)).length-1,i.push({val:parseFloat(n),args:0})):this._isValEqual(r[0],e)?i.push({val:e,args:0}):ln(i[o])||!sn(Number(i[o].val))||this._isValEqual(i[o-1],e)?r.unshift({val:e,args:0}):(t+=(n=this._lookAhead(e,t,!0)).length-1,i[o].val+=parseFloat(n)),t},t.prototype.__handleLeftBrace=function(t){this.__operatorStack.unshift({val:t,args:0}),this.__objArgCount.push(0),this.__lastColonChar.push(t),this.__lastCommaChar.push(t)},t.prototype.__handleRightBrace=function(t){var e=this.__operatorStack,n=e[0],i=this.__objArgCount.pop();ln(n)&&this._throwError("Improper object literal"),this._popStackForVal(n,"{","Improper object literal"),e.shift(),this.__lastColonChar.pop(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"{}",args:i})},t.prototype.__handleLeftBracket=function(t){var e=this.__previousChar,n=this.__operatorStack;this._isValEqual(n[0],".")&&this.__outputQueue.push(n.shift()),n.unshift({val:t,args:0}),this.__argCount.push({num:0,isArray:!("]"===e||")"===e||this._isAlphaNumeric(e))}),this.__lastCommaChar.push(t)},t.prototype.__handleRightBracket=function(t){var e=this.__operatorStack,n=e[0],i=this.__argCount.pop();(ln(n)||ln(i))&&this._throwError("Brackets mismatch"),i.isArray||(i.num-=1),this._popStackForVal(n,"[","Brackets mismatch"),e.shift(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"[]",args:"["===this.__previousChar?-1:i.num+1})},t.prototype.__handleLeftParenthesis=function(t){var e,n=this.__previousChar,i=this.__operatorStack;if(this._isAlphaNumeric(n)||"]"===n||")"===n){var r=this.__outputQueue,o=r[r.length-1],s=ln(o)?void 0:o.val;"[]"===s?(i.unshift(r.pop()),i.unshift(r.pop())):"()"===s||this._isNumeric(s)||i.unshift(r.pop()),e=0}else e=-1;this.__argCount.push({num:e}),i.unshift({val:t,args:e}),this.__lastCommaChar.push(t)},t.prototype.__handleRightParenthesis=function(t){var e=this.__operatorStack,n=e[0],i=this.__argCount.pop();if(ln(n)&&this._throwError("Parentheses mismatch"),this._popStackForVal(n,"(","Parentheses mismatch"),e.shift(),this.__lastCommaChar.pop(),!ln(i)&&0<=i.num){var r=i.num;"("===this.__previousChar?this.__removeFnFromStack(r)&&this.__outputQueue.push({val:"()",args:0}):this.__removeFnFromStack(r+1)&&this.__outputQueue.push({val:"()",args:r+1})}},t.prototype.__handleComma=function(t){var e=this.__lastCommaChar,n=e[e.length-1];if("("===n||"["===n){var i=this.__argCount,r=i.length;0<r?i[r-1].num+=1:this._throwError("Mismatch with "+n)}var o=this.__operatorStack[0];ln(o)&&this._throwError("Unexpected comma"),this._popStackForVal(o,n,"Unexpected comma")},t.prototype.__handleStringLiteral=function(t,e){var n=this._lookAheadForDelimiter(e,t),i=this.__operatorStack,r=i[0];return!ln(r)&&("["===r.val||"("===r.val&&0<=r.args)?i.unshift({val:n,args:0}):this.__outputQueue.push({val:n,args:0}),t+n.length+1},t.prototype.__handleQuestion=function(t){this.__lastColonChar.push(t),this.__determinePrecedence(t)},t.prototype.__handleColon=function(t,e){var n=this.__lastColonChar,i=n[n.length-1],r=this.__outputQueue;if("?"===i){var o=this.__operatorStack,s=o[0];ln(s)&&this._throwError("Ternary mismatch"),e-=1,n.pop(),this._popStackForVal(s,"?","Ternary mismatch"),r.push(o.shift()),o.unshift({val:t,args:-2})}else if("{"===i){var a=this.__objArgCount,l=r.length-1;a[a.length-1]+=1,l<0&&this._throwError("Unexpected colon"),r[l].args=1}else this._throwError("Unexpected colon");return e},t.prototype.__handleOtherOperator=function(t,e){var n=this._lookAheadForOperatorFn(e,t);return this.__determinePrecedence(n),t+n.length-1},t.prototype.__popRemainingOperators=function(){for(var t,e,n=this.__outputQueue,i=this.__operatorStack;0<i.length;)"("!==(e=(t=i.shift()).val)&&")"!==e||this._throwError("Parentheses mismatch"),n.push(t)},t.prototype.__determineOperator=function(t){switch(t){case"+":case"-":if(0===this.__outputQueue.length||Ni(this.__previousChar))return Ci["u"+t];default:return Ci[t]}},t.prototype.__determinePrecedence=function(t){var e,n,i=this.__determineOperator(t),r=i.precedence,o="ltr"===i.associativity,s=this.__operatorStack,a=this.__outputQueue;if(0!==s.length){do{if("."!==(n=s[0].val)){if(ln(e=Ci[n])||!(e.precedence<r||o&&e.precedence===r))return void s.unshift({val:t,args:i.fn.length-2});a.push(s.shift())}else a.push(s.shift())}while(0<s.length);s.unshift({val:t,args:i.fn.length-2})}else s.unshift({val:t,args:i.fn.length-2})},t.prototype.__removeFnFromStack=function(t){for(var e,n=this.__outputQueue,i=this.__operatorStack,r=i[0],o=this._isValEqual,s=this._isValUnequal,a=!1;!ln(r)&&s(r,"([")&&(this._isStringValidVariable(r.val)||o(r.val,".[]")||Ti(r.val));)-1!==(e=i.shift()).args||o(e,".[]")||(e.args=-2),n.push(e),r=i[0],a=!0;return a||s(n[n.length-t-1],"()")||(a=!0),a},t._inject={_log:k},t}();t.Tokenizer=n,Zn.injectable(o,n);var i=function(){function t(){this._tokens=[],this.__cache={},this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={},this.__fnEvalConstant="var initialContext;return "}return t.prototype.parse=function(t){var e=this.__cache[t];if(!ln(e))return{expression:e.expression,identifiers:e.identifiers.slice(0),aliases:e.aliases.slice(0),evaluate:e.evaluate};if(this._tokens=this._tokenizer.createTokens(t),0===(e=this._evaluate(t)).identifiers.length){var n=e.evaluate(null);e.evaluate=function(){return n}}return this.__cache[t]=e},t.prototype.clearCache=function(t){tn(t)?Nn(this.__cache,t):this.__cache={}},t.prototype._evaluate=function(t){for(var e,n,i,r=this._tokens,o=r.length,s=this.__tempIdentifiers,a=this.__codeArray,l=!1,u=0;u<o;u+=1)if(n=(e=r[u]).val,i=e.args,Ti(n))switch(n){case"()":l=this.__handleFunction(u,i,l);break;case"{}":a.push(this.__convertObject(i)),s.push(".");break;default:i<0?(a.push("[]"),s.push(".")):0<i?(a.push(this.__convertArrayLiteral(i)),s.push(".")):l=this.__indexIntoObject(u,n,l)}else if(Ni(n))if(0===i)a.push(this.__convertPrimitive(u,n,i));else switch(n){case"?":this.__handleQuestion();break;case":":this.__handleColon();break;case"+":case"-":1===i&&(n="u"+n);default:this.__handleOperator(n,i)}else i<0?a.push(this.__convertFunction(u,n,l)):a.push(this.__convertPrimitive(u,n,i));this._popRemainingIdentifiers(),this._makeIdentifiersUnique();var c={evaluate:new Function(W,"aliases",""+this.__fnEvalConstant+(0===a.length?'"'+t+'"':a.join(""))+";"),expression:t,identifiers:this.__identifiers.slice(0),aliases:Object.keys(this.__aliases)};return this._resetParser(),c},t.prototype._peek=function(t){return this._tokens[t+1]},t.prototype._lookBack=function(t){return this._tokens[t-1]},t.prototype._popRemainingIdentifiers=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers;0<n.length;)"."!==(t=n.pop())&&e.push(t)},t.prototype._makeIdentifiersUnique=function(){for(var t,e=this.__identifiers,n=[],i={};0<e.length;)i[t=e.pop()]||(i[t]=!0,n.push(t));this.__identifiers=n},t.prototype._isValEqual=function(t,e){return ln(t)||ln(t.val)?ln(e):""===t.val?""===e:-1!==e.indexOf(t.val)},t.prototype._isValUnequal=function(t,e){return ln(t)||ln(t.val)?!ln(e):""===t.val?""!==e:-1===e.indexOf(t.val)},t.prototype._resetParser=function(){this._tokens=[],this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={}},t.prototype._throwError=function(t){this._log.error(new Error(t))},t.prototype.__convertPrimitive=function(t,e,n){if(0<n)return this.__tempIdentifiers.push("."),e;var i=sn(Number(e)),r=this._peek(t),o=!(ln(r)||1<=r.args),s=this._isValEqual;return ki(e)||tn(e)&&(i||this._isValUnequal(r,"[]()")||s(r,"[]")&&!o)?(this.__tempIdentifiers.push("."),'"'+e+'"'):(!i||s(r,".[]")&&o?this.__tempIdentifiers.push(e):this.__tempIdentifiers.push("."),e)},t.prototype.__convertFunction=function(t,e,n){if("@"===e[0])this.__aliases[e.slice(1)]=!0;else if(ki(e))return this.__tempIdentifiers.push("."),e;var i=this._peek(t),r=this._isValEqual;if(r(this._tokens[t-1],"()")&&r(i,".[]")?this.__tempIdentifiers.push("."):this.__tempIdentifiers.push(e),ln(i))return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+e+'"))';switch(i.val){case".":case"()":return e;default:if(!n)return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+e+'"))'}},t.prototype.__convertObject=function(t){for(var e,n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="{";s<t;)s+=1,n=o.pop(),a+=',"'+o.pop()+'":'+n,1<r.length&&(e=r.pop(),r.pop(),"."!==e&&i.push(e));return a.replace(",","")+"}"},t.prototype.__convertArrayLiteral=function(t){for(var e,n=this.__identifiers,i=this.__tempIdentifiers,r=this.__codeArray,o=0,s="";o<t;)o+=1,s=r.pop()+","+s,0<i.length&&"."!==(e=i.pop())&&n.push(e);return"["+s.slice(0,-1)+"]"},t.prototype.__handleFunction=function(t,e,n){var i,r,o=this.__identifiers,s=this.__tempIdentifiers,a=this.__codeArray,l=this._lookBack(t),u=!ln(l)&&(-2===l.args||this._isValEqual(l,".[]")),c=0,h="",p="",_="",f=!1;for(u&&(p=a.pop(),_=s.pop());c<e;)c+=1,h=a.pop()+","+h,0<s.length&&"."!==(i=s.pop())&&(o.push(i),f=!0);if(r=0<e?".call(initialContext || context,"+h.slice(0,h.length-1)+")":".call(initialContext || context)",n)if(n=!1,0<a.length){var d=a.pop(),v=s.length-1;v<0||"."===s[v]||""===_?""!==_&&f&&"["!==d[0]&&"]"!==d[d.length-1]&&(o[o.length-1]+="."+_):(s[v]+="."+_,o.push(s.pop())),r=rn(p)?d+r:"(("+this.__indexIntoContext.toString()+")("+d+',"'+p+'") || (function () {}))'+r}else this._throwError("Improper expression or context");else u?(r="(initialContext = (("+this.__findInitialContext.toString()+')(context,aliases,"'+p+'") || (function () {}))'+r+")",o.push(p)):r=a.pop()+r;a.push(r);var m=s.length;return this._isValEqual(this._peek(t),"[]")&&0<m&&"."!==s[m-1]&&o.push(s.pop()),n},t.prototype.__indexIntoObject=function(t,e,n){var i=this._isValEqual;if(i(this._peek(t),"()"))return!0;var r,o=this.__codeArray,s=this.__identifiers,a=this.__tempIdentifiers,l=this._lookBack(t),u=a.pop(),c=!ln(u),h=o.pop();return c&&"@"===u[0]?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",s.push(u),0<a.length&&s.push(a.pop())):i(l,"++--()[]*/%?:>=<=&&||!===")?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",a.push(".")):"[]"!==e||ln(l)||0<=l.args?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+',"'+h+'")',0<=(r=a.length-1)?"."!==a[r]&&(a[r]+="."+u):c&&"."!==u&&"."!==e&&s.push(u)):(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",0<=(r=a.length-1)&&"."!==a[r]&&s.push(a.pop()),s.push(u)),o.push(h),n},t.prototype.__handleQuestion=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&0<n.length;o+=1)"."!==(t=n.pop())&&e.push(t);i.push(i.pop()+"?"+r)},t.prototype.__handleColon=function(){for(var t,e=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&0<n.length;o+=1)"."!==(t=n.pop())&&e.push(t);i.push(i.pop()+":"+r)},t.prototype.__handleOperator=function(t,e){for(var n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="";s<e;)s+=1,a="function (context, aliases) { return "+o.pop()+"; },"+a,0<r.length&&"."!==(n=r.pop())&&i.push(n);r.push("."),o.push("("+Ci[t].fn.toString()+")(context, aliases,"+a.slice(0,a.length-1)+")")},t.prototype.__findInitialContext=function(t,e,n){return"@"===n[0]&&null!==e&&"object"==typeof e?e[n.slice(1)]:null!==t&&"object"==typeof t?t[n]:void 0},t.prototype.__indexIntoContext=function(t,e){if(null!==t&&"object"==typeof t)return t[e]},t._inject={_tokenizer:o,_log:k},t}();t.Parser=i,Zn.injectable(J,i)}(d.expressions||(d.expressions={})),function(t){function e(t){return t.location}t.Location=e,Zn.injectable(ct,e,[Q]);var n=function(){function l(){this.uid=wn(ht),this.__lastUrl=this._location.href,this.__protocol=this.urlUtils().protocol,this.__initializing=!1,this._EventManager.on(this.uid,Rt,this.initialize,this),this._compat.msApp&&(this._stack=[])}return l.prototype.initialize=function(){var t=this._compat;this._EventManager.dispose(this.uid),this.__initializing=!0,fi(H);var e=this.url(),n=e,i=this._urlChanged.bind(this),r=this._dom,o=this._window;n!==e&&this.url(n,!0),t.pushState&&r.addEventListener(o,"popstate",i,!1),r.addEventListener(o,"hashchange",i,!1),this.__initializing=!1},l.prototype.url=function(t,e){var n=this._location;return tn(t)&&!this._isLastUrl(t)&&(!e&&cn(this._stack)&&this._stack.push(n.href),this._setUrl(t,e)),rn(this.__currentUrl)?n.href:this.__currentUrl},l.prototype.back=function(t){sn(t)||(t=1);var e=this._stack;if(cn(e)&&1<e.length)return this._stack=e=e.slice(0,e.length-(t-1)),this.url(e.pop()),void e.pop();this._history.go(-t)},l.prototype.forward=function(t){sn(t)||(t=1),this._history.go(t)},l.prototype.urlUtils=function(t){tn(t)||(t=this.url());var e=fi(H),n=l.config,i=n.hashPrefix;return tn(i)||(i=""),n.routingType===n.HASH&&(t=t.replace(new RegExp("#"+i+"/?"),"")),e.initialize(t),e},l.prototype.isCrossDomain=function(t){if(!tn(t))return!1;var e=this.urlUtils(t),n=this.urlUtils();return e.protocol!==n.protocol||e.hostname!==n.hostname||e.port!==n.port},l.prototype.formatUrl=function(t){var e=l.config,n=e.baseUrl;if(!tn(t))return"";if(t===n)return t;var i=!this._regex.fullUrlRegex.test(t)||-1<t.indexOf(n);if("/"===t[0]&&(t=t.slice(1)),i){if(e.routingType===e.HASH){var r=0===t.indexOf(this.__protocol+":"),o=e.hashPrefix;tn(o)||(o="");var s="#"+o,a=new RegExp(s+"|#/");"/"!==t[t.length-1]&&-1===t.indexOf("?")&&(t+="/"),a.test(t)||(t=r?""+t+s+"/":s+("/"!==t[0]?"/":"")+t)}-1===t.indexOf(n)&&(t=n+t)}return t},l.prototype._urlChanged=function(){var t=this;if(!this.__initializing){this.__currentUrl=null;var e=this.urlUtils(),n=this._trimSlashes(e.href);if(this.__lastUrl!==n){this.__lastUrl=n;var i=this._EventManager;bn(function(){i.dispatch(Pt,t,i.DIRECT,[e])})}}},l.prototype._setUrl=function(t,e){t=this.formatUrl(t);var n=this.urlUtils(t),i=l.config.baseUrl,r=this._history,o=this._location;if(-1!==n.href.indexOf(i))if(this._regex.fullUrlRegex.test(t)||"/"===t[0]||(t=i+t),this._compat.pushState){if(e){var s=r.state;We(s)||(s={}),r.replaceState({previousLocation:s.previousLocation},"",t)}else r.pushState({previousLocation:this.urlUtils().pathname},"",t);this.__initializing||this._urlChanged()}else this.__currentUrl=t,e?o.replace(t):o.href=t;else o.href=t},l.prototype._isLastUrl=function(t){var e=this.__lastUrl;return tn(t)&&(rn(t)&&(t="/"),t=this._trimSlashes(this.urlUtils(t).href)),t===e},l.prototype._trimSlashes=function(t){return tn(t)&&"/"===t[t.length-1]?t.slice(0,-1):t},l._inject={_EventManager:N,_compat:X,_regex:K,_window:Q,_location:ct,_history:ut,_dom:M},l.config={HASH:"hash",STATE:"state",routingType:"hash",hashPrefix:"!",baseUrl:""},l}();function i(){return n.config}t.Browser=n,Zn.injectable(tt,n),t.IBrowserConfig=i,Zn.injectable(V,i);var r=function(){function r(){var t=this._browserConfig,e=t.baseUrl;if(rn(e)||!this._regex.fullUrlRegex.test(e)){var n=this._window.location.href.replace(this._regex.initialUrlRegex,"/");for(tn(e)?0===e.indexOf("/")&&(e=e.slice(1)):e="",e=r.__getBaseUrl(n)+e;"/"===e[e.length-1];)e=e.slice(0,-1);t.baseUrl=e+"/"}}return r.__getQuery=function(t){return Sn(t)},r.__getBaseUrl=function(t){var e=fi(K),n=fi(ct),i=n.protocol,r=(n.host,n.origin);return"file:"===i||-1<i.indexOf("wmapp")||-1<i.indexOf("ms-appx")?r=n.href:un(r)&&(r=n.protocol+"//"+n.host),(r=r.replace(e.initialUrlRegex,"")).split("?")[0].split("#")[0]+"/"},r.prototype.initialize=function(t){tn(t)||(t=""),Je(r.__urlUtilsElement)||(r.__urlUtilsElement=this._document.createElement("a"));var e,n=r.__urlUtilsElement,i=this._browserConfig;"/"===t[0]&&0!==t.indexOf("//")&&(t=t.slice(1)),this._regex.fullUrlRegex.test(t)||(t=i.baseUrl+t),n.setAttribute("href",t),t=n.href,n.setAttribute("href",t),t=n.href,this.href=t,this.protocol=tn(n.protocol)?n.protocol.replace(/:$/,""):"",this.host=n.host,this.search=tn(n.search)?n.search.replace(/^\?/,""):"",this.hash=tn(n.hash)?n.hash.replace(/^#/,""):"",this.hostname=n.hostname,this.port=n.port,e=(e=rn(i.baseUrl)?"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname:t.replace(i.baseUrl,"/")).replace(this._regex.initialUrlRegex,"/"),this.pathname=e.split("?")[0].split("#")[0],this.query=r.__getQuery(this.search)},r.prototype.toString=function(){return this.href},r._inject={_EventManager:N,_document:G,_window:Q,_compat:X,_regex:K,_browserConfig:V},r}();t.UrlUtils=r,Zn.injectable(H,r,null,ve)}(d.web||(d.web={})),function(t){var n,e,i,r,o,s=[],a="undefined"!=typeof window?window:{},l=a.MutationObserver;We(l)||(l=a.WebKitMutationObserver),n="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?function(){process.nextTick(p)}:l?(e=fi(G),i=fi(Q),r=e.createElement("div"),(o=new l(p)).observe(r,{attributes:!0}),i.addEventListener("unload",function(){o.disconnect(),o=null},!1),function(){r.setAttribute("drainQueue","drainQueue")}):function(){bn(p)};var c,u,h=function(){function u(t){if(!an(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof u))throw new TypeError('Failed to construct "Promise": Please use the "new" operator, this object constructor cannot be called as a function.');this.__subscribers=[],u.__invokeResolveFunction(t,this)}return u.all=function(l){return cn(l)?new u(function(n,t){var e,i=[],r=l.length;function o(e){return function(t){return s(e,t)}}function s(t,e){i[t]=e,0===(r-=1)&&n(i)}0===r&&n([]);for(var a=0;a<l.length;a+=1)nn(e=l[a])?e.then(o(a),t):s(a,e)}):u.all([l])},u.race=function(r){return cn(r)?new u(function(t,e){for(var n,i=0;i<r.length;i+=1)We(n=r[i])&&"function"==typeof n.then?n.then(t,e):t(n)}):u.race([r])},u.resolve=function(n){return new u(function(t,e){t(n)})},u.reject=function(n){return new u(function(t,e){e(n)})},u.__invokeResolveFunction=function(t,e){function n(t){u.__reject(e,t)}try{t(function(t){u.__resolve(e,t)},n)}catch(t){n(t)}},u.__invokeCallback=function(t,e,n,i){var r,o,s,a,l=an(n);if(l)try{r=n(i),s=!0}catch(t){a=!0,o=t}else r=i,s=!0;u.__handleThenable(e,r)||(l&&s?u.__resolve(e,r):a?u.__reject(e,o):t===c.FULFILLED?u.__resolve(e,r):t===c.REJECTED&&u.__reject(e,r))},u.__publish=function(t,e){for(var n,i,r=t.__subscribers,o=t.__detail,s=0;s<r.length;s+=3)n=r[s],i=r[s+e],u.__invokeCallback(e,n,i,o);t.__subscribers=null},u.__publishFulfillment=function(t){u.__publish(t,t.__state=c.FULFILLED)},u.__publishRejection=function(t){u.__publish(t,t.__state=c.REJECTED)},u.__reject=function(t,e){t.__state===c.PENDING&&(t.__state=c.SEALED,t.__detail=e,u.config.async(u.__publishRejection,t))},u.__fulfill=function(t,e){t.__state===c.PENDING&&(t.__state=c.SEALED,t.__detail=e,u.config.async(u.__publishFulfillment,t))},u.__resolve=function(t,e){t===e?u.__fulfill(t,e):u.__handleThenable(t,e)||u.__fulfill(t,e)},u.__handleThenable=function(e,n){var i;if(e===n)return u.__reject(e,new TypeError("A promises callback cannot return the same promise.")),!0;if(nn(n))try{return n.then.call(n,function(t){if(i)return!0;i=!0,n!==t?u.__resolve(e,t):u.__fulfill(e,t)},function(t){if(i)return!0;i=!0,u.__reject(e,t)}),!0}catch(t){return i||u.__reject(e,t),!0}return!1},u.__subscribe=function(t,e,n,i){var r=t.__subscribers,o=r.length;r[o]=e,r[o+c.FULFILLED]=n,r[o+c.REJECTED]=i},u.prototype.then=function(t,e){var n=this,i=new this.constructor(qe,this);if(ln(this.__state))u.__subscribe(this,i,t,e);else{var r=arguments;u.config.async(function(){u.__invokeCallback(n.__state,i,r[n.__state-1],n.__detail)})}return i},u.prototype.catch=function(t){return this.then(null,t)},u.prototype.toString=function(){return"[object Promise]"},u.config={async:function(t,e){1===s.push([t,e])&&n()}},u}();function p(){for(var t=0,e=s;t<e.length;t++){var n=e[t];(0,n[0])(n[1])}s=[]}function _(t){return!ln(t.Promise)&&an(t.Promise.all)&&an(t.Promise.race)&&an(t.Promise.resolve)&&an(t.Promise.reject)?t.Promise:h}t.Promise=h,(u=c||(c={}))[u.PENDING=void 0]="PENDING",u[u.SEALED=0]="SEALED",u[u.FULFILLED=1]="FULFILLED",u[u.REJECTED=2]="REJECTED",t.IPromise=_,Zn.injectable(w,_,[Q],ge);var f=function(){function t(){var t=fi(X);this.__fileSupported=t.fileSupported}return t.prototype.initialize=function(t){this.__options=Qe(!1,!1,{},this._config,t)},t.prototype.execute=function(){var t=this.__options,e=t.url;if(!tn(e)||rn(e.trim()))return this._invalidOptions();t.url=this._browser.urlUtils(e).toString();var n=!1;return t.isCrossDomain||!1?n=!0:(this.xhr=new XMLHttpRequest,un(this.xhr.withCredentials)&&(n=this._browser.isCrossDomain(e))),n?(this.xhr=null,this.jsonpCallback=t.jsonpCallback,ln(this.jsonpCallback)&&(this.jsonpCallback=wn("plat_callback")),this.executeJsonp()):this._sendXhrRequest()},t.prototype.executeJsonp=function(){var u=this,c=this.__options,h=c.url;if(!tn(h)||rn(h.trim()))return this._invalidOptions();c.url=this._browser.urlUtils(h).toString(),ln(this.jsonpCallback)&&(this.jsonpCallback=c.jsonpCallback,ln(this.jsonpCallback)&&(this.jsonpCallback=wn("plat-callback")));var t=new g(function(e,t){var n=u._window,i=u._document,r=i.createElement("script"),o=u.jsonpCallback,s=c.jsonpIdentifier;tn(s)||(s="callback"),r.src=h+(-1<h.indexOf("?")?"&":"?")+s+"="+o;var a=n[o];n[o]=function(t){an(u.clearTimeout)&&u.clearTimeout(),i.head.removeChild(r),un(a)?Nn(n,o):n[o]=a,e({response:t,status:200})},i.head.appendChild(r);var l=c.timeout;sn(l)&&0<l&&(u.clearTimeout=bn(function(){u.clearTimeout=Cn(function(){t(new m({response:"Request timed out in "+l+"ms for "+h,status:408})),n[o]=qe},l-1)}))});return t.initialize(this),t},t.prototype._xhrOnReadyStateChange=function(){var t=this.xhr;if(4===t.readyState){var e=t.status;if(0!==e)return 200<=e&&e<300||304===e;var n=t.response;if(ln(n))try{n=t.responseText}catch(t){}return!rn(n)}},t.prototype._sendXhrRequest=function(){var p=this,_=this.xhr,f=this.__options,d=f.method,v=f.url,t=new g(function(n,i){_.onreadystatechange=function(){var t=p._xhrOnReadyStateChange();if(!ln(t)){var e=p._formatResponse(f.responseType,t);t?n(e):i(new m(e)),p.xhr=f=null}},tn(d)||(p._log.info('AjaxOptions method was not of type string. Defaulting to "GET".'),d="GET"),_.open(d.toUpperCase(),v,!0,f.user,f.password);var t=f.responseType;if(p.__fileSupported||""===t||"text"===t||(t=""),"json"===t)try{_.responseType=t}catch(t){_.responseType=""}_.withCredentials=f.withCredentials;var e=f.overrideMimeType,r=f.data;if(tn(e)&&!rn(e)&&_.overrideMimeType(e),ln(r)||""===r)p.__setHeaders(),_.send();else{var o=f.transforms;hn(o)||(o=[]);var s=o.length,a=f.contentType,l=tn(a)&&!rn(a);if(0<s){for(var u=0;u<s;u+=1)r=o[u](r,_);l&&_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)}else if(We(r))if(l){var c=a.toLowerCase();-1!==c.indexOf("x-www-form-urlencoded")?(r=p.__serializeFormData(),_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)):-1!==c.indexOf("multipart/form-data")?p.__fileSupported?(r=p.__appendFormData(),p.__setHeaders(),_.send(r)):p.__submitFramedFormData().then(function(t){n(t)},function(){p.xhr=null}):(r=JSON.stringify(r),_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r))}else p.__setHeaders(),_.send(r);else l&&_.setRequestHeader("Content-Type",a),p.__setHeaders(),_.send(r)}var h=f.timeout;sn(h)&&0<h&&(p.clearTimeout=bn(function(){p.clearTimeout=Cn(function(){i(new m({response:"Request timed out in "+h+"ms for "+f.url,status:408,getAllResponseHeaders:function(){return _.getAllResponseHeaders()},xhr:_})),_.onreadystatechange=null,_.abort(),p.xhr=null},h-1)}))});return t.initialize(this),t},t.prototype._invalidOptions=function(){var n=this;return new g(function(t,e){n._log.warn("Attempting a request without specifying a url"),e(new m({response:"Attempting a request without specifying a url",status:null,getAllResponseHeaders:null,xhr:null}))})},t.prototype._formatResponse=function(t,e){var n=this.xhr,i=n.status,r=n.response;if(ln(r))try{r=n.responseText}catch(t){}if(0===i&&(i=e?200:404),n.onreadystatechange=null,an(this.clearTimeout)&&this.clearTimeout(),"json"===t&&tn(r))try{r=JSON.parse(r)}catch(t){}return{response:r,status:i,getAllResponseHeaders:function(){return n.getAllResponseHeaders()},xhr:n}},t.prototype.__setHeaders=function(){var t=this.__options.headers;We(t)||(t={});var e,n,i=Object.keys(t),r=this.xhr,o=i.length;for(n=0;n<o;n+=1)e=i[n],r.setRequestHeader(e,t[e])},t.prototype.__serializeFormData=function(){for(var t,e,n=this.__options.data,i=Object.keys(n),r=[];0<i.length;)ln(e=n[t=i.pop()])?e="":We(e)&&(e=pn(e)?e.toISOString():Ze(e)?(this._log.warn('Invalid File entry with key "'+t+'"'),"[object File]"):(this._log.warn('Invalid form entry with key "'+t+'" and value "'+e+'"'),JSON.stringify(e))),r.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return r.join("&").replace(/%20/g,"+")},t.prototype.__appendFormData=function(){for(var t,e,n=this.__options.data,i=new FormData,r=Object.keys(n);0<r.length;)if(ln(e=n[t=r.pop()]))i.append(t,"");else if(We(e))if(pn(e))i.append(t,e.toISOString());else if(Ze(e)){var o=e.name;tn(o)||(o=e.fileName),tn(o)||(o="blob"),i.append(t,e,o)}else this._log.warn('Invalid form entry with key "'+t+'" and value "'+e+'"'),i.append(t,JSON.stringify(e));else i.append(t,e);return i},t.prototype.__submitFramedFormData=function(){var t,n=this,e=this.__options,i=e.data,r=e.url,o=this._document,s=o.body,a=fi(w),l=o.createElement("form"),u=o.createElement("iframe"),c=wn("iframe_target"),h=Object.keys(i);for(u.name=l.target=c,u.src="javascript:false;",l.enctype=l.encoding="multipart/form-data",l.action=r,l.method="POST",l.style.display="none";0<h.length;)t=h.pop(),l.insertBefore(this.__createInput(t,i[t]),null);return new a(function(e,t){n.xhr.abort=function(){u.onload=null,s.removeChild(l),s.removeChild(u),t()},u.onload=function(){var t=u.contentDocument.body.innerHTML;s.removeChild(l),s.removeChild(u),e({response:t,status:200,getAllResponseHeaders:function(){return""}}),n.xhr=u.onload=null},s.insertBefore(l,null),s.insertBefore(u,null),l.submit()})},t.prototype.__createInput=function(t,e){var n=this._document,i=n.createElement("input");if(i.type="hidden",i.name=t,ln(e))i.value="";else if(We(e))if(!an(e.slice)||un(e.name)||un(e.path))this._log.info('Invalid form entry with key "'+t+'" and value "'+e+'"'),i.value=JSON.stringify(e);else{var r=n.querySelectorAll('input[type="file"][name="'+t+'"]'),o=r.length;if(0===o)this._log.info('Could not find input[type="file"] with [name="'+t+'"]. Stringifying data instead.'),i.value=JSON.stringify(e);else if(1===o){var s=(i=r[0]).cloneNode(!0);i.parentNode.insertBefore(s,i)}else{for(var a=void 0,l=e.path;0<o;)if((a=r[o-=1]).value===l){var u=(i=a).cloneNode(!0);i.parentNode.insertBefore(u,i);break}-1===o&&(this._log.info('Could not find input[type="file"] with [name="'+t+'"] and [value="'+e.path+'"]. Stringifying data instead.'),i.value=JSON.stringify(e))}}else i.value=e;return i},t._inject={_browser:tt,_window:Q,_document:G,_config:E,_log:k},t}();t.HttpRequest=f;var m=function(){function t(t){this.name="AjaxError",Error.apply(this),this.response=this.message=t.response,this.status=t.status,this.getAllResponseHeaders=t.getAllResponseHeaders,this.xhr=t.xhr}return t.prototype.toString=function(){var t=this.response,e=t;return We(t)&&!t.hasOwnProperty("toString")&&(e=JSON.stringify(t)),"Request failed with status: "+this.status+" and response: "+e},t}();(t.AjaxError=m).prototype=Error.prototype;var g=function(i){function t(t,e){var n=i.call(this,t)||this;return n._window=fi(Q),ln(e)||(n.__http=e.__http),n}return __extends(t,i),t.prototype.initialize=function(t){We(t)&&ln(this.__http)&&(this.__http=t)},t.prototype.cancel=function(){var t=this.__http,e=t.xhr,n=t.jsonpCallback;an(t.clearTimeout)&&t.clearTimeout(),ln(e)?ln(n)||(this._window[n]=qe):(e.onreadystatechange=null,e.abort(),t.xhr=null),this.__subscribers=[]},t.prototype.then=function(t,e){return i.prototype.then.call(this,t,e)},t.prototype.catch=function(t){return i.prototype.catch.call(this,t)},t}(h);t.AjaxPromise=g;var d=function(){function t(){this.responseType={DEFAULT:"",ARRAYBUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},this.contentType={ENCODED_FORM:"application/x-www-form-urlencoded;charset=utf-8",JSON:"application/json;charset=utf-8",MULTIPART_FORM:"multipart/form-data",OCTET_STREAM:"application/octet-stream;charset=utf-8",XML:"application/xml;charset=utf-8",PLAIN_TEXT:"text/plain",HTML:"text/html"}}return t.prototype.ajax=function(t){var e=fi(x);return e.initialize(t),e.execute()},t.prototype.jsonp=function(t){var e=fi(x);return e.initialize(t),e.executeJsonp()},t.prototype.json=function(t){var e=fi(x);return e.initialize(Qe(!1,!1,{},t,{responseType:"json"})),e.execute()},t.config={url:null,method:"GET",responseType:"",transforms:[],headers:{},withCredentials:!1,timeout:null,jsonpIdentifier:"callback",contentType:"application/json;charset=utf-8"},t}();function v(){return d.config}t.Http=d,Zn.injectable(C,d),Zn.injectable(x,f,null,ve),t.IHttpConfig=v,Zn.injectable(E,v)}(vi=d.async||(d.async={})),function(t){var r={},o={},e=function(){function i(t,e){this.__uid=t,this.__options=e,this.__size=0,ln(e)&&(this.__options={timeout:0}),o[t]={}}return i.create=function(t,e){var n=r[t];return ln(n)&&(n=r[t]=new i(t,e)),n},i.fetch=function(t){return r[t]},i.clear=function(){for(var t=Object.keys(r),e=t.length,n=0;n<e;n+=1)r[t[n]].clear();r={}},i.prototype.info=function(){return{uid:this.__uid,size:this.__size,options:this.__options}},i.prototype.put=function(t,e){var n=o[this.__uid][t];o[this.__uid][t]=e,un(n)&&(this.__size+=1);var i=this.__options.timeout;return sn(i)&&0<i&&Cn(this.remove,i,[t],this),e},i.prototype.read=function(t){return o[this.__uid][t]},i.prototype.remove=function(t){Nn(o[this.__uid],t),this.__size-=1},i.prototype.clear=function(){o[this.__uid]={},this.__size=0},i.prototype.dispose=function(){this.clear(),Nn(r,this.__uid)},i}();function n(){return e}function i(){return t.managerCache}t.Cache=e,t.ICacheFactory=n,Zn.injectable(R,n,null,me),t.managerCache=e.create("__managerCache"),t.IManagerCache=i,Zn.injectable(A,i);var s=function(r){function t(){return r.call(this,"__templateCache")||this}return __extends(t,r),t.prototype.put=function(t,e){var n=this._Promise;if(r.prototype.put.call(this,t,n.resolve(e)),Ke(e))e=e.cloneNode(!0);else if(Je(e)){var i=document.createDocumentFragment();i.appendChild(e.cloneNode(!0)),e=i}else(tn(e)||ln(e))&&(e=Hn(e));return n.resolve(e)},t.prototype.read=function(e){var n=this,t=r.prototype.read.call(this,e);return ln(t)?this._Promise.reject(null):t.then(function(t){return n.put(e,t)},function(t){return n._log.warn("Error retrieving template, "+e+", from promise."),null})},t._inject={_Promise:w,_log:k},t}(e);t.TemplateCache=s,Zn.injectable(L,s);var a=function(){function t(t){var n=this;fn(function(t,e){n[e]=t},this._storage=t)}return Object.defineProperty(t.prototype,"length",{get:function(){return this._storage.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._storage.clear()},t.prototype.getItem=function(t){return this._storage.getItem(t)},t.prototype.key=function(t){return this._storage.key(t)},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t.prototype.setItem=function(t,e){this._storage.setItem(t,e),this[t]=this.getItem(t)},t}(),l=function(t){function e(){return t.call(this,fi(Q).localStorage)||this}return __extends(e,t),e}(t.BaseStorage=a);t.LocalStorage=l,Zn.injectable("$LocalStorage",l);var u=function(t){function e(){return t.call(this,fi(Q).sessionStorage)||this}return __extends(e,t),e}(a);t.SessionStorage=u,Zn.injectable("$SessionStorage",u)}(d.storage||(d.storage={}));var bi,Ci={"u+":{precedence:4,associativity:"rtl",fn:function(t,e,n){return+n(t,e)}},"+":{precedence:6,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)+i(t,e)}},"u-":{precedence:4,associativity:"rtl",fn:function(t,e,n){return-n(t,e)}},"-":{precedence:6,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)-i(t,e)}},"*":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)*i(t,e)}},"/":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)/i(t,e)}},"%":{precedence:5,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)%i(t,e)}},"?":{precedence:15,associativity:"rtl",fn:function(){}},":":{precedence:15,associativity:"rtl",fn:function(){}},">":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>i(t,e)}},"<":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<i(t,e)}},"!":{precedence:4,associativity:"rtl",fn:function(t,e,n){return!n(t,e)}},"~":{precedence:4,associativity:"rtl",fn:function(t,e,n){return~n(t,e)}},"&":{precedence:10,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)&i(t,e)}},"|":{precedence:12,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)|i(t,e)}},">>":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>>i(t,e)}},"<<":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<<i(t,e)}},">>>":{precedence:7,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>>>i(t,e)}},"&&":{precedence:13,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)&&i(t,e)}},"||":{precedence:14,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)||i(t,e)}},"==":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)==i(t,e)}},"===":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)===i(t,e)}},"!=":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)!=i(t,e)}},"!==":{precedence:9,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)!==i(t,e)}},">=":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)>=i(t,e)}},"<=":{precedence:8,associativity:"ltr",fn:function(t,e,n,i){return n(t,e)<=i(t,e)}},"=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"++":{precedence:3,associativity:"",fn:function(t,e,n){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"--":{precedence:3,associativity:"",fn:function(t,e,n){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"+=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"-=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"*=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"/=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}},"%=":{precedence:17,associativity:"rtl",fn:function(t,e,n,i){d.acquire(k).error(new Error("Assignment operators are not supported"))}}},xi={"()":{precedence:2,associativity:null,fn:null},"[]":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},"{}":{precedence:1,associativity:null,fn:null}},Ei={"{":{precedence:1,associativity:null,fn:null},"}":{precedence:1,associativity:null,fn:null},"[":{precedence:2,associativity:null,fn:null},"]":{precedence:2,associativity:null,fn:null},"(":{precedence:2,associativity:null,fn:null},")":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},",":{precedence:18,associativity:null,fn:null},"'":{precedence:0,associativity:null,fn:null},'"':{precedence:0,associativity:null,fn:null}},wi={false:!1,true:!0,null:null,undefined:"undefined"};function Ti(t){return!ln(xi[t])}function Ni(t){return!ln(Ci[t])}function ki(t){return!un(wi[t])}!function(t){var a=["push","pop","reverse","shift","sort","splice","unshift"],e=function(){function T(){this._compat=fi(X),this.__identifiers={},this.__identifierHash={},this.__lengthListeners={},this.__contextObjects={},this.__isArrayFunction=!1}return T.getManager=function(t){var e,n=T.__managers,i=t.uid,r=n[i];return ln(r)?((e=n[i]=new T).context=t,e):e=r},T.dispose=function(t){if(!ln(t)){var e=t.uid,n=T.__controls,i=T.__managers,r=i[e],o=n[e];We(o)||(o={}),ln(r)||(r.dispose(),Nn(i,e));for(var s,a=Object.keys(o);0<a.length;)for(s=o[a.shift()];0<s.length;)s.shift()();Nn(n,e),t.hasOwnContext&&!ln(t.context)&&(T.unObserve(t.context),T.defineProperty(t,W,t.context,!0,!0,!0))}},T.removeArrayListeners=function(t,e){var n=T.arrayChangeListeners[t];ln(n)||Nn(n,e)},T.getContext=function(t,e){if(ln(t))return t;for(e=e.slice(0);0<e.length;)if(ln(t=t[e.shift()]))return t;return t},T.defineProperty=function(t,e,n,i,r,o){He(t,e,n,i,r,o)},T.defineGetter=function(t,e,n,i,r){var o,s,a,l,u;o=t,s=e,a=n,l=i,u=r,Object.defineProperty(o,s,{get:function(){return a},enumerable:!0===l,configurable:!0===u})},T.pushRemoveListener=function(t,e,n){var i,r=T.__controls,o=r[e];ln(o)&&(o=r[e]={}),ln(i=o[t])&&(i=o[t]=[]),i.push(n)},T.spliceRemoveListener=function(t,e,n){var i,r=T.__controls[e];if(!ln(r)&&!ln(i=r[t])){var o=i.indexOf(n);-1!==o&&(i.splice(o,1),0===i.length&&Nn(r,t))}},T.removeIdentifier=function(t,e){for(var n,i=t.length,r=T.__controls,o=0;o<i;o+=1)ln(n=r[t[o]])||Nn(n,e)},T.createContext=function(t,e){var n=t.context;if(!We(n)){if(!ln(n))return void T._log.warn("A child control is trying to create a child context that has a parent control with a primitive type context");n=t.context={}}for(var i,r,o=e.split(".");0<o.length;)ln(r=n[i=o.shift()])&&(r=sn(Number(o[0]))?n[i]=[]:n[i]={}),n=r;return n},T.unObserve=function(t){Qe(!0,!0,t)},T.prototype.getContext=function(t,e){return this._getContext(t.join("."),t,e)},T.prototype.observe=function(n,t){var i=this;if(rn(n))return qe;var r,o,e=n.split("."),s=e.pop(),a="length"===s,l=!ln(t),u=this._hasIdentifier(n);if(!We(o=0<e.length?(r=e.join("."),this._getContext(r,e,!0)):(r=s,this.context)))return l?(a&&(this.__lengthListeners[n]=t,T.pushRemoveListener(n,t.uid,function(){Nn(i.__lengthListeners,n)})),this._addObservableListener(n,t,a)):qe;this.__observedIdentifier=null,this.__contextObjects[n]=o[s];var c=this.__observedIdentifier,h=!ln(c),p=qe;if(h&&(u=!0),l){var _=this._addObservableListener(n,t,a),f=qe;h&&n!==c&&(f=this._addObservableListener(c,t,a)),p=function(){_(),f()}}var d=cn(o),v=p,m=Number(s),g=qe,y=qe;if(d&&m>=o.length)g=this.observe(r+".length",{uid:t.uid,listener:function(t,e){t<=m||(g(),i._define(n,o,s))}}),p=function(){v(),g()};else if(!u)if(d&&a){var b=e.pop(),C=this.getContext(e,!1);if(this.__observedIdentifier=null,kn(C,b),tn(this.__observedIdentifier)&&(r=this.__observedIdentifier),l){var x=t.uid;g=this.observeArrayMutation(x,qe,r,o,null),y=this.observe(r,{uid:x,listener:function(t,e){g(),g=i.observeArrayMutation(x,qe,r,t,e)}})}p=function(){v(),y(),g()}}else this._define(n,o,s);return p},T.prototype.observeArrayMutation=function(t,e,n,i,r){if(cn(r)&&this._restoreArray(r),ln(i))return qe;var o=n.split("."),s=o.pop(),a=this.getContext(o,!1);this.__observedIdentifier=null,kn(a,s),tn(this.__observedIdentifier)&&(n=this.__observedIdentifier);var l=[];return an(e)&&l.push(this._pushArrayListener(t,n,e)),this._overwriteArray(n,i),function(){for(;0<l.length;)l.pop()()}},T.prototype.dispose=function(){this.context=null,this.__identifiers={},this.__identifierHash={},this.__contextObjects={}},T.prototype._pushArrayListener=function(e,n,i){var r=T.arrayChangeListeners,o=r[n];ln(o)&&(o=r[n]={});var s=o[e];ln(s)&&(s=o[e]=[]);var a=!1,l=function(){if(!a){a=!0,T.spliceRemoveListener(n,e,l);var t=s.indexOf(i);-1!==t&&(s.splice(t,1),0===s.length&&(Nn(o,e),rn(o)&&Nn(r,n)))}};return s.push(i),T.pushRemoveListener(n,e,l),l},T.prototype._restoreArray=function(t){var e=this._compat;if(e.setProto)Object.setPrototypeOf(t,Object.create(Array.prototype));else if(e.proto)t.__proto__=Object.create(Array.prototype);else for(var n=a.length,i=void 0,r=0;r<n;r+=1)t[i=a[r]]=Array.prototype[i]},T.prototype._overwriteArray=function(t,e){var n,i,r=this._compat,o=a.length;if(r.proto){var s=Object.create(Array.prototype);for(i=0;i<o;i+=1)s[n=a[i]]=this._overwriteArrayFunction(t,n);r.setProto?Object.setPrototypeOf(e,s):e.__proto__=s}else for(i=0;i<o;i+=1)T.defineProperty(e,n=a[i],this._overwriteArrayFunction(t,n),!1,!0,!0)},T.prototype._getContext=function(t,e,n){var i=this.__contextObjects[t];return ln(i)&&(i=!0===n?this.__contextObjects[t]=this._observeImmediateContext(e,t):this._getImmediateContext(e)),i},T.prototype._getImmediateContext=function(t){for(var e=this.context;0<t.length&&!ln(e=e[t.shift()]););return e},T.prototype._observeImmediateContext=function(t,e){return ln(this.__identifiers[e])&&this.observe(e,null),this._getImmediateContext(t)},T.prototype._getValues=function(t,e,n){for(var i,r,o,s=We(e),a=We(n);1<t.length&&(i=t.shift(),s&&ln(e=e[i])&&(s=!1),a&&ln(n=n[i])&&(a=!1),s||a););return i=t[0],ln(e)||(r=e[i]),ln(n)||(o=n[i]),{newValue:r,oldValue:o}},T.prototype._notifyChildProperties=function(l,u,c,h){var p=this;if(!We(h)){var t=this.__identifierHash[l];We(t)||(t={}),h=Object.keys(t)}for(var _,f,d,v,m,g,y,b,C,x,E,e=h.length,w=l.length+1,T={},n=function(t){if(b=h[t],C=b.slice(w),E=C.split("."),f=E.pop(),d="length"===f,rn(x=E.join("."))){if(m=c,g=ln(v=u)?void 0:v[f],y=ln(m)?void 0:m[f],d&&!cn(m)&&cn(v)){var e=N.__lengthListeners[b];if(!ln(e)){var n=e.uid,i=l.split("."),r=i.pop(),o=i.join("."),s=N._getContext(o,i,!1);N.__observedIdentifier=null,kn(s,r),tn(N.__observedIdentifier)&&(o=N.__observedIdentifier);var a=N.observeArrayMutation(n,qe,o,v,null);N.observe(o,{uid:n,listener:function(t,e){a(),a=p.observeArrayMutation(n,qe,o,t,e)}}),Nn(N.__lengthListeners,b)}}}else ln(_=T[x])&&(_=T[x]=N._getValues(E,u,c)),v=_.newValue,m=_.oldValue,g=ln(v)?v:v[f],y=ln(m)?m:m[f];T[C]={newValue:g,oldValue:y},We(v)&&(!cn(v)||v.length>Number(f))&&N._define(b,v,f),N._execute(b,g,y)},N=this,i=0;i<e;i+=1)n(i);T=null},T.prototype._addObservableListener=function(t,e,n){var i=this;if(!0===n){var r=t.split(".");r.pop();var o=r.pop(),s=this.getContext(r,!1);We(s)&&(this.__observedIdentifier=null,kn(s,o),tn(this.__observedIdentifier)&&(t=this.__observedIdentifier+(!0===n?".length":"")))}this.__add(t,e);var a=e.uid,l=function(){T.spliceRemoveListener(t,a,l),i._removeCallback(t,e)};return T.pushRemoveListener(t,a,l),l},T.prototype._define=function(t,e,n){We(e[n])?this.__defineObject(t,e,n):this.__definePrimitive(t,e,n)},T.prototype._overwriteArrayFunction=function(C,x){var E=this,w=T.arrayChangeListeners[C];return We(w)||(w={}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,i,r,o,s,a,l=this.length,u=Ye(this,!0),c="unshift"===x,h="shift"===x,p="splice"===x,_=h||c||p,f="sort"===x||"reverse"===x;_?(E.__isArrayFunction=!0,a=Array.prototype[x].apply(this,t),E.__isArrayFunction=!1,o=this.length,r=0,s=h?(i=0)<l?[a]:[]:c?(i=t.length,[]):(i=t.length-2,r=t[0],a)):(a=Array.prototype[x].apply(this,t),o=this.length,f?n=u:"push"===x?(i=t.length,r=l,s=[]):"pop"===x&&(r=o,s=(i=0)<l?[a]:[])),(h||p||"pop"===x)&&T.unObserve(a);var d,v,m,g,y=Object.keys(w),b=y.length;for(m=0;m<b;m+=1)for(v=(d=w[y[m]]).length,g=0;g<v;g+=1)d[g]([{object:this,type:x,index:r,removed:s,addedCount:i,oldArray:n}]);return _?E._notifyChildProperties(C,this,u):E._execute(C+".length",o,l),a}},T.prototype._removeCallback=function(t,e){var n=this.__identifiers[t];if(!ln(n)){var i=n.indexOf(e);-1!==i&&(n.splice(i,1),0===n.length&&Nn(this.__contextObjects,t))}},T.prototype._hasIdentifier=function(t){return!rn(this.__identifiers[t])},T.prototype._execute=function(t,e,n){var i=this.__identifiers[t];if(un(e)?Nn(this.__contextObjects,t):this.__contextObjects[t]=e,e!==n&&!ln(i))for(var r=i.slice(0),o=r.length,s=0;s<o;s+=1)r[s].listener(e,n)},T.prototype.__defineObject=function(o,s,a){var l=this,u=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!0,get:function(){return l.__observedIdentifier=o,u},set:function(t){if(u!==t){var e=u;if(u=t,!l.__isArrayFunction){T.unObserve(e);var n,i=l.__identifierHash[o],r=!1;We(i)&&(r=0<(n=Object.keys(i)).length),l._execute(o,u,e),r?(l._notifyChildProperties(o,u,e,n),We(u)||l.__definePrimitive(o,s,a)):rn(l.__identifiers[o])?T.defineProperty(s,a,u,!0,!0,!0):We(u)||l.__definePrimitive(o,s,a)}}}})},T.prototype.__definePrimitive=function(o,s,a){var l=this,u=s[a],c=!ln(u);cn(s)&&"length"===a||Object.defineProperty(s,a,{configurable:!0,enumerable:!0,get:function(){return l.__observedIdentifier=o,u},set:function(t){if(u!==t){var e=u;if(u=t,!l.__isArrayFunction||!cn(s)){var n,i=l.__identifierHash[o],r=!1;We(i)&&(r=0<(n=Object.keys(i)).length),l._execute(o,t,e),!r&&rn(l.__identifiers[o])?T.defineProperty(s,a,u,!0,!0,!0):We(u)?(l.__defineObject(o,s,a),r&&l._notifyChildProperties(o,t,e,n)):c||(l.__definePrimitive(o,s,a),c=!0)}}}})},T.prototype.__add=function(t,e){var n=e.priority,i=this.__identifiers[t],r=!1;if(ln(i)&&(i=this.__identifiers[t]=[]),sn(n)){for(var o=i.length,s=0;s<o;s+=1)if(n>i[s].priority){i.splice(s,0,e),r=!0;break}}else e.priority=-1;r||i.push(e),this.__addHashValues(t)},T.prototype.__addHashValues=function(t){var e=this.__identifierHash;if(!We(e[t])){e[t]={};var n,i,r,o,s=[],a=t;for(n=a.lastIndexOf(".");-1!==n;){for(i=e[a=a.slice(0,n)],o=s.length,ln(i)&&(i=e[a]={}),i[t]=!0,r=0;r<o;r+=1)i[s[r]]=!0;s.push(a),n=a.lastIndexOf(".")}}},T.arrayChangeListeners={},T.__managers={},T.__controls={},T}();function n(t){return e._log=t,e}t.ContextManager=e,t.IContextManagerStatic=n,Zn.injectable(Z,n,[k],fe),Zn.injectable("$ContextManagerInstance",e,null,ve)}(d.observable||(d.observable={})),function(t){var e=function(){function t(){this.defaultPrevented=!1,this.stopped=!1}return t.prototype.initialize=function(t,e,n){this.name=t,tn(n)?this.direction=n:this.direction=this._EventManager.UP,this.sender=e},t.prototype.preventDefault=function(){this.defaultPrevented||this._ContextManager.defineGetter(this,"defaultPrevented",!0)},t.prototype.stopPropagation=function(){this.direction===this._EventManager.UP&&(this.stopped=!0,this._EventManager.propagatingEvents[this.name]=!1)},t._inject={_EventManager:N,_ContextManager:Z},t}();t.DispatchEvent=e,Zn.injectable(l,e,null,ve);var d=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.dispatch=function(t,e){var n=fi(p);return n.initialize(t,e),o.sendEvent(n),n},t.prototype.initialize=function(t,e){n.prototype.initialize.call(this,t,e,this._EventManager.DIRECT)},t}(e);function n(){return d}t.LifecycleEvent=d,t.ILifecycleEventStatic=n,Zn.injectable(h,n,null,fe),Zn.injectable(p,d,null,ve);var o=function(){function f(){}return f.initialize=function(){if(!f.__initialized){f.__initialized=!0;for(var t,e=f.__lifecycleEventListeners,n=f._compat,i=f._document,r=f._window,o=f._dom,s=d.dispatch;0<e.length;)t=e.pop(),i.removeEventListener(t.name,t.value,!1);if(n.cordova){for(var a,l=["resume","online",jt],u=n.winJs,c=l.length,h=function(t){return function(){s(t,f)}},p=void 0,_=0;_<c;_+=1)p=h(a=l[_]),e.push({name:a,value:p}),o.addEventListener(i,a,p,!1);p=h(It),e.push({name:"pause",value:p}),o.addEventListener(i,"pause",p,!1),p=h(St),e.push({name:Ot,value:p}),o.addEventListener(i,Ot,p,!1),p=function(){return u||s(Ft,f),!0},e.push({name:Ft,value:p}),o.addEventListener(i,Ft,p,!1),u&&(p=function(){return s(Ft,f),!0},e.push({name:Mt,value:p}),r.WinJS.Application.addEventListener(Mt,p,!1))}else{if(n.amd)return;o.addEventListener(r,"load",function(){s(St,f)})}}},f.dispose=function(t){Nn(f.__eventsListeners,t)},f.on=function(t,e,n,i){var r=f.__eventsListeners[t];ln(r)&&(r=f.__eventsListeners[t]={listeners:{},context:i});var o=r.listeners[e];return cn(o)||(o=r.listeners[e]=[]),o.push(n),function(){var t=o.indexOf(n);-1!==t&&o.splice(t,1)}},f.dispatch=function(t,e,n,i){var r=fi(l);return r.initialize(t,e,n),f.sendEvent(r,i),r},f.hasDirection=function(t){return t===f.UP||t===f.DOWN||t===f.DIRECT},f.sendEvent=function(t,e){var n=t.name,i=t.direction;switch(cn(e)||(e=[]),f.propagatingEvents[n]=!0,i){case f.UP:f._dispatchUp(t,e);break;case f.DOWN:f._dispatchDown(t,e);break;case f.DIRECT:f._dispatchDirect(t,e)}Nn(f.propagatingEvents,n)},f._dispatchUp=function(t,e){for(var n=t.name,i=t.sender;!ln(i)&&f.propagatingEvents[n];)i=(ln(i.uid)||f.__executeEvent(i.uid,t,e),i.parent)},f._dispatchDown=function(t,e){var n,i=t.name,r=[];for(r.push(t.sender);!rn(r.length)&&f.propagatingEvents[i];)ln((n=r.pop()).uid)||(f.__executeEvent(n.uid,t,e),ln(n.controls)||(r=r.concat(n.controls)))},f._dispatchDirect=function(t,e){for(var n,i=Object.keys(f.__eventsListeners),r=i.length,o=t.name,s=0;s<r&&f.propagatingEvents[o];s+=1)ln(n=f.__eventsListeners[i[s]])||ln(n.listeners[o])||f.__callListeners(n.context,t,n.listeners[o],e)},f.__executeEvent=function(t,e,n){var i=f.__eventsListeners[t];if(!ln(i)){var r=i.context,o=i.listeners[e.name];ln(o)||f.__callListeners(r,e,o,n)}},f.__callListeners=function(t,e,n,i){var r=e.name,o=n.length,s=-1;for(i=[e].concat(i),s+=1;s<o&&f.propagatingEvents[r];){try{n[s].apply(t,i)}catch(t){f._log.debug(t)}s+=1}},f.UP="up",f.DOWN="down",f.DIRECT="direct",f.propagatingEvents={},f.__eventsListeners={},f.__lifecycleEventListeners=[],f.__initialized=!1,f}();function i(t,e,n,i,r){return o._log=t,o._compat=e,o._document=n,o._window=i,o._dom=r,o}t.EventManager=o,t.IEventManagerStatic=i,Zn.injectable(N,i,[k,X,G,Q,M],fe);var r=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return __extends(o,r),o.dispatch=function(t,e,n,i){var r=fi(o);return r.initialize(t,e,null,n),r.logLevel=i,o._EventManager.sendEvent(r),r},o.prototype.initialize=function(t,e,n,i){r.prototype.initialize.call(this,t,e,this._EventManager.DIRECT),this.error=i},o}(e);function s(t){return r._EventManager=t,r}t.ErrorEvent=r,t.IErrorEventStatic=s,Zn.injectable(c,s,[N],fe)}(bi=d.events||(d.events={}));var Si=function(){function S(){this.uid=wn(ht),this.priority=0,this.dom=S._dom,this.utils=fi(U),this._log=S._log}return S.getRootControl=function(t){if(ln(t))return t;if(!ln(t.root))return t.root;for(;!ln(t.parent)&&!t.hasOwnContext;){if(!ln(t.root))return t.root;t=t.parent}return!t.hasOwnContext&&We(t.context)&&S._log.debug("Root control: "+t.type+" found that sets its context to an Object but does not set the this.hasOwnContext = true."),t},S.load=function(n){var t=S._Promise;if(ln(n))return t.resolve();var e=n;if(tn(e.absoluteContextPath)){if(an(e.contextChanged))S._ContextManager.getManager(e.root).observe(e.absoluteContextPath,{uid:n.uid,priority:1e3,listener:function(t,e){ji.TemplateControl.contextChanged(n,t,e)}}),an(e.zCC__plat)&&(e.zCC__plat(),Nn(e,"zCC__plat"));var i=e.element;Je(i)&&an(i.removeAttribute)&&i.removeAttribute(Dt)}return an(n.loaded)?t.resolve(n.loaded()):t.resolve()},S.dispose=function(t){var e=t;if(!ln(e))if(un(e.templateControl)){if(e.hasOwnContext)ji.ViewControl.dispose(e);else if(e.controls)ji.TemplateControl.dispose(e);else if(an(t.dispose)&&t.dispose(),S.removeEventListeners(t),S._ContextManager.dispose(t),t.element=null,S.removeParent(t),t.__injectable__type===fe){var n=si[t.type];Zn.control(t.type,t.constructor,n.dependencies,!0)}}else Ri.dispose(e)},S.removeParent=function(t){if(!ln(t)){var e=t.parent;if(!ln(e)){var n=e.controls;cn(n)||(n=[]);var i=n.indexOf(t);-1!==i&&n.splice(i,1),t.parent=null}}},S.removeEventListeners=function(t){if(!ln(t)){var e=S.__eventListeners,n=t.uid,i=e[n];if(cn(i)){for(var r=i.length;0<r;)i[r-=1]();Nn(e,n)}}},S.getInstance=function(){return new S},S.__addRemoveListener=function(t,e){var n=S.__eventListeners;cn(n[t])?n[t].push(e):n[t]=[e]},S.__spliceRemoveListener=function(t,e){var n=S.__eventListeners[t];if(cn(n)){var i=n.indexOf(e);if(-1===i)return;n.splice(i,1)}},S.__getControls=function(t,e,n){var i,r=[],o=S.getRootControl(t);ln(o)||o[e]!==n||r.push(o);var s=o.controls;if(ln(s))return r;for(var a=[].concat(s);0<a.length;)(i=a.shift())[e]===n&&r.push(i),ln(i.controls)||(a=a.concat(i.controls));return r},S.prototype.initialize=function(){},S.prototype.loaded=function(){},S.prototype.getControlsByName=function(t){return S.__getControls(this,"name",t)},S.prototype.getControlsByType=function(t){return tn(t)?S.__getControls(this,"type",t):S.__getControls(this,"constructor",t)},S.prototype.addEventListener=function(t,e,n,i){if(!an(n))return this._log.warn('"Control.addEventListener" must take a function as the third argument.'),qe;n=n.bind(this);var r=this.dom.addEventListener(t,e,n,i),o=this.uid;return S.__addRemoveListener(o,r),function(){r(),S.__spliceRemoveListener(o,r)}},S.prototype.observe=function(n,i){var t,r=this,e=We(this.context)?this:this.parent,o=S.getRootControl(e);if(ln(e))return qe;if(ln(e.absoluteContextPath))return this._log.warn("Should not call plat.Control.observe prior to the control being loaded"),qe;var s=S._parser;if(We(s)||(s=fi(J)),rn(i))t=e.absoluteContextPath;else if(tn(i)){var a=s.parse(i);1<a.identifiers.length&&this._log.warn("Only a single identifier can be observed when calling the function plat.Control.observe");var l=a.identifiers[0];if("@"===l[0]){var u=l.split("."),c=u.shift().slice(1),h=0<u.length?"."+u.join("."):"";t=c===je?W+h:c===Ae?e.absoluteContextPath+h:e.absoluteContextPath+"."+l}else t=e.absoluteContextPath+"."+l}else t=e.absoluteContextPath+"."+i;var p=S._ContextManager;return We(p)||(p=fi(Z)),p.getManager(o).observe(t,{listener:function(t,e){n.call(r,t,e,i)},uid:this.uid})},S.prototype.observeArray=function(e,n){var t,i,r=We(this.context)?this:this.parent,o=r.context;if(ln(r)||!We(o))return qe;var s=S._parser;if(We(s)||(s=fi(J)),rn(n))t=o,i=r.absoluteContextPath;else if(tn(n)){var a=s.parse(n);t=a.evaluate(o),i=r.absoluteContextPath+"."+a.identifiers[0]}else t=o[n],i=r.absoluteContextPath+"."+n;if(!cn(t))return qe;if(!an(e))return qe;e=e.bind(this);var l=S._ContextManager;We(l)||(l=fi(Z));var u=l.getManager(S.getRootControl(r)),c=this.uid,h=function(t){e(t,n)},p=u.observeArrayMutation(c,h,i,t,null),_=u.observe(i,{listener:function(t,e){p(),p=u.observeArrayMutation(c,h,i,t,e)},uid:c});return function(){p(),_()}},S.prototype.observeExpression=function(e,n){var i=this;if(rn(n))return qe;var t=S._parser;if(We(t)||(t=fi(J)),tn(n))n=t.parse(n);else if(!an(n.evaluate))return qe;var r=ln(this.resources)?this.parent:this;if(ln(r)||!tn(r.absoluteContextPath))return qe;var o=S._ContextManager;We(o)||(o=fi(Z));var s,a,l,u,c=n.aliases,h={},p=o.getManager,_=ji.TemplateControl,f=_.findResource,d=_.evaluateExpression,v=c.length;for(u=0;u<v;u+=1)s=c[u],ln(a=f(r,s))||(l=a.resource.type)!==Te&&l!==Ie||(h[s]=p(a.control));var m,g,y=p(S.getRootControl(r)),b=r.absoluteContextPath,C=b+".",x={},E=n.identifiers;for(v=E.length,u=0;u<v;u+=1)g=(m=E[u]).split(".")[0],"@"!==m[0]?x[C+m]=y:(s=g.slice(1))===Ae?x[b+m.replace(g,"")]=y:s===je?x[m.replace(g,"context")]=y:(m=m.replace(g,"resources."+s+".value"),ln(h[s])||(x[m]=h[s]));v=(E=Object.keys(x)).length;var w=d(n,r),T=[],N=this.uid,k=function(){var t=d(n,r);e.call(i,t,w,n.expression),w=t};for(u=0;u<v;u+=1)m=E[u],T.push(x[m].observe(m,{uid:N,listener:k}));return function(){for(var t=T.length,e=0;e<t;e+=1)T[e]()}},S.prototype.evaluateExpression=function(t,e){return ji.TemplateControl.evaluateExpression(t,this.parent,e)},S.prototype.findProperty=function(t,e){var n=S._parser;We(n)||(n=fi(J));var i,r=n.parse(t);for(ln(e)&&(e=this);!ln(e);){if(!ln(i=r.evaluate(e)))return{expression:r,control:e,value:i};e=e.parent}},S.prototype.dispatchEvent=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=S._EventManager;We(r)||(r=fi(N)),r.hasDirection(e)||(un(e)||n.unshift(e),e=r.UP);var o=this;ln(o.templateControl)||(o=o.templateControl),r.dispatch(t,o,e,n)},S.prototype.on=function(t,e){var n=S._EventManager;return We(n)||(n=fi(N)),n.on(this.uid,t,e,this)},S.prototype.dispose=function(){},S.__eventListeners={},S}();function Ii(t,e,n,i,r,o){return Si._parser=t,Si._ContextManager=e,Si._EventManager=n,Si._Promise=i,Si._dom=r,Si._log=o,Si}d.Control=Si,d.IControlFactory=Ii,Zn.injectable(T,Ii,[J,Z,N,w,M,k],me);var ji,Ri=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateControl=null,t}return __extends(t,e),t.dispose=function(t){Nn(t,"templateControl"),Si.dispose(t)},t.getInstance=function(){return new t},t}(Si);function Ai(){return Ri}d.AttributeControl=Ri,d.IAttributeControlFactory=Ai,Zn.injectable("$AttributeControlFactory",Ai,null,me),function(t){var c=function(e){function h(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=100,t.context=null,t.absoluteContextPath=null,t.hasOwnContext=!1,t.replaceWith="any",t}return __extends(h,e),h.evaluateExpression=function(t,e,n){if(rn(t))return t;if(tn(t))t=h._parser.parse(t);else if(!an(t.evaluate))return t;return ln(e)?t.evaluate(null,n):0<t.aliases.length&&rn(n=h.getResources(e,t.aliases,n))?void 0:t.evaluate(e.context,n)},h.getResources=function(t,e,n){if(ln(t))return{};var i,r,o,s=e.length,a=h.__resourceCache[t.uid];ln(a)&&(a=h.__resourceCache[t.uid]={}),We(n)||(n={});for(var l=0;l<s;l+=1)if("@"===(i=e[l])[0]&&(i=i.slice(1)),i!==Ae)if(i!==je){if(ln(n[i])){if(ln(a[i]))o=h.findResource(t,i);else{var u=a[i].control,c=u.resources;o=ln(c)?h.findResource(t,i):{control:u,resource:c[i]}}if(ln(o)){if(-1!==t.type.indexOf(ye))continue;h._log.warn("Resource alias: "+i+" is not defined.")}else r=(a[i]=o).resource,n[i]=ln(r)?r:r.value}}else n[i]=Si.getRootControl(t).context;else n[i]=t.context;return n},h.findResource=function(t,e){var n;if(!ln(t)&&!ln(t.resources)&&tn(e)&&!rn(e)){"@"===e[0]&&(e=e.slice(1));var i=e===je;if(i||e===Ae||e===Re){if(i&&(t=Si.getRootControl(t)),We(t.resources)&&(n=t.resources[e]),ln(n))return;return{resource:n,control:t}}for(;!ln(t);){if(We(t.resources)&&(n=t.resources[e]),!ln(n))return{resource:n,control:t};t=t.parent}}},h.dispose=function(t){if(!ln(t)){var e=t.uid,n=t.controls,i=cn(n)?n.slice(0):n,r=Si._ContextManager,o=r.defineProperty;if(!ln(i))for(var s=i.length-1;0<=s;s-=1)Si.dispose(i[s]);if(an(t.dispose)&&t.dispose(),Si.removeEventListeners(t),h.removeElement(t),h._ResourcesFactory.dispose(t),h._BindableTemplatesFactory.dispose(t),Nn(h.__resourceCache,t.uid),r.dispose(t),bi.EventManager.dispose(t.uid),h._managerCache.remove(e),Si.removeParent(t),o(t,"resources",null,!0,!0,!0),t.attributes=null,t.bindableTemplates=null,t.controls=[],t.root=null,t.innerTemplate=null,t.__injectable__type===fe){var a=si[t.type];Zn.control(t.type,t.constructor,a.dependencies,!0)}}},h.loadControl=function(t){for(var e,n=t.controls,i=n.length,r=0;r<i;r+=1)ln((e=n[r]).controls)?e.loaded():h.loadControl(e);t.loaded()},h.contextChanged=function(t,e,n){t.context=e,h.setContextResources(t),an(t.contextChanged)&&t.contextChanged(e,n)},h.setContextResources=function(t){var e=t.context;ln(t.resources)&&(t.resources=h._ResourcesFactory.getInstance(),t.resources.initialize(t)),t.hasOwnContext&&(ln(t.resources.rootContext)?t.resources.add({root:{type:Te,value:e}}):t.resources.rootContext.value=e),ln(t.resources.context)?t.resources.add({context:{type:Te,value:e}}):t.resources.context.value=e},h.removeElement=function(t){if(!ln(t)){var e,n=t.element;if(null===t.replaceWith||""===t.replaceWith||Ke(n))return Yn(t.startNode,t.endNode),void(t.elementNodes=t.startNode=t.endNode=null);ln(n)||(ln(e=n.parentNode)||e.removeChild(n),t.element=null)}},h.setAbsoluteContextPath=function(t,e){Si._ContextManager.defineGetter(t,"absoluteContextPath",e,!1,!0)},h.determineTemplate=function(e,t){var n=h._templateCache,i=e.dom,r=h._Promise;if(ln(t)){if(ln(e.templateUrl)){if(ln(e.templateString))return r.reject(null);var o=e.type;return n.read(o).catch(function(t){return ln(t)&&(t=e.templateString),n.put(o,t)})}t=e.templateUrl}else;return i.getTemplate(t)},h.detach=function(t){if(!ln(t)&&!ln(t.controls)){for(var e=t.controls.slice(0),n=e.length,i=0;i<n;i+=1)Si.dispose(e[i]);Si.removeEventListeners(t),h.removeElement(t),h._ResourcesFactory.dispose(t,!0),Nn(h.__resourceCache,t.uid),Si._ContextManager.dispose(t),bi.EventManager.dispose(t.uid),h._managerCache.remove(t.uid),Si.removeParent(t),t.controls=[],t.attributes=null}},h.getInstance=function(){return new h},h.prototype.contextChanged=function(t,e){},h.prototype.setTemplate=function(){},h.prototype.getResources=function(t,e){return h.getResources(this,t,e)},h.prototype.findResource=function(t){return h.findResource(this,t)},h.prototype.evaluateExpression=function(t,e){return h.evaluateExpression(t,this,e)},h.__resourceCache={},h}(Si);function e(t,e,n,i,r,o,s,a){return c._ResourcesFactory=t,c._BindableTemplatesFactory=e,c._managerCache=n,c._templateCache=i,c._parser=r,c._http=o,c._Promise=s,c._log=a,c}t.TemplateControl=c,t.ITemplateControlFactory=e,Zn.injectable(z,e,[$,F,A,L,J,C,w,k],me),Zn.injectable(B,c,null,ve);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=120,t._listeners=[],t}return __extends(t,e),t.prototype.onInput=function(e){var n=this._listeners;return n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}},t.prototype.observeProperties=function(t){},t.prototype.inputChanged=function(t,e){if(t!==e)for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](t,e)},t.prototype.dispose=function(){this._listeners=[]},t}(c);t.BindControl=h;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasOwnContext=!0,t}return __extends(t,e),t.dispose=function(t){c.dispose(t)},t.getInstance=function(){return new t},t.prototype.canNavigateFrom=function(){},t.prototype.canNavigateTo=function(t,e){},t.prototype.navigatingFrom=function(){},t.prototype.navigatedTo=function(t,e){},t}(c);t.ViewControl=n;var i=function(){function t(){this._domEvents=fi(D)}return t.prototype.addEventListener=function(t,e,n,i){return this._domEvents.addEventListener(t,e,n,i)},t.prototype.appendChildren=function(t,e){return Dn(t,e)},t.prototype.cloneChildren=function(t,e){return Dn(t,e,!0)},t.prototype.clearNode=function(t){$n(t)},t.prototype.clearNodeBlock=function(t,e){zn(t,e)},t.prototype.setInnerHtml=function(t,e){return Bn(t,e)},t.prototype.insertBefore=function(t,e,n){return Un(t,e,n)},t.prototype.replace=function(t){return Vn(t)},t.prototype.replaceWith=function(t,e){return qn(t,e)},t.prototype.serializeHtml=function(t){return Hn(t)},t.prototype.removeBetween=function(t,e){Qn(t,e)},t.prototype.removeAll=function(t,e){Yn(t,e)},t.prototype.addClass=function(t,e){Gn(t,e)},t.prototype.removeClass=function(t,e){Jn(t,e)},t.prototype.toggleClass=function(t,e){!function(t,e){We(t)||(t={});var n=t.className;if(tn(n)&&tn(e)&&""!==e){var i,r=e.split(An);if(un(t.classList)){var o=void 0;if(""===n)t.className=e;else if(n===e)return t.className="";for(;0<r.length;)if(""!==(i=r.shift())){if((o=new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g")).test(n)){t.className=n=n.replace(o,"");continue}t.className+=" "+i}}else for(;0<r.length;)""!==(i=r.shift())&&t.classList.toggle(i)}}(t,e)},t.prototype.replaceClass=function(t,e,n){!function(t,e,n){We(t)||(t={});var i=t.className;if(tn(i)&&tn(n)&&""!==n)if(un(t.classList)){var r=new RegExp("^"+e+"\\s+","g"),o=new RegExp("\\s+"+e+"\\s+","g"),s=new RegExp("\\s+"+e+"$","g");t.className=i.replace(r,n+" ").replace(o," "+n+" ").replace(s," "+n)}else t.classList.add(n),t.classList.remove(e)}(t,e,n)},t.prototype.hasClass=function(t,e){return Kn(t,e)},t.prototype.getTemplate=function(t){return n=t,We(g)||(g=d.acquire(L)),We(y)||(y=d.acquire(C)),g.put(n,g.read(n).catch(function(t){if(ln(t))return y.ajax({url:n})}).then(function(t){if(Ke(t))return g.put(n,t);if(!We(t)||!tn(t.response))return We(b)||(b=d.acquire(k)),b.warn("No template found at "+n),g.put(n);var e=t.response;return rn(e.trim())?g.put(n):g.put(n,e)}).catch(function(t){return bn(function(){We(b)||(b=d.acquire(k)),b.error(new Error("Failure to get template from "+n+"."))}),t}));var n},t.prototype.whenPresent=function(t,e){return function(t,e){if(!Je(e))return We(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check DOM presence of something that isn't a Node.")),qe;We(m)||(m=d.acquire(G));var n=m.body;if(Je(e.parentElement)&&n.contains(e))return t(),qe;var i=xn(function(){Je(e.parentElement)&&n.contains(e)&&(i(),t())},100);return i}(t,e)},t.prototype.whenVisible=function(t,e){return function(t,e){if(!Je(e))return We(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check visibility of something that isn't a Node.")),qe;var n=e.clientWidth,i=e.clientHeight;if(!sn(n)||!sn(i))return We(b)||(b=d.acquire(k)),b.error(new Error("Attempting to check visibility of something that isn't an Element.")),qe;if(0<n&&0<i)return t(),qe;var r=xn(function(){0<e.clientWidth&&0<e.clientHeight&&(r(),t())},100);return r}(t,e)},t._inject={_domEvents:D},t}();t.Dom=i,Zn.injectable(M,i);var r=function(){function s(){this._ResourcesFactory=fi($),this._ControlFactory=fi(T),this._TemplateControlFactory=fi(z),this._ContextManager=fi(Z),this._Promise=fi(w),this._managerCache=fi(A),this._document=fi(G),this._ElementManagerFactory=fi(I),this._BindableTemplatesFactory=fi(F),this._log=fi(k),this.templates={},this.cache={},this.__compiledControls=[]}return s.create=function(t,e){var n=new s;return n.control=t,ln(e)||(n.templates=e.templates,n.cache=e.cache),n},s.dispose=function(t){if(!ln(t)){var e=t.bindableTemplates;!ln(e)&&an(e.dispose)&&e.dispose()}},s.isBoundControl=function(t){if(ln(t))return!1;var e=t.parent;return!ln(e)&&0===t.type.indexOf(e.type+"-@")},s.prototype.once=function(t,e,n){var i,r=this;if(ln(t))return this._Promise.resolve(this._document.createDocumentFragment());if(tn(t))i=Hn(t);else if(Ke(t))i=t;else if(i=this._document.createDocumentFragment(),Je(t))i.appendChild(t);else{if(!hn(t))return this._Promise.resolve(i);Dn(t,i)}if(ln(e)||sn(e)||tn(e)){var o=this.control,s=this._managerCache.read(o.uid),a=this._ElementManagerFactory.getInstance(),l=this._createBoundControl("",i,e,n),u=this._createNodeMap(l,i,e);return o.controls.push(l),s.children=[],a.initialize(u,s),a.setUiControlTemplate(),a.fulfillAndLoad().then(function(){var t=r._document;return l.startNode=i.insertBefore(t.createComment(l.type+Ce),i.firstChild),l.endNode=i.insertBefore(t.createComment(l.type+xe),null),i})}this._log.warn(this.control.type+" using relativeIdentifier: "+e+", need a string or number")},s.prototype.bind=function(t,e,n){return this._bind(t,e,n)},s.prototype.add=function(t,e,n){if(rn(t))this._log.debug(this.control.type+" must use a valid key to add a template to BindableTemplates.");else if((ln(this.templates[t])||n)&&!ln(e))if(tn(e))this._compile(t,Hn(e));else if(Ke(e))this._compile(t,e);else{var i=this._document.createDocumentFragment();if(Je(e))i.appendChild(e);else{if(!hn(e))return;Dn(e,i)}this._compile(t,i)}},s.prototype.replace=function(t,e,n,i){var r=this.control.controls[t];if(!s.isBoundControl(r))return this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" is not a bound control."),this._Promise.resolve([]);var o=r.endNode;return Je(o)&&Je(o.parentNode)?this._bind(e,n,i,t):(this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" needs place-holding comment nodes."),this._Promise.resolve([]))},s.prototype.dispose=function(){for(var t=this._TemplateControlFactory.dispose,e=this.__compiledControls,n=e.length,i=0;i<n;i+=1)t(e[i]);this.__compiledControls=[],this.control=null,this.cache={},this.templates={}},s.prototype._bind=function(r,o,s,a){var l=this,t=this.templates[r],u=ln(a);if(ln(t))this._log.error(new Error(this.control.type+" cannot bind template, no template stored with key: "+r));else{if(ln(o)||sn(o)||tn(o))return t=t.then(function(t){var e=t.cloneNode(!0),n=l._createBoundControl(r,e,o,s),i=l._createNodeMap(n,e,o);return u&&l.control.controls.push(n),l._bindTemplate(r,i)}),u?t.then(null,function(t){return bn(function(){tn(t)&&(t=new Error(t)),l._log.error(t)}),l._document.createDocumentFragment()}):t.then(function(t){var e=Array.prototype.slice.call(t.childNodes),n=l.control.controls[a],i=n.endNode,r=i.parentNode,o=i.nextSibling;return l._TemplateControlFactory.dispose(n),r.insertBefore(t,o),e}).then(null,function(t){return bn(function(){tn(t)&&(t=new Error(t)),l._log.error(t)}),l._document.createDocumentFragment()});this._log.warn(this.control.type+" trying to bind: "+o+". Identifier must be either a string or number")}},s.prototype._bindTemplate=function(t,n){var i=this,r=n.uiControlNode.control,o=!1,e=an(r.dispose)?r.dispose.bind(r):qe;return r.dispose=function(){o=!0,e(),r.dispose=e},this._bindNodeMap(t,n).then(function(){var t=i._document,e=n.element;return o?t.createDocumentFragment():(r.startNode=e.insertBefore(t.createComment(r.type+Ce),e.firstChild),r.endNode=e.insertBefore(t.createComment(r.type+xe),null),e)},function(t){return bn(function(){tn(t)&&(t=new Error(t)),i._log.error(t)}),null})},s.prototype._bindNodeMap=function(t,e){var n=this.cache[t],i=e.uiControlNode.control,r=e.element,o=this._managerCache;return n.clone(r,o.read(this.control.uid),e),o.read(i.uid).bindAndLoad()},s.prototype._compile=function(t,e){var n=this._createBoundControl(t+ye,e),i=this._createNodeMap(n,e);this.__compiledControls.push(n),this._compileNodeMap(n,i,t)},s.prototype._compileNodeMap=function(o,s,t){var a=this,e=this._ElementManagerFactory.getInstance(),n=[];e.isClone=!0,e.initialize(s,null),e.setUiControlTemplate(),this.cache[t]=e,n.push(e.fulfillTemplate()),this.templates[t]=this._Promise.all(n).then(function(){var t=s.element,e=t.cloneNode(!0),n=a._document,i=o.startNode=n.createComment(o.type+Ce),r=o.endNode=n.createComment(o.type+xe);return t.insertBefore(i,t.firstChild),t.insertBefore(r,null),e})},s.prototype._createNodeMap=function(t,e,n){return{element:e,attributes:{},nodes:[],childContext:n,uiControlNode:{control:t,nodeName:t.type,expressions:[],injector:null}}},s.prototype._createBoundControl=function(t,e,n,i){var r=this._TemplateControlFactory.getInstance(),o=this._ResourcesFactory,s=this.control,a=this.cache[t],l=We(a),u=o.getInstance();if(l){var c=a.getUiControl();u.initialize(r,c.resources),u.add(i)}else u.initialize(r,i);if(r.resources=u,o.addControlResources(r),r.bindableTemplates=this._BindableTemplatesFactory.create(r,s.bindableTemplates),r.parent=s,r.controls=[],r.element=e,r.type=s.type+"-@"+t,r.root=this._ControlFactory.getRootControl(r),l){var h=this._ContextManager.getManager(r.root);r.absoluteContextPath=s.absoluteContextPath,tn(r.absoluteContextPath)||(r.absoluteContextPath=W),ln(n)||(r.absoluteContextPath+="."+n),r.context=h.getContext(r.absoluteContextPath.split("."),!1)}return r},s}();function o(){return r}t.BindableTemplates=r,t.IBindableTemplatesFactory=o,Zn.injectable(F,o,null,me);var s=function(){function t(){this.__listeners={}}return t.getInstance=function(){return new t},t.prototype.initialize=function(t,e){this.__control=t;for(var n,i=Object.keys(e),r=this.__listeners,o=i.length,s=0;s<o;s+=1)this[n=i[s]]=e[n],r[n]=[]},t.prototype.observe=function(e,t){var n=this.__listeners[Tn(t)];return ln(n)?qe:(e=e.bind(this.__control),n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)})},t.prototype._attributeChanged=function(t,e,n){for(var i=this.__listeners[Tn(t)],r=i.length,o=0;o<r;o+=1)i[o](e,n)},t}();function a(){return s}t.Attributes=s,t.IAttributesFactory=a,Zn.injectable("$AttributesInstance",s,null,ve),Zn.injectable(O,a,null,me);var l=function(){function p(){this.__resources={},this.__bound=!1}return p.create=function(t,e){if(ln(e))return e;var n;switch(e.type.toLowerCase()){case Ne:var i=ui[e.value];ln(i)||(e.value=i.inject());break;case Te:p._observeResource(t,e);break;case ke:tn(n=e.value)&&(e.value=t.evaluateExpression(n));break;case Ie:break;case Se:tn(n=e.value)&&(an(n=t[n])?e.value=n.bind(t):(p._log.warn('Attempted to create a "function" type Resource, but the function '+n+" cannot be found on your control."),e.value=qe))}return e},p.addControlResources=function(t){t.resources.add({context:{value:t.context,type:Te},control:{value:t,type:ke}}),t.hasOwnContext&&p.__addRoot(t)},p.bindResources=function(t){var e=t.__resources;if(!ln(e)){for(var n,i=t.__controlInstance,r=Object.keys(e),o=p.__controlResources,s=r.length,a=0;a<s;a+=1)!0!==o[n=r[a]]&&(t[n]=e[n]=p.create(i,t[n]));t.__bound=!0}},p.dispose=function(t,e){var n=t.resources;if(!ln(n)){for(var i,r,o=Object.keys(n.__resources),s=o.length,a=p._ContextManager.defineProperty,l=0;l<s;l+=1)ln(r=n[i=o[l]])||r.type!==Te&&r.type!==Ie||a(n,i,e?Ye(r,!0):null,!0,!0,!0);p._removeListeners(n.__controlInstance)}},p.parseElement=function(t){for(var e,n,i,r,o,s=Array.prototype.slice.call(t.children),a=p._regex,l=a.whiteSpaceRegex,u=a.quotationRegex,c={},h=p.__resourceTypes;0<s.length;)h[r=(e=s.pop()).nodeName.toLowerCase()]&&(n={},ln(i=e.attributes.getNamedItem("alias"))||(n.alias=i.value,rn(o=e.textContent.replace(l,"$1"))||(n.value=r===Ne||r===Ie?o.replace(u,""):o,n.type=r,c[n.alias]=n)));return c},p.getInstance=function(){return new p},p._observeResource=function(t,e){var n=t.uid,i=e.value,r=p.__observableResourceRemoveListeners[n];if(ln(r)&&(r=p.__observableResourceRemoveListeners[n]=[]),tn(i)){ln(e.initialValue)?e.initialValue=i:i=e.initialValue;var o=t.observeExpression(function(t){e.value=t},i);e.value=t.evaluateExpression(i),r.push(o)}},p._removeListeners=function(t){if(!ln(t)){var e=t.uid,n=p.__observableResourceRemoveListeners[e];if(cn(n))for(var i=n.length,r=0;r<i;r+=1)n[r]();Nn(p.__observableResourceRemoveListeners,e)}},p.__addRoot=function(t){t.resources.add({root:{value:t,type:ke,alias:"root"},rootContext:{value:t.context,type:Te,alias:je}})},p.prototype.initialize=function(t,e){if(this.__controlInstance=t,!ln(e)){Je(e)?e=p.parseElement(e):We(e.resources)&&(e=e.resources),this.__resources=e;for(var n,i=Object.keys(e),r=i.length,o=0;o<r;o+=1)this[n=i[o]]=e[n]}},p.prototype.add=function(t){if(!ln(t)){Je(t)&&(t=p.parseElement(t));for(var e,n,i=Object.keys(t),r=i.length,o=this.__controlInstance,s=this.__bound,a=p.create,l=0;l<r;l+=1)this[(e=t[n=i[l]]).alias=n]=this.__resources[n]=s?a(o,e):e}},p.INJECTABLE=Ne,p.OBJECT=ke,p.OBSERVABLE=Te,p.LITERAL=Ie,p.FUNCTION=Se,p.__observableResourceRemoveListeners={},p}();function u(t,e,n){l._ContextManager=t,l._regex=e,l._log=n;var i={},r={};return i[Re]=i[Ae]=i.root=i[je]=!0,r[Ne]=r[ke]=r[Te]=r[Se]=r[Ie]=!0,l.__controlResources=i,l.__resourceTypes=r,l}t.Resources=l,t.IResourcesFactory=u,Zn.injectable($,u,[Z,K,k],me),Zn.injectable("$ResourcesInstance",l,null,ve);var p=function(){function d(){this._gestures=d.gestures,this._androidVersion=un(this._compat.ANDROID)?-1:this._compat.ANDROID,this._android44orBelow=-1<this._androidVersion&&Math.floor(this._androidVersion/10)<=44,this._inMouse=!1,this._subscribers={},this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__hasMoved=!1,this.__hasRelease=!1,this.__detectingMove=!1,this.__tapCount=0,this.__touchCount=0,this.__cancelDeferredTap=qe,this.__cancelDeferredHold=qe,this.__cancelRegex=/cancel/i,this.__pointerEndRegex=/up|cancel/i,this.__haveSwipeSubscribers=!1,this.__blurRemover=qe,this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__boundPreventDefaultClick=this.__preventDefaultClick.bind(this),this.__reverseMap={},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this.__pointerHash={},this.__pointerEvents=[],this.__listeners={},this.__getTypes(),this.initialize()}return d.prototype.addEventListener=function(t,e,n,i){var r=this,o=this._compat,s=o.mappedEvents[e],a=!ln(s),l=this.__mappedCount,u=this._gestures,c=!1;if(a&&(this.__reverseMap[s]=e,this.__registerElement(t,e),l[e]+=1,o.hasTouchEvents&&!this.__cancelRegex.test(s)&&(s=s.replace("touch","mouse").replace("start","down").replace("end","up"),this.__reverseMap[s]=e)),t.addEventListener(e,n,i),!un(t["on"+e])||un(u[e])||a)return function(){c||(a&&(0<l[e]&&(l[e]-=1),r.__unregisterElement(t,e)),c=!0,t.removeEventListener(e,n,i))};var h=u.$swipe,p=u.$track,_=e;if(-1!==e.indexOf(p)){var f=u.$trackend;_=e===f?f:p}else-1!==e.indexOf(h)&&(_=h);return this._gestureCount[_]+=1,this.__registerElement(t,e),function(){c||(c=!0,r.__removeEventListener(t,e,n,i))}},d.prototype.initialize=function(){var t=this._isActive;!0!==t&&(this.__registerTypes(),ln(t)&&this.__appendGestureStyle(),this._isActive=!0)},d.prototype.dispose=function(){this.__unregisterTypes(),this.__blurRemover(),this.__blurRemover=qe,this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this._isActive=!1,this._subscribers={},this.__pointerEvents=[],this.__pointerHash={},this.__reverseMap={},this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__tapCount=this.__touchCount=0,this.__detectingMove=this.__hasMoved=this.__hasRelease=this.__haveSwipeSubscribers=!1,this.__lastMoveEvent=this.__lastTouchDown=this.__lastTouchUp=null,this.__swipeOrigin=this.__capturedTarget=this.__focusedElement=this.__delayedClickRemover=null,this.__cancelDeferredHold=this.__cancelDeferredTap=qe},d.prototype._onTouchStart=function(t){var e=this,n=t.type;if(this.__ignoreEvent[n])return this.__ignoreEvent[n]=!1,this.__delayedClickRemover[n](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),!1);if(0<this.__touchCount)return this.__touchCount+=1,!0;if(this.__touchCount+=1,"mousedown"!==n)this._inTouch=!0;else{if(!0===this._inTouch)return t.preventDefault(),!1;this._compat.hasTouchEvents&&(this._inMouse=!0)}if(ln(t=this.__standardizeEventObject(t)))return!0;this.__lastMoveEvent=null,this.__hasMoved=!1;var i=t.clientX,r=t.clientY,o=t.timeStamp,s=t.target,a=this._gestures;this.__lastTouchDown={_buttons:t._buttons,clientX:i,clientY:r,timeStamp:o,target:s,identifier:t.identifier},this.__swipeOrigin={clientX:i,clientY:r,xTimestamp:o,yTimestamp:o,xTarget:s,yTarget:s},this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(s,[a.$swipe,a.$swipedown,a.$swipeleft,a.$swiperight,a.$swipeup]).length);var l=this._gestureCount,u=l.$hold<=0,c=l.$release<=0;if(u&&c)return this.__handleMappedEvents(n,t,t),this.__registerMove(n),!0;var h,p,_,f=d.config.intervals.holdInterval;if(u)return this.__hasRelease=!1,this.__cancelDeferredHold=Cn(function(){e.__hasRelease=!0},f),this.__handleMappedEvents(n,t,t),this.__registerMove(n),!0;c?(_=!ln(h=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(p=function(){h.trigger(t),e.__cancelDeferredHold=qe}):(this.__hasRelease=!1,(_=!ln(h=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(p=function(){h.trigger(t),e.__hasRelease=!0,e.__cancelDeferredHold=qe})),_&&(this.__cancelDeferredHold=Cn(p,f)),this.__handleMappedEvents(n,t,t),this.__registerMove(n)},d.prototype._onTouchMove=function(t){this.__cancelDeferredHold(),this.__cancelDeferredHold=qe;var e=t.type;if(!0===this._inTouch&&"mousemove"===e)return!0;var n=this.__standardizeEventObject(t);if(ln(n))return!0;var i=this._gestureCount,r=i.$track<=0,o=i.$swipe<=0,s=d.config,a=this.__swipeOrigin,l=n.clientX,u=n.clientY,c=this.__hasMoved;if(c||(c=this.__getDistance(a.clientX,l,a.clientY,u)>=s.distances.minScrollDistance),!c)return this.__handleMappedEvents(e,t,n),!0;if(this.__hasMoved=!0,r&&o)return this.__handleMappedEvents(e,t,n),!0;var h=this.__lastMoveEvent;We(h)||(h=a);var p=n.direction=this.__getDirection(l-h.clientX,u-h.clientY);this.__handleOriginChange(p);var _=Math.abs(l-a.clientX),f=Math.abs(u-a.clientY);n.velocity=this.__getVelocity(_,f,n.timeStamp-a.xTimestamp,n.timeStamp-a.yTimestamp),!o&&this._android44orBelow&&this.__haveSwipeSubscribers&&t.preventDefault(),r||this.__handleTrack(n,t),this.__handleMappedEvents(e,t,n),this.__lastMoveEvent=n},d.prototype._onTouchEnd=function(t){var n=this,e=t.type;if(this.__ignoreEvent[e])return this.__ignoreEvent[e]=!1,this.__delayedClickRemover[e](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),bn(function(){var t=n.__lastTouchUp;We(t)||(t={});var e=t.target;n._document.body.contains(e)&&n.__handleInput(e)}),!1);var i=this.__hasMoved,r="mouseup"!==e;if(r){if("touchend"===e){if(i)!0===t.cancelable&&t.preventDefault();else{if(!0!==this._inTouch)return!0===t.cancelable&&t.preventDefault(),this.__preventClickFromTouch(),!(this.__touchCount=0);t.target!==this.__focusedElement&&this.__handleInput(t.target)&&!0===t.cancelable&&t.preventDefault()}this.__preventClickFromTouch()}}else if(!un(this._inTouch)){if(!this._inMouse)return!0===t.cancelable&&t.preventDefault(),!1;this._inMouse=!1}if(this.__cancelRegex.test(e))return this.__handleCanceled(t),!0;if(this.__touchCount<=0?this.__touchCount=0:this.__touchCount-=1,ln(t=this.__standardizeEventObject(t)))return!0;r&&(this._inTouch=!1),0<this.__touchCount&&(this.__touchCount=t._touches.length),this.__clearTempStates(),this.__hasRelease&&this.__handleRelease(t),this.__handleSwipe();var o=d.config,s=o.intervals,a=t.timeStamp,l=this.__lastTouchDown;if(i)return this.__handleTrackEnd(t),this.__handleMappedEvents(e,t,t),this.__tapCount=0,!(this.__capturedTarget=null);if(ln(l)||a-l.timeStamp>s.tapInterval)return this.__handleMappedEvents(e,t,t),this.__tapCount=0,!(this.__capturedTarget=null);var u=this.__lastTouchUp,c=t.clientX,h=t.clientY;0<this.__tapCount&&this.__getDistance(c,u.clientX,h,u.clientY)<=o.distances.maxDblTapDistance&&a-u.timeStamp<=s.dblTapInterval?this.__handleDbltap(t):this.__tapCount=0,this.__handleTap(t),this.__handleMappedEvents(e,t,t),this.__lastTouchUp=t,this.__capturedTarget=null},d.prototype.__clearTempStates=function(){this.__cancelDeferredHold(),this.__cancelDeferredHold=qe,this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1)},d.prototype.__resetTouchEnd=function(){this.__tapCount=this.__touchCount=0,this._inTouch=this.__hasRelease=!1,this.__pointerHash={},this.__pointerEvents=[],this.__capturedTarget=null},d.prototype.__handleCanceled=function(t){var e=t.touches;We(e)||(e=this.__pointerEvents);var n=this.__getTouchIndex(e),i=t.type;t=0<=n?e[n]:this.__standardizeEventObject(t),this._inTouch=!1,this.__clearTempStates(),this.__hasMoved&&(this._android44orBelow&&this.__handleSwipe(),this.__handleTrackEnd(t)),this.__handleMappedEvents(i,t,t),this.__resetTouchEnd()},d.prototype.__handleMappedEvents=function(t,e,n){var i=this.__reverseMap[t];if(0<this.__mappedCount[i]){var r=this.__findFirstSubscriber(e.target,i);ln(r)||r.trigger(n)}},d.prototype.__handleTap=function(t){var e=this,n=t.target,i=this.__lastTouchDown;We(i)||(i={});var r=i.target;if(this.__tapCount+=1,!(this._gestureCount.$tap<=0||ln(r)||r!==n&&an(r.contains)&&!r.contains(n)&&an(n.contains)&&!n.contains(r))){var o=this._gestures,s=this.__findFirstSubscriber(n,o.$tap);if(!ln(s))return d.config.intervals.dblTapZoomDelay<=0||"mouse"===t.pointerType||"mouseup"===t.type?(t._buttons=i._buttons,void s.trigger(t)):void(this.__cancelDeferredTap=Cn(function(){t._buttons=i._buttons,s.trigger(t),e.__tapCount=0,e.__cancelDeferredTap=qe},d.config.intervals.dblTapZoomDelay))}},d.prototype.__handleDbltap=function(t){if(this.__tapCount=0,this.__cancelDeferredTap(),this.__cancelDeferredTap=qe,!(this._gestureCount.$dbltap<=0)){var e=this.__findFirstSubscriber(t.target,this._gestures.$dbltap);ln(e)||(t._buttons=this.__lastTouchDown._buttons,e.trigger(t),this.__tapCount=-1)}},d.prototype.__handleRelease=function(t){var e=this.__findFirstSubscriber(t.target,this._gestures.$release);ln(e)||e.trigger(t),this.__hasRelease=!1},d.prototype.__handleSwipe=function(){if(!(this._gestureCount.$swipe<=0)){var t=this.__lastMoveEvent;if(!ln(t)){for(var e=this.__swipeOrigin,n=Math.abs(t.clientX-e.clientX),i=Math.abs(t.clientY-e.clientY),r=this.__getRegisteredSwipes(t.direction,t.velocity,n,i);0<r.length;)r.pop().trigger(t);this.__lastMoveEvent=null}}},d.prototype.__handleTrack=function(t,e){var n=this._gestures,i=n.$track,r=t.direction,o=this.__capturedTarget;We(o)||(o=t.target);var s=this.__findFirstSubscribers(o,[i,i+r.x,i+r.y]);this._android44orBelow&&(0<this.__findFirstSubscribers(o,[i,n.$trackdown,n.$trackup,n.$trackleft,n.$trackright,n.$trackend]).length&&e.preventDefault());if(0<s.length)for(-1<this._androidVersion&&e.preventDefault();0<s.length;)s.pop().trigger(t)},d.prototype.__handleTrackEnd=function(t){if(!(this._gestureCount.$trackend<=0)){var e=this.__capturedTarget;We(e)||(e=t.target);var n=this.__findFirstSubscriber(e,this._gestures.$trackend);ln(n)||n.trigger(t)}},d.prototype.__getTypes=function(){var t,e,n,i=this._compat,r=i.mappedEvents,o=this.__listeners;if(i.hasPointerEvents)t=this._startEvents=r.$touchstart,e=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+" "+r.$touchcancel;else if(i.hasTouchEvents)t=this._startEvents=r.$touchstart+" mousedown",e=this._moveEvents=r.$touchmove+" mousemove",n=this._endEvents=r.$touchend+" mouseup "+r.$touchcancel;else{var s=r.$touchcancel;t=this._startEvents=r.$touchstart,e=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+(rn(s)?"":" "+s)}o[t]=this._onTouchStart.bind(this),o[e]=this._onTouchMove.bind(this),o[n]=this._onTouchEnd.bind(this)},d.prototype.__registerTypes=function(){this.__registerType(this._startEvents),this.__registerType(this._endEvents),this._document.addEventListener("dragstart",this.__preventDefault,!1)},d.prototype.__unregisterTypes=function(){this.__unregisterType(this._startEvents),this.__unregisterType(this._endEvents),this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1),this._document.removeEventListener("dragstart",this.__preventDefault,!1)},d.prototype.__registerType=function(t){for(var e=this.__listeners[t],n=this._document,i=t.split(" "),r=i.length;0<r;)r-=1,n.addEventListener(i[r],e,!1)},d.prototype.__unregisterType=function(t){for(var e=this.__listeners[t],n=this._document,i=t.split(" "),r=i.length;0<r;)r-=1,n.removeEventListener(i[r],e,!1)},d.prototype.__registerMove=function(t){var e=this._gestureCount;("touchstart"===t||0<this.__mappedCount.$touchmove||0<e.$track||0<e.$trackend||0<e.$swipe)&&(this.__registerType(this._moveEvents),this.__detectingMove=!0)},d.prototype.__registerElement=function(t,e){var n,i,r=t.__plat;if(ln(r)?(n=wn("domEvent_"),t.__plat=r={domEvent:n}):ln(r.domEvent)&&(n=wn("domEvent_"),r.domEvent=n),ln(n)){var o=this._subscribers[r.domEvent];return un(o[e])?(i=new v(t,e),o[e]=i):o[e].count+=1,void(o.gestureCount+=1)}var s={gestureCount:1};i=new v(t,e),s[e]=i,this._subscribers[n]=s,un(t.className)||Gn(t,d.config.styleConfig[0].className),this.__removeSelections(t)},d.prototype.__unregisterElement=function(t,e){var n=t.__plat;if(!ln(n)&&!ln(n.domEvent)){var i=n.domEvent,r=this._subscribers[i],o=r[e];ln(o)||(o.count-=1,0===o.count&&Nn(r,e),r.gestureCount-=1,0===r.gestureCount&&(Nn(this._subscribers,i),this.__removeElement(t)))}},d.prototype.__setTouchPoint=function(t){var e=t.type,n=this._compat;n.hasPointerEvents||n.hasMsPointerEvents?this.__updatePointers(t,this.__pointerEndRegex.test(e)):t.pointerType=-1===e.indexOf("mouse")?"touch":"mouse"},d.prototype.__setCapture=function(t){ln(this.__capturedTarget)&&!Ge(t)&&(this.__capturedTarget=t)},d.prototype.__updatePointers=function(t,e){var n,i=t.pointerId,r=this.__pointerHash,o=r[i];if(e)un(o)||(-1<(n=this.__pointerEvents.indexOf(o))&&this.__pointerEvents.splice(n,1),Nn(this.__pointerHash,i));else{if(1===i&&!rn(r))return;t.identifier=t.pointerId,n=this.__pointerEvents.indexOf(o),un(o)||n<0?this.__pointerEvents.push(t):this.__pointerEvents.splice(n,1,t),r[i]=t}},d.prototype.__findFirstSubscriber=function(t,e){var n,i;if(!ln(t))do{if(!un(n=t.__plat)&&!un(n.domEvent)&&!un(i=this._subscribers[n.domEvent][e]))return i}while(!ln(t=t.parentNode))},d.prototype.__findFirstSubscribers=function(t,e){if(ln(t))return[];var n,i,r,o,s,a=[];do{if(!un(n=t.__plat)&&!un(n.domEvent))for(i=this._subscribers[n.domEvent],r=Object.keys(i);0<r.length;)o=r.pop(),-1!==(s=e.indexOf(o))&&(a.push(i[o]),e.splice(s,1))}while(0<e.length&&!ln(t=t.parentNode));return a},d.prototype.__removeEventListener=function(t,e,n,i){var r=this._gestures;t.removeEventListener(e,n,i);var o=r.$swipe,s=r.$track,a=e;if(-1!==e.indexOf(s)){var l=r.$trackend;a=e===l?l:s}else-1!==e.indexOf(o)&&(a=o);this._gestureCount[a]-=1,this.__unregisterElement(t,e)},d.prototype.__removeElement=function(t){this.__returnSelections(t),un(t.className)||Jn(t,d.config.styleConfig[0].className);var e=t.__plat;Nn(e,"domEvent"),rn(e)&&Nn(t,"__plat")},d.prototype.__standardizeEventObject=function(t){this.__setTouchPoint(t);var e,n=-1!==this._startEvents.indexOf(t.type),i=t.changedTouches,r=!un(i),o=t.timeStamp,s=t.touches;if(We(s)||(s=this.__pointerEvents),r)if(n)e=t.preventDefault.bind(t),(t=i[0]).preventDefault=e;else{var a=this.__getTouchIndex(i);if(0<=a)e=t.preventDefault.bind(t),(t=i[a]).preventDefault=e;else if(0<=this.__getTouchIndex(s))return null}return n&&this.__setCapture(t.target),this.__normalizeButtons(t),t._touches=s,t.offset=this.__getOffset(t),(un(t.timeStamp)||o>t.timeStamp)&&(t.timeStamp=o),t},d.prototype.__normalizeButtons=function(t){var e;if(sn(t.buttons)&&0!==t.buttons)e=t.buttons;else if(sn(t.which)&&0<t.which)e=t.which;else switch(t.button){case-1:e=0;break;case 0:e=1;break;case 1:e=4;break;case 2:e=2;break;case 3:e=8;break;case 4:e=16;break;default:e=1}t._buttons=e},d.prototype.__getTouchIndex=function(t){var e=this.__lastTouchDown;We(e)||(e={});for(var n=e.identifier,i=t.length,r=0;r<i;r+=1)if(t[r].identifier===n)return r;return-1},d.prototype.__getOffset=function(t){var e,n,i=this.__capturedTarget;if(We(i)||(i=t.target),Ge(i))return{x:t.clientX,y:t.clientY};if(!un(t.offsetX)&&!un(t.offsetY)&&i===t.target)return{x:t.offsetX,y:t.offsetY};if(an(i.getBoundingClientRect)){var r=i.getBoundingClientRect();e=r.left,n=r.top}else for(e=i.offsetLeft,n=i.offsetTop;!ln(i=i.offsetParent);)e+=i.offsetLeft,n+=i.offsetTop;return{x:t.clientX-e,y:t.clientY-n}},d.prototype.__getDistance=function(t,e,n,i){var r=e-t,o=i-n;return Math.sqrt(r*r+o*o)},d.prototype.__getVelocity=function(t,e,n,i){var r=0,o=0;return 0<n&&(r=t/n),0<i&&(o=e/i),isFinite(r)||(r=0),isFinite(o)||(o=0),{x:r,y:o}},d.prototype.__getDirection=function(t,e){var n=Math.abs(t),i=Math.abs(e),r=this.__lastMoveEvent;We(r)||(r={});var o=r.direction;We(o)||(o={x:"none",y:"none",primary:"none"});var s=o.x,a=o.y,l=o.primary;rn(s)&&(s="none"),rn(a)&&(a="none"),rn(l)&&(l="none");var u=0===t?s:t<0?"left":"right",c=0===e?a:e<0?"up":"down";return{x:u,y:c,primary:n===i?l:i<n?u:c}},d.prototype.__handleOriginChange=function(t){var e=this.__lastMoveEvent;if(!ln(e)){var n=e.direction,i=n.x===t.x,r=n.y===t.y;if(!i||!r){var o=this.__swipeOrigin,s=this._gestures,a=[s.$swipe,s.$swipedown,s.$swipeleft,s.$swiperight,s.$swipeup];i||(o.clientX=e.clientX,o.xTimestamp=e.timeStamp,o.xTarget=e.target,this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(o.xTarget,a).length)),r||(o.clientY=e.clientY,o.yTimestamp=e.timeStamp,o.yTarget=e.target,this._android44orBelow&&(this.__haveSwipeSubscribers=0<this.__findFirstSubscribers(o.yTarget,a).length))}}},d.prototype.__getRegisteredSwipes=function(t,e,n,i){var r,o=this._gestures.$swipe,s=d.config.velocities.minSwipeVelocity,a=[o],l=this.__swipeOrigin;return We(l)||(l={}),i<n?(r=l.xTarget,e.x>=s&&a.push(o+t.x)):n<i&&(r=l.yTarget,e.y>=s&&a.push(o+t.y)),this.__findFirstSubscribers(r,a)},d.prototype.__isHorizontal=function(t){return"left"===t||"right"===t},d.prototype.__appendGestureStyle=function(){var t,e,n=this._document;if(!this._compat.platCss)if(!ln(n.styleSheets)&&0<n.styleSheets.length){var i=n.styleSheets[0];for(e=(t=d.config.styleConfig).length;0<e;)e-=1,i.insertRule(this.__createStyle(t[e]),0)}else{var r=n.head,o=n.createElement("style"),s="";for(o.type="text/css",e=(t=d.config.styleConfig).length;0<e;)e-=1,s=this.__createStyle(t[e])+s;o.textContent=s,r.appendChild(o)}},d.prototype.__createStyle=function(t){var e=t.styles;cn(e)||(e=[]);var n=e.length,i="."+t.className+" { ",r="";n=e.length;for(var o=0;o<n;o+=1)r+=e[o]+";";return i+=r+" } "},d.prototype.__blurFocusedElement=function(){var t=this.__focusedElement;We(t)||(t={}),an(t.blur)&&t.blur()},d.prototype.__waitForBlur=function(t){var e=this;this.__blurRemover=this.addEventListener(t,"blur",function(){e.__blurRemover(),e.__blurRemover=qe,t===e.__focusedElement&&(e.__focusedElement=null)},!1)},d.prototype.__clickTarget=function(t){var e=this,n=!1,i=function(){n=!0,t.removeEventListener("click",i,!1)};t.addEventListener("click",i,!1),bn(function(){n||(t.removeEventListener("click",i,!1),e._document.body.contains(t)&&an(t.click)&&t.click())})},d.prototype.__handleInput=function(t){this.__blurRemover();var e=t.nodeName;if(!tn(e))return this.__focusedElement=null,void this.__blurFocusedElement();var n=!0;switch(e.toLowerCase()){case"input":switch(t.type){case"range":this.__blurFocusedElement();break;case"text":case"password":case"email":case"number":case"tel":case"search":case"url":t.focus(),this.__waitForBlur(t);break;default:this.__blurFocusedElement(),this.__clickTarget(t)}break;case"a":case"button":case"label":this.__blurFocusedElement(),this.__clickTarget(t);break;case"textarea":t.focus(),this.__waitForBlur(t);break;case"select":n=!1;break;default:this.__blurFocusedElement(),this.__clickTarget(t)}return this.__focusedElement=t,n},d.prototype.__preventClickFromTouch=function(){var t=this._document,e=this.__ignoreEvent,n=this.__boundPreventDefaultClick,i=d.config.intervals.delayedClickInterval;i<=0||(this.__delayedClickRemover={mousedown:Cn(function(){e.mousedown=!1},i),mouseup:Cn(function(){e.mouseup=!1},i),click:Cn(function(){t.removeEventListener("click",n,!0)},i)},e.mousedown=e.mouseup=!0,bn(function(){t.addEventListener("click",n,!0)}))},d.prototype.__preventDefaultClick=function(t){return t.preventDefault(),t.stopImmediatePropagation(),this._document.removeEventListener("click",this.__boundPreventDefaultClick,!0),this.__delayedClickRemover.click(),!1},d.prototype.__removeSelections=function(t){Je(t)&&(un(t.onselectstart)||t.addEventListener("selectstart",this.__preventDefault,!1),un(t.ondragstart)||t.addEventListener("dragstart",this.__preventDefault,!1))},d.prototype.__returnSelections=function(t){Je(t)&&(un(t.onselectstart)||t.removeEventListener("selectstart",this.__preventDefault,!1),un(t.ondragstart)||t.removeEventListener("dragstart",this.__preventDefault,!1))},d.prototype.__preventDefault=function(t){var e=t.target.nodeName;return tn(e)&&(e=e.toLowerCase()),"input"===e||"textarea"===e||(t.preventDefault(),!1)},d._inject={_document:G,_compat:X},d.config={intervals:{tapInterval:300,dblTapInterval:300,holdInterval:400,dblTapZoomDelay:0,delayedClickInterval:400},distances:{minScrollDistance:3,maxDblTapDistance:10},velocities:{minSwipeVelocity:.645},styleConfig:[{className:"plat-gesture",styles:["-moz-user-select: none","-khtml-user-select: none","-webkit-touch-callout: none","-webkit-user-select: none","-webkit-user-drag: none","-webkit-tap-highlight-color: transparent","-webkit-overflow-scrolling: touch","-ms-user-select: none","-ms-touch-action: manipulation","touch-action: manipulation"]},{className:"plat-no-touch-action",styles:["-ms-touch-action: none","touch-action: none"]}]},d.gestures={$tap:Wt,$dbltap:Xt,$hold:"$hold",$release:Gt,$swipe:"$swipe",$swipeleft:Jt,$swiperight:Kt,$swipeup:Zt,$swipedown:te,$track:"$track",$trackleft:ee,$trackright:ne,$trackup:ie,$trackdown:re,$trackend:oe},d}();function _(){return p.config}t.DomEvents=p,Zn.injectable(D,p),t.IDomEventsConfig=_,Zn.injectable("$IDomEventsConfig",_);var f=function(){function t(){this._document=fi(G)}return t.prototype.initialize=function(t,e,n){this.element=t,this.event=e,this.eventType=tn(n)?n:"CustomEvent"},t.prototype.trigger=function(t,e,n){var i=this._document.createEvent(this.eventType);return We(t)&&Qe(!1,!1,i,t),i.initCustomEvent(this.event,!0,!0,ln(e)?0:e),Je(n)||(n=this.element),n.dispatchEvent(i)},t}();t.DomEvent=f,Zn.injectable("$DomEventInstance",f,null,ve);var v=function(i){function t(t,e){var n=i.call(this)||this;return n.count=0,n.element=t,n.event=e,n.count+=1,n}return __extends(t,i),t.prototype.trigger=function(t){var e=this._document.createEvent("CustomEvent"),n=this.element,i=t.target;this.__extendEventObject(e,t),e.initCustomEvent(this.event,!0,!0,0);var r=Ge(n)||n.contains(i)?i.dispatchEvent(e):n.dispatchEvent(e);return r||t.preventDefault(),r},t.prototype.__extendEventObject=function(t,e){var n=e.pointerType;t.clientX=e.clientX,t.clientY=e.clientY,t.offsetX=e.offset.x,t.offsetY=e.offset.y,t.direction=ln(e.direction)?{x:"none",y:"none",primary:"none"}:e.direction,t.touches=e._touches,t.velocity=ln(e.velocity)?{x:0,y:0}:e.velocity,t.identifier=ln(e.identifier)?0:e.identifier,t.pointerType=sn(n)?this.__convertPointerType(n,e.type):n,t.screenX=e.screenX,t.screenY=e.screenY,t.pageX=e.pageX,t.pageY=e.pageY,t.buttons=e._buttons},t.prototype.__convertPointerType=function(t,e){switch(t){case MSPointerEvent.MSPOINTER_TYPE_MOUSE:return"mouse";case MSPointerEvent.MSPOINTER_TYPE_PEN:return"pen";case MSPointerEvent.MSPOINTER_TYPE_TOUCH:return"touch"}return-1===e.indexOf("mouse")?"touch":"mouse"},t}(f);!function(t){var e=function(){function t(){this._animatedElements={}}return t.prototype.create=function(t,e,n){return this._create(t,e,n,{key:null})},t.prototype.animate=function(t,e,n){return this._animate(t,e,n,{key:null})},t.prototype.enter=function(t,e,n,i,r){return this._animate(t,e,r,{key:"enter",parent:n,refChild:i})},t.prototype.leave=function(t,e,n){return this._animate(t,e,n,{key:"leave"})},t.prototype.move=function(t,e,n,i,r){return this._animate(t,e,r,{key:"move",parent:n,refChild:i})},t.prototype.show=function(t,e,n){return this._animate(t,e,n,{key:"show"})},t.prototype.hide=function(t,e,n){return this._animate(t,e,n,{key:"hide"})},t.prototype.all=function(e){for(var n=this,t=e.length,i=[],r=new s(function(t){n._Promise.all(e).then(function(){t()})}),o=0;o<t;o+=1)i=i.concat(e[o].getInstances());return r.initialize(i),r.then(qe)},t.prototype.resolve=function(){var e=new s(function(t){t(function(){return e})});return e},t.prototype._animate=function(t,e,n,i){var r=this._create(t,e,n,i),o=r.current;return r.previous.then(function(){En(function(){o.start()})}),o},t.prototype._create=function(u,t,c,h){var e,p=this,n=pi[t],_=[],f=[];if((!this._compat.animationSupported||un(n))&&un(n=_i[t]))return u=this.__constructAnimatableElements(u,{inject:qe},f,_),this._handlePreInitFunctionality(u,f,h),this._handlePostInitFunctionality(u,f,h),this._handleEndFunctionality(u,f,h),{previous:e=this.resolve(),current:e};u=this.__constructAnimatableElements(u,n,f,_);var d=f.length;if(0===d)return this._handlePreInitFunctionality(u,f,h),this._handlePostInitFunctionality(u,f,h),this._handleEndFunctionality(u,f,h),{previous:e=this.resolve(),current:e};this._handlePreInitFunctionality(u,f,h);var i,v=wn("animation_"),r=this.__setAnimationId(v,f),m=new s(function(a){var l=p._Promise;i=l.all(r).then(function(){for(var t=[],e=0;e<d;e+=1)t.push(_[e].instantiate(f[e],c));p._handlePostInitFunctionality(u,f,h);var n=l.all(t),i=p.__isParentAnimating(f),r=p.__generateAnimatedElement(v,f,m);if(!ln(i)){p._handleEndFunctionality(u,f,h),r.animationEnd(!0);var o=p._animatedElements[i],s=nn(o.promise)?function(){return o.promise}:function(){return m};n.then(function(){a(s)})}p.__stopChildAnimations(f),r.promise=m,n.then(function(){p._handleEndFunctionality(u,f,h),r.animationEnd(),a(function(){return m})})})});return m.initialize(_),{previous:i,current:m}},t.prototype._handlePreInitFunctionality=function(t,e,n){switch(n.key){case"move":for(var i=0;i<length;i+=1)Xn(t[i])}},t.prototype._handlePostInitFunctionality=function(t,e,n){var i,r;switch(n.key){case"enter":case"move":var o,s=n.refChild;if(Je(s)?o=s.parentNode:(o=n.parent,s=null),!Je(o))break;for(i=t.length,r=0;r<i;r+=1)o.insertBefore(t[r],s);break;case"show":for(i=e.length,r=0;r<i;r+=1)e[r].removeAttribute(Dt)}},t.prototype._handleEndFunctionality=function(t,e,n){var i,r;switch(n.key){case"leave":for(i=t.length,r=0;r<i;r+=1)Xn(t[r]);break;case"hide":for(i=e.length,r=0;r<i;r+=1)e[r].setAttribute(Dt,"")}},t.prototype.__setAnimationId=function(t,e){for(var n,i,r,o=this._animatedElements,s=[],a=e.length,l=0;l<a;l+=1)un(i=(r=e[l]).__plat)?(r.__plat={animation:t},Gn(r,$t)):un(i.animation)?(i.animation=t,Gn(r,$t)):(un(n=o[i.animation])||(s.push(n.promise),n.animationEnd(!0)),i.animation=t);return s},t.prototype.__generateAnimatedElement=function(s,a,l){var u=this._animatedElements;return u[s]={animationEnd:function(t){var e,n,i,r=a.length;if(!0===t)return l.cancel(),void Nn(u,s);for(var o=0;o<r;o+=1)We(e=(n=a[o]).__plat)||(e={}),un(i=e.animation)||i!==s||(Jn(n,$t),Nn(e,"animation"),rn(e)&&Nn(n,"__plat"));Nn(u,s)}}},t.prototype.__isParentAnimating=function(t){for(var e,n=t[0];!Ge(n=n.parentNode)&&!ln(n)&&n.nodeType===Node.ELEMENT_NODE;)if(Kn(n,$t)){var i=n.__plat;if(We(i)||(i={}),tn(e=i.animation)){if(!ln(this._animatedElements[e]))return e;Nn(i,"animation"),rn(i)&&Nn(n,"__plat"),Jn(n,$t)}}},t.prototype.__stopChildAnimations=function(t){for(var e,n,i,r,o=this._animatedElements,s=Array.prototype.slice,a=t.length,l=0;l<a;l+=1)for(e=s.call(t[l].querySelectorAll("."+$t));0<e.length;)We(i=e.pop().__plat)||(i={}),ln(r=i.animation)||(We(n=o[r])||(n={}),an(n.animationEnd)&&n.animationEnd(!0))},t.prototype.__constructAnimatableElements=function(t,e,n,i){if(!cn(t))if(Ke(t))t=Array.prototype.slice.call(t.childNodes);else if(hn(t))t=Array.prototype.slice.call(t);else{if(!Je(t)||t.nodeType!==Node.ELEMENT_NODE)return[];t=[t]}for(var r,o=t.length,s=0;s<o;s+=1)Je(r=t[s])&&r.nodeType===Node.ELEMENT_NODE&&(n.push(r),i.push(e.inject()));return t},t._inject={_compat:X,_Promise:w,_document:G},t}();t.Animator=e,Zn.injectable(P,e);var s=function(i){function t(t,e){var n=i.call(this,t)||this;return n._Promise=fi(w),n.__animationState=0,n.__animationInstances=[],ln(e)||(n.__animationInstances=e.__animationInstances,n.__animationState=e.__animationState),n}return __extends(t,i),t.prototype.initialize=function(t){rn(this.__animationInstances)&&(cn(t)?this.__animationInstances=t:We(t)&&(this.__animationInstances=[t]))},t.prototype.getInstances=function(){return this.__animationInstances},t.prototype.start=function(){if(!(0<this.__animationState)){for(var t,e=this.__animationInstances,n=e.length,i=0;i<n;i+=1)an((t=e[i]).start)&&t.start();this.__animationState=1}},t.prototype.pause=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var t,e=this.__animationInstances,n=[],i=e.length,r=0;r<i;r+=1)an((t=e[r]).pause)&&n.push(t.pause());return this._Promise.all(n).then(qe)},t.prototype.resume=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var t,e=this.__animationInstances,n=[],i=e.length,r=0;r<i;r+=1)an((t=e[r]).resume)&&n.push(t.resume());return this._Promise.all(n).then(qe)},t.prototype.cancel=function(){if(2===this.__animationState)return this;for(var t,e=this.__animationInstances,n=e.length,i=0;i<n;i+=1)an((t=e[i]).cancel)&&t.cancel(),an(t.end)&&t.end();return this.__animationState=2,this},t.prototype.isCanceled=function(){return 2===this.__animationState},t.prototype.then=function(t,e){return i.prototype.then.call(this,t,e)},t.prototype.catch=function(t){return i.prototype.catch.call(this,t)},t}(vi.Promise);t.AnimationPromise=s;var n=function(){function t(){this.__eventListeners=[]}return t.prototype.initialize=function(){},t.prototype.start=function(){},t.prototype.end=function(){for(var t=this.__eventListeners;0<t.length;)t.pop()();an(this._resolve)&&(this._resolve(),this._resolve=null)},t.prototype.pause=function(){return this._Promise.resolve()},t.prototype.resume=function(){return this._Promise.resolve()},t.prototype.cancel=function(){this.end()},t.prototype.addEventListener=function(t,e,n){if(!an(e))return this._log.warn('An animation\'s "addEventListener" must take a function as the second argument.'),qe;e=e.bind(this);var i=this.dom.addEventListener(this.element,t,function(t){t.stopPropagation(),e(t)},n),r=this.__eventListeners;return r.push(i),function(){i();var t=r.indexOf(i);-1!==t&&r.splice(t,1)}},t.prototype.instantiate=function(t,e){var n=this;this.element=t,this.options=e;var i=new s(function(t){n._resolve=t,n.initialize()});return i.initialize(this),i},t._inject={_window:Q,_compat:X,_log:k,_Promise:w,dom:M,utils:U},t}(),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationEvents=t._compat.animationEvents,t}return __extends(t,e),t.prototype.animationStart=function(t){return this.addEventListener(this._animationEvents.$animationStart,t,!1)},t.prototype.animationEnd=function(t){return this.addEventListener(this._animationEvents.$animationEnd,t,!1)},t.prototype.animationIteration=function(t){return this.addEventListener(this._animationEvents.$animationIteration,t,!1)},t.prototype.transitionStart=function(t){return this.addEventListener(this._animationEvents.$transitionStart,t,!1)},t.prototype.transitionEnd=function(t){return this.addEventListener(this._animationEvents.$transitionEnd,t,!1)},t}(t.BaseAnimation=n),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=zt,t._cancelAnimation=qe,t}return __extends(t,e),t.prototype.initialize=function(){Gn(this.element,this.className+be)},t.prototype.start=function(){var s=this;this._cancelAnimation=En(function(){var t=s.element,e=s.className;if(null===t.offsetParent)return s._dispose(),void s.end();Gn(t,e);var n=s._animationEvents.$animation,i=s.options;We(i)||(i={});var r=s._window.getComputedStyle(t,i.pseudo),o=r[n+"Name"];if(""===o||"none"===o||"paused"===r[n+"PlayState"])return s._dispose(),void s.end();i.preserveInit||Jn(t,e+be),s._cancelAnimation=s.animationEnd(function(){s._cancelAnimation=En(function(){s._dispose(),s.end()})})})},t.prototype.pause=function(){var e=this;if(this._cancelAnimation===qe)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(t){En(function(){e._cancelAnimation!==qe&&(e.element.style[n.$animation+"PlayState"]="paused"),t()})})},t.prototype.resume=function(){var e=this;if(this._cancelAnimation===qe)return this._Promise.resolve();var n=this._compat.animationEvents;return new this._Promise(function(t){En(function(){e._cancelAnimation!==qe&&(e.element.style[n.$animation+"PlayState"]="running"),t()})})},t.prototype.cancel=function(){this._cancelAnimation(),this._dispose(),this.end()},t.prototype._dispose=function(){var t=this.className;Jn(this.element,t+" "+t+be),this._cancelAnimation=qe},t}(t.CssAnimation=i);t.SimpleCssAnimation=r,Zn.animation(zt,r);var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ht,t}return __extends(t,e),t}(r);t.FadeIn=o,Zn.animation(Ht,o);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Qt,t}return __extends(t,e),t}(r);t.FadeOut=a,Zn.animation(Qt,a);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ut,t}return __extends(t,e),t}(r);t.Enter=l,Zn.animation(Ut,l);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Vt,t}return __extends(t,e),t}(r);t.Leave=u,Zn.animation(Vt,u);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=qt,t}return __extends(t,e),t}(r);t.Move=c,Zn.animation(qt,c);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Bt,t._animationCanceled=qe,t._normalizeRegex=/-/g,t._nonNumRegex=/[^\-0-9\.]/g,t._normalizedKeys={},t._transitionCount=0,t._count=0,t._started=!1,t._usingCss=!1,t}return __extends(t,e),t.prototype.initialize=function(){Gn(this.element,this.className+be)},t.prototype.start=function(){var p=this;this._animationCanceled=En(function(){var t=p.element,e=p.className;null===t.offsetParent&&(p._animate(),p._dispose(),p.end()),Gn(t,e),p._started=!0;var n=p.utils,i=p._animationEvents.$transition,r=p.options;We(r)||(r={});for(var o,s=p._window.getComputedStyle(t,r.pseudo),a=p._properties=s[i+"Property"].split(","),l=s[i+"Duration"].split(","),u=a.length,c=u,h=!1;0<u;)""===(o=a[u-=1])||"none"===o?a.splice(u,1):1<c&&"all"===o&&(p._log.debug('Improper transition declaration on class "'+t.className+'"'),a.splice(u,1));if(0===a.length)h=!0;else{for(u=l.length;0<u&&(""===(o=l[u-=1])||"0s"===o););u<0&&(h=!0)}if(h)return p._animate(),p._dispose(),void p.end();n.isNumber(r.count)&&0<r.count&&(p._count=r.count),!1===r.preserveInit&&Jn(t,e+be),p._animationCanceled=p.transitionEnd(p._done),p._animate()||(n.isEmpty(r.properties)?p.__cssTransition(s,l):(p._dispose(),p.end()))})},t.prototype.cancel=function(){this._animationCanceled(),this._started||this._animate(),this._dispose(),this.end()},t.prototype._dispose=function(){var t=this.className;Jn(this.element,t+" "+t+be),this._animationCanceled=qe},t.prototype._done=function(t){var e=t.propertyName;if(tn(e)){this._transitionCount+=1;var n=this._transitionCount;if(e=e.replace(this._normalizeRegex,"").toLowerCase(),n<this._count||!this._usingCss&&!0===this._normalizedKeys[e]&&n<this._properties.length)return}this._dispose(),this.end()},t.prototype._animate=function(){var t=this._normalizedKeys,e=this._normalizeRegex,n=this.options;We(n)||(n={});var i=this.options.properties;We(i)||(i={});var r,o,s,a=Object.keys(i),l=a.length,u=0,c=this.element.style;for(We(c)||(c={});0<a.length;)o=c[r=a.shift()],tn(s=i[r])?(c[r]=s,o===c[r]?u+=1:t[r.replace(e,"").toLowerCase()]=!0):u+=1;return u<l},t.prototype._toMs=function(t){var e=this._nonNumRegex,n=t.match(e)[0],i=Number(t.replace(e,""));return this.utils.isNumber(i)?"s"===n?1e3*i:"ms"===n?i:0:0},t.prototype.__cssTransition=function(n,t){var e,i,r,o,s=this,a=this._animationEvents.$transition,l=n[a+"Delay"].split(","),u=this._properties,c=u.length,h=this._normalizedKeys,p=this._normalizeRegex,_=0,f=0,d=!1,v=this.utils.defer.bind(this,function(t,e){s._animationCanceled!==qe&&("all"!==t&&n[t]===e||(d=!0),(f+=1)<c||d||(s._dispose(),s.end()))});for(this._usingCss=!0,isFinite(this._count)&&0!==this._count||(this._count=c);_<c;_+=1)i=u[_]=u[_].trim(),r=t.length>_?t[_].trim():t[t.length-1].trim(),o=l.length>_?l[_].trim():l[l.length-1].trim(),h[i.replace(p,"").toLowerCase()]=!0,e=n[i],v(this._toMs(r)+this._toMs(o),[i,e])},t}(i);t.SimpleCssTransition=h,Zn.animation(Bt,h)}(t.animations||(t.animations={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){var t=this._router=this._Router.currentRouter(),e=this._getParentViewport();ln(e)||ln(e._router)||(this._parentRouter=e._router).addChild(t),this._navigator.initialize(t)},e.prototype.loaded=function(){var t=this;(this._animate=We(this.options)&&!0===this.options.value.animate)&&this.dom.addClass(this.element,dt+"-animate"),this._Promise.resolve(this._router.finishNavigating).then(function(){t._router.register(t)})},e.prototype.canNavigateTo=function(t){var e=this,n=this._Router.currentRouter,i=n(),r=!0,o=this._Injector.getDependency(t.delegate.view),s=o.inject(),a=t.parameters,l=n();if(!We(s))return this._Promise.resolve(null);if(i!==l){l.initialize(this._router);var u=fi(S);(s.navigator=u).initialize(l)}else s.navigator=this._navigator;return an(s.canNavigateTo)&&(r=s.canNavigateTo(a,t.query)),this._Promise.resolve(r).then(function(t){return e._nextInjector=o,e._nextView=s,t})},e.prototype.canNavigateFrom=function(){var t=this.controls[0],e=!0;return We(t)&&an(t.canNavigateFrom)&&(e=t.canNavigateFrom()),this._Promise.resolve(e)},e.prototype.navigateTo=function(t){var e=this._nextInjector;We(e)||(e=this._Injector.getDependency(t.delegate.view));var n=this._createNodeMap(e),i=this.element,r=n.element,o=(t.parameters,t.query),s=n.uiControlNode.control;if(this._nextInjector=this._nextView=void 0,this._animate){var a=this._animator,l=this.dom;this._navigator.isBackNavigation()?(l.addClass(r,Yt),a.enter(r,Ut,i).then(function(){l.removeClass(r,Yt)})):a.enter(r,Ut,i)}else i.insertBefore(r,null);var u=this._managerCache.read(this.uid),c=this._ElementManagerFactory.getInstance();return u.children=[],c.initialize(n,u),an(s.navigatedTo)&&s.navigatedTo(t.parameters,o),c.setUiControlTemplate(),s.hasOwnContext?c.observeRootContext(s,c.fulfillAndLoad):c.fulfillAndLoad()},e.prototype.navigateFrom=function(){var e=this,n=this.controls[0],i=We(n);return(i&&an(n.navigatingFrom)?this._Promise.resolve(n.navigatingFrom()):this._Promise.resolve()).catch(function(t){if(We(t))return tn(t.message)?void e._log.debug(e.type+" error: "+t.message):void e._log.debug(e.type+" error: "+JSON.stringify(t));e._log.debug(t)}).then(function(){if(e._animate&&i){var t=n.element;e._navigator.isBackNavigation()&&e.dom.addClass(t,Yt),e._animator.leave(t,Vt).then(function(){Si.dispose(n)})}else Si.dispose(n)})},e.prototype.dispose=function(){this._router.unregister(this),this._navigator.dispose()},e.prototype._createNodeMap=function(t){var e=this._nextView;We(e)||(e=t.inject());var n=this._document,i=t.name,r=e.replaceWith,o=rn(r)||"any"===r?n.createElement("div"):n.createElement(r);return o.setAttribute(vt,i),o.className="plat-viewcontrol",{element:o,attributes:{},nodes:[],uiControlNode:{control:e,nodeName:i,expressions:[],injector:t}}},e.prototype._getParentViewport=function(){for(var t=this.parent,e=this.type;!ln(t)&&t.type!==e;)t=t.parent;return t},e._inject={_Router:q,_Promise:w,_Injector:lt,_ElementManagerFactory:I,_document:G,_managerCache:A,_animator:P,_navigator:S},e}(c);t.Viewport=e,Zn.control(dt,e);var n=function(n){function t(){var t=n.call(this)||this;t.replaceWith=null,t.__isFirst=!1;var e=fi(R);return t.__templateControlCache=e.create("__templateControlCache"),t}return __extends(t,n),t.prototype.initialize=function(){var t=this.options;We(t)||(t={});var e=t.value;We(e)||(e={});var n=this._id=e.id;if(ln(n))this._log.warn(this.type+" instantiated without an id option");else{this._url=e.templateUrl;var i=this.__templateControlCache.read(n);ln(i)?(this.__isFirst=!0,this._initializeTemplate()):this.__templatePromise=i}},t.prototype.loaded=function(){this.__isFirst||this._waitForTemplateControl(this.__templatePromise)},t.prototype.dispose=function(){if(this.__isFirst){var t=this.__templateControlCache;t.remove(this._id),0===t.info().size&&t.dispose()}},t.prototype._initializeTemplate=function(){var e=this,n=this._id;if(!ln(n)){var t,i,r=this.endNode.parentNode,o=this._url;ln(o)?(t=this._document.createDocumentFragment(),Dn(this.elementNodes,t)):(t=this._templateCache.read(o),zn(this.elementNodes,r)),this.elementNodes=[],i=nn(t)?t.catch(function(t){if(ln(t))return c.determineTemplate(e,o)}).then(function(t){return e.bindableTemplates.add(n,t.cloneNode(!0)),e}):(this.bindableTemplates.add(n,t.cloneNode(!0)),this._Promise.resolve(this)),this.__templateControlCache.put(n,i)}},t.prototype._waitForTemplateControl=function(t){var n=this;nn(t)&&t.then(function(t){return ln(n._url)||n._url===t._url||n._log.warn("The specified url: "+n._url+" should match "+n.type+' with id: "'+n._id+'". Loading original url.'),n.__mapBindableTemplates(t),n.bindableTemplates.bind(n._id)}).then(function(t){var e=n.endNode;Un(e.parentNode,t,e)}).catch(function(t){bn(function(){n._log.warn("Problem resolving "+n.type+" url: "+t.response)})})},t.prototype.__mapBindableTemplates=function(t){var e=this.bindableTemplates;e.cache=t.bindableTemplates.cache,e.templates=t.bindableTemplates.templates},t._inject={_Promise:w,_templateCache:L,_document:G},t}(c);t.Template=n,Zn.control(ft,n);var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setTemplate=function(){this.innerTemplate=Dn(this.element.childNodes)},e.prototype.loaded=function(){this.element.appendChild(this.innerTemplate.cloneNode(!0))},e}(c);t.Ignore=i,Zn.control("plat-ignore",i);var r=function(t){function e(){var n=t.call(this)||this;return n.priority=120,n._aliases={index:se,even:ae,odd:le,first:ue,last:ce},n._blockLength=0,n._addQueue=[],n._itemLength=0,n.__listenerSet=!1,n.itemsLoaded=new n._Promise(function(t,e){n.__resolveFn=t,n.__rejectFn=e}).catch(qe),n}return __extends(e,t),e.prototype.setTemplate=function(){this.bindableTemplates.add("item",this.element.childNodes)},e.prototype.contextChanged=function(t,e){cn(t)?this._setListener():t=[],this._executeEvent([{object:t,type:"splice"}])},e.prototype.loaded=function(){var t=this.options,e=this._animate=We(t)&&!0===t.value.animate,n=this.context;if(this._container=this.element,e&&(this._animationQueue=[]),this._setAliases(),cn(n)){var i=this._addQueue,r=n.length,o=this._addItems(0,r,0).then(function(){var t=i.indexOf(o);-1!==t&&i.splice(t,1)});i.push(o),this._setListener()}},e.prototype.dispose=function(){this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._animationQueue=this._addQueue=null},e.prototype._setAliases=function(){var t=this.options;if(!un(t)){var e=t.value.aliases;if(We(e))for(var n,i=this._aliases,r=Object.keys(i),o=r.length,s=0;s<o;s+=1)tn(n=e[r[s]])&&(i[r[s]]=n)}},e.prototype._addItems=function(t,e,r){var o=this,n=+(t+e),i=[],s=t;for(this._itemLength+=e;t<n;)i.push(this._bindItem(t)),t+=1;return 0<i.length&&(this.itemsLoaded=this._Promise.all(i).then(function(t){if(o._setBlockLength(t),0<r)for(var e=t.length,n=o._container,i=0;i<e;i+=1)i<r?o._appendAnimatedItem(t[i]):n.insertBefore(t[i],null);else o._appendItems(t);o._updateResource(s-1),an(o.__resolveFn)&&(o.__resolveFn(),o.__resolveFn=o.__rejectFn=null)}).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),o._log.error(t)})})),this.itemsLoaded},e.prototype._appendItems=function(t){Dn(t,this._container)},e.prototype._appendAnimatedItem=function(t){if(Je(t)){var e=this._animationQueue,n={animation:this._animator.enter(t,Ut,this._container).then(function(){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}),op:null};e.push(n)}},e.prototype._removeItems=function(t,e){for(var n=c.dispose,i=this.controls,r=t+e;t<r;)n(i[r-=1]);this._updateResource(i.length-1)},e.prototype._bindItem=function(t){return this.bindableTemplates.bind("item",t,this._getAliases(t))},e.prototype._setBlockLength=function(t){0<this._blockLength||0===t.length||(this._blockLength=t[0].childNodes.length)},e.prototype._updateResource=function(t){var e=this.controls;t<0||t>=e.length||e[t].resources.add(this._getAliases(t))},e.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},e.prototype._executeEvent=function(t){var e="_"+t[0].type;an(this[e])&&this[e](t)},e.prototype._getAliases=function(t){var e=t%2==0,n={},i=this._aliases,r=Ie;return n[i.index]={value:t,type:r},n[i.even]={value:e,type:r},n[i.odd]={value:!e,type:r},n[i.first]={value:0===t,type:r},n[i.last]={value:t===this.context.length-1,type:r},n},e.prototype._push=function(t){var e=t[0],n=this._addQueue,i=e.addedCount,r=this._addItems(e.index,i,this._animate?i:0).then(function(){var t=n.indexOf(r);-1!==t&&n.splice(t,1)});n.push(r)},e.prototype._pop=function(t){var e=this,n=t[0],i=n.object.length;if(0!==n.removed.length){var r=n.object.length;0<this._itemLength&&(this._itemLength-=1),this._Promise.all(this._addQueue).then(function(){e._animate?e._animateItems(i,1,Vt,"leave",!1).then(function(){e._removeItems(r,1)}):e._removeItems(r,1)})}},e.prototype._unshift=function(t){var e=t[0],n=e.addedCount,i=this._addQueue;if(this._animate){var r=this._animationQueue,o=r.length;this._animateItems(0,n,Ut,null,0<o&&"clone"===r[o-1].op)}var s=this._addItems(e.object.length-n,n,0).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1)});i.push(s)},e.prototype._shift=function(t){var e=this,n=this._addQueue,i=t[0];if(0!==i.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,Vt,"clone",!0)]));var r=i.object.length;0<this._itemLength&&(this._itemLength-=1),this._Promise.all(n).then(function(){e._removeItems(r,1)})}},e.prototype._splice=function(t){var e,n=this,i=t[0],r=i.addedCount,o=this._itemLength,s=this._animate,a=this._addQueue;if(ln(r)){s&&this._cancelCurrentAnimations();var l=i.object.length,u=o-l;o<l?(e=this._addItems(o,-u,0).then(function(){var t=a.indexOf(e);-1!==t&&a.splice(t,1)}),a.push(e)):l<o&&(u<=o?this._itemLength-=u:this._itemLength=0,this._Promise.all(a).then(function(){n._removeItems(o-u,u)}))}else{var c=i.removed.length,h=this._animationQueue;if(c<r){var p=r-c,_=void 0;if(s){_=r;var f=h.length,d=i.index;o<r-d&&(_=o-d),this._animateItems(d,_,Ut,null,0<f&&"clone"===h[f-1].op),_=r-_}else _=0;e=this._addItems(i.object.length-p,p,_).then(function(){var t=a.indexOf(e);-1!==t&&a.splice(t,1)}),a.push(e)}else if(r<c){var v=0<r;s&&!v&&0===a.length&&(a=a.concat([this._animateItems(i.index,c,Vt,"clone",!0)]));var m=c-r;m<=o?this._itemLength-=m:this._itemLength=0,this._Promise.all(a).then(function(){if(s&&v){var t=h.length;n._animateItems(i.index,r,Ut,null,0<t&&"clone"===h[t-1].op)}n._removeItems(o-m,m)})}}},e.prototype._calculateBlockLength=function(t,e){return this._blockLength},e.prototype._animateItems=function(t,e,n,i,r){var o=this._calculateBlockLength();if(0===o)return this._Promise.resolve();var s=t*o;switch(i){case"clone":return this._handleClonedContainerAnimation(s,e*o+s,n,!0===r);case"leave":return this._handleLeave(s,e*o+s,n);default:return this._handleSimpleAnimation(s,e*o+s,n,!0===r)}},e.prototype._handleSimpleAnimation=function(t,e,n,i){var r=this._container,o=Array.prototype.slice.call(r.childNodes,t,e);if(0===o.length)return this._Promise.resolve();var s=this._animationQueue,a=this._animator.create(o,n),l=a.current.then(function(){var t=s.indexOf(c);-1!==t&&s.splice(t,1)}),u=function(){return a.previous.then(function(){l.start()}),l},c={animation:l,op:null};if(i&&0<s.length){var h=this._cancelCurrentAnimations().then(u);return s.push(c),h}return s.push(c),u()},e.prototype._handleLeave=function(t,e,n){var i=this._container,r=Array.prototype.slice.call(i.childNodes,t,e);if(0===r.length)return this._Promise.resolve();var o=this._animationQueue,s=this._animator.leave(r,n).then(function(){var t=o.indexOf(a);-1!==t&&o.splice(t,1)}),a={animation:s,op:"leave"};return o.push(a),s},e.prototype._handleClonedContainerAnimation=function(t,e,n,i){var r,o=this._container,s=o.cloneNode(!0),a=Array.prototype.slice.call(s.childNodes,t,e);if(0===a.length)return this._Promise.resolve();var l=this._animationQueue,u=this._animator.create(a,n),c=u.current.then(function(){var t=l.indexOf(p);-1<t&&l.splice(t,1),ln(r)||r.replaceChild(o,s)}),h=function(){return ln(r=o.parentNode)||c.isCanceled()||(r.replaceChild(s,o),u.previous.then(function(){c.start()})),c},p={animation:c,op:"clone"};if(i&&0<l.length){var _=this._cancelCurrentAnimations().then(h);return l.push(p),_}return l.push(p),h()},e.prototype._cancelCurrentAnimations=function(){for(var t=this._animationQueue,e=[],n=t.length,i=0;i<n;i+=1)e.push(t[i].animation.cancel());return this._Promise.all(e)},e._inject={_animator:P,_Promise:w},e}(c);t.ForEach=r,Zn.control("plat-foreach",r);var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="head",t._structuredDataElements=[],t}return __extends(t,e),t.prototype.initialize=function(){var t=this;this.on(Lt,function(){t._removeAllElements()})},t.prototype.setTemplate=function(){var t=bt,e="title",n="author",i="description",r=Tt,o=Nt;this.element.setAttribute("prefix","og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"),this._titleElement=this._createElement(e),this._ogTitleElement=this._createElement(t,r+e),this._twitterTitleElement=this._createElement(t,o+e),this._descriptionElement=this._createElement(t,i),this._ogDescriptionElement=this._createElement(t,r+i),this._twitterDescriptionElement=this._createElement(t,o+i),this._ogUrlElement=this._createElement(t,"og:url"),this._twitterUrlElement=this._createElement(t,o+"url"),this._authorElement=this._createElement(t,n),this._googleAuthorElement=this._createElement("link",n),this._fbAuthorElement=this._createElement(t,"article:"+n),this._twitterCreatorElement=this._createElement(t,o+"creator"),this._ogTypeElement=this._createElement(t,"og:type")},t.prototype.title=function(t){return tn(t)?(this._titleElement.innerText=t,this._setContent([this._ogTitleElement,this._twitterTitleElement],t),t):this._getContent(this._titleElement)},t.prototype.description=function(t){return tn(t)?(this._setContent([this._descriptionElement,this._ogDescriptionElement,this._twitterDescriptionElement],t),t):this._getContent(this._descriptionElement)},t.prototype.url=function(t){return tn(t)?(this._setContent([this._ogUrlElement,this._twitterUrlElement],t),t):this._getContent(this._ogUrlElement)},t.prototype.author=function(t){return tn(t)?(this._setContent([this._authorElement],t),t):this._getContent(this._authorElement)},t.prototype.googleAuthor=function(t){return tn(t)?(this._setContent([this._googleAuthorElement],t),t):this._getContent(this._googleAuthorElement)},t.prototype.fbAuthor=function(t){return tn(t)?(this._setContent([this._fbAuthorElement],t),t):this._getContent(this._fbAuthorElement)},t.prototype.twitterCreator=function(t){return tn(t)?(this._setContent([this._twitterCreatorElement],t),t):this._getContent(this._twitterCreatorElement)},t.prototype.fbType=function(t){return tn(t)?(this._setContent([this._ogTypeElement],t),t):this._getContent(this._ogTypeElement)},t.prototype.images=function(t){var e=this;if(cn(t)){var n,i,r=bt,o=this.element;fn(function(t){t=e._browser.urlUtils(t).href,2!==o.querySelectorAll(r+'[content="'+t+'"]').length&&(n=e._createElement(r,"og:"+Et,!0),i=e._createElement(r,"twitter:"+Et,!0),e._setContent([n,i],t))},t)}},t.prototype.videos=function(t){var e=this;if(cn(t)){var n,i=this._browser,r=this.element;fn(function(t){t=i.urlUtils(t).href,1!==r.querySelectorAll('meta[content="'+t+'"]').length&&(n=e._createElement("meta","og:video",!0),e._setContent([n],t))},t)}},t.prototype.structuredData=function(t){if(!rn(t)){var e=this._document.createElement("script"),n=this._titleElement.nextSibling;e.setAttribute("type","application/ld+json"),e.textContent=JSON.stringify(t),this._structuredDataElements.push(e),this.dom.insertBefore(this.element,e,n)}},t.prototype.blogPostings=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length,i=0;i<n;i+=1)this.structuredData(t[i])},t.prototype.loaded=function(){this.url(this._browser.url())},t.prototype.navigated=function(t){this.url(t)},t.prototype._getContent=function(t){var e=t.nodeName.toLowerCase();return"title"===e?t.innerText:e===bt?t.getAttribute(kt):e===Ct?t.getAttribute("href"):void 0},t.prototype._setContent=function(t,e){for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=t.length,s=this._titleElement.nextSibling,a=this.dom,l=0;l<o;l+=1)(n=t[l]).nodeName.toLowerCase()===bt?n.setAttribute("content",e):n.setAttribute("href",e),-1===r.indexOf(n)&&a.insertBefore(i,n,s)},t.prototype._createElement=function(t,e,n){var i,r=tn(e),o=this.element,s=!r||0!==e.indexOf(Tt)&&0!==e.indexOf(wt)?"name":xt;return t===Ct&&(s="rel"),!n&&r?i=o.querySelector(t+"["+s+'="'+e+'"]'):n||(i=o.querySelector(t)),Je(i)||(i=this._document.createElement(t)),r&&i.setAttribute(s,e),i},t.prototype._removeAllElements=function(){var t=Array.prototype.slice,e=this._document.head.querySelectorAll('meta[property^="og:"]'),n=this._document.head.querySelectorAll('meta[name^="'+Nt+'"]');this._removeElements.apply(this,[this._descriptionElement,this._authorElement,this._googleAuthorElement].concat(t.call(e),t.call(n),t.call(this._structuredDataElements))),this._structuredDataElements=[]},t.prototype._removeElements=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=t.length,s=0;s<o;s+=1)n=t[s],-1!==r.indexOf(n)&&i.removeChild(n)},t._inject={_document:G,_browser:tt},t}(c);t.Head=o;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setTemplate=function(){this.dom.clearNode(this.element)},e.prototype.loaded=function(){var t=this.options;We(t)&&(this._onOptionsChanged(t.value),t.observe(this._onOptionsChanged))},e.prototype._onOptionsChanged=function(t,e){var n=this;if(t!==e)if(We(t)){var i=t.html;if(i!==this._html){var r=tn(this._html=i);if(ln(i)||r&&""===i.trim())0<this.controls.length?this._TemplateControlFactory.dispose(this.controls[0]):this.dom.clearNode(this.element);else if(r)if(!0!==t.compile)Bn(this.element,i);else{var o=0<this.controls.length;this.bindableTemplates.once(i).then(function(t){o?n._TemplateControlFactory.dispose(n.controls[0]):n.dom.clearNode(n.element),n.element.insertBefore(t,null)})}else this._log.debug("Trying to bind a non-string value to "+this.type+".")}}else this._log.debug("plat-options for "+this.type+" must be an object.")},e._inject={_TemplateControlFactory:z},e}(c);t.InnerHtml=s,Zn.control("plat-html",s);var a=function(t){function e(){var n=t.call(this)||this;return n.replaceWith="select",n.priority=120,n.groups={},n.itemsLoaded=new n._Promise(function(t,e){n.__resolveFn=t,n.__rejectFn=e}).catch(qe),n}return __extends(e,t),e.prototype.setTemplate=function(){this.bindableTemplates.add("option",this.element.childNodes);var t=this.options;We(t)||(t={});var e=t.value;We(e)||(e={});var n=e.default;if(We(n)){var i=this._document.createElement("option"),r=n.value,o=n.textContent;i.value=un(r)?o:r,i.textContent=un(o)?r:o,this.element.insertBefore(i,null)}if(ln(e.group))this._isGrouped=!1;else{var s=this._group=e.group,a=this._document.createElement("optgroup");a.label=pe+s+_e,this.bindableTemplates.add("group",a),this._isGrouped=!0}},e.prototype.contextChanged=function(t,e){var n=this;if(!rn(t)&&cn(t)){var i=cn(t)?t.length:0,r=cn(e)?e.length:0;this._setListener(),r<i?this._addItems(i-r,r):i<r&&this._removeItems(r-i),this.itemsLoaded.then(this._observeChange.bind(this))}else rn(e)||this.itemsLoaded.then(function(){n._removeItems(n.controls.length)}).then(this._observeChange.bind(this))},e.prototype.loaded=function(){if(un(this._isGrouped)){var t=this.options;We(t)||(t={});var e=t.value;We(e)||(e={}),this._group=e.group,this._isGrouped=!ln(this._group)}this._defaultOption=this.element.firstElementChild;var n=this.context;cn(n)&&(this._addItems(n.length,0),this._setListener())},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._defaultOption=null},e.prototype.observeProperties=function(t){var e=this,n=this.element;if(this._binder=t,n.multiple){if(ln(t.evaluate())){var i=[];this.inputChanged(i,this.__lastValue),this.__lastValue=i}t.observeProperty(this._setSelectedIndices),t.observeArrayChange(function(){e._setSelectedIndices(t.evaluate(),null,null)})}else t.observeProperty(this._setSelectedIndex);this.addEventListener(n,"change",this._observeChange,!1)},e.prototype._setSelectedIndex=function(e,t,n,i){var r=this,o=this.element,s=o.value;if(ln(e))return!0!==i&&this._document.body.contains(o)?void(o.selectedIndex=-1):void this.itemsLoaded.then(function(){if(ln(r._binder.evaluate())){var t=o.value;r.inputChanged(t,r.__lastValue),r.__lastValue=t}});tn(e)||(sn(e)?(this._propertyType="number",e=e.toString()):on(e)?(this._propertyType="boolean",e=e.toString()):(e=an(e.toString)?e.toString():Object.prototype.toString.call(e),this._log.info('Trying to bind the invalid value "'+e+'" to a '+this.type+"."))),s!==e&&this.itemsLoaded.then(function(){if(r._document.body.contains(o))o.value=r.__lastValue=e,o.value===e&&-1!==o.selectedIndex||(o.selectedIndex=-1);else{if(o.value=e,o.value!==e){o.value=s;var t=r._castValue(o.value);r.inputChanged(t,r.__lastValue),r.__lastValue=t}r.__lastValue=e}})},e.prototype._setSelectedIndices=function(p,t,e,_){var f=this;this.itemsLoaded.then(function(){var t,e=f.element.options,n=ln(p),i=ln(e)?0:e.length;if(!n&&cn(p)){for(var r,o,s,a=1/0;0<i;)if(r=(t=e[i-=1]).value,-1===p.indexOf(r)){o=Number(r);var l=p.indexOf(o),u=p.indexOf(!0),c=p.indexOf(!1);sn(o)&&-1!==l?((s=l)<a&&(f._propertyType="number",a=s),t.selected=!0):t.selected=("true"===r&&-1!==u||"false"===r&&-1!==c)&&((s=c<u?u:c)<a&&(f._propertyType="boolean",a=s),!0)}else t.selected=!0;f.__lastValue=p}else{if(!0===_&&ln(f._binder.evaluate())){var h=f._getSelectedValues();f.inputChanged(h,f.__lastValue),f.__lastValue=h}for(;0<i;){if(t=e[i-=1],!n&&t.value===""+p)return void(t.selected=!0);t.selected=!1}f.__lastValue=p}})},e.prototype._observeChange=function(){var t=this.element,e=t.multiple?this._getSelectedValues():this._castValue(t.value);e!==this.__lastValue&&(this.inputChanged(e,this.__lastValue),this.__lastValue=e)},e.prototype._getSelectedValues=function(){for(var t,e=this.element.options,n=e.length,i=[],r=0;r<n;r+=1)(t=e[r]).selected&&i.push(this._castValue(t.value));return i},e.prototype._castValue=function(t){var e,n=this._propertyType;if(ln(n))return t;switch(n){case"number":e=rn(t)?null:Number(t);break;case"boolean":switch(t){case"true":e=!0;break;case"false":case"0":case"null":case"undefined":e=!1;break;default:e=!!t}break;default:e=t}return e},e.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},e.prototype._executeEvent=function(t){var e="_"+t[0].type;an(this[e])&&this[e](t)},e.prototype._addItems=function(t,e){for(var n=this,i=this.bindableTemplates,r=[],o=this._insertOption;0<t;)t-=1,r.push(i.bind("option",e).then(o.bind(this,e))),e+=1;return 0<r.length&&(this.itemsLoaded=this._Promise.all(r).then(function(){an(n.__resolveFn)&&(n.__resolveFn(),n.__resolveFn=n.__rejectFn=null)}).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),n._log.error(t)})})),this.itemsLoaded},e.prototype._insertOption=function(t,e){var n=this.element;if(this._isGrouped){var i=this.groups,r=this.context[t];We(r)||(r={});var o=r[this._group],s=i[o];return ln(s)?i[o]=this.bindableTemplates.bind("group",t).then(function(t){return(s=i[o]=t.childNodes[1]).insertBefore(e,null),n.insertBefore(t,null),s}):nn(s)?s.then(function(t){t.insertBefore(e,null)}):(s.insertBefore(e,null),this._Promise.resolve())}return n.insertBefore(e,null),this._Promise.resolve()},e.prototype._removeItems=function(t){for(var e=c.dispose,n=this.controls;0<t;)t-=1,e(n.pop())},e.prototype._removeItem=function(){this._isGrouped?this._resetSelect():this._removeItems(1)},e.prototype._resetSelect=function(){this._removeItems(this.controls.length),this.groups={},ln(this._defaultOption)||this.element.insertBefore(this._defaultOption.cloneNode(!0),null),this._addItems(this.context.length,0)},e.prototype._push=function(t){var e=t[0];this._addItems(e.addedCount,e.index)},e.prototype._pop=function(t){var e=this;0!==t[0].removed.length&&this.itemsLoaded.then(function(){e._removeItem()})},e.prototype._unshift=function(t){if(this._isGrouped)this._resetSelect();else{var e=t[0],n=e.addedCount;this._addItems(n,e.object.length-n-1)}},e.prototype._shift=function(t){var e=this;0!==t[0].removed.length&&this.itemsLoaded.then(function(){e._removeItem()})},e.prototype._splice=function(t){var e=this;if(this._isGrouped)this._resetSelect();else{var n=t[0],i=n.addedCount,r=n.removed.length;r<i?this._addItems(i-r,n.object.length-i-1):i<r&&this.itemsLoaded.then(function(){e._removeItems(r-i)})}},e.prototype._sort=function(t){this._isGrouped&&this._resetSelect()},e.prototype._reverse=function(t){this._isGrouped&&this._resetSelect()},e._inject={_Promise:w,_document:G},e}(h);t.Select=a,Zn.control("plat-select",a);var l=function(n){function t(){var t=n.call(this)||this;t._animate=!1,t.__condition=!0,t.__firstTime=!0,t.__isBound=!1;var e=t._document;return t.commentNode=e.createComment(_t+"-@placeholder"),t.fragmentStore=e.createDocumentFragment(),t}return __extends(t,n),t.prototype.contextChanged=function(){var t=this.options.value;if(!rn(t))return this._setter(t)},t.prototype.setTemplate=function(){this.bindableTemplates.add("template",Array.prototype.slice.call(this.element.childNodes))},t.prototype.loaded=function(){var t=this.options;We(t)?this._animate=!0===t.value.animate:(this._log.warn("No condition specified in "+pt+" for "+this.type+"."),this.options={value:{condition:!0},observe:qe});var e=this.contextChanged();return this.__removeListener=this.options.observe(this._setter),e},t.prototype.dispose=function(){an(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null),an(this.__cancelFrame)&&(this.__cancelFrame(),this.__cancelFrame=null),this.commentNode=null,this.fragmentStore=null},t.prototype._setter=function(t){var e,n,i,r=this,o=!!t.condition;return o!==this.__condition||this.__firstTime?(n=o?(e=this.__leavePromise,function(){return r.__leavePromise=null,r._addItem()}):(e=this.__enterPromise,function(){return r.__enterPromise=null,r._removeItem()}),i=ln(e)?n():this._animate&&an(e.cancel)?e.cancel().then(n):e.then(n),this.__firstTime=!1,this.__condition=o,i):this._Promise.resolve(null)},t.prototype._addItem=function(){var n=this,t=this.__isBound;return t&&!Je(this.commentNode.parentNode)?this._Promise.resolve(null):t?ln(this.__initialBind)?this._animate?this._animateEntrance():this._elementEntrance():(this.__initialBind=this.__initialBind.then(function(){return n.__initialBind=null,n._animate?n._animateEntrance():n._elementEntrance()}),this.__initialBind):(this.__isBound=!0,this.__initialBind=this.bindableTemplates.bind("template").then(function(t){n.__initialBind=null;var e=n.element;return e.parentNode===n.fragmentStore||ln(e.parentNode)?(e.insertBefore(t,null),n._animate?n._animateEntrance():n._elementEntrance()):n._animate?(n.__enterPromise=n._animator.animate(e,Ut).then(function(){n.__enterPromise=null}),e.insertBefore(t,null),n.__enterPromise):void e.insertBefore(t,null)}))},t.prototype._elementEntrance=function(){var e=this,n=this.commentNode,i=n.parentNode;return Je(i)?(this.__enterPromise=new this._Promise(function(t){e.__cancelFrame=En(function(){i.insertBefore(e.element,n),t()})}).then(function(){e.__enterPromise=null}),this.__enterPromise):this._Promise.resolve()},t.prototype._animateEntrance=function(){var t=this,e=this.commentNode,n=e.parentNode;return Je(n)?(this.__enterPromise=this._animator.enter(this.element,Ut,n,e).then(function(){t.__enterPromise=null}),this.__enterPromise):this._animator.resolve().then(qe)},t.prototype._removeItem=function(){var t=this;return ln(this.__initialBind)?this._animate?this._animateLeave():this._elementLeave():(this.__initialBind=this.__initialBind.then(function(){return t.__initialBind=null,t._animate?t._animateLeave():t._elementLeave()}),this.__initialBind)},t.prototype._elementLeave=function(){var r=this;return this.__leavePromise=new this._Promise(function(i){r.__cancelFrame=En(function(){var t=r.element,e=t.parentNode,n=t.nextSibling;Je(e)&&(Je(r.commentNode.parentNode)||e.insertBefore(r.commentNode,n),r.fragmentStore.insertBefore(t,null)),i()})}).then(function(){r.__leavePromise=null}),this.__leavePromise},t.prototype._animateLeave=function(){var n=this,i=this.element;return this.__leavePromise=this._animator.leave(i,Vt).then(function(){var t=i.parentNode,e=i.nextSibling;n.__leavePromise=null,Je(n.commentNode.parentNode)||t.insertBefore(n.commentNode,e),n.fragmentStore.insertBefore(i,null)}),this.__leavePromise},t._inject={_animator:P,_Promise:w,_document:G},t}(c);t.If=l,Zn.control(_t,l);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="a",t._router=t._Router.currentRouter(),t._allowClick=!1,t}return __extends(t,e),t.prototype.initialize=function(){this._removeClickListener=this.dom.addEventListener(this.element,"click",this._handleClick.bind(this),!1)},t.prototype.loaded=function(){var t=this.options,e=this.setHref.bind(this);if(!We(t))return this._log.warn("No options specified for "+this.type+". Please send in options of type plat.ui.controls.ILinkOptions."),(t=this.options={}).value={view:""},void this.setHref();We(t.value)||(t.value={view:""}),this.addEventListener(this.element,Wt,this._handleTap,!1),e(),t.observe(e)},t.prototype.setHref=function(){var t=this.getHref();rn(t)||(this.element.href=t)},t.prototype.getHref=function(){if(!ln(this._router)){var t=this.options.value,e=t.view;if(!0!==t.isUrl){var n=t.parameters,i=t.query;if(rn(e))return e;e=this._router.generate(e,n,i)}return this._browser.formatUrl(e)}},t.prototype.dispose=function(){Cn(this._removeClickListener,3e3)},t.prototype._handleClick=function(t){if(this._allowClick)this._allowClick=!1;else{var e;if(sn(t.buttons)&&0!==t.buttons)e=t.buttons;else if(sn(t.which)&&0<t.which)e=t.which;else switch(t.button){case-1:e=0;break;case 0:e=1;break;case 1:e=4;break;case 2:e=2;break;case 3:e=8;break;case 4:e=16;break;default:e=1}1===e&&t.preventDefault()}},t.prototype._handleTap=function(t){var e=this;if(1===t.buttons){var n=this.getHref();if(!un(n)){var i=this.element.target;if(rn(i)||"_self"===i)return t.preventDefault(),void En(function(){e._browser.url(n)});this._allowClick=!0,this.element.click()}}},t._inject={_Router:q,_Injector:lt,_browser:tt,_window:Q},t}(c);t.Link=u,Zn.control("plat-link",u)}(t.controls||(t.controls={}))}(ji=d.ui||(d.ui={})),function(t){var e=function(){function t(){}return t.prototype.compile=function(t,e){var n,i,r,o=!ln(e)?this._managerCache.read(e.uid):null,s=this._ElementManagerFactory.create,a=t.childNodes;if(a=un(a)?an(t.push)?t:Array.prototype.slice.call(t):Array.prototype.slice.call(a),ln(o)){n=a.length;for(var l=0;l<n;l+=1)(r=a[l]).nodeType===Node.ELEMENT_NODE&&(ln(s(r))||this.compile(r)),l+=(i=a.length)-n,n=i}else this._compileNodes(a,o)},t.prototype._compileNodes=function(t,e){for(var n,i,r,o=this._ElementManagerFactory.create,s=this._CommentManagerFactory.create,a=this._TextManagerFactory.create,l=t.length,u=0;u<l;u+=1){switch((n=t[u]).nodeType){case Node.ELEMENT_NODE:ln(i=o(n,e))||this._compileNodes(Array.prototype.slice.call(n.childNodes),i);break;case Node.TEXT_NODE:a(n,e);break;case Node.COMMENT_NODE:s(n,e)}u+=(r=t.length)-l,l=r}},t._inject={_ElementManagerFactory:I,_TextManagerFactory:j,_CommentManagerFactory:f,_managerCache:A},t}();t.Compiler=e,Zn.injectable(_,e);var m=function(){function p(){this.isClone=!1}return p.hasMarkup=function(t){return p._markupRegex.test(t)},p.findMarkup=function(t){var e,n,i,r,o=pe.length,s=_e.length,a=_e[s-1],l=[],u=p._wrapExpression,c=p._parser;for(e=(t=t.replace(p._newLineRegex,"")).indexOf(pe),n=t.indexOf(_e);-1!==e&&-1!==n;){for(0!==e&&l.push(u(t.slice(0,e)));t[n]!==a||t[n+1]===a;)n+=1;n+=1,"="===(i=t.slice(e+o,n-s))[0]?((r=c.parse(i.slice(1).trim())).oneTime=!0,l.push(r)):l.push(c.parse(i.trim())),e=(t=t.slice(n)).indexOf(pe),n=t.indexOf(_e)}return 0<=e&&0<=n?l.push(u(t.slice(n))):""!==t&&l.push(u(t)),l},p.build=function(t,e){for(var n,i=t.length,r={},o=p._TemplateControlFactory.evaluateExpression,s="",a=0;a<i;a+=1)if(We(n=o(t[a],e,r)))try{s+=JSON.stringify(n,null,4)}catch(t){ln(t.description)||(t.description="Cannot stringify object: "+t.description),t.message="Cannot stringify object: "+t.message,p._log.warn(t)}else ln(n)||(s+=n);return s},p.observeExpressions=function(t,n,e){for(var i,r,o,s,a=p.__findUniqueIdentifiers(t),l=a.identifiers,u=a.oneTimeIdentifiers,c={listener:e,uid:n.uid};0<l.length;)r=p.__getObservationDetails(l.pop(),n),ln(o=r.manager)||o.observe(r.absoluteIdentifier,c);for(var h=function(){if(i=u.pop(),r=p.__getObservationDetails(i,n),!ln(o=r.manager)&&!r.isDefined){s=r.absoluteIdentifier;var t=o.observe(s,c),e=o.observe(s,{uid:n.uid,listener:function(){t(),e()}})}};0<u.length;)h()},p._wrapExpression=function(t){return{evaluate:function(){return t},identifiers:[],aliases:[],expression:t}},p.__findUniqueIdentifiers=function(t){var e,n=t.length;if(1===n)return!0===(e=t[0]).oneTime?{identifiers:[],oneTimeIdentifiers:e.identifiers.slice(0)}:{identifiers:e.identifiers.slice(0),oneTimeIdentifiers:[]};for(var i,r,o,s,a,l={},u={},c=[],h=[],p=0;p<n;p+=1)for(a=(e=t[p]).oneTime,s=(i=e.identifiers).length,o=0;o<s;o+=1)if(r=i[o],a){if(!0===l[r])continue;u[r]||(u[r]=!0,h.push(r))}else l[r]||(l[r]=!0,c.push(r)),!0===u[r]&&(u[r]=!1,h.splice(h.indexOf(r),1));return{identifiers:c,oneTimeIdentifiers:h}},p.__getObservationDetails=function(t,e){var n,i=p._ContextManager,r=t.split("."),o="",s=!1;if("@"===t[0]){var a={},l=r.shift().slice(1),u=void 0;if(0<r.length&&(o="."+r.join(".")),ln(u=a[l])&&(u=a[l]=e.findResource(l)),!ln(u)&&!ln(u.resource)){var c=u.resource.type;l===Ae?(n=i.getManager(Si.getRootControl(e)),o=e.absoluteContextPath+o):l===je?(n=i.getManager(a[l].control),o="context"+o):c!==Te&&c!==Ie||(n=i.getManager(a[l].control),o="resources."+l+".value"+o)}}else(s=!un(i.getContext(e.context,r)))||un(i.getContext(e,r))?(n=i.getManager(Si.getRootControl(e)),o=e.absoluteContextPath+"."+t):n=null;return{absoluteIdentifier:o,manager:n,isDefined:s}},p.prototype.initialize=function(t,e){this.nodeMap=t,ln(this.parent=e)||(this.isClone=e.isClone,e.children.push(this))},p.prototype.getParentControl=function(){for(var t,e=this.parent;ln(t)&&!ln(e);)t=e.getUiControl(),e=e.parent;return t},p.prototype.clone=function(t,e){return 1},p.prototype.bind=function(){},p}();function n(t,e,n,i,r){return m._markupRegex=t.markupRegex,m._newLineRegex=t.newLineRegex,m._ContextManager=e,m._parser=n,m._TemplateControlFactory=i,m._log=r,m}t.NodeManager=m,t.INodeManagerStatic=n,Zn.injectable(v,n,[K,Z,J,z,k],fe);var s=function(s){function g(){var t=null!==s&&s.apply(this,arguments)||this;return t.children=[],t.type="element",t.replace=!1,t.hasOwnContext=!1,t}return __extends(g,s),g.create=function(t,e){var n=t.nodeName.toLowerCase(),i=n,r=si[n];We(r)||(r=ai[n]);var o,s=!0,a=!1;if(ln(r)&&(t.hasAttribute(vt)?(n=t.getAttribute(vt).toLowerCase(),We(r=si[n])||(r=ai[n]),s=!1):t.hasAttribute(yt+vt)&&(n=t.getAttribute(yt+vt).toLowerCase(),We(r=si[n])||(r=ai[n]),s=!1)),!ln(r)){var l=r.inject();o={control:l,resourceElement:g.locateResources(t),nodeName:n,expressions:[],injector:r},a=!0,s&&t.setAttribute(vt,n);var u=l.replaceWith,c="any"===u&&s;if(!rn(u)&&("any"!==u||c)&&u.toLowerCase()!==i){c&&(u="div");var h=g._document.createElement(u);h.nodeType===Node.ELEMENT_NODE&&(t=qn(t,h))}}var p=g._collectAttributes(t.attributes),_=g.getInstance();return p.element=t,!a&&tn(p.childContext)?(r=ui[B],a=!0,p.uiControlNode={control:r.inject(),resourceElement:null,nodeName:"plat-template-context",expressions:[],injector:r}):p.uiControlNode=o,_.initialize(p,e),p.hasControl||a?(_.setUiControlTemplate(),a?null:_):(_.bind=function(){return[]},_)},g.locateResources=function(t){for(var e,n,i=Array.prototype.slice.call(t.childNodes);0<i.length;)if((n=(e=i.shift()).nodeName.toLowerCase())===mt||n==="x-"+mt)return t.removeChild(e);return null},g.clone=function(t,e,n,i,r){if(ln(r)){var o=e.getUiControl();We(o)||(o=e.getParentControl()),r=g._cloneNodeMap(t.nodeMap,n,o,i)}var s=g.getInstance(),a=!ln(i);return s.nodeMap=r,ln(s.parent=e)||e.children.push(s),s.replace=t.replace,s.replaceNodeLength=t.replaceNodeLength,s.hasOwnContext=t.hasOwnContext,s.isClone=!0,r.hasControl||a||(s.bind=function(){return[]}),a&&g._managerCache.put(i.uid,s),s},g.cloneUiControl=function(t,e){var n=t.uiControlNode;if(!ln(n)&&!ln(n.injector)){var i=n.control,r=n.injector.inject(),o=g._ResourcesFactory.getInstance(),s=g._AttributesFactory.getInstance();return(r.parent=e).controls.push(r),r.controls=[],s.initialize(r,t.attributes),r.attributes=s,o.initialize(r,i.resources),r.resources=o,g._ResourcesFactory.addControlResources(r),ln(i.innerTemplate)||(r.innerTemplate=i.innerTemplate.cloneNode(!0)),r.type=i.type,r.bindableTemplates=g._BindableTemplatesFactory.create(r,i.bindableTemplates),r.replaceWith=i.replaceWith,r}},g.createAttributeControls=function(t,e,n,i,r){var o,s=t.nodes,a=!0===r?i:t.element;if(Je(a)){if(a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0===r?g._copyAttributeNodes(s):[];o=a.attributes}var l,u,c,h,p,_,f=t.attributes,d=[],v=s.length;for(_=0;_<v;_+=1)if(p=(u=s[_]).nodeName,h=null,ln(c=u.injector)||(h=c.inject(),(u.control=h).parent=e,h.element=a,(l=g._AttributesFactory.getInstance()).initialize(h,f),h.attributes=l,h.type=p,tn(h.uid)||(h.uid=wn(ht)),h.templateControl=n),!0===r){var m=null;We(o)&&(We(m=o.getNamedItem(p))||(m=o.getNamedItem(yt+p))),d.push({control:h,expressions:u.expressions,node:m,nodeName:p,injector:c}),ln(h)||(ln(e)||e.controls.push(h),an(h.initialize)&&h.initialize())}if(!r)for(s.sort(function(t,e){var n=t.control,i=e.control;if(ln(n))return 1;if(ln(i))return-1;var r=sn(n.priority)?n.priority:0;return(sn(i.priority)?i.priority:0)-r}),_=0;_<v;_+=1)ln(h=(u=s[_]).control)||(ln(e)||e.controls.push(h),an(h.initialize)&&h.initialize());return d},g.getInstance=function(){var t=new g;return t._Promise=fi(w),t._ContextManager=m._ContextManager,t._compiler=fi(_),t._CommentManagerFactory=fi(f),t._ControlFactory=fi(T),t._TemplateControlFactory=m._TemplateControlFactory,t._BindableTemplatesFactory=g._BindableTemplatesFactory,t._log=g._log,t},g._collectAttributes=function(t){for(var e,n,i,r,o,s,a,l,u=[],c=m.hasMarkup,h=m.findMarkup,p=m._parser,_=t.length,f={},d=!1,v=0;v<_;v+=1)i=(e=t[v]).value,n=e.name.replace(/^data-/i,"").toLowerCase(),We(l=si[n])||(l=ai[n]),n===gt?""!==i&&(1!==(r=p.parse(i)).identifiers.length&&g._log.warn("Incorrect "+gt+": "+i+", must contain a single identifier."),o=r.identifiers[0]):n!==vt&&(a=(s=c(i))?h(i):[],d||!s&&ln(l)||(d=!0),u.push({control:null,node:e,nodeName:n,expressions:a,injector:l})),f[Tn(n)]=i;return{element:null,attributes:f,nodes:u,childContext:o,hasControl:d}},g._copyAttributeNodes=function(t){for(var e,n=[],i=t.length,r=0;r<i;r+=1)e=t[r],n.push({expressions:e.expressions,nodeName:e.nodeName});return n},g._cloneNode=function(t,e,n){return{control:n,injector:t.injector,expressions:t.expressions,node:e,nodeName:t.nodeName}},g._cloneNodeMap=function(t,e,n,i){var r=t.hasControl,o={attributes:t.attributes,childContext:t.childContext,nodes:[],element:e,uiControlNode:ln(t.uiControlNode)?null:g._cloneNode(t.uiControlNode,e,i),hasControl:r};return r&&(o.nodes=g.createAttributeControls(t,n,i,e,!0)),o},g.prototype.clone=function(t,e,n){var i,r,o,s,a=this.replace,l=this.children,u=ln(n)?null:n.uiControlNode.control,c=!ln(u);if(!c){var h=e.getUiControl();We(h)||(h=e.getParentControl()),c=!ln(u=g.cloneUiControl(this.nodeMap,h))}if(a){var p=t.parentNode.childNodes,_=Array.prototype,f=_.indexOf.call(p,t);i=_.slice.call(p,f+1,f+this.replaceNodeLength),r=g.clone(this,e,null,u,n),u.elementNodes=i,u.startNode=t,u.endNode=i.pop(),o=l.shift(),s=l.shift(),o.clone(u.startNode,r),s.clone(u.endNode,r),an(u.initialize)&&u.initialize()}else i=Array.prototype.slice.call(t.childNodes),n=(r=g.clone(this,e,t,u,n)).nodeMap,c&&(u.element=t,an(u.initialize)&&u.initialize());for(var d=l.length,v=0,m=0;m<d;m+=1)v+=l[m].clone(i[v],r);return a?(l.unshift(s),l.unshift(o),v+2):1},g.prototype.initialize=function(t,e,n){s.prototype.initialize.call(this,t,e);var i,r=t.uiControlNode,o=!ln(r);o&&(this._populateUiControl(),i=r.control,this.hasOwnContext=i.hasOwnContext),t.hasControl&&g.createAttributeControls(t,this.getParentControl(),i),!n&&o&&an(i.initialize)&&i.initialize()},g.prototype.bind=function(){var r=this,t=this.nodeMap,e=this.getParentControl(),n=t.uiControlNode,i=[];if(!ln(n)){var o,s=n.control,a=this._TemplateControlFactory,l=!s.hasOwnContext,u=this._ContextManager.getManager,c=t.childContext,h=ln(e)?W:e.absoluteContextPath;if(i.push(s),l&&!ln(c))if("@"===c[0]){var p=c.split("."),_=p.shift().slice(1),f=a.findResource(s,_);if(We(f)){var d=f.resource;c=0<p.length?"."+p.join("."):"",_===Ae?h+=c:_===je?h=W+c:d.type===Te||d.type===Ie?(h="resources."+_+".value"+c,s.root=f.control):this._log.warn('Only resources of type "observable" can be set as context.')}else this._log.warn("Could not set the context of "+s.type+' with the resource specified as "'+c+'".')}else h+="."+c;We(s.root)||(s.root=this._ControlFactory.getRootControl(s),We(s.root)||(s.root=s)),o=u(s.root);var v=!1;l?(s.context=o.getContext(h.split("."),!1),v=un(s.context)&&!this._BindableTemplatesFactory.isBoundControl(s)):h=W,v?this.contextPromise=new this._Promise(function(n,t){var i=o.observe(h,{uid:s.uid,listener:function(t,e){un(t)||(i(),s.context=t,r._beforeLoad(s,h),n())}})}):this._beforeLoad(s,h)}return this._observeControlIdentifiers(t.nodes,e,i,t.element),i},g.prototype.setUiControlTemplate=function(t){var n=this,e=this.nodeMap.uiControlNode;if(ln(e))ln(this.parent)&&this.bindAndLoad();else{var i=e.control;this.templatePromise=this._TemplateControlFactory.determineTemplate(i,t).then(function(t){n.templatePromise=null,n._initializeControl(i,t.cloneNode(!0))},function(t){if(n.templatePromise=null,ln(t)){var e=t;n._BindableTemplatesFactory.isBoundControl(i)&&(e=Dn(i.element.childNodes)),n._initializeControl(i,e)}else bn(function(){tn(t)&&(t=new Error(t)),n._log.error(t)})})}},g.prototype.getUiControl=function(){var t=this.nodeMap.uiControlNode;if(!ln(t))return t.control},g.prototype.fulfillTemplate=function(){var t=this;return ln(this.templatePromise)?this._fulfillChildTemplates():this.templatePromise.then(function(){return t._fulfillChildTemplates()})},g.prototype.fulfillAndLoad=function(){var e=this;return this.fulfillTemplate().then(function(){return e.bindAndLoad()}).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),e._log.error(t)})})},g.prototype.bindAndLoad=function(){var e=this,t=this.bind();return(nn(this.contextPromise)?this.contextPromise.then(function(){return e._bindChildren()}):this._bindChildren()).then(function(){return e._loadControls(t,e.getUiControl())}).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),e._log.error(t)})})},g.prototype.observeRootContext=function(n,i){var r=this;return i=i.bind(this),ln(n.context)?new this._Promise(function(t){var e=r._ContextManager.getManager(n).observe(W,{listener:function(){e(),i().then(t)},uid:n.uid})}).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),r._log.error(t)})}):i()},g.prototype._beforeLoad=function(n,t){var e=this._ContextManager.getManager(n.root),i=this._TemplateControlFactory;n.zCC__plat=e.observe(t,{uid:n.uid,priority:1e3,listener:function(t,e){n.context=t}}),i.setAbsoluteContextPath(n,t),i.setContextResources(n),g._ResourcesFactory.bindResources(n.resources)},g.prototype._bindChildren=function(){for(var t,e=this.children,n=e.length,i=[],r=0;r<n;r+=1)(t=e[r]).hasOwnContext?this.isClone?i.push(t.observeRootContext(t.getUiControl(),t.bindAndLoad)):i.push(t.observeRootContext(t.getUiControl(),t.fulfillAndLoad)):un(t.children)?t.bind():i.push(t.bindAndLoad());return this._Promise.all(i)},g.prototype._loadControls=function(t,e){var n,i,r,o,s=t.length,a=this._ControlFactory.load,l=ln(e);if(l)o=0;else{var u=e.priority;r=sn(u)?u:100,o=1}for(;o<s;o+=1)(n=t[o]).templateControl=e,!l&&r>n.priority&&(l=!0,i=a(e)),a(n);return l||(i=a(e)),i},g.prototype._populateUiControl=function(){var t=this.nodeMap,e=this.getParentControl(),n=t.uiControlNode,i=n.control,r=t.element,o=Array.prototype.slice.call(r.childNodes),s=g._AttributesFactory.getInstance(),a=this.replace=null===i.replaceWith||""===i.replaceWith,l=i.uid,u=i.resources;tn(l)||(l=i.uid=wn(ht)),g._managerCache.put(l,this),ln(e)||i.parent===e||(e.controls.push(i),i.parent=e),an(r.setAttribute)&&r.setAttribute(Dt,""),i.element=r,i.controls=[],s.initialize(i,t.attributes),i.attributes=s,We(u)&&an(u.add)?u.add(n.resourceElement):((u=g._ResourcesFactory.getInstance()).initialize(i,n.resourceElement),i.resources=u),g._ResourcesFactory.addControlResources(i),i.type=n.nodeName,We(i.bindableTemplates)||(i.bindableTemplates=this._BindableTemplatesFactory.create(i)),!(0<o.length)||rn(i.templateString)&&rn(i.templateUrl)||(i.innerTemplate=Dn(o)),a&&this._replaceElement(i,t)},g.prototype._replaceElement=function(t,e){var n=e.element,i=n.parentNode,r=g._document,o=t.type,s=t.uid,a=t.startNode=r.createComment(o+" "+s+Ce),l=t.endNode=r.createComment(o+" "+s+xe),u=this._CommentManagerFactory.create;u(a,this),u(l,this),i.insertBefore(a,n),i.insertBefore(l,n.nextSibling),t.elementNodes=Vn(n),t.element=e.element=null},g.prototype._initializeControl=function(t,e){var n,i=this.nodeMap.element,r=this.replace;if(!ln(e)){var o=g.locateResources(e);ln(o)||t.resources.add(g._ResourcesFactory.parseElement(o)),r?(n=t.endNode,t.elementNodes=Array.prototype.slice.call(e.childNodes),Un(n.parentNode,e,n)):Un(i,e,i.lastChild)}if(an(t.setTemplate)&&t.setTemplate(),r){this._compiler.compile(t.elementNodes,t);var s=t.startNode,a=s.parentNode,l=Array.prototype.slice.call(a.childNodes);n=t.endNode,t.elementNodes=l.slice(l.indexOf(s)+1,l.indexOf(n)),this.replaceNodeLength=t.elementNodes.length+2}else this._compiler.compile(i,t);ln(t.parent)&&this.fulfillAndLoad()},g.prototype._observeControlIdentifiers=function(t,e,n,i){for(var r,o,s,a=!ln(e),l=this.replace,u=[],c=t.length,h=0;h<c;h+=1)o=(r=t[h]).control,a&&0<r.expressions.length&&(s=p.getInstance(),u.push(s),s.initialize(i,r,e,n,l),m.observeExpressions(r.expressions,e,s.attributeChanged.bind(s))),ln(o)||n.push(o);for(c=u.length,h=0;h<c;h+=1)u[h].attributeChanged()},g.prototype._fulfillChildTemplates=function(){for(var t,e=this,n=this.children,i=n.length,r=[],o=0;o<i;o+=1)un((t=n[o]).children)||r.push(t.fulfillTemplate());return this._Promise.all(r).catch(function(t){bn(function(){tn(t)&&(t=new Error(t)),e._log.error(t)})})},g._inject={_Promise:w,_ContextManager:Z,_compiler:_,_CommentManagerFactory:f,_ControlFactory:T,_TemplateControlFactory:z,_BindableTemplatesFactory:F,_log:k},g}(m);function i(t,e,n,i,r,o){return s._document=t,s._managerCache=e,s._ResourcesFactory=n,s._AttributesFactory=i,s._BindableTemplatesFactory=r,s._log=o,s}t.ElementManager=s,t.IElementManagerFactory=i,Zn.injectable(I,i,[G,A,$,O,F,k],me),Zn.injectable("$ElementManagerInstance",s,null,ve);var r=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="text",t}return __extends(o,e),o.create=function(t,e){var n=t.nodeValue,i=new o;if(m.hasMarkup(n)){var r={nodes:[{node:t,expressions:m.findMarkup(n)}]};return i.initialize(r,e),i}return i.initialize(null,e),i.bind=qe,i},o._cloneNodeMap=function(t,e){var n=t.nodes[0];return{nodes:[{expressions:n.expressions,nodeName:n.nodeName,node:e}]}},o._clone=function(t,e,n){var i=t.nodeMap,r=new o;return ln(i)?(r.initialize(null,n),r.bind=qe):r.initialize(o._cloneNodeMap(i,e),n),r},o.prototype.clone=function(t,e){return o._clone(this,t,e),1},o.prototype.bind=function(){var t=this.getParentControl(),e=this.nodeMap.nodes[0],n=e.node,i=e.expressions;m.observeExpressions(e.expressions,t,this._setText.bind(this,n,t,i)),this._setText(n,t,i)},o.prototype._setText=function(t,e,n){We(e)||(e={}),t.nodeValue=m.build(n,e)},o}(m);function o(){return r}t.TextManager=r,t.ITextManagerFactory=o,Zn.injectable(j,o,null,me),Zn.injectable("$TextManagerInstance",r,null,ve);var a=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="comment",t}return __extends(i,e),i.create=function(t,e){var n=new i;return n.initialize({nodes:[{node:t}]},e),n},i.prototype.clone=function(t,e){return i.create(t,e),1},i}(m);function l(){return a}t.CommentManager=a,t.ICommentManagerFactory=l,Zn.injectable(f,l,null,me),Zn.injectable("$CommentManagerInstance",a,null,ve);var p=function(){function e(){this._lastValues={}}return e.getInstance=function(){var t=new e;return t._NodeManager=fi(v),t},e.prototype.initialize=function(t,e,n,i,r){this.element=t,this.node=e,this.parent=n,this._controls=i,this.replace=r,e.nodeName!==ge?this.attributeChanged=this._staticAttributeChanged:this.attributeChanged=this._dynamicAttributeChanged},e.prototype._dynamicAttributeChanged=function(){var t,e,n=this.node,i=n.node,r=this._NodeManager,o=this._lastValues,s=this.element,a=i.value,l=r.build(n.expressions,this.parent).trim().split(/\s+/),u=l.length;if(r.hasMarkup(a)){for(var c=_e[_e.length-1],h=a.indexOf(pe),p=a.indexOf(_e);-1!==h&&-1!==p;){for(;a[p]!==c||a[p+1]===c;)p+=1;p+=1,h=(a=a.slice(0,h).trim()+" "+a.slice(p).trim()).indexOf(pe),p=a.indexOf(_e)}i.value=a.trim()}for(e=0;e<u;e+=1)o[l[e]]=!0;for(u=(l=Object.keys(o)).length,e=0;e<u;e+=1)o[t=l[e]]?(Gn(s,t),o[t]=!1):(Nn(o,t),Jn(s,t));this._notifyAttributes(n.nodeName,i.value)},e.prototype._staticAttributeChanged=function(){this._controls;var t=this.node,e=Tn(t.nodeName),n=this._NodeManager.build(t.expressions,this.parent);this._notifyAttributes(e,n),this.replace||(t.node.value=n)},e.prototype._notifyAttributes=function(t,e){for(var n,i,r=this._controls,o=r.length,s=0;s<o;s+=1)i=(n=r[s].attributes)[t],n[t]=e,n._attributeChanged(t,e,i)},e}();t.AttributeManager=p}(d.processing||(d.processing={})),function(t){var e=function(){function o(){this.uid=wn(ht),this.isRoot=!1,this._removeUrlListener=qe,this._ignoreOnce=!1,this._backNavigate=!1}return o.prototype.initialize=function(t){We(this._router=t)&&t.isRoot&&!We(o._root)&&(this.isRoot=!0,(o._root=this)._observeUrl())},o.prototype.navigate=function(e,n){var i,r=this;return n=We(n)?n:{},this.finishNavigating().then(function(){if(!tn(i=n.isUrl?e:r._generate(e,n.parameters,n.query))){var t=new Error("Cannot serialize url from input parameters, check your view reference.");r._log.error(t)}return r._navigate(i,n.replace)})},o.prototype.finishNavigating=function(){var t=o._root._router;return t.navigating?t.finishNavigating.catch(qe):this._Promise.resolve()},o.prototype.goBack=function(t){var e=this;t=We(t)?t:{};var n=Number(t.length);return sn(n)||(n=1),this.isRoot?this.finishNavigating().then(function(){return e._backNavigate=!0,e._goBack(n)}):o._root.goBack(t)},o.prototype.isBackNavigation=function(){return this.isRoot?this._backNavigate:o._root.isBackNavigation()},o.prototype.dispose=function(){this._removeUrlListener(),Nn(this,"router")},o.prototype._navigate=function(n,i){var r=this;return this.isRoot?new this._Promise(function(t,e){r._resolveNavigate=t,r._rejectNavigate=e,r._browser.url()===r._browser.url(n,i)&&r._resolveNavigate()}):o._root._navigate(n,i)},o.prototype._goBack=function(n){var i=this;return new this._Promise(function(t,e){i._resolveNavigate=t,i._rejectNavigate=e,i._browser.back(n)})},o.prototype._observeUrl=function(){var i=this;if(We(this._router)){var r,n=this._EventManager,o=fi("head"),s=We(o)&&an(o.navigated),a=function(t){i._previousUrl=r;var e=i._history,n=e.state;i._ignoreOnce=!0,ln(n.previousLocation)||n.previousLocation===r?e.go(-1):e.go(1),i._backNavigate=!1,an(i._rejectNavigate)&&i._rejectNavigate(t),rn(t)||i._log.warn(t)};this._previousUrl=this._browser.url(),n.dispose(this.uid),n.on(this.uid,Ft,function(){n.dispatch("backButtonPressed",i,n.DIRECT).defaultPrevented||i.goBack()}),n.on(this.uid,Pt,function(t,e){if(i._ignoreOnce)return i._ignoreOnce=!1,void(an(i._resolveNavigate)&&(i._backNavigate=!1,i._resolveNavigate()));r=i._previousUrl,n.dispatch(At,i,n.DIRECT,[e]).defaultPrevented?a(new Error("Navigation prevented during "+At+" event")):i.finishNavigating().then(function(){return n.dispatch(Lt,i,n.DIRECT,[e]),i._router.navigate(e.pathname,e.query)}).then(function(){i._previousUrl=e.pathname,an(i._resolveNavigate)&&(i._backNavigate=!1,i._resolveNavigate()),s&&o.navigated(e.href),n.dispatch("navigated",i,n.DIRECT,[e])},a)})}},o.prototype._generate=function(t,e,n){if(!ln(this._router))return rn(t)?t:this._router.generate(t,e,n)},o._inject={_Promise:w,_Injector:lt,_browserConfig:V,_browser:tt,_EventManager:N,_window:Q,_log:k,_history:ut},o}();function n(t){return t.history}t.Navigator=e,Zn.injectable(S,e,null,ve),t.History=n,Zn.injectable(ut,n,[Q]);var _,i=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),f={},d={},v={},r=function(){function p(){this.type=he,this.name="",this.regex=""}return p.parse=function(t,e,n){if(!(tn(t)&&cn(e)&&We(n)))return[];"/"===t[0]&&(t=t.slice(1));for(var i,r,o,s=t.split("/"),a=s.length,l=p.__findSegment,u=[],c=p._regex,h=0;h<a;h+=1)""!==(i=s[h])?We(o=i.match(c.dynamicSegmentsRegex))?(r=o[1],u.push(l(r,it,f)),e.push(r),n.dynamics+=1):We(o=i.match(c.splatSegmentRegex))?(r=o[1],u.push(l(r,rt,d)),e.push(r),n.splats+=1):(u.push(l(i,nt,v)),n.statics+=1):(We(_)||(_=fi(et)),u.push(_));return u},p.__findSegment=function(t,e,n){var i=n[t];return We(i)||(i=n[t]=fi(e)).initialize(t),i},p.prototype.initialize=function(t){this.name=t},p.prototype.reduceCharacters=function(t,e){return We(this._specification)&&(e=t(e,this._specification)),e},p.prototype.generate=function(t){return this.name},p}();function o(t){return r._regex=t,r}t.BaseSegment=r,t.IBaseSegmentFactory=o,Zn.injectable(Y,o,[K],me),Zn.injectable(et,r,null,ve);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="static",t}return __extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.regex=this.name.replace(i,"\\$1")},t.prototype.reduceCharacters=function(t,e){for(var n=this.name,i=n.length,r=e,o=0;o<i;o+=1)r=t(r,{validCharacters:n[o]});return r},t}(r);t.StaticSegment=s,Zn.injectable(nt,s,null,ve);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="variable",t}return __extends(t,e),t.prototype.generate=function(t){if(We(t))return t[this.name]},t}(r);t.VariableSegment=a,Zn.injectable("$VariableSegmentInstance",a,null,ve);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="splat",t.regex="(.+)",t._specification={invalidCharacters:"",repeat:!0},t}return __extends(t,e),t}(a);t.SplatSegment=l,Zn.injectable(rt,l,null,ve);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dynamic",t.regex="([^/]+)",t._specification={invalidCharacters:"/",repeat:!0},t}return __extends(t,e),t}(a);t.DynamicSegment=u,Zn.injectable(it,u,null,ve);var c=function(){function n(){this.initialize()}return n.compile=function(t,e){return t.reduceCharacters(function(t,e){return t.add(e)},e)},n.link=function(t,e){for(var n,i,r,o,s,a=t.delegates,l=t.regex,u=a.length,c=e.match(l),h=[],p=1,_=0;_<u;_+=1){for(i={},o=(n=(s=a[_]).names).length,r=0;r<o;r+=1)i[n[r]]=c[p],p+=1;h.push({delegate:s.delegate,parameters:i,isDynamic:0<o})}return h},n.recognize=function(t,e){for(var n,i=[],r=e.length,o=0;o<r;o+=1)n=e[o],i=i.concat(n.match(t));return i},n.sort=function(t){return cn(t)?t.sort(function(t,e){if(n=t.types,s=e.types,i=n.splats,a=s.splats,i!==a)return i-a;if(r=n.statics,o=n.dynamics,l=s.statics,u=s.dynamics,0<i){if(r!==l)return l-r;if(o!==u)return u-o}return o!==u?o-u:r!==l?l=r:0}):t;var n,i,r,o,s,a,l,u},n.prototype.initialize=function(t){this.specification=t,this.nextStates=[]},n.prototype.add=function(t){var e=this._find(t);return We(e)||((e=fi(n)).initialize(t),this.nextStates.push(e),t.repeat&&e.nextStates.push(e)),e},n.prototype.match=function(e){var n,i,r=[];return this._someChildren(function(t){n=t.specification,tn(i=n.validCharacters)&&-1<i.indexOf(e)?r.push(t):tn(i=n.invalidCharacters)&&-1===i.indexOf(e)&&r.push(t)}),r},n.prototype._find=function(t){var e,n,i=t.validCharacters,r=t.invalidCharacters;return this._someChildren(function(t){if((e=t.specification).validCharacters===i&&e.invalidCharacters===r)return n=t,!0}),n},n.prototype._someChildren=function(t){for(var e=this.nextStates,n=e.length,i=0;i<n;i+=1)if(!0===t(e[i]))return!0;return!1},n}();function h(){return c}t.State=c,t.IStateStatic=h,Zn.injectable(ot,h,null,fe),Zn.injectable(st,c,null,ve);var p=function(){function t(){this._namedRoutes={}}return t.prototype.register=function(t,e){if(cn(t)){for(var n,i=this._rootState,r=t.length,o=["^"],s={statics:0,dynamics:0,splats:0},a=[],l=[],u=0;u<r;u+=1)n=this._parse(t[u],a,s),l=l.concat(n),i=this._compile(n,i,o);(i=this._finalize(i,o)).delegates=a,i.regex=new RegExp(o.join("")+"$"),i.types=s,We(e)&&tn(e.name)&&(this._namedRoutes[this._toLowerCase(e.name)]={segments:l,delegates:a})}},t.prototype.recognize=function(t){var e,n;return t=this._addLeadingSlash(t),(e=this._hasTrailingSlash(t))&&(t=t.substr(0,t.length-1)),n=this._filter(this._findStates(t)),this._link(n[0],t,e)},t.prototype.generate=function(t,e){t=this._toLowerCase(t);var n,i,r=this._namedRoutes[t],o="";if(We(r)){i=(n=r.segments).length;for(var s=0;s<i;s+=1){var a=n[s];a.type!==he&&(o+="/",o+=a.generate(e))}return o=this._addLeadingSlash(o)}},t.prototype.delegatesFor=function(t){t=this._toLowerCase(t);var e,n=this._namedRoutes[t];return We(n)&&cn(e=n.delegates)?e.slice(0):[]},t.prototype.exists=function(t){return We(this._namedRoutes[this._toLowerCase(t)])},t.prototype._toLowerCase=function(t){return tn(t)?t.toLowerCase():t},t.prototype._finalize=function(t,e){return t===this._rootState&&(t=t.add({validCharacters:"/"}),e.push("/")),t},t.prototype._parse=function(t,e,n){var i=[];return e.push({delegate:t.delegate,names:i}),this._BaseSegmentFactory.parse(t.pattern,i,n)},t.prototype._compile=function(t,e,n){for(var i,r=t.length,o=this._State.compile,s=0;s<r;s+=1)(i=t[s]).type!==he&&(e=o(i,e=e.add({validCharacters:"/"})),n.push("/"+i.regex));return e},t.prototype._addLeadingSlash=function(t){return"/"!==(t=decodeURI(t))[0]&&(t="/"+t),t},t.prototype._hasTrailingSlash=function(t){var e=t.length;return 1<e&&"/"===t[e-1]},t.prototype._findStates=function(t){for(var e=[this._rootState],n=this._State.recognize,i=t.length,r=0;r<i&&0!==(e=n(t[r],e)).length;r+=1);return e},t.prototype._filter=function(t){for(var e,n=t.length,i=[],r=0;r<n;r+=1)cn((e=t[r]).delegates)&&i.push(e);return this._State.sort(i)},t.prototype._link=function(t,e,n){if(We(t)&&cn(t.delegates))return n&&this._isDynamic(t)&&(e+="/"),this._State.link(t,e)},t.prototype._isDynamic=function(t){return"(.+)$"===t.regex.source.slice(-5)},t._inject={_BaseSegmentFactory:Y,_State:ot,_rootState:st},t}();t.RouteRecognizer=p,Zn.injectable(at,p,null,ve);var m="/*childRoute",b=m.length,g=function(){function i(){this.navigating=!1,this.children=[],this.isRoot=!1,this._paramTransforms={},this._queryTransforms={},this._interceptors={},this._ports=[],this._resolve=this._Promise.resolve.bind(this._Promise),this._reject=this._Promise.reject.bind(this._Promise),this.uid=wn(ht),this.isRoot=ln(i.currentRouter()),i.currentRouter(this),this.initialize()}return i.currentRouter=function(t){return ln(t)||(i.__currentRouter=t),i.__currentRouter},i.prototype.initialize=function(t){this.parent=t},i.prototype.addChild=function(t){return ln(t)||-1<this.children.indexOf(t)||(t.initialize(this),this.children.push(t)),t},i.prototype.removeChild=function(t){var e=this.children,n=e.indexOf(t);n<0||(e.splice(n,1),i.currentRouter()===t&&i.currentRouter(this))},i.prototype.register=function(t){var n=this,e=this._ports;return ln(t)||-1<e.indexOf(t)?this._resolve():(e.push(t),We(this.currentRouteInfo)?(this.navigating=!0,this._resolve(this.finishNavigating).catch(qe).then(function(){var e=Ye(n.currentRouteInfo,!0);return n.finishNavigating=n._canNavigateTo(e).then(function(t){if(t)return n.currentRouteInfo=void 0,n._performNavigation(e)}).then(function(){n.navigating=!1,n.currentRouteInfo=e},function(){n.navigating=!1})})):this._resolve())},i.prototype.unregister=function(t){var e=this._ports,n=e.indexOf(t);n<0||(e.splice(n,1),0!==e.length||ln(this.parent)||this.parent.removeChild(this))},i.prototype.configure=function(t,e){var n=this;return cn(t)?fn(function(t){n._configureRoute(t)},t):this._configureRoute(t),!1!==e?this._forceNavigate():this._resolve()},i.prototype.unknown=function(t){return this._unknownHandler=t,this},i.prototype.param=function(t,e,n){return this._addHandler(t,e,n,this._paramTransforms)},i.prototype.queryParam=function(t,e,n){return this._addHandler(t,e,n,this._queryTransforms)},i.prototype.intercept=function(t,e){un(e)&&(e="*");var n=e;"*"!==e&&(e=this._Injector.convertDependency(e)),e===Ee&&(e=n);var i=this._interceptors[e];return cn(i)||(i=this._interceptors[e]=[]),i.push(t),this},i.prototype.navigate=function(e,t,n,i){var r=this;!1===i&&(i=!We(this.currentRouteInfo)),We(t)||(t={});var o=this._resolve,s=In(t);if("/"===e&&(e=""),n=!0===n,!tn(e)||this.navigating||!n&&e===this._previousUrl&&s===this._previousQuery)return this.navigating?this.finishNavigating.then(function(){return r.navigate(e,t,n)}):o();var a,l,u,c=this._recognizer,h=c.recognize(e),p=rn(h);p||((a=h[0]).query=t);var _=this._isSameRoute(a);if(p||_){var f=e;if(_){var d=a.delegate.alias;rn(d)&&(d=a.delegate.view),u=c.generate(d,a.parameters),f=f.replace(u,"")}if("/"===f||""===f?(f="",yn(function(t){return!rn(h=t._recognizer.recognize(f))},this.children)):h=this._childRecognizer.recognize(f),rn(h)){if(p){if(this._previousUrl=f,this._previousQuery=s,this.currentRouteInfo=a,an(this._unknownHandler)){var v={segment:e,view:void 0};return o(this._unknownHandler(v)).then(function(){var t=v.view;if(!un(t))return r.configure({pattern:e,view:t})})}return o()}h=c.recognize(e),(a=h[0]).query=t,l=a.delegate.pattern}else if((a=h[0]).query=t,l=(l=a.delegate.pattern).slice(0,l.length-b),!p||this._isSameRoute(a))return this.navigating=!0,this.finishNavigating=this._navigateChildren(a).then(function(){r._previousUrl=e,r._previousQuery=s,r.navigating=!1},function(t){throw r.navigating=!1,t})}else l=a.delegate.pattern;var m=a.delegate.alias;rn(m)&&(m=a.delegate.view),u=c.generate(m,a.parameters);var g=this._previousSegment;this._previousSegment=u,this.navigating=!0;var y=this._nextRouteInfo=Ye(a,!0);return this.finishNavigating=this._canNavigate(a,i).then(function(t){if(!t)throw r.navigating=!1,new Error("Not cleared to navigate");return r._previousUrl=e,r._previousQuery=s,r._performNavigation(a)}).then(function(){r._previousPattern=l,r._previousSegment=u,r.currentRouteInfo=y,r.navigating=!1},function(t){throw r._previousSegment=g,r.navigating=!1,t})},i.prototype.generate=function(t,e,n){var i=t;(t=this._Injector.convertDependency(t))===Ee&&(t=i);for(var r=this,o="";!ln(r)&&!r._recognizer.exists(t);)r=r.parent;if(ln(r))throw new Error("Route for "+t+" does not exist.");for(var s,a=r._recognizer.generate(t,e);!ln(r=r.parent);)o=(s=ln(s=r._previousSegment)||"/"===s?"":s)+o;return o+a+In(n)},i.prototype._configureRoute=function(t){var e=this._Injector.convertDependency(t.view),n=t.alias;if(rn(n)&&(n=e),e!==Ee){t.view=e,rn(t.alias=n)&&(t.alias=e);var i={pattern:t.pattern,delegate:t},r=t.pattern+m,o={pattern:r,delegate:{pattern:r,view:e,alias:n}};this._recognizer.register([i],{name:n}),this._childRecognizer.register([o])}},i.prototype._addHandler=function(t,e,n,i){un(n)&&(n="*");var r=n;if("*"!==n&&(n=this._Injector.convertDependency(n)),n===Ee&&(n=r),rn(n)||rn(e))return this;var o=i[n];We(o)||(o=i[n]={});var s=o[e];return cn(s)||(s=o[e]=[]),s.push(t),this},i.prototype._forceNavigate=function(){var t,e=this;this._resolve;if(this.navigating)return this.finishNavigating.then(function(){return e._forceNavigate()});if(this.isRoot&&rn(this._previousUrl)){var n=this._browser.urlUtils();this._previousUrl=n.pathname,t=n.query}return rn(this._previousQuery)||(t=Sn(this._previousQuery)),this.navigate(this._previousUrl,t,!0)},i.prototype._navigateChildren=function(e,n){void 0===n&&(n=!0);var i=this._getChildRoute(e);return ln(i)?this._resolve():vn(function(t){return t.navigate(i,e.query,void 0,n)},this.children).then(qe)},i.prototype._getChildRoute=function(t){if(!ln(t)){var e=t.parameters.childRoute;return tn(e)||(e=""),"/"+e}},i.prototype._performNavigation=function(e){var t=this,n=this._isSameRoute(this._nextRouteInfo);return this._performNavigateFrom(n).then(function(){if(!n)return vn(function(t){return t.navigateTo(e)},t._ports)}).then(function(){return t._navigateChildren(e,!1)})},i.prototype._performNavigateFrom=function(t){var e=this;return vn(function(t){return t._performNavigateFrom()},this.children).then(function(){if(!t)return vn(function(t){return t.navigateFrom()},e._ports)}).then(qe)},i.prototype._canNavigate=function(e,t){var n=this;void 0===t&&(t=!0);var i=this._isSameRoute(this._nextRouteInfo);return t?this._canNavigateFrom(i).then(function(t){return t?n._canNavigateTo(e,i):t}):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return n._callInterceptors(e)}).then(function(){return!0},function(){return!0})},i.prototype._canNavigateFrom=function(e){var n=this;return this._Promise.all(this.children.reduce(function(t,e){return t.concat(e._canNavigateFrom())},[])).then(jn).then(function(t){return!t||e?[t]:vn(function(t){return t.canNavigateFrom()},n._ports)}).then(jn)},i.prototype._canNavigateTo=function(e,n){var i=this;return rn(this._ports)?this._resolve(!0):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return i._callInterceptors(e)}).then(function(t){return!1===t||n?[t]:vn(function(t){return t.canNavigateTo(e)},i._ports)}).then(jn)},i.prototype._callAllHandlers=function(t,e,n){var i=this;return this._callHandlers(this._queryTransforms["*"],n,void 0,!0).then(function(){return i._callHandlers(i._queryTransforms[t],n,void 0,!0)}).then(function(){return i._callHandlers(i._paramTransforms["*"],e,n)}).then(function(){return i._callHandlers(i._paramTransforms[t],e,n)}).then(qe)},i.prototype._callHandlers=function(t,n,i,r){var o=this._resolve;return We(n)||(n={}),vn(function(t,e){return gn(function(t){return!0!==r&&un(n[e])?o():o(t(n[e],n,i))},t)},t).then(qe)},i.prototype._callInterceptors=function(e){var n=this,i=this._resolve;return gn(function(t){return i(t(e))},this._interceptors["*"]).then(jn).then(function(t){return t?vn(function(t){return i(t(e))},n._interceptors[e.delegate.alias]):[t]}).then(jn)},i.prototype._isSameRoute=function(t){var e=Ye(this.currentRouteInfo,!0);if(t=Ye(t,!0),this._sanitizeRouteInfo(e),this._sanitizeRouteInfo(t),!We(e)||!We(t))return!1;var n=e.delegate,i=t.delegate,r=In(e.parameters),o=In(t.parameters),s=In(e.query),a=In(t.query);return n.view===i.view&&n.alias===i.alias&&n.pattern===i.pattern&&r===o&&(s===a||0<this.children.length)},i.prototype._sanitizeRouteInfo=function(t){if(We(t)&&t.parameters.hasOwnProperty("childRoute")){var e=t.delegate,n=e.pattern;e.pattern=n.slice(0,n.length-b),Nn(t.parameters,"childRoute")}},i.prototype._clearInfo=function(){this._previousSegment=void 0,this._previousPattern=void 0,this._previousUrl=void 0,this._previousQuery=void 0,this.currentRouteInfo=void 0,this.navigating=!1,fn(function(t){t._clearInfo()},this.children)},i._inject={_Promise:w,_Injector:lt,_EventManager:N,_browser:tt,_browserConfig:V,_recognizer:at,_childRecognizer:at},i}();function y(){return g}t.Router=g,Zn.injectable("$Router",g,null,ve),t.IRouterStatic=y,Zn.injectable(q,y)}(d.routing||(d.routing={})),function(l){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){var t=Tn(this.type),e=this.attributes[t];rn(e)||this._isPrecompiled()||(this._label=e,this._define(e))},e.prototype.dispose=function(){for(var t=this._label,e=this.parent;!un(t)&&We(e);)We(e[t])&&Je(e[t].element)&&e[t].element===this.element&&Nn(e,t),e=e.parent},e.prototype._define=function(t){var e=this.templateControl;ln(e)||(e.name=t);for(var n={element:this.element,control:e},i=this.parent;We(i);){We(i[t])||(i[t]=n),i=i.parent}},e.prototype._isPrecompiled=function(){for(var t=this.parent;!ln(t);){if(-1!==t.type.indexOf(ye))return!0;t=t.parent}return!1},e}(Ri);l.Name=t,Zn.control("plat-name",t);var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._aliases=[],t}return __extends(t,e),t.prototype.loaded=function(){ln(this.element)||(this.attribute=Tn(this.type),this._setListener())},t.prototype._setListener=function(){var t=this.attributes[this.attribute];rn(this.event)||rn(t)||(this._parseArgs(t),this._addEventListeners())},t.prototype._addEventListeners=function(){this.addEventListener(this.element,this.event,this._onEvent,!1)},t.prototype._buildExpression=function(){var t,e,n,i=this.parent,r=this.templateControl,o=this._listener,s=qe;if(ln(r)?ln(i)||(e=i.getResources(this._aliases),n=i.context):(e=r.getResources(this._aliases),ln(i)||(n=i.context)),"@"===o[0]){if(!ln(e)){var a=o.split("."),l=e[a[0].slice(1)];if(We(l)){a.shift();for(var u=void 0;1<a.length&&!ln(l[u=a.shift()]);)l=l[u];1===a.length?an(l[u=a.shift()])&&(s=(t=l)[u]):this._log.warn('Invalid path for function "'+o+'"')}else an(l)&&(s=l)}}else{var c=this.findProperty(o,this.templateControl);if(ln(c))return this._log.warn("Could not find property "+o+" on any associated control."),{fn:qe,context:{},args:[]};var h=c.expression.identifiers;if(1<h.length)return this._log.warn("Cannot have more than one identifier in a "+this.type+"'s expression."),{fn:qe,context:{},args:[]};var p=h[0].split("."),_=c.control;if(p.pop(),0<p.length)for(var f=void 0;0<p.length&&!ln(_[f=p.shift()]);)_=_[f];s=c.value,t=_}return{fn:s,context:t,args:ln(this._args)?[]:this._args.evaluate(n,e)}},t.prototype._onEvent=function(t){var e=this._buildExpression(),n=e.fn;an(n)?n.apply(e.context,e.args.concat(t)):this._log.warn("Cannot find registered event method "+this._listener+" for control: "+this.type)},t.prototype._parseArgs=function(t){if(!rn(t)){var e,n=this._regex.argumentRegex.exec(t),i=[];if(ln(n))e=t;else if(e=t.slice(0,n.index),""!==n[1]){var r=this._parser.parse("["+n[1]+"]");i=r.aliases,this._args=r}if("@"===e[0]){var o=e.slice(1).split(".")[0];-1===i.indexOf(o)&&i.push(o)}this._listener=e,this._aliases=i}},t._inject={_parser:J,_regex:K},t}(Ri),n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Wt,t}return __extends(t,e),t}(l.SimpleEventControl=e);l.Tap=n;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="blur",t}return __extends(t,e),t}(e);l.Blur=i;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="change",t}return __extends(t,e),t}(e);l.Change=r;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="copy",t}return __extends(t,e),t}(e);l.Copy=o;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="cut",t}return __extends(t,e),t}(e);l.Cut=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="paste",t}return __extends(t,e),t}(e);l.Paste=a;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Xt,t}return __extends(t,e),t}(e);l.DblTap=u;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="focus",t}return __extends(t,e),t}(e);l.Focus=c;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$touchstart",t}return __extends(t,e),t}(e);l.TouchStart=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$touchend",t}return __extends(t,e),t}(e);l.TouchEnd=p;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$touchmove",t}return __extends(t,e),t}(e);l.TouchMove=_;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$touchcancel",t}return __extends(t,e),t}(e);l.TouchCancel=f;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$hold",t}return __extends(t,e),t}(e);l.Hold=d;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Gt,t}return __extends(t,e),t}(e);l.Release=v;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$swipe",t}return __extends(t,e),t}(e);l.Swipe=m;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Jt,t}return __extends(t,e),t}(e);l.SwipeLeft=g;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Kt,t}return __extends(t,e),t}(e);l.SwipeRight=y;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Zt,t}return __extends(t,e),t}(e);l.SwipeUp=b;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=te,t}return __extends(t,e),t}(e);l.SwipeDown=C;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="$track",t}return __extends(t,e),t}(e);l.Track=x;var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=ee,t}return __extends(t,e),t}(e);l.TrackLeft=E;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=ne,t}return __extends(t,e),t}(e);l.TrackRight=w;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=ie,t}return __extends(t,e),t}(e);l.TrackUp=T;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=re,t}return __extends(t,e),t}(e);l.TrackDown=N;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=oe,t}return __extends(t,e),t}(e);l.TrackEnd=k;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="submit",t}return __extends(t,e),t.prototype._onEvent=function(t){this.element.hasAttribute("action")||t.preventDefault(),e.prototype._onEvent.call(this,t)},t}(e);l.Submit=S;var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="input",t}return __extends(t,e),t.prototype._addEventListeners=function(){var e,n=this,t=this.element,i=this._compat,r=!1,o=!1,s=function(t){r||n._onEvent(t)},a=function(t){an(e)||(e=bn(function(){s(t),e=null}))};un(i.ANDROID)&&(this.addEventListener(t,"compositionstart",function(){r=!0},!1),this.addEventListener(t,"compositionend",function(t){r=!1,s(t)},!1)),this.addEventListener(t,"input",function(t){o=!0,s(t)},!1),this.addEventListener(t,"change",function(t){o?o=!1:s(t)},!1),i.hasEvent("input")||(this.addEventListener(t,"keydown",function(t){var e=t.keyCode,n=l.KeyCodes;e===n.lwk||e===n.rwk||e>=n.shift&&e<=n.escape||e>n.space&&e<=n.down||a(t)},!1),this.addEventListener(t,"cut",a,!1),this.addEventListener(t,"paste",a,!1))},t._inject={_compat:X},t}(e);l.React=I,Zn.control("plat-tap",n),Zn.control("plat-blur",i),Zn.control("plat-change",r),Zn.control("plat-copy",o),Zn.control("plat-cut",s),Zn.control("plat-paste",a),Zn.control("plat-dbltap",u),Zn.control("plat-focus",c),Zn.control("plat-submit",S),Zn.control("plat-touchstart",h),Zn.control("plat-touchend",p),Zn.control("plat-touchmove",_),Zn.control("plat-touchcancel",f),Zn.control("plat-hold",d),Zn.control("plat-release",v),Zn.control("plat-swipe",m),Zn.control("plat-swipeleft",g),Zn.control("plat-swiperight",y),Zn.control("plat-swipeup",b),Zn.control("plat-swipedown",C),Zn.control("plat-track",x),Zn.control("plat-trackleft",E),Zn.control("plat-trackright",w),Zn.control("plat-trackup",T),Zn.control("plat-trackdown",N),Zn.control("plat-trackend",k),Zn.control("plat-react",I),l.KeyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,"caps lock":20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,"left arrow":37,up:38,"up arrow":38,right:39,"right arrow":39,down:40,"down arrow":40,insert:45,delete:46,0:48,zero:48,")":48,"right parenthesis":48,1:49,one:49,"!":49,exclamation:49,"exclamation point":49,2:50,two:50,"@":50,at:50,3:51,three:51,"#":51,"number sign":51,hash:51,pound:51,4:52,four:52,$:52,dollar:52,"dollar sign":52,5:53,five:53,"%":53,percent:53,"percent sign":53,6:54,six:54,"^":54,caret:54,7:55,seven:55,"&":55,ampersand:55,8:56,eight:56,"*":56,asterisk:56,9:57,nine:57,"(":57,"left parenthesis":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lwk:91,"left window key":91,rwk:92,"right window key":92,select:93,"select key":93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"num lock":144,"scroll lock":145,";":186,"semi-colon":186,":":186,colon:186,"=":187,equal:187,"equal sign":187,"+":187,plus:187,",":188,comma:188,"<":188,lt:188,"less than":188,"left angle bracket":188,"-":189,dash:189,_:189,underscore:189,".":190,period:190,">":190,gt:190,"greater than":190,"right angle bracket":190,"/":191,"forward slash":191,"?":191,"question mark":191,"`":192,"grave accent":192,"~":192,tilde:192,"[":219,"open bracket":219,"{":219,"open brace":219,"\\":220,"back slash":220,"|":220,pipe:220,"]":221,"close bracket":221,"}":221,"close brace":221,"'":222,"single quote":222,'"':222,"double quote":222};var j=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.keyCodes={},t}return __extends(t,r),t.prototype._setListener=function(){var t=this.attribute;if(!rn(this.event)&&!rn(t)){var e=this.attributes[t].trim();if("{"===e[0]){var n=this.evaluateExpression(e);We(n)||(n={method:""});var i=this._filterArgs(n);return this._setKeyCodes(i),void this.addEventListener(this.element,this.event,this._onEvent,!1)}r.prototype._setListener.call(this)}},t.prototype._filterArgs=function(t){var e=t.key,n=t.keys;return this._parseArgs(t.method),cn(n)?n:tn(n)?[n]:cn(e)?e:tn(e)?[e]:void(ln(t.char)&&ln(t.chars)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},t.prototype._onEvent=function(t){this._compareKeys(t)&&r.prototype._onEvent.call(this,t)},t.prototype._compareKeys=function(t){var e=this.keyCodes,n=t.keyCode;return(ln(n)||0===n)&&(n=t.which),rn(e)||!0===e[n]},t.prototype._setKeyCodes=function(t){cn(t)||(t=[]);for(var e,n=t.length,i=this.keyCodes,r=0;r<n;r+=1)i[sn(e=t[r])?e:l.KeyCodes[e.toLowerCase()]]=!0},t}(e),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,e),t}(l.KeyCodeEventControl=j);l.KeyDown=R;var A=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,r),t.prototype._onEvent=function(t){var e=this,n=t.keyCode;if((ln(n)||0===n)&&(n=t.which),r.prototype._compareKeys.call(this,t)&&(48<=n&&n<=90||186<=n||96<=n&&n<=111))var i=this.addEventListener(this.element,"keypress",function(t){i(),r.prototype._onEvent.call(e,t)},!1)},t.prototype._compareKeys=function(t){return!0},t}(j);l.KeyPress=A;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keyup",t}return __extends(t,e),t}(j);l.KeyUp=L;var P=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.event="keypress",t}return __extends(t,r),t.prototype._filterArgs=function(t){var e=t.char,n=t.chars;return this._parseArgs(t.method),cn(n)?n:tn(n)?[n]:cn(e)?e:tn(e)?[e]:void(ln(t.key)&&ln(t.keys)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},t.prototype._onEvent=function(t){var e,n=this.keyCodes,i=t.charCode;if((ln(i)||0===i)&&(i=t.which),ln(i)||0===i){if(!tn(e=t.key))return}else e=String.fromCharCode(i);(rn(n)||!0===n[e])&&r.prototype._onEvent.call(this,t)},t.prototype._compareKeys=function(t){return!0},t.prototype._setKeyCodes=function(t){cn(t)||(t=[]);for(var e,n=t.length,i=this.keyCodes,r=0;r<n;r+=1)i[sn(e=t[r])?String.fromCharCode(e):e]=!0},t}(j);l.CharPress=P,Zn.control("plat-keydown",R),Zn.control("plat-keypress",A),Zn.control("plat-keyup",L),Zn.control("plat-charpress",P);var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t._stopSetter=qe,t}return __extends(t,e),t.prototype.loaded=function(){ln(this.element)||(this.attribute=Tn(this.type),this.setter(),this.__removeListener=this.attributes.observe(this.setter,this.attribute))},t.prototype.contextChanged=function(){ln(this.element)||this.setter()},t.prototype.dispose=function(){this._stopSetter(),an(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null)},t.prototype.setter=function(){var n=this;this._stopSetter(),this._stopSetter=En(function(){var t=n.element,e=n.property;if(Je(t))switch(n.attributes[n.attribute]){case"false":case"0":case"null":case"":t.setAttribute(e,""),t[e]=!1,t.removeAttribute(e);break;default:t.setAttribute(e,e),t[e]=!0}})},t}(Ri),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="checked",t}return __extends(t,e),t}(l.SetAttributeControl=O);l.Checked=F;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="disabled",t}return __extends(t,e),t}(O);l.Disabled=M;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="selected",t}return __extends(t,e),t}(O);l.Selected=D;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="readonly",t}return __extends(t,e),t}(O);l.ReadOnly=$;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="display",t.value="none",t.importance="important",t._initialValue="",t}return __extends(t,e),t.prototype.initialize=function(){var t=this.element.style;We(t)||(t={getPropertyValue:qe});var e=t.getPropertyValue(this.property);this._setValue(this.value,this.importance),rn(e)||"none"===e||(this._initialValue=e)},t.prototype.setter=function(){var t=this;this._stopSetter(),this._stopSetter=En(function(){if(Je(t.element))switch(t.attributes[t.attribute]){case"false":case"0":case"null":case"":t._setValue(t.value,t.importance);break;default:t._setValue(t._initialValue)}})},t.prototype._setValue=function(t,e){var n=this.property,i=this.element.style;We(i)||(i={setProperty:qe,removeProperty:qe,getPropertyValue:qe,getPropertyPriority:qe});var r=i.getPropertyValue(n),o=i.getPropertyPriority(n);t===r&&e===o||(rn(t)?i.removeProperty(n):i.setProperty(n,t,e))},t}(O);l.Visible=z;var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="style",t._styleRegex=/(.*?):(.*)/,t._urlRegex=/url\([^\)]*\)/gi,t._urlReplace="[PLAT-STYLE-URL]",t.__addedStyles=[],t.__oldStyles={},t}return __extends(t,e),t.prototype.setter=function(){var d=this;this._stopSetter();var v=this.element,m=this.attributes[this.attribute];rn(m)||ln(v)||(this._stopSetter=En(function(){var e=[],n=d._urlReplace;m=m.replace(d._urlRegex,function(t){return e.push(t),n});var t,i,r,o,s=v.style,a=d.__addedStyles,l=d.__oldStyles,u=[],c=m.split(";"),h={},p=d._styleRegex,_=c.length;for(o=0;o<_;o+=1)ln(r=p.exec(c[o]))||r.length<3||0===(t=r[1].trim()).length||un(s[t])||(-1===a.indexOf(t)&&(l[t]=s[t]),u.push(t),i=r[2].trim(),0<e.length&&-1!==i.indexOf(n)&&(i=i.replace(n,e.shift())),h[t]=i);for(_=a.length;0<_;)t=a[_-=1],-1===u.indexOf(t)&&(h[t]=l[t],a.splice(_,1));var f=Object.keys(h);for(_=f.length;0<_;)s[t=f[_-=1]]=h[t];d.__addedStyles=a.concat(u)}))},t}(O);l.Style=B,Zn.control("plat-checked",F),Zn.control("plat-disabled",M),Zn.control("plat-selected",D),Zn.control("plat-readonly",$),Zn.control("plat-visible",z),Zn.control("plat-style",B);var U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setter=function(){var t=this.element,e=this.property,n=this.attributes[this.attribute];rn(n)||ln(t)||un(t[e])||(t[e]=n)},e}(O),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="href",t}return __extends(t,e),t}(l.ElementPropertyControl=U);l.Href=V;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="src",t}return __extends(t,e),t.prototype.setter=function(){var t=this.element,e=this.property,n=this.attributes[this.attribute];rn(n)||ln(t)||un(t[e])||(t[e]=this._browser.urlUtils(n))},t._inject={_browser:tt},t}(U);l.Src=q,Zn.control("plat-href",V),Zn.control("plat-src",q);var H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=100,t._supportsTwoWayBinding=!1,t._dateRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/,t._dateTimeLocalRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])T(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9])(?:\.([0-9]+))?)?/,t.__fileSupported=fi(X).fileSupported,t.__fileNameRegex=fi(K).fileNameRegex,t.__isSelf=!1,t}return __extends(t,e),t.prototype.initialize=function(){this._determineType()},t.prototype.loaded=function(){var t=this.parent;if(!ln(t)&&!ln(this.element)){var e=Tn(this.type),n=this._parser,i=this._expression=n.parse(this.attributes[e]),r=i.identifiers;if(1!==r.length)return this._log.warn("Only 1 identifier allowed in a "+this.type+" expression."),void(this._contextExpression=null);var o=r[0].split(".");if(this._property=o.pop(),0<i.aliases.length){var s=i.aliases[0],a=t.findResource(s),l=void 0;if(We(a)){if((l=a.resource.type)!==Te&&l!==Ie)return}else a={resource:{}};this._contextExpression=s===Ae||s===je?n.parse(o.join(".")):(this._property="value",{evaluate:function(){return a.resource},aliases:[],identifiers:[],expression:""})}else 0<o.length?this._contextExpression=n.parse(o.join(".")):this._contextExpression={evaluate:function(){return t.context},aliases:[],identifiers:[],expression:""};this._supportsTwoWayBinding&&this.templateControl.observeProperties(this),this._watchExpression(),ln(this._addEventType)||this._addEventType()}},t.prototype.contextChanged=function(){this._watchExpression()},t.prototype.dispose=function(){this._addEventType=null},t.prototype.evaluate=function(){var t=this._expression;if(!un(t))return this.evaluateExpression(t)},t.prototype.observeProperty=function(t,e,n){return this._observeProperty(t,e,n)},t.prototype.observeArrayChange=function(t,e){return this._observeProperty(t,e,!1,!0)},t.prototype._addTextEventListener=function(){var t,e=this,n=this.element,i=this._compat,r=!1,o=function(){r||e._propertyChanged()},s=function(){an(t)||(t=bn(function(){o(),t=null}))};un(i.ANDROID)&&(this.addEventListener(n,"compositionstart",function(){r=!0},!1),this.addEventListener(n,"compositionend",function(){r=!1,o()},!1)),i.hasEvent("input")?this.addEventListener(n,"input",o,!1):(this.addEventListener(n,"keydown",function(t){var e=l.KeyCodes,n=t.keyCode;(ln(n)||0===n)&&(n=t.which),n===e.lwk||n===e.rwk||n>=e.shift&&n<=e.escape||n>e.space&&n<=e.down||s()},!1),this.addEventListener(n,"cut",s,!1),this.addEventListener(n,"paste",s,!1)),this.addEventListener(n,"change",o,!1)},t.prototype._addChangeEventListener=function(){this.addEventListener(this.element,"change",this._propertyChanged,!1)},t.prototype._addButtonEventListener=function(){this.addEventListener(this.element,Wt,this._propertyChanged,!1)},t.prototype._addRangeEventListener=function(){var t=this.element;this._compat.hasEvent("input")&&this.addEventListener(t,"input",this._propertyChanged,!1),this.addEventListener(t,"change",this._propertyChanged,!1)},t.prototype._getChecked=function(){return this.element.checked},t.prototype._getValue=function(){return this.element.value},t.prototype._getTextContent=function(){return this.element.textContent},t.prototype._getDate=function(){var t=this.element.value,e=this._dateRegex;if("string"!==this._propertyType&&e.test(t)){var n=e.exec(t);if(4===n.length)return new Date(Number(n[1]),Number(n[2])-1,Number(n[3]))}return t},t.prototype._getDateTimeLocal=function(){var t=this.element.value,e=this._dateTimeLocalRegex;if("string"!==this._propertyType&&e.test(t)){var n=e.exec(t);if(8===n.length)return ln(n[6])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5])):ln(n[7])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6])):new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6]),Number(n[7]))}return t},t.prototype._getFile=function(){var t=this.element,e=t.value;return this.__fileSupported?0<t.files.length?t.files[0]:null:{name:e.replace(this.__fileNameRegex,""),path:e,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:qe,msClose:qe,slice:function(){return{}}}},t.prototype._getFiles=function(){var t=this.element;if(this.__fileSupported)return Array.prototype.slice.call(t.files);for(var e,n=t.value.split(/,|;/g),i=n.length,r=[],o=function(){return{}},s=0;s<i;s+=1)e=n[s],r.push({name:e.replace(this.__fileNameRegex,""),path:e,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:qe,msClose:qe,slice:o});return r},t.prototype._getSelectedValues=function(){for(var t,e=this.element.options,n=e.length,i=[],r=0;r<n;r+=1)(t=e[r]).selected&&i.push(t.value);return i},t.prototype._setText=function(t,e,n){if(!this.__isSelf)return ln(t)&&!(t="")===n?(ln(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},t.prototype._setRange=function(t,e,n){if(!this.__isSelf)return rn(t)&&(t=""===t?"0":0,!0===n)?(rn(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},t.prototype._setHidden=function(t,e,n){if(!this.__isSelf)return rn(t)&&!(t="")===n?(rn(this.element.value)&&this._setValue(t),void this._propertyChanged()):void this._setValue(t)},t.prototype._setValue=function(t){var e=this.element;tn(t)||(sn(t)?(this._propertyType="number",t=t.toString()):on(t)&&(this._propertyType="boolean",t=t.toString())),e.value!==t&&(e.value=t)},t.prototype._setChecked=function(t,e,n){if(!this.__isSelf)return on(t)||(t=!!t,!0!==n)?void(this.element.checked=t):(this.element.checked=t,void this._propertyChanged())},t.prototype._setRadio=function(t){var e=this.element;this.__isSelf||(ln(t)?e.checked&&this._propertyChanged():(tn(t)||(sn(t)?(this._propertyType="number",t=t.toString()):on(t)&&(this._propertyType="boolean",t=t.toString())),e.checked=e.value===t))},t.prototype._setDate=function(t,e,n){if(!this.__isSelf){if(!pn(t))return this._dateRegex.test(t)?(this._propertyType="string",void this._setValue(t)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2);this._setValue(t.getFullYear()+"-"+r+"-"+i)}},t.prototype._setDateTimeLocal=function(t,e,n){if(!this.__isSelf){if(!pn(t))return this._dateTimeLocalRegex.test(t)?(this._propertyType="string",void this._setValue(t)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2),o=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),a=("0"+t.getSeconds()).slice(-2),l=t.getMilliseconds();this._setValue(t.getFullYear()+"-"+r+"-"+i+"T"+o+":"+s+":"+a+"."+l)}},t.prototype._setSelectedIndex=function(t,e,n){if(!this.__isSelf){var i=this.element,r=i.value;if(ln(t))return!0!==n&&this._document.body.contains(i)?void(i.selectedIndex=-1):void this._propertyChanged();if(tn(t)||(sn(t)?(this._propertyType="number",t=t.toString()):on(t)?(this._propertyType="boolean",t=t.toString()):this._log.info("Trying to bind an invalid value to a <select> element using a "+this.type+".")),r!==t){if(!this._document.body.contains(i))return i.value=t,void(i.value!==t&&(i.value=r,this._propertyChanged()));i.value=t,i.value===t&&-1!==i.selectedIndex||(i.selectedIndex=-1)}}},t.prototype._setSelectedIndices=function(t,e,n){if(!this.__isSelf){var i,r=ln(t),o=this.element.options,s=ln(o)?0:o.length;if(!r&&cn(t))for(var a,l,u,c=1/0;0<s;)if(a=(i=o[s-=1]).value,-1===t.indexOf(a)){l=Number(a),u=t.indexOf(l);var h=t.indexOf(!0),p=t.indexOf(!1);sn(l)&&-1!==u?(u<c&&(this._propertyType="number",c=u),i.selected=!0):i.selected=("true"===a&&-1!==h||"false"===a&&-1!==p)&&((u=-1!==h?h:p)<c&&(this._propertyType="boolean",c=u),!0)}else i.selected=!0;else for(!0===n&&this._propertyChanged();0<s;){if(i=o[s-=1],!r&&i.value===""+t)return void(i.selected=!0);i.selected=!1}}},t.prototype._determineType=function(){if(!this._observingBindableProperty()){var t=this.element;if(!ln(t))switch(t.nodeName.toLowerCase()){case"input":switch(t.type){case"button":case"submit":case"reset":case"image":this._addEventType=this._addButtonEventListener,this._getter=this._getValue;break;case"checkbox":this._addEventType=this._addChangeEventListener,this._getter=this._getChecked,this._setter=this._setChecked;break;case"radio":this._initializeRadio();break;case"range":this._addEventType=this._addRangeEventListener,this._getter=this._getValue,this._setter=this._setRange;break;case"date":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDate,this._setter=this._setDate;break;case"datetime-local":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDateTimeLocal,this._setter=this._setDateTimeLocal;break;case"file":this._propertyType="nullable";var e=t.multiple;this._addEventType=this._addChangeEventListener,this._getter=e?this._getFiles:this._getFile;break;case"hidden":this._getter=this._getValue,this._setter=this._setHidden;break;case"number":this._propertyType="number";default:this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText}break;case"textarea":this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText;break;case"select":this._initializeSelect();break;case"button":this._addEventType=this._addButtonEventListener,this._getter=this._getTextContent}}},t.prototype._watchExpression=function(){var t,n=this,e=this._contextExpression,i=this.evaluateExpression(e);if(!We(i)){if(!(ln(i)&&0<e.identifiers.length))return void this._log.warn("Cannot index into a non-object type: "+this.type+'="'+this._expression.expression+'"');i=this._createContext(e.identifiers[0])}if(an(this._setter)){this._setter===this._setSelectedIndices&&(ln(i[t=this._property])&&(i[t]=[]),this.observeArray(function(t){n._setter(t[0].object,null,!0)},e+"."+t));var r=this._expression;this.observeExpression(function(t,e){n._setter(t,e)},r),this._setter(this.evaluateExpression(r),void 0,!0)}},t.prototype._createContext=function(t){var e=t.split("."),n=e.shift().slice(1),i=this.parent;return n===je?(t=e.join("."),i=this.parent.root):n===W&&(t=e.join(".")),this._ContextManager.createContext(i,t)},t.prototype._castProperty=function(t,e){var n;if(ln(e)&&(e=this._propertyType),ln(e))return t;if(We(t))if(cn(t)){var i=t.length;n=[];for(var r=0;r<i;r+=1)n.push(this._castProperty(t[r],e))}else if(pn(t)||Ze(t)||nn(t)||Xe(t)||Je(t))n=t;else{var o=Object.keys(t),s=void 0;for(n={};0<o.length;)n[s=o.pop()]=t[s]}else switch(e){case"string":n=tn(t)?t:an(t.toString)?t.toString():Object.prototype.toString.call(t);break;case"number":n=rn(t)?null:Number(t);break;case"boolean":switch(t){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!t}break;case"nullable":rn(t)&&(n=null);break;default:n=t}return n},t.prototype._propertyChanged=function(){if(!ln(this._contextExpression)){var t=this.evaluateExpression(this._contextExpression);if(We(t)){var e=this._property,n=this._castProperty(this._getter());t[e]!==n&&(this.__isSelf=!0,t[e]=n,this.__isSelf=!1)}}},t.prototype._initializeRadio=function(){var t=this.element;if(this._addEventType=this._addChangeEventListener,this._getter=this._getValue,this._setter=this._setRadio,!t.hasAttribute("name")){var e=Tn(this.type),n=this.attributes[e];t.setAttribute("name",n)}t.hasAttribute("value")||t.setAttribute("value","")},t.prototype._initializeSelect=function(){var t,e=this.element,n=e.multiple,i=e.options,r=i.length;this._addEventType=this._addChangeEventListener,this._setter=n?(this._getter=this._getSelectedValues,this._setSelectedIndices):(this._getter=this._getValue,this._setSelectedIndex);for(var o=0;o<r;o+=1)(t=i[o]).hasAttribute("value")||t.setAttribute("value",t.textContent)},t.prototype._observingBindableProperty=function(){var e=this,t=this.templateControl;return!!(We(t)&&an(t.onInput)&&an(t.observeProperties))&&(t.onInput(function(t){e._getter=function(){return t},e._propertyChanged()}),this._supportsTwoWayBinding=!0)},t.prototype._observeProperty=function(n,i,r,t){var e,o,s=this;if(rn(i))e=this._expression.expression;else if(sn(i))e=this._expression.expression+"."+i;else{var a=this._parser,l=a.parse(i).identifiers;if(1!==l.length)return void this._log.warn("Only 1 identifier path allowed with "+this.type);var u=(e=a.parse(this._expression.expression+"."+l[0]).identifiers[0]).split(".");u.pop();var c=u.join("."),h=this.evaluateExpression(c);if(!We(h)){if(!ln(h))return void this._log.warn("Cannot index a primitive type: "+this.type+'="'+this._expression.expression+'"');h=this._ContextManager.createContext(this.parent,c)}}if(n=n.bind(this.templateControl),r=!0===r,!0===t)o=this.observeArray(function(t){n(t,i)},e);else{o=this.observe(function(t,e){s.__isSelf||t===e||(r&&(s._propertyType=s._getPropertyType(t)),n(t,e,i))},e);var p=this.evaluateExpression(e);r&&(this._propertyType=this._getPropertyType(p)),n(p,void 0,i,!0)}return o},t.prototype._getPropertyType=function(t){return We(t)?t:tn(t)?"string":sn(t)?"number":on(t)?"boolean":void 0},t._inject={_parser:J,_ContextManager:Z,_compat:X,_document:G},t}(Ri);l.Bind=H,Zn.control("plat-bind",H);var Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t.priority=200,t._listeners=[],t._boundAddListener=t._addListener.bind(t),t}return __extends(t,e),t.prototype.initialize=function(){this.attribute=Tn(this.type),this._setProperty(this._getValue())},t.prototype.loaded=function(){this._observeProperty(),this._setProperty(this._getValue())},t.prototype.dispose=function(){an(this._removeListener)&&this._removeListener(),this._listeners=[]},t.prototype._setProperty=function(t,e){var n=this.templateControl;ln(n)||(this._ContextManager.defineGetter(n,this.property,{value:t,observe:this._boundAddListener},!0,!0),this._callListeners(t,e))},t.prototype._callListeners=function(t,e){for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](t,e)},t.prototype._addListener=function(e){var n=this._listeners;return e=e.bind(this.templateControl),n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}},t.prototype._getValue=function(){if(!ln(this.templateControl))return this.evaluateExpression(this.attributes[this.attribute])},t.prototype._observeProperty=function(){ln(this.templateControl)||(this._removeListener=this.observeExpression(this._setProperty,this.attributes[this.attribute]))},t._inject={_ContextManager:Z},t}(Ri),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="options",t}return __extends(t,e),t}(l.ObservableAttributeControl=Q);l.Options=Y,Zn.control(pt,Y)}(d.controls||(d.controls={}));var Li=function(){function o(){this.uid=wn(ht),this._log=o._log,(this.navigator=fi(S)).initialize(fi(q).currentRouter())}return o.start=function(){if(o._compat.isCompatible){o.__addPlatCss();var t=o._EventManager;t.dispose(we),t.on(we,St,o.__ready),t.on(we,n,o.__shutdown),t.initialize()}else o._log.error(new Error("PlatypusTS only supports modern browsers where Object.defineProperty is defined"))},o.registerApp=function(t){!ln(o.app)&&tn(o.app.uid)&&o._EventManager.dispose(o.app.uid),o.__injector=t},o.load=function(t){var e=o._LifecycleEvent,n=o._compiler,i=o._document.body,r=o._document.head;return e.dispatch(Rt,o),ln(t)?(i.setAttribute(Dt,""),void bn(function(){n.compile([r]),n.compile([i]),i.removeAttribute(Dt)})):an(t.setAttribute)?(t.setAttribute(Dt,""),void bn(function(){n.compile([t]),t.removeAttribute(Dt)})):void bn(function(){n.compile([t])})},o.__ready=function(t){ti.Injector.initialize(),o.__registerAppEvents(t),t.defaultPrevented||o.load()},o.__shutdown=function(){var t=navigator.app,e=o._LifecycleEvent;if(!ln(t)&&an(t.exitApp)){if(e.dispatch(i,o).defaultPrevented)return;t.exitApp()}},o.__registerAppEvents=function(t){var e=o.__injector;if(!ln(e)&&an(e.inject)){var n=o.app=e.inject();n.on(It,n.suspend),n.on("resume",n.resume),n.on("online",n.online),n.on(jt,n.offline),n.on("error",n.error),n.on(i,n.exiting),an(n.ready)&&n.ready(t)}},o.__addPlatCss=function(){var t=o._document;if(!o._compat.platCss)if(!ln(t.styleSheets)&&0<t.styleSheets.length)t.styleSheets[0].insertRule("[plat-hide] { display: none !important; }",0);else{var e=document.createElement("style");e.textContent="[plat-hide] { display: none !important; }",document.head.appendChild(e)}},o.prototype.suspend=function(t){},o.prototype.resume=function(t){},o.prototype.error=function(t){},o.prototype.ready=function(t){},o.prototype.exiting=function(t){},o.prototype.online=function(t){},o.prototype.offline=function(t){},o.prototype.dispatchEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=o._EventManager;We(i)||(i=fi(N)),i.dispatch(t,this,i.DIRECT,e)},o.prototype.on=function(t,e){var n=o._EventManager;return We(n)||(n=fi(N)),n.on(this.uid,t,e,this)},o.prototype.load=function(t){o.load(t)},o.prototype.exit=function(){this.dispatchEvent(n)},o.app=null,o}();function Pi(t,e,n,i,r,o){return Li._compat=t,Li._EventManager=e,Li._document=n,Li._compiler=i,Li._LifecycleEvent=r,Li._log=o,Li}function Oi(t){return t.app}d.App=Li,d.IAppStatic=Pi,Zn.injectable(u,Pi,[X,N,G,_,h,k],fe),d.IApp=Oi,Zn.injectable("$App",Oi,[u],ve)}(plat||(plat={})),module.exports=plat;