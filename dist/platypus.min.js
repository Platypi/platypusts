"use strict";var plat,__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();!function(e){"use strict;";var t,n,i,r,o,s,a,l,u="context",c="$AppStatic",h="$Http",p="$HttpRequestInstance",_="$HttpConfig",f="$Promise",d="$Compat",v="$ControlFactory",m="$Document",g="$DispatchEventInstance",y="$ErrorEventStatic",b="$EventManagerStatic",C="$LifecycleEventStatic",x="$LifecycleEventInstance",E="$Log",w="$Parser",T="$Regex",N="$Tokenizer",k="$NavigatorInstance",S="$ContextManagerStatic",I="$Compiler",R="$CommentManagerFactory",j="$ElementManagerFactory",A="$NodeManagerStatic",L="$TextManagerFactory",P="$CacheFactory",O="$ManagerCache",F="$TemplateCache",M="$Animator",D="$AttributesFactory",$="$BindableTemplatesFactory",z="$Dom",B="$DomEvents",U="$ResourcesFactory",V="$TemplateControlFactory",q="$TemplateControlInstance",H="$Utils",Q="$Browser",W="$BrowserConfig",Y="$RouterStatic",X="$UrlUtilsInstance",G="$Window",J="$BaseSegmentFactory",K="$BaseSegmentInstance",Z="$StaticSegmentInstance",ee="$DynamicSegmentInstance",te="$SplatSegmentInstance",ne="$StateStatic",ie="$StateInstance",re="$RouteRecognizerInstance",oe="$InjectorStatic",se="$History",ae="$Location",le="plat-",ue=le+"bind",ce=le+"href",he=le+"src",pe=le+"keydown",_e=le+"keypress",fe=le+"keyup",de=le+"charpress",ve=le+"name",me=le+"options",ge=le+"checked",ye=le+"disabled",be=le+"selected",Ce=le+"readonly",xe=le+"visible",Ee=le+"style",we=le+"tap",Te=le+"blur",Ne=le+"change",ke=le+"copy",Se=le+"cut",Ie=le+"paste",Re=le+"dbltap",je=le+"focus",Ae=le+"submit",Le=le+"touchstart",Pe=le+"touchend",Oe=le+"touchmove",Fe=le+"touchcancel",Me=le+"hold",De=le+"release",$e=le+"swipe",ze=le+"swipeleft",Be=le+"swiperight",Ue=le+"swipeup",Ve=le+"swipedown",qe=le+"track",He=le+"trackleft",Qe=le+"trackright",We=le+"trackup",Ye=le+"trackdown",Xe=le+"trackend",Ge=le+"react",Je=le+"link",Ke=le+"foreach",Ze=le+"html",et=le+"if",tt=le+"ignore",nt=le+"select",it=le+"template",rt=le+"viewport",ot=le+"control",st=le+"viewcontrol",at=le+"resources",lt=le+u,ut=it+"-"+u,ct=le+"callback",ht="data-",pt="__templateControlCache",_t="head",ft="meta",dt="link",vt="property",mt="image",gt="article:",yt="og:",bt="twitter:",Ct="content",xt="ready",Et="suspend",wt="offline",Tt="shutdown",Nt="exiting",kt="beforeLoad",St="beforeNavigate",It="navigating",Rt="urlChanged",jt="deviceReady",At="backbutton",Lt="backclick",Pt=le+"hide",Ot=le+"animating",Ft=le+"animation",Mt=le+"transition",Dt=le+"enter",$t=le+"leave",zt=le+"move",Bt=le+"fadein",Ut=le+"fadeout",Vt=le+"back-nav",qt="$tap",Ht="$dbltap",Qt="$touchstart",Wt="$touchend",Yt="$touchmove",Xt="$touchcancel",Gt="$hold",Jt="$release",Kt="$swipe",Zt="$swipeleft",en="$swiperight",tn="$swipeup",nn="$swipedown",rn="$track",on="$trackleft",sn="$trackright",an="$trackup",ln="$trackdown",un="$trackend",cn={index:"index",even:"even",odd:"odd",first:"first",last:"last"},hn="base",pn="variable",_n="static",fn="splat",dn="dynamic",vn="{{",mn="}}",gn="static",yn="singleton",bn="instance",Cn="factory",xn="class",En="css",wn="-compiled",Tn="-@",Nn="-init",kn=": start node",Sn=": end node",In="js",Rn="noop",jn="__app__",An="observable",Ln="injectable",Pn="object",On="function",Fn="literal",Mn="root",Dn="rootContext",$n="control",zn=u,Bn=!!Array.isArray,Un={},Vn=Object.prototype.toString,qn="[object ",Hn=qn+"Error]",Qn=qn+"File]",Wn=qn+"Array]",Yn=qn+"Boolean]",Xn=qn+"Date]",Gn=qn+"Number]",Jn=qn+"RegExp]",Kn=qn+"String]",Zn=qn+"Promise]";function ei(){}function ti(e,t,n,i,r,o){Object.defineProperty(e,t,{value:n,enumerable:!0===i,configurable:!0===r,writable:!0===o})}function ni(e,t,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return mi(n)?n:(r=vi(t)?t:t?function(e,t,n){ti(e,t,n,!0,!0,!0)}:function(e,t,n){e[t]=n},_i(o)&&o.push(n),Ei(function(t,o){ri(t)&&Ei(function(o){if(i=t[o],e){if(yi(i))return void ni(e,r,n[o]||(n[o]=[]),i);if(Ci(i))return void r(n,o,new Date(i.getTime()));if(hi(i))return void r(n,o,new RegExp(i));if(ai(i))return void r(n,o,i.cloneNode(!0));if(ui(i))return void r(n,o,i);if(ri(i))return void ni(e,r,n[o]||(n[o]={}),i)}r(n,o,i)},Object.keys(t))},o),n)}function ii(e,t){if(!ri(e))return e;if(Ci(e))return new Date(e.getTime());if(hi(e))return new RegExp(e);if(ai(e))return e.cloneNode(t);if(ui(e))return e;if(n=e,Vn.call(n)===Hn)return new e.constructor(e.message);var n,i={};return yi(e)&&(i=[]),fi(t)&&t?ni(!0,!1,i,e):ni(!1,!1,i,e)}function ri(e){return null!=e&&"object"==typeof e}function oi(e){return!!(e&&e.document&&e.setInterval)}function si(e){return!(!e||e.nodeType!==Node.DOCUMENT_NODE)}function ai(e){return!(!e||"number"!=typeof e.nodeType)}function li(e){return!(!e||e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)}function ui(e){return ri(e)&&Vn.call(e)===Qn}function ci(e){return"string"==typeof e||ri(e)&&Vn.call(e)===Kn}function hi(e){return ri(e)&&Vn.call(e)===Jn}function pi(e){return ri(e)&&(Vn.call(e)===Zn||vi(e.then))}function _i(e){return!!mi(e)||(ci(e)||yi(e)?0===e.length:!!ri(e)&&0===Object.keys(e).length)}function fi(e){return!0===e||!1===e||ri(e)&&Vn.call(e)===Yn}function di(e){return("number"==typeof e||ri(e)&&Vn.call(e)===Gn)&&!isNaN(e)}function vi(e){return"function"==typeof e}function mi(e){return null==e}function gi(e){return void 0===e}function yi(e){return Bn?Array.isArray(e):Vn.call(e)===Wn}function bi(e){return!(mi(e)||oi(e)||vi(e))&&(ci(e)||e.length>=0)}function Ci(e){return"object"==typeof e&&Vn.call(e)===Xn}function xi(e,t,n){var i=[];return mi(t)?i:vi(t.filter)?t.filter(e,n):(Ei(function(t,n,r){e(t,n,r)&&i.push(t)},t),i)}function Ei(e,t,n){if(mi(t)||!ri(t)&&!bi(t))return t;var i,r,o;if(vi(t.forEach))return t.forEach(e,n);if(bi(t))for(i=0,o=t.length;i<o;++i)e.call(n,t[i],i,t);else{var s=Object.keys(t);for(o=s.length;s.length>0;)r=s.shift(),e.call(n,t[r],r,t)}return t}function wi(e,t,n){var i=[];return mi(t)?i:vi(t.map)?t.map(e,n):(Ei(function(r,o){i.push(e.call(n,r,o,t))},t),i)}function Ti(e,n,i){return(t=t||plat.acquire(f)).all(wi(e,n,i))}function Ni(e,n,i,r){var o=(t=t||plat.acquire(f)).resolve([]);if(!yi(n))return o;e=e.bind(i);var s=function(t,n,i,r){return t.then(function(t){return e(n,i,r).then(function(e){return t.concat(e)})})};return!0===r?n.reduceRight(s,o):n.reduce(s,o)}function ki(e,t,n){return Ni(e,t,n)}function Si(e,t,n){if(mi(t)||vi(t))return!1;var i,r,o;if(vi(t.some))return t.some(e,n);if(bi(t)){for(i=0,o=t.length;i<o;++i)if(!0===e.call(n,t[i],i,t))return!0}else{var s=Object.keys(t);for(o=s.length;s.length>0;)if(r=s.shift(),!0===e.call(n,t[r],r,t))return!0}return!1}function Ii(e,t,n){return Ri(e,0,t,n)}function Ri(e,t,n,i){var r=setTimeout(function(){e.apply(i,n)},t);return function(){clearTimeout(r)}}function ji(e,t,n,i){var r=setInterval(function(){e.apply(i,n)},t);return function(){clearInterval(r)}}function Ai(e,t){var i=(n=n||plat.acquire(d)).requestAnimationFrame;if(gi(i))return Ii(function(){e.call(t,Date.now())});var r=i(e.bind(t)),o=n.cancelAnimationFrame||ei;return function(){o(r)}}function Li(e){mi(e)&&(e="");var t=Un[e];mi(t)&&(t=Un[e]=["0","/"]);for(var n,i=t.length;i--;){if(57===(n=t[i].charCodeAt(0)))return t[i]="A",r();if(90===n)return t[i]="a",r();if(122!==n)return t[i]=String.fromCharCode(n+1),r();t[i]="0"}function r(){return e+t.join("")}return t.unshift("0"),r()}function Pi(e){return!ci(e)||_i(e)?e:(e=e.charAt(0).toLowerCase()+e.slice(1),i=i||plat.acquire(T).camelCaseRegex,e.replace(i,function(e,t,n,i){return i?n.toUpperCase():n}))}function Oi(e,t){return mi(e)||delete e[t],e}function Fi(e,t){return mi(e)?e:e[t]}function Mi(e){if(!_i(e)){for(var t,n=(e=e.replace(/^\?+/,"")).split("&"),i={},r=n.length,o=0;o<r;++o)i[(t=n[o].split("="))[0]]=t[1];return i}}function Di(e){var t="";return _i(t+=wi(function(e,t){return t+"="+e},e).join("&"))||(t="?"+t),t}function $i(e){return yi(e)?e.reduce(function(e,t){return e&&!1!==t},!0):!fi(e)||e}var zi=/<([\w:]+)/,Bi=/\s+/g,Ui=[1,'<select multiple="multiple">',"</select>"],Vi=[1,"<table>","</table>"],qi=[3,"<table><tbody><tr>","</tr></tbody></table>"],Hi=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],Qi={thead:Vi,tbody:Vi,tfoot:Vi,colgroup:Vi,caption:Vi,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:qi,th:qi},Wi=ni(!1,!1,{},Qi,{option:Ui,optgroup:Ui,legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],text:Hi,circle:Hi,ellipse:Hi,line:Hi,path:Hi,polygon:Hi,polyline:Hi,rect:Hi,_default:[0,"",""]});function Yi(e,t,n){var i=li(t),r=!ai(t),s=i?t:(o||(o=plat.acquire(m))).createDocumentFragment();r&&(t=s);var a,l=yi(e)?e:Array.prototype.slice.call(e),u=l.length;if(!0===n){var c=void 0;for(a=0;a<u;++a)c=l[a].cloneNode(!0),s.insertBefore(c,null)}else for(a=0;a<u;++a)s.insertBefore(l[a],null);return i||r||t.appendChild(s),t}function Xi(e){for(var t=Array.prototype.slice.call(e.childNodes);t.length>0;)e.removeChild(t.pop())}function Gi(e,t){if(vi(e.push)||(e=Array.prototype.slice.call(e)),mi(t))for(var n;e.length>0;)mi(t=(n=e.pop()).parentNode)||t.removeChild(n);else!function(e,t){for(;e.length>0;)t.removeChild(e.pop())}(e,t)}function Ji(e,t){if(Xi(e),!_i(t)){var i=function(e){n=n||(n=plat.acquire(d)),o=o||(o=plat.acquire(m));var t=zi.exec(e),i=o.createElement("div");if(mi(t))return(i=rr(i,e)).removeChild(i.lastChild);e=e.trim();var r=t[1];if(n.pushState&&gi(Qi[r]))return rr(i,e);if("body"===r)return(i=rr(o.createElement("html"),e)).removeChild(i.lastChild);var s=Wi[r]||Wi._default,a=s[0];for(i=rr(i,s[1]+e+s[2]);a-- >0;)i=i.lastChild;return i}(t);return i.childNodes.length>0?Yi(i.childNodes,e):e.insertBefore(i,null),e}}function Ki(e,t,n){if(!mi(e)&&ri(t)){var i;if(gi(n)&&(n=null),ai(t))return i=t,t=Array.prototype.slice.call(i.childNodes),e.insertBefore(i,n),t;vi(t.push)||(t=Array.prototype.slice.call(t)),o=o||(o=plat.acquire(m));var r=t.length;i=o.createDocumentFragment();for(var s=0;s<r;++s)i.insertBefore(t[s],null);return e.insertBefore(i,n),t}}function Zi(e){var t=e.parentNode,n=Ki(t,e.childNodes,e);return t.removeChild(e),n}function er(e,t){if(mi(t))return t;if(e.nodeType===Node.ELEMENT_NODE)for(var n=e.attributes,i=n.length,r=void 0,o=0;o<i;++o)r=n[o],t.setAttribute(r.name,r.value);var s=e.parentNode;return Ki(t,e.childNodes),s.replaceChild(t,e),t}function tr(e){var t=(o=o||(o=plat.acquire(m))).createDocumentFragment();return _i(e)||Ji(t,e),t}function nr(e,t){if(!mi(e)){var n,i=e.nextSibling,r=e.parentNode;if(mi(t)&&(t=null),!mi(r)&&(mi(t)||t.parentNode===r))for(;i!==t;)n=i.nextSibling,r.removeChild(i),i=n}}function ir(e,t){mi(e)||(nr(e,t),or(e),or(t))}function rr(e,t){return(n=n||(n=plat.acquire(d))).msApp?MSApp.execUnsafeLocalFunction(function(){e.innerHTML=t}):e.innerHTML=t,e}function or(e){if(ai(e)){var t=e.parentNode;mi(t)||t.removeChild(e)}}function sr(e,t){var n=(e||{}).className;if(ci(n)&&ci(t)&&""!==t){var i,r=t.split(Bi);if(gi(e.classList)){if(_i(n))return void(e.className=t);for(;r.length>0;)""!==(i=r.shift())&&(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g").test(n)||(e.className+=" "+i))}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.add(i)}}function ar(e,t){var n=(e||{}).className;if(ci(n)&&ci(t)&&""!==t){var i,r=t.split(Bi);if(gi(e.classList)){if(n===t)return void(e.className="");for(;r.length>0;)""!==(i=r.shift())&&(e.className=n=n.replace(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g"),""))}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.remove(i)}}function lr(e,t){var n=(e||{}).className;if(!ci(n)||!ci(t)||""===t)return!1;var i,r=t.split(Bi);if(gi(e.classList)){if(""===n)return!1;if(n===t)return!0;for(;r.length>0;)if(""!==(i=r.shift())&&!new RegExp("^"+i+"\\s|\\s"+i+"$|\\s"+i+"\\s","g").test(n))return!1;return!0}for(;r.length>0;)if(""!==(i=r.shift())&&!e.classList.contains(i))return!1;return!0}var ur,cr,hr,pr,_r,fr,dr,vr={},mr={},gr={},yr={},br={},Cr={},xr={},Er={};function wr(e){for(var t,n=yi(e),i=(t=n?cr.Injector.getDependencies(e):cr.Injector.getDependencies([e])).length,r=[],o=0;o<i;++o)r.push(t[o].inject());return n?r:r[0]}!function(e){function t(t,n,i,r,o,s){var a=t[n]=new cr.Injector(n,i,r,o);return!0===s&&(Cr[n]=a),e}function n(e,n,i,r){if(ci(r)){if((r=r.toLowerCase())===Cn||r===gn||r===xn)return t(yr,e,n,i,r,!0);if(r!==yn&&r!==bn)throw new Error("Invalid injectable type "+r+" during injectable registration.")}else r=yn;return t(yr,e,n,i,r,!1)}var i,r;function o(n,i,r,o){if(ci(o)&&(o=o.toLowerCase())!==En&&o!==In)throw new Error('Invalid animationType "'+o+'" during animation registration.');return t(o===In?Er:xr,n,i,r,e.injectable.INSTANCE)}e.app=function(t,n,i){var r=wr(oe);return wr(c).registerApp(new r(t,n,i)),e},e.control=function(e,n,i,r){if(!ci(e))throw new Error("A Control must be registered with a string name");return"head"===(e=e.toLowerCase())&&(r=!0),t(vr,e,n,i,r?gn:void 0)},e.viewControl=function(e,n,i){if(!ci(e))throw new Error("A ViewControl must be registered with a string name");return e=e.toLowerCase(),t(mr,e,n,i)},e.injectable=n,(i=n=e.injectable||(e.injectable={})).STATIC=gn,i.SINGLETON=yn,i.INSTANCE=bn,i.FACTORY=Cn,i.CLASS=xn,e.animation=o,(r=o=e.animation||(e.animation={})).CSS=En,r.JS=In}(ur=e.register||(e.register={})),hr=cr=e.dependency||(e.dependency={}),_r=function(){function e(t,n,i,r){void 0===r&&(r=null),this.name=t,this.Constructor=n,this.type=r;var o,s=this.dependencies=e.convertDependencies(i),a=s.indexOf(Rn);if(Object.defineProperty(n,"__injectorName",{value:t,enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(n,"__injectorDependencies",{value:s.slice(0),enumerable:!1,configurable:!0,writable:!0}),a>-1){var l=i[a];if(mi(l))throw new TypeError("The dependency for "+t+" at index "+a+" is undefined, did you forget to include a file?");throw new TypeError("Could not resolve dependency "+l.slice(9,l.indexOf("("))+" for "+t+". Are you using a static injectable Type?")}if(ci(o=e.__findCircularReferences(this)))throw new Error("Circular dependency detected from "+this.name+" to "+o+".");if(t===c){var u=this.inject();this.dependencies=s,u.start()}}return e.initialize=function(){for(var e=Cr,t=Object.keys(e),n=t.length,i=0;i<n;++i)e[t[i]].inject();Cr={}},e.getDependencies=function(t){if(mi(t)||_i(t))return[];for(var n=[],i=t.length,r=0;r<i;++r)n.push(e.getDependency(t[r]));return n},e.getDependency=function(t){return mi(t)||t===Rn?e.__noop():e.isInjector(t)?t:e.__locateInjector(t)},e.convertDependencies=function(t){if(!yi(t))return[];for(var n=e.convertDependency,i=[],r=t.length,o=0;o<r;++o)i.push(n(t[o]));return i},e.convertDependency=function(t){return mi(t)?Rn:e.__getInjectorName(t)},e.isInjector=function(e){return vi(e.inject)&&!gi(e.type)&&!gi(e.name)&&!gi(e.Constructor)},e.__getInjectorName=function(t){if(mi(t))return Rn;if(ci(t))return t;var n=t,i=ri(n._inject)?n._inject:{};if(ci(n.__injectorName)&&(t=n.__injectorName),!ci(t))return new e(t,n,i.dependencies);var r=e.__findInjector.bind(e,t),o=r(yr)||r(br)||r(Cr)||r(mr)||r(vr)||r(xr)||r(Er);return!ri(o)&&ci(t)&&(o=br[t]=new e(t,n,n._inject.dependencies)),ri(o)?o.name:Rn},e.__construct=function(t,n,i){if(mi(t)||mi(t.prototype))return t;var r,o=Object.create(t.prototype),s=i===bn;s&&(r=gr[t.__injectorName]),ri(r)||(r=e.__walk(o,Object.getPrototypeOf(o),{}),s&&(gr[t.__injectorName]=r));for(var a=wr(wi(function(e){return e},r)),l=Object.keys(r),u=l.length,c=0;c<u;++c)o[l[c]]=a[c];var h=o.constructor.apply(o,n);return gi(h)?o:h},e.__walk=function(t,n,i){var r=n.constructor,o={};return ri(r._inject)&&r!==Object&&(o=e.__walk(t,Object.getPrototypeOf(n),i)),ni(!1,!1,{},i,o,ii(r._inject,!0))},e.__locateInjector=function(t){if(!mi(t)){var n=t;ci(t.__injectorName)&&(n=t.__injectorName);var i=e.__findInjector.bind(e,n),r=i(yr)||i(br)||i(Cr)||i(vr)||i(mr)||i(xr)||i(Er);return ri(r)||(vi(t)?(ci(n)||(n=Li(le)),r=new e(n,t,ri(t._inject)?t._injectorDependencies:[]),br[n]=r):r=e.__wrap(t)),r}},e.__findInjector=function(t,n){if(!mi(t)){if(t===e||t===oe){var i=e.__wrap(e);return i.name=oe,i}return ci(t)?n[t]||n[t.toLowerCase()]:void 0}},e.__wrap=function(e){return{inject:function(){return e},name:"wrapped",dependencies:[],Constructor:e}},e.__noop=function(){return{inject:ei,type:Rn,name:Rn,dependencies:[],Constructor:ei}},e.__findCircularReferences=function(t){if(ri(t)&&yi(t.dependencies))for(var n,i,r,o=t.name,s=t.dependencies,a=[{name:o,dependencies:s.slice(0)}],l=e.__locateInjector;a.length>0;){r=(s=(n=a.pop()).dependencies).length;for(var u=0;u<r;++u){if((i=s[u])===o)return n.name;ri(t=l(i))&&yi(t.dependencies)&&a.push({name:t.name,dependencies:t.dependencies.slice(0)})}}},e.prototype.inject=function(){for(var t,n,i=[],r=this.type,o=this.dependencies,s=o.length,a=0;a<s;++a)t=e.getDependency(o[a]),i.push(t.inject());return n=e.__construct(this.Constructor,i,r),ci(r)&&r!==bn&&this._wrapInjector(n),n.__injectable__type=r,n},e.prototype._wrapInjector=function(e){return this.inject=function(){return e},this},e}(),hr.Injector=_r,(pr=hr.injectors||(hr.injectors={})).control=vr,pr.viewControl=mr,pr.injectable=yr,pr.staticInjectable=Cr,pr.animation=xr,pr.jsAnimation=Er,gi(window)||(gi(window.plat)&&(window.plat=plat),gi(window.module)&&(window.module={})),e.acquire=wr,fr=e.debug||(e.debug={}),dr=function(){function e(){this.ERROR=5,this.WARN=4,this.INFO=3,this.DEBUG=2,this.TRACE=1,this._level=this.INFO}return e.prototype.error=function(e){throw this._log(e,this.ERROR),e},e.prototype.warn=function(e){this._log(e,this.WARN)},e.prototype.info=function(e){this._log(e,this.INFO)},e.prototype.debug=function(e){this._log(e,this.DEBUG)},e.prototype.trace=function(e){this._log(e,this.TRACE)},e.prototype.setLogLevel=function(e){switch(ci(e)&&(e=this[e.toUpperCase()]),e){case this.ERROR:case this.WARN:case this.INFO:case this.DEBUG:case this.TRACE:this._level=e;break;default:this._level=this.INFO}},e.prototype._log=function(t,n){if(this._shouldLog(n)){ci(t)&&(t=new Error(t));var i=this._ErrorEvent;mi(i)&&(i=this._ErrorEvent=wr(y)),i.dispatch("error",e,t,n)}},e.prototype._shouldLog=function(e){return di(e)||(e=this.INFO),this._level<e},e}(),fr.Log=dr,ur.injectable(E,dr);var Tr=function(){function e(){this.__events={},this.__defineBooleans(),this.__defineMappedEvents(),this.__defineVendorDependencies(),this.__determineCss()}return e.prototype.hasEvent=function(e){var t=this.__events,n=t[e];if(gi(n)){var i=this._document.createElement("div");n="input"===e&&9===this.IE?t[e]=!1:t[e]=!gi(i["on"+e])}return n},e.prototype.__defineBooleans=function(){var e=this._window,t=e.navigator||{},n=(t.userAgent||"").toLowerCase(),i=this._history,r=e.define,o=e.MSApp,s=e.WinJS,a=(/android ((?:\d|\.)+)/.exec(n)||[])[1];if(ci(a)&&!/iemobile/i.test(n)&&(a=parseInt(a.replace(/\./g,""),10)),this.isCompatible=vi(Object.defineProperty)&&vi(this._document.querySelector),this.cordova=!mi(e.cordova),this.pushState=!(mi(i)||mi(i.pushState)),this.fileSupported=!(gi(e.File)||gi(e.FormData)),this.amd=vi(r)&&!mi(r.amd),this.msApp=ri(o)&&vi(o.execUnsafeLocalFunction),this.winJs=ri(s)&&ri(s.Application),this.indexedDb=!mi(e.indexedDB),this.proto=ri({}.__proto__),this.getProto=vi(Object.getPrototypeOf),this.setProto=vi(Object.setPrototypeOf),this.hasTouchEvents=!gi(e.ontouchstart),this.hasPointerEvents=!!t.pointerEnabled,this.hasMsPointerEvents=!!t.msPointerEnabled,di(a))this.ANDROID=a;else{var l=parseInt((/msie (\d+)/.exec(n)||[])[1],10)||parseInt((/trident\/.*; rv:(\d+)/.exec(n)||[])[1],10);di(l)&&(this.IE=l)}},e.prototype.__defineMappedEvents=function(){this.hasPointerEvents?this.mappedEvents={$touchstart:"pointerdown",$touchend:"pointerup",$touchmove:"pointermove",$touchcancel:"pointercancel"}:this.hasMsPointerEvents?this.mappedEvents={$touchstart:"MSPointerDown",$touchend:"MSPointerUp",$touchmove:"MSPointerMove",$touchcancel:"MSPointerCancel"}:this.hasTouchEvents?this.mappedEvents={$touchstart:"touchstart",$touchend:"touchend",$touchmove:"touchmove",$touchcancel:"touchcancel"}:this.mappedEvents={$touchstart:"mousedown",$touchend:"mouseup",$touchmove:"mousemove",$touchcancel:null}},e.prototype.__defineVendorDependencies=function(){var e,t,n,i,r=this._window,o=this._document.documentElement,s=r.getComputedStyle(o,""),a=Array.prototype.slice.call(s).join("").match(/-(moz|webkit|ms)-/);yi(a)&&a.length>1?(i=(e=yi(a)&&a.length>1?a[1]:"")[0].toUpperCase()+e.slice(1),t="WebKit|Moz|MS".match(new RegExp("("+e+")","i"))[1],n="-"+e+"-"):gi(s.OLink)?e=i=t=n="":(e="o",i=t="O",n="-o-"),this.vendorPrefix={dom:t,lowerCase:e,css:n,upperCase:i},this.requestAnimationFrame=r.requestAnimationFrame||r[e+"RequestAnimationFrame"],this.cancelAnimationFrame=r.cancelAnimationFrame||r[e+"CancelRequestAnimationFrame"]||r[e+"CancelAnimationFrame"];var l=o.style;!(gi(this.ANDROID)||Math.floor(this.ANDROID/10)>=44)||gi(l.animation)||gi(l.transition)?(gi(l[i+"Animation"])||gi(l[i+"Transition"]))&&(gi(l[e+"Animation"])||gi(l[e+"Transition"]))&&(gi(l[t+"Animation"])||gi(l[t+"Transition"]))||(this.animationSupported=!0,this.animationEvents={$animation:e+"Animation",$animationStart:e+"AnimationStart",$animationEnd:e+"AnimationEnd",$animationIteration:e+"AnimationIteration",$transition:e+"Transition",$transitionStart:e+"TransitionStart",$transitionEnd:e+"TransitionEnd"}):(this.animationSupported=!0,this.animationEvents={$animation:"animation",$animationStart:"animationstart",$animationEnd:"animationend",$animationIteration:"animationiteration",$transition:"transition",$transitionStart:"transitionstart",$transitionEnd:"transitionend"})},e.prototype.__determineCss=function(){var e=this._document,t=e.head,n=e.createElement("div");n.setAttribute(Pt,""),t.insertBefore(n,null);var i=this._window.getComputedStyle(n),r=i.display,o=i.visibility;this.platCss="none"===r||"hidden"===o,t.removeChild(n)},e._inject={_window:G,_history:se,_document:m},e}();e.Compat=Tr,ur.injectable(d,Tr);var Nr,kr=function(){function e(){}return e.prototype.noop=function(){},e.prototype.extend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ni.apply(null,[!1,!1,e].concat(t))},e.prototype.deepExtend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ni.apply(null,[!0,!1,e].concat(t))},e.prototype.clone=function(e,t){return ii(e,t)},e.prototype.isObject=function(e){return ri(e)},e.prototype.isWindow=function(e){return oi(e)},e.prototype.isDocument=function(e){return si(e)},e.prototype.isNode=function(e){return ai(e)},e.prototype.isDocumentFragment=function(e){return li(e)},e.prototype.isString=function(e){return ci(e)},e.prototype.isRegExp=function(e){return hi(e)},e.prototype.isPromise=function(e){return pi(e)},e.prototype.isEmpty=function(e){return _i(e)},e.prototype.isBoolean=function(e){return fi(e)},e.prototype.isNumber=function(e){return di(e)},e.prototype.isFile=function(e){return ui(e)},e.prototype.isFunction=function(e){return vi(e)},e.prototype.isNull=function(e){return mi(e)},e.prototype.isUndefined=function(e){return gi(e)},e.prototype.isArray=function(e){return yi(e)},e.prototype.isArrayLike=function(e){return bi(e)},e.prototype.isDate=function(e){return Ci(e)},e.prototype.filter=function(e,t,n){return xi(e,t,n)},e.prototype.where=function(e,t){return n=e,xi(function(e){return!Si(function(t,n){return e[n]!==t},n)},t);var n},e.prototype.forEach=function(e,t,n){return Ei(e,t,n)},e.prototype.map=function(e,t,n){return wi(e,t,n)},e.prototype.mapAsync=function(e,t,n){return Ti(e,t,n)},e.prototype.mapAsyncInOrder=function(e,t,n){return ki(e,t,n)},e.prototype.mapAsyncInDescendingOrder=function(e,t,n){return Ni(e,t,n,!0)},e.prototype.pluck=function(e,t){return n=e,wi(function(e){return e[n]},t);var n},e.prototype.some=function(e,t,n){return Si(e,t,n)},e.prototype.postpone=function(e,t,n){return Ri(e,0,t,n)},e.prototype.defer=function(e,t,n,i){return Ri(e,t,n,i)},e.prototype.setInterval=function(e,t,n,i){return ji(e,t,n,i)},e.prototype.requestAnimationFrame=function(e,t){return Ai(e,t)},e.prototype.uniqueId=function(e){return Li(e)},e.prototype.camelCase=function(e){return Pi(e)},e.prototype.delimit=function(e,t){return i=t,!ci(n=e)||_i(n)?n:(mi(i)&&(i=""),r=r||plat.acquire(T).capitalCaseRegex,n.replace(r,function(e,t){return t?i+e.toLowerCase():e.toLowerCase()}));var n,i},e}();function Sr(){return window}function Ir(e){return e.document}e.Utils=kr,ur.injectable(H,kr),e.Window=Sr,ur.injectable(G,Sr),e.Document=Ir,ur.injectable(m,Ir,[G]),function(e){var t=function(){function e(){this.markupRegex=new RegExp(vn+"[\\S\\s]*"+mn),this.argumentRegex=/\((.*)\)/,this.initialUrlRegex=/\/[^\/]*\.(?:html|htm)/,this.protocolRegex=/:\/\//,this.invalidVariableRegex=/[^a-zA-Z0-9@_$]/,this.fileNameRegex=/.*(?:\/|\\)/,this.shiftedKeyRegex=/[A-Z!@#$%^&*()_+}{":?><|~]/,this.fullUrlRegex=/^(?:[a-z0-9\-]+:)(?:\/\/)?|(?:\/\/)/i,this.validateEmail=new RegExp('^(([^<>()[\\]\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),this.validateTelephone=/^\+?[0-9\.\(\)\s-]*$/,this.dynamicSegmentsRegex=/^:([^\/]+)$/,this.splatSegmentRegex=/^\*([^\/]+)$/}return Object.defineProperty(e.prototype,"newLineRegex",{get:function(){return/\r|\n/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optionalRouteRegex",{get:function(){return/\((.*?)\)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"namedParameterRouteRegex",{get:function(){return/(\(\?)?:\w+/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wildcardRouteRegex",{get:function(){return/\*\w*/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"escapeRouteRegex",{get:function(){return/[\-{}\[\]+?.,\\\^$|#\s]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"camelCaseRegex",{get:function(){return/([\-_\.\s])(\w+?)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capitalCaseRegex",{get:function(){return/[A-Z]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"whiteSpaceRegex",{get:function(){return/("[^"]*?"|'[^']*?')|[\s\r\n\t\v]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quotationRegex",{get:function(){return/'|"/g},enumerable:!0,configurable:!0}),e}();e.Regex=t,ur.injectable(T,t);var n=function(){function e(){this.__previousChar="",this.__variableRegex=wr(T).invalidVariableRegex,this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]}return e.prototype.createTokens=function(e){if(mi(e))return[];this._input=e;for(var t,n=e.length,i=0,r=!1,o=this._isSpace,s=this._isAlphaNumeric,a=0;a<n;a++)if(!o(t=e[a])){if(s(t))a=this.__handleAplhaNumeric(a,t);else if(mi(Lr[t])){if(Fr(t))switch(t){case"?":r=!0,i++,this.__handleQuestion(t);break;case":":i=this.__handleColon(t,i);break;default:a=this.__handleOtherOperator(a,t)}else if(";"===t)return this._throwError("Unexpected semicolon"),[]}else switch(t){case".":a=this.__handlePeriod(a,t);break;case"{":this.__handleLeftBrace(t);break;case"}":this.__handleRightBrace(t);break;case"[":this.__handleLeftBracket(t);break;case"]":this.__handleRightBracket(t);break;case"(":this.__handleLeftParenthesis(t);break;case")":this.__handleRightParenthesis(t);break;case",":this.__handleComma(t);break;case"'":case'"':a=this.__handleStringLiteral(a,t)}this.__previousChar=t}if(r&&i>0)return this._throwError("Improper ternary expression"),[];if(this.__objArgCount.length>0)return this._throwError("Improper object literal"),[];this.__popRemainingOperators();var l=this.__outputQueue;return this._resetTokenizer(),l},e.prototype._checkType=function(e,t){return t?this._isNumeric(e):this._isAlphaNumeric(e)},e.prototype._lookAhead=function(e,t,n){for(var i,r=this._input,o=r.length;++t<o&&(i=r[t],this._checkType(i,n));)e+=i;return e},e.prototype._lookAheadForOperatorFn=function(e,t){for(var n=e,i=this._input,r=i.length;++t<r&&Fr(n+=i[t]);)e=n;return e},e.prototype._lookAheadForDelimiter=function(e,t){for(var n,i="",r=this._input,o=r.length;++t<o&&(n=r[t])!==e;)i+=n;return i},e.prototype._popStackForVal=function(e,t,n){for(var i=this.__outputQueue,r=this.__operatorStack;e.val!==t;)if(i.push(r.shift()),e=r[0],0===r.length)return this._throwError(n)},e.prototype._isValEqual=function(e,t){return mi(e)||mi(e.val)?mi(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return mi(e)||mi(e.val)?!mi(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetTokenizer=function(){this._input=null,this.__previousChar="",this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]},e.prototype._throwError=function(e){this._log.error(new Error(e+" in "+this._input))},e.prototype._isNumeric=function(e){return"0"<=e&&e<="9"},e.prototype._isSpace=function(e){return" "===e||"\r"===e||"\n"===e||"\t"===e||"\v"===e||" "===e},e.prototype._isAlphaNumeric=function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"0"<=e&&e<="9"||"@"===e||"_"===e||"$"===e},e.prototype._isStringValidVariable=function(e){return!this.__variableRegex.test(e)},e.prototype.__handleAplhaNumeric=function(e,t){var n=this._isNumeric(t),i=this._lookAhead(t,e,n);return this.__outputQueue.push(n?{val:Number(i),args:0}:{val:i,args:-1}),e+i.length-1},e.prototype.__handlePeriod=function(e,t){var n,i=this.__outputQueue,r=this.__operatorStack,o=i.length-1,s=this.__previousChar;return o<0||this._isSpace(s)||!mi(jr[s])||"("===s||","===s?(e+=(n=this._lookAhead(t,e,!0)).length-1,i.push({val:parseFloat(n),args:0})):this._isValEqual(r[0],t)?i.push({val:t,args:0}):mi(i[o])||!di(Number(i[o].val))||this._isValEqual(i[o-1],t)?r.unshift({val:t,args:0}):(e+=(n=this._lookAhead(t,e,!0)).length-1,i[o].val+=parseFloat(n)),e},e.prototype.__handleLeftBrace=function(e){this.__operatorStack.unshift({val:e,args:0}),this.__objArgCount.push(0),this.__lastColonChar.push(e),this.__lastCommaChar.push(e)},e.prototype.__handleRightBrace=function(e){var t=this.__operatorStack,n=t[0],i=this.__objArgCount.pop();if(mi(n))return this._throwError("Improper object literal");this._popStackForVal(n,"{","Improper object literal"),t.shift(),this.__lastColonChar.pop(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"{}",args:i})},e.prototype.__handleLeftBracket=function(e){var t=this.__previousChar,n=this.__operatorStack;this._isValEqual(n[0],".")&&this.__outputQueue.push(n.shift()),n.unshift({val:e,args:0}),this.__argCount.push({num:0,isArray:!("]"===t||")"===t||this._isAlphaNumeric(t))}),this.__lastCommaChar.push(e)},e.prototype.__handleRightBracket=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();if(mi(n)||mi(i))return this._throwError("Brackets mismatch");i.isArray||i.num--,this._popStackForVal(n,"[","Brackets mismatch"),t.shift(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"[]",args:"["===this.__previousChar?-1:i.num+1})},e.prototype.__handleLeftParenthesis=function(e){var t,n=this.__previousChar,i=this.__operatorStack;if(this._isAlphaNumeric(n)||"]"===n||")"===n){var r=this.__outputQueue,o=r[r.length-1],s=mi(o)?void 0:o.val;"[]"===s?(i.unshift(r.pop()),i.unshift(r.pop())):"()"===s||this._isNumeric(s)||i.unshift(r.pop()),t=0}else t=-1;this.__argCount.push({num:t}),i.unshift({val:e,args:t}),this.__lastCommaChar.push(e)},e.prototype.__handleRightParenthesis=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();if(mi(n))return this._throwError("Parentheses mismatch");if(this._popStackForVal(n,"(","Parentheses mismatch"),t.shift(),this.__lastCommaChar.pop(),!mi(i)&&i.num>=0){var r=i.num;"("===this.__previousChar?this.__removeFnFromStack(r)&&this.__outputQueue.push({val:"()",args:0}):this.__removeFnFromStack(r+1)&&this.__outputQueue.push({val:"()",args:r+1})}},e.prototype.__handleComma=function(e){var t=this.__lastCommaChar,n=t[t.length-1];if("("===n||"["===n){var i=this.__argCount,r=i.length;if(!(r>0))return this._throwError("Mismatch with "+n);i[r-1].num++}var o=this.__operatorStack[0];if(mi(o))return this._throwError("Unexpected comma");this._popStackForVal(o,n,"Unexpected comma")},e.prototype.__handleStringLiteral=function(e,t){var n=this._lookAheadForDelimiter(t,e),i=this.__operatorStack,r=i[0];return!mi(r)&&("["===r.val||"("===r.val&&r.args>=0)?i.unshift({val:n,args:0}):this.__outputQueue.push({val:n,args:0}),e+n.length+1},e.prototype.__handleQuestion=function(e){this.__lastColonChar.push(e),this.__determinePrecedence(e)},e.prototype.__handleColon=function(e,t){var n=this.__lastColonChar,i=n[n.length-1],r=this.__outputQueue;if("?"===i){var o=this.__operatorStack,s=o[0];if(mi(s))return void this._throwError("Ternary mismatch");t--,n.pop(),this._popStackForVal(s,"?","Ternary mismatch"),r.push(o.shift()),o.unshift({val:e,args:-2})}else{if("{"!==i)return void this._throwError("Unexpected colon");var a=this.__objArgCount,l=r.length-1;if(a[a.length-1]++,l<0)return void this._throwError("Unexpected colon");r[l].args=1}return t},e.prototype.__handleOtherOperator=function(e,t){var n=this._lookAheadForOperatorFn(t,e);return this.__determinePrecedence(n),e+n.length-1},e.prototype.__popRemainingOperators=function(){for(var e,t,n=this.__outputQueue,i=this.__operatorStack;i.length>0;){if("("===(t=(e=i.shift()).val)||")"===t)return this._throwError("Parentheses mismatch");n.push(e)}},e.prototype.__determineOperator=function(e){switch(e){case"+":case"-":if(0===this.__outputQueue.length||Fr(this.__previousChar))return jr["u"+e];default:return jr[e]}},e.prototype.__determinePrecedence=function(e){var t,n,i=this.__determineOperator(e),r=i.precedence,o="ltr"===i.associativity,s=this.__operatorStack,a=this.__outputQueue;if(0!==s.length){do{if("."!==(n=s[0].val)){if(mi(t=jr[n])||!(t.precedence<r||o&&t.precedence===r))return void s.unshift({val:e,args:i.fn.length-2});a.push(s.shift())}else a.push(s.shift())}while(s.length>0);s.unshift({val:e,args:i.fn.length-2})}else s.unshift({val:e,args:i.fn.length-2})},e.prototype.__removeFnFromStack=function(e){for(var t,n=this.__outputQueue,i=this.__operatorStack,r=i[0],o=this._isValEqual,s=this._isValUnequal,a=!1;!mi(r)&&s(r,"([")&&(this._isStringValidVariable(r.val)||o(r.val,".[]")||Or(r.val));)-1!==(t=i.shift()).args||o(t,".[]")||(t.args=-2),n.push(t),r=i[0],a=!0;return a||s(n[n.length-e-1],"()")||(a=!0),a},e._inject={_log:E},e}();e.Tokenizer=n,ur.injectable(N,n);var i=function(){function e(){this._tokens=[],this.__cache={},this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={},this.__fnEvalConstant="var initialContext;return "}return e.prototype.parse=function(e){var t=this.__cache[e];if(!mi(t))return{expression:t.expression,identifiers:t.identifiers.slice(0),aliases:t.aliases.slice(0),evaluate:t.evaluate};if(this._tokens=this._tokenizer.createTokens(e),0===(t=this._evaluate(e)).identifiers.length){var n=t.evaluate(null);t.evaluate=function(){return n}}return this.__cache[e]=t,t},e.prototype.clearCache=function(e){ci(e)?Oi(this.__cache,e):this.__cache={}},e.prototype._evaluate=function(e){for(var t,n,i,r=this._tokens,o=r.length,s=this.__tempIdentifiers,a=this.__codeArray,l=!1,c=0;c<o;c++)if(n=(t=r[c]).val,i=t.args,Or(n))switch(n){case"()":l=this.__handleFunction(c,i,l);break;case"{}":a.push(this.__convertObject(i)),s.push(".");break;default:i<0?(a.push("[]"),s.push(".")):i>0?(a.push(this.__convertArrayLiteral(i)),s.push(".")):l=this.__indexIntoObject(c,n,l)}else if(Fr(n))if(0===i)a.push(this.__convertPrimitive(c,n,i));else switch(n){case"?":this.__handleQuestion();break;case":":this.__handleColon();break;case"+":case"-":1===i&&(n="u"+n);default:this.__handleOperator(n,i)}else i<0?a.push(this.__convertFunction(c,n,l)):a.push(this.__convertPrimitive(c,n,i));this._popRemainingIdentifiers(),this._makeIdentifiersUnique();var h={evaluate:new Function(u,"aliases",this.__fnEvalConstant+(0===a.length?'"'+e+'"':a.join(""))+";"),expression:e,identifiers:this.__identifiers.slice(0),aliases:Object.keys(this.__aliases)};return this._resetParser(),h},e.prototype._peek=function(e){return this._tokens[e+1]},e.prototype._lookBack=function(e){return this._tokens[e-1]},e.prototype._popRemainingIdentifiers=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers;n.length>0;)"."!==(e=n.pop())&&t.push(e)},e.prototype._makeIdentifiersUnique=function(){for(var e,t=this.__identifiers,n=[],i={};t.length>0;)i[e=t.pop()]||(i[e]=!0,n.push(e));this.__identifiers=n},e.prototype._isValEqual=function(e,t){return mi(e)||mi(e.val)?mi(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return mi(e)||mi(e.val)?!mi(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetParser=function(){this._tokens=[],this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={}},e.prototype._throwError=function(e){this._log.error(new Error(e))},e.prototype.__convertPrimitive=function(e,t,n){if(n>0)return this.__tempIdentifiers.push("."),t;var i=di(Number(t)),r=this._peek(e),o=!(mi(r)||r.args>=1),s=this._isValEqual;return Mr(t)||ci(t)&&(i||this._isValUnequal(r,"[]()")||s(r,"[]")&&!o)?(this.__tempIdentifiers.push("."),'"'+t+'"'):(!i||s(r,".[]")&&o?this.__tempIdentifiers.push(t):this.__tempIdentifiers.push("."),t)},e.prototype.__convertFunction=function(e,t,n){if("@"===t[0])this.__aliases[t.slice(1)]=!0;else if(Mr(t))return this.__tempIdentifiers.push("."),t;var i=this._peek(e),r=this._isValEqual;if(r(this._tokens[e-1],"()")&&r(i,".[]")?this.__tempIdentifiers.push("."):this.__tempIdentifiers.push(t),mi(i))return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))';switch(i.val){case".":case"()":return t;default:if(!n)return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))'}},e.prototype.__convertObject=function(e){for(var t,n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="{";s++<e;)n=o.pop(),a+=',"'+o.pop()+'":'+n,r.length>1&&(t=r.pop(),r.pop(),"."!==t&&i.push(t));return a.replace(",","")+"}"},e.prototype.__convertArrayLiteral=function(e){for(var t,n=this.__identifiers,i=this.__tempIdentifiers,r=this.__codeArray,o=0,s="";o++<e;)s=r.pop()+","+s,i.length>0&&"."!==(t=i.pop())&&n.push(t);return"["+s.slice(0,-1)+"]"},e.prototype.__handleFunction=function(e,t,n){var i,r,o=this.__identifiers,s=this.__tempIdentifiers,a=this.__codeArray,l=0,u=this._lookBack(e),c=!mi(u)&&(-2===u.args||this._isValEqual(u,".[]")),h="",p="",_="",f=!1;for(c&&(p=a.pop(),_=s.pop());l++<t;)h=a.pop()+","+h,s.length>0&&"."!==(i=s.pop())&&(o.push(i),f=!0);if(r=t>0?".call(initialContext || context,"+h.slice(0,h.length-1)+")":".call(initialContext || context)",n)if(n=!1,a.length>0){var d=a.pop(),v=s.length-1;v<0||"."===s[v]||""===_?""!==_&&f&&"["!==d[0]&&"]"!==d[d.length-1]&&(o[o.length-1]+="."+_):(s[v]+="."+_,o.push(s.pop())),r=_i(p)?d+r:"(("+this.__indexIntoContext.toString()+")("+d+',"'+p+'") || (function () {}))'+r}else this._throwError("Improper expression or context");else c?(r="(initialContext = (("+this.__findInitialContext.toString()+')(context,aliases,"'+p+'") || (function () {}))'+r+")",o.push(p)):r=a.pop()+r;a.push(r);var m=s.length;return this._isValEqual(this._peek(e),"[]")&&m>0&&"."!==s[m-1]&&o.push(s.pop()),n},e.prototype.__indexIntoObject=function(e,t,n){var i=this._isValEqual;if(i(this._peek(e),"()"))return!0;var r,o=this.__codeArray,s=o.pop(),a=this.__identifiers,l=this.__tempIdentifiers,u=this._lookBack(e),c=l.pop(),h=!mi(c);return h&&"@"===c[0]?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",a.push(c),l.length>0&&a.push(l.pop())):i(u,"++--()[]*/%?:>=<=&&||!===")?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",l.push(".")):"[]"!==t||mi(u)||u.args>=0?(s="("+this.__indexIntoContext.toString()+")("+o.pop()+',"'+s+'")',(r=l.length-1)>=0?"."!==l[r]&&(l[r]+="."+c):h&&"."!==c&&"."!==t&&a.push(c)):(s="("+this.__indexIntoContext.toString()+")("+o.pop()+","+s+")",(r=l.length-1)>=0&&"."!==l[r]&&a.push(l.pop()),a.push(c)),o.push(s),n},e.prototype.__handleQuestion=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o++)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+"?"+r)},e.prototype.__handleColon=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o++)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+":"+r)},e.prototype.__handleOperator=function(e,t){for(var n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="";s++<t;)a="function (context, aliases) { return "+o.pop()+"; },"+a,r.length>0&&"."!==(n=r.pop())&&i.push(n);r.push("."),o.push("("+jr[e].fn.toString()+")(context, aliases,"+a.slice(0,a.length-1)+")")},e.prototype.__findInitialContext=function(e,t,n){return"@"===n[0]&&null!==t&&"object"==typeof t?t[n.slice(1)]:null!==e&&"object"==typeof e?e[n]:void 0},e.prototype.__indexIntoContext=function(e,t){if(null!==e&&"object"==typeof e)return e[t]},e._inject={_tokenizer:N,_log:E},e}();e.Parser=i,ur.injectable(w,i)}(e.expressions||(e.expressions={})),function(e){function t(e){return e.location}e.Location=t,ur.injectable(ae,t,[G]);var n=function(){function e(){this.uid=Li(le),this.__lastUrl=this._location.href,this.__protocol=this.urlUtils().protocol,this.__initializing=!1,this._EventManager.on(this.uid,kt,this.initialize,this),this._compat.msApp&&(this._stack=[])}return e.prototype.initialize=function(){var e=this._compat;this._EventManager.dispose(this.uid),this.__initializing=!0,wr(X);var t=this.url(),n=t,i=this._urlChanged.bind(this),r=this._dom,o=this._window;n!==t&&this.url(n,!0),e.pushState&&r.addEventListener(o,"popstate",i,!1),r.addEventListener(o,"hashchange",i,!1),this.__initializing=!1},e.prototype.url=function(e,t){var n=this._location;return ci(e)&&!this._isLastUrl(e)&&(!t&&yi(this._stack)&&this._stack.push(n.href),this._setUrl(e,t)),this.__currentUrl||n.href},e.prototype.back=function(e){di(e)||(e=1);var t=this._stack;if(yi(t)&&t.length>1)return this._stack=t=t.slice(0,t.length-(e-1)),this.url(t.pop()),void t.pop();this._history.go(-e)},e.prototype.forward=function(e){di(e)||(e=1),this._history.go(e)},e.prototype.urlUtils=function(t){t=t||this.url();var n=wr(X),i=e.config;return i.routingType===i.HASH&&(t=t.replace(new RegExp("#"+(i.hashPrefix||"")+"/?"),"")),n.initialize(t),n},e.prototype.isCrossDomain=function(e){if(!ci(e))return!1;var t=this.urlUtils(e),n=this.urlUtils();return t.protocol!==n.protocol||t.hostname!==n.hostname||t.port!==n.port},e.prototype.formatUrl=function(t){var n=e.config,i=n.baseUrl;if(!ci(t))return"";if(t===i)return t;var r=!this._regex.fullUrlRegex.test(t)||t.indexOf(i)>-1;if("/"===t[0]&&(t=t.slice(1)),r){if(n.routingType===n.HASH){var o=0===t.indexOf(this.__protocol+":"),s="#"+(n.hashPrefix||""),a=new RegExp(s+"|#/");"/"!==t[t.length-1]&&-1===t.indexOf("?")&&(t+="/"),a.test(t)||(t=o?t+s+"/":s+("/"!==t[0]?"/":"")+t)}-1===t.indexOf(i)&&(t=i+t)}return t},e.prototype._urlChanged=function(){var e=this;if(!this.__initializing){this.__currentUrl=null;var t=this.urlUtils(),n=this._trimSlashes(t.href);if(this.__lastUrl!==n){this.__lastUrl=n;var i=this._EventManager;Ii(function(){i.dispatch(Rt,e,i.DIRECT,[t])})}}},e.prototype._setUrl=function(t,n){t=this.formatUrl(t);var i=this.urlUtils(t),r=e.config.baseUrl,o=this._history,s=this._location;if(-1!==i.href.indexOf(r))if(this._regex.fullUrlRegex.test(t)||"/"===t[0]||(t=r+t),this._compat.pushState){if(n){var a=o.state;ri(a)||(a={}),o.replaceState({previousLocation:a.previousLocation},"",t)}else o.pushState({previousLocation:this.urlUtils().pathname},"",t);this.__initializing||this._urlChanged()}else this.__currentUrl=t,n?s.replace(t):s.href=t;else s.href=t},e.prototype._isLastUrl=function(e){var t=this.__lastUrl;return ci(e)&&(_i(e)&&(e="/"),e=this._trimSlashes(this.urlUtils(e).href)),e===t},e.prototype._trimSlashes=function(e){return ci(e)&&"/"===e[e.length-1]?e.slice(0,-1):e},e._inject={_EventManager:b,_compat:d,_regex:T,_window:G,_location:ae,_history:se,_dom:z},e.config={HASH:"hash",STATE:"state",routingType:"hash",hashPrefix:"!",baseUrl:""},e}();function i(){return n.config}e.Browser=n,ur.injectable(Q,n),e.IBrowserConfig=i,ur.injectable(W,i);var r=function(){function e(){var t=this._browserConfig,n=t.baseUrl;if(_i(n)||!this._regex.fullUrlRegex.test(n)){var i=this._window.location.href.replace(this._regex.initialUrlRegex,"/");for(ci(n)?0===n.indexOf("/")&&(n=n.slice(1)):n="",n=e.__getBaseUrl(i)+n;"/"===n[n.length-1];)n=n.slice(0,-1);t.baseUrl=n+"/"}}return e.__getQuery=function(e){return Mi(e)},e.__getBaseUrl=function(e){var t=wr(T),n=wr(ae),i=n.origin,r=n.protocol;n.host;return"file:"===r||r.indexOf("wmapp")>-1||r.indexOf("ms-appx")>-1?i=n.href:gi(i)&&(i=n.protocol+"//"+n.host),(i=i.replace(t.initialUrlRegex,"")).split("?")[0].split("#")[0]+"/"},e.prototype.initialize=function(t){t=t||"";var n,i=e.__urlUtilsElement||(e.__urlUtilsElement=this._document.createElement("a")),r=this._browserConfig;"/"===t[0]&&0!==t.indexOf("//")&&(t=t.slice(1)),this._regex.fullUrlRegex.test(t)||(t=r.baseUrl+t),i.setAttribute("href",t),t=i.href,i.setAttribute("href",t),t=i.href,this.href=t,this.protocol=i.protocol?i.protocol.replace(/:$/,""):"",this.host=i.host,this.search=i.search?i.search.replace(/^\?/,""):"",this.hash=i.hash?i.hash.replace(/^#/,""):"",this.hostname=i.hostname,this.port=i.port,n=(n=_i(r.baseUrl)?"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname:t.replace(r.baseUrl,"/")).replace(this._regex.initialUrlRegex,"/"),this.pathname=n.split("?")[0].split("#")[0],this.query=e.__getQuery(this.search)},e.prototype.toString=function(){return this.href},e._inject={_EventManager:b,_document:m,_window:G,_compat:d,_regex:T,_browserConfig:W},e}();e.UrlUtils=r,ur.injectable(X,r,null,bn)}(e.web||(e.web={})),function(e){var t,n,i,r,o,s=[],a="undefined"!=typeof window?window:{},l=a.MutationObserver||a.WebKitMutationObserver,u=u;void 0!==u&&"[object process]"==={}.toString.call(u)?t=function(){u.nextTick(y)}:l?(n=new l(y),i=wr(m),r=wr(G),o=i.createElement("div"),n.observe(o,{attributes:!0}),r.addEventListener("unload",function(){n.disconnect(),n=null},!1),t=function(){o.setAttribute("drainQueue","drainQueue")}):t=function(){Ii(y)};var c,v,g=function(){function e(t){if(!vi(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof e))throw new TypeError('Failed to construct "Promise": Please use the "new" operator, this object constructor cannot be called as a function.');this.__subscribers=[],e.__invokeResolveFunction(t,this)}return e.all=function(t){return yi(t)?new e(function(e,n){var i,r=[],o=t.length;function s(e){return function(t){return a(e,t)}}function a(t,n){r[t]=n,0==--o&&e(r)}0===o&&e([]);for(var l=0;l<t.length;l++)pi(i=t[l])?i.then(s(l),n):a(l,i)}):e.all([t])},e.race=function(t){return yi(t)?new e(function(e,n){for(var i,r=0;r<t.length;r++)(i=t[r])&&"function"==typeof i.then?i.then(e,n):e(i)}):e.race([t])},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.__invokeResolveFunction=function(t,n){function i(t){e.__reject(n,t)}try{t(function(t){e.__resolve(n,t)},i)}catch(e){i(e)}},e.__invokeCallback=function(t,n,i,r){var o,s,a,l,u=vi(i);if(u)try{o=i(r),a=!0}catch(e){l=!0,s=e}else o=r,a=!0;e.__handleThenable(n,o)||(u&&a?e.__resolve(n,o):l?e.__reject(n,s):t===c.FULFILLED?e.__resolve(n,o):t===c.REJECTED&&e.__reject(n,o))},e.__publish=function(t,n){for(var i,r,o=t.__subscribers,s=t.__detail,a=0;a<o.length;a+=3)i=o[a],r=o[a+n],e.__invokeCallback(n,i,r,s);t.__subscribers=null},e.__publishFulfillment=function(t){e.__publish(t,t.__state=c.FULFILLED)},e.__publishRejection=function(t){e.__publish(t,t.__state=c.REJECTED)},e.__reject=function(t,n){t.__state===c.PENDING&&(t.__state=c.SEALED,t.__detail=n,e.config.async(e.__publishRejection,t))},e.__fulfill=function(t,n){t.__state===c.PENDING&&(t.__state=c.SEALED,t.__detail=n,e.config.async(e.__publishFulfillment,t))},e.__resolve=function(t,n){t===n?e.__fulfill(t,n):e.__handleThenable(t,n)||e.__fulfill(t,n)},e.__handleThenable=function(t,n){var i;if(t===n)return e.__reject(t,new TypeError("A promises callback cannot return the same promise.")),!0;if(pi(n))try{return n.then.call(n,function(r){if(i)return!0;i=!0,n!==r?e.__resolve(t,r):e.__fulfill(t,r)},function(n){if(i)return!0;i=!0,e.__reject(t,n)}),!0}catch(n){return!!i||(e.__reject(t,n),!0)}return!1},e.__subscribe=function(e,t,n,i){var r=e.__subscribers,o=r.length;r[o]=t,r[o+c.FULFILLED]=n,r[o+c.REJECTED]=i},e.prototype.then=function(t,n){var i=this,r=new this.constructor(ei,this);if(this.__state){var o=arguments;e.config.async(function(){e.__invokeCallback(i.__state,r,o[i.__state-1],i.__detail)})}else e.__subscribe(this,r,t,n);return r},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.toString=function(){return"[object Promise]"},e.config={async:function(e,n){1===s.push([e,n])&&t()}},e}();function y(){for(var e,t=0;t<s.length;t++)(0,(e=s[t])[0])(e[1]);s=[]}function b(e){return!mi(e.Promise)&&vi(e.Promise.all)&&vi(e.Promise.race)&&vi(e.Promise.resolve)&&vi(e.Promise.reject)?e.Promise:g}e.Promise=g,(v=c||(c={}))[v.PENDING=void 0]="PENDING",v[v.SEALED=0]="SEALED",v[v.FULFILLED=1]="FULFILLED",v[v.REJECTED=2]="REJECTED",e.IPromise=b,ur.injectable(f,b,[G],xn);var C=function(){function e(){var e=wr(d);this.__fileSupported=e.fileSupported}return e.prototype.initialize=function(e){this.__options=ni(!1,!1,{},this._config,e)},e.prototype.execute=function(){var e=this.__options,t=e.url;if(!ci(t)||_i(t.trim()))return this._invalidOptions();e.url=this._browser.urlUtils(t).toString();var n=!1;return e.isCrossDomain||!1?n=!0:(this.xhr=new XMLHttpRequest,gi(this.xhr.withCredentials)&&(n=this._browser.isCrossDomain(t))),n?(this.xhr=null,this.jsonpCallback=e.jsonpCallback||Li("plat_callback"),this.executeJsonp()):this._sendXhrRequest()},e.prototype.executeJsonp=function(){var e=this,t=this.__options,n=t.url;if(!ci(n)||_i(n.trim()))return this._invalidOptions();t.url=this._browser.urlUtils(n).toString(),mi(this.jsonpCallback)&&(this.jsonpCallback=t.jsonpCallback||Li(ct));var i=new w(function(i,r){var o=e._window,s=e._document,a=s.createElement("script"),l=e.jsonpCallback,u=t.jsonpIdentifier||"callback";a.src=n+(n.indexOf("?")>-1?"&":"?")+u+"="+l;var c=o[l];o[l]=function(t){vi(e.clearTimeout)&&e.clearTimeout(),s.head.removeChild(a),gi(c)?Oi(o,l):o[l]=c,i({response:t,status:200})},s.head.appendChild(a);var h=t.timeout;di(h)&&h>0&&(e.clearTimeout=Ii(function(){e.clearTimeout=Ri(function(){r(new x({response:"Request timed out in "+h+"ms for "+n,status:408})),o[l]=ei},h-1)}))});return i.initialize(this),i},e.prototype._xhrOnReadyStateChange=function(){var e=this.xhr;if(4===e.readyState){var t=e.status;if(0===t){var n=e.response;if(mi(n))try{n=e.responseText}catch(e){}return!_i(n)}return t>=200&&t<300||304===t}},e.prototype._sendXhrRequest=function(){var e=this,t=this.xhr,n=this.__options,i=n.method,r=n.url,o=new w(function(o,s){t.onreadystatechange=function(){var t=e._xhrOnReadyStateChange();if(!mi(t)){var i=e._formatResponse(n.responseType,t);t?o(i):s(new x(i)),e.xhr=n=null}},ci(i)||(e._log.info('AjaxOptions method was not of type string. Defaulting to "GET".'),i="GET"),t.open(i.toUpperCase(),r,!0,n.user,n.password);var a=n.responseType;if(e.__fileSupported||""===a||"text"===a||(a=""),"json"===a)try{t.responseType=a}catch(e){t.responseType=""}t.withCredentials=n.withCredentials;var l=n.overrideMimeType,u=n.data;if(ci(l)&&!_i(l)&&t.overrideMimeType(l),mi(u)||""===u)e.__setHeaders(),t.send();else{var c=n.transforms||[],h=c.length,p=n.contentType,_=ci(p)&&!_i(p);if(h>0){for(var f=0;f<h;++f)u=c[f](u,t);_&&t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)}else if(ri(u))if(_){var d=p.toLowerCase();-1!==d.indexOf("x-www-form-urlencoded")?(u=e.__serializeFormData(),t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)):-1!==d.indexOf("multipart/form-data")?e.__fileSupported?(u=e.__appendFormData(),e.__setHeaders(),t.send(u)):e.__submitFramedFormData().then(function(e){o(e)},function(){e.xhr=null}):(u=JSON.stringify(u),t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u))}else e.__setHeaders(),t.send(u);else _&&t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)}var v=n.timeout;di(v)&&v>0&&(e.clearTimeout=Ii(function(){e.clearTimeout=Ri(function(){s(new x({response:"Request timed out in "+v+"ms for "+n.url,status:408,getAllResponseHeaders:function(){return t.getAllResponseHeaders()},xhr:t})),t.onreadystatechange=null,t.abort(),e.xhr=null},v-1)}))});return o.initialize(this),o},e.prototype._invalidOptions=function(){var e=this;return new w(function(t,n){e._log.warn("Attempting a request without specifying a url"),n(new x({response:"Attempting a request without specifying a url",status:null,getAllResponseHeaders:null,xhr:null}))})},e.prototype._formatResponse=function(e,t){var n=this.xhr,i=n.status,r=n.response;if(mi(r))try{r=n.responseText}catch(e){}if(0===i&&(i=t?200:404),n.onreadystatechange=null,vi(this.clearTimeout)&&this.clearTimeout(),"json"===e&&ci(r))try{r=JSON.parse(r)}catch(e){}return{response:r,status:i,getAllResponseHeaders:function(){return n.getAllResponseHeaders()},xhr:n}},e.prototype.__setHeaders=function(){var e,t,n=this.__options.headers,i=Object.keys(n||{}),r=this.xhr,o=i.length;for(t=0;t<o;++t)e=i[t],r.setRequestHeader(e,n[e])},e.prototype.__serializeFormData=function(){for(var e,t,n=this.__options.data,i=Object.keys(n),r=[];i.length>0;)mi(t=n[e=i.pop()])?t="":ri(t)&&(Ci(t)?t=t.toISOString():ui(t)?(this._log.warn('Invalid File entry with key "'+e+'"'),t="[object File]"):(this._log.warn('Invalid form entry with key "'+e+'" and value "'+t),t=JSON.stringify(t))),r.push(encodeURIComponent(e)+"="+encodeURIComponent(t));return r.join("&").replace(/%20/g,"+")},e.prototype.__appendFormData=function(){for(var e,t,n=this.__options.data,i=new FormData,r=Object.keys(n);r.length>0;)mi(t=n[e=r.pop()])?i.append(e,""):ri(t)?Ci(t)?i.append(e,t.toISOString()):ui(t)?i.append(e,t,t.name||t.fileName||"blob"):(this._log.warn('Invalid form entry with key "'+e+'" and value "'+t),i.append(e,JSON.stringify(t))):i.append(e,t);return i},e.prototype.__submitFramedFormData=function(){var e,t=this,n=this.__options,i=n.data,r=n.url,o=this._document,s=o.body,a=wr(f),l=o.createElement("form"),u=o.createElement("iframe"),c=Li("iframe_target"),h=Object.keys(i);for(u.name=l.target=c,u.src="javascript:false;",l.enctype=l.encoding="multipart/form-data",l.action=r,l.method="POST",l.style.display="none";h.length>0;)e=h.pop(),l.insertBefore(this.__createInput(e,i[e]),null);return new a(function(e,n){t.xhr.abort=function(){u.onload=null,s.removeChild(l),s.removeChild(u),n()},u.onload=function(){var n=u.contentDocument.body.innerHTML;s.removeChild(l),s.removeChild(u),e({response:n,status:200,getAllResponseHeaders:function(){return""}}),t.xhr=u.onload=null},s.insertBefore(l,null),s.insertBefore(u,null),l.submit()})},e.prototype.__createInput=function(e,t){var n=this._document,i=n.createElement("input");if(i.type="hidden",i.name=e,mi(t))i.value="";else if(ri(t))if(!vi(t.slice)||gi(t.name)||gi(t.path))this._log.info('Invalid form entry with key "'+e+'" and value "'+t),i.value=JSON.stringify(t);else{var r=n.querySelectorAll('input[type="file"][name="'+e+'"]'),o=r.length;if(0===o)this._log.info('Could not find input[type="file"] with [name="'+e+'"]. Stringifying data instead.'),i.value=JSON.stringify(t);else if(1===o){var s=(i=r[0]).cloneNode(!0);i.parentNode.insertBefore(s,i)}else{for(var a=void 0,l=t.path;o-- >0;)if((a=r[o]).value===l){var u=(i=a).cloneNode(!0);i.parentNode.insertBefore(u,i);break}-1===o&&(this._log.info('Could not find input[type="file"] with [name="'+e+'"] and [value="'+t.path+'"]. Stringifying data instead.'),i.value=JSON.stringify(t))}}else i.value=t;return i},e._inject={_browser:Q,_window:G,_document:m,_config:_,_log:E},e}();e.HttpRequest=C;var x=function(){function e(e){this.name="AjaxError",Error.apply(this),this.response=this.message=e.response,this.status=e.status,this.getAllResponseHeaders=e.getAllResponseHeaders,this.xhr=e.xhr}return e.prototype.toString=function(){var e=this.response,t=e;return ri(e)&&!e.hasOwnProperty("toString")&&(t=JSON.stringify(e)),"Request failed with status: "+this.status+" and response: "+t},e}();e.AjaxError=x,x.prototype=Error.prototype;var w=function(e){function t(t,n){var i=e.call(this,t)||this;return i._window=wr(G),mi(n)||(i.__http=n.__http),i}return __extends(t,e),t.prototype.initialize=function(e){ri(e)&&mi(this.__http)&&(this.__http=e)},t.prototype.cancel=function(){var e=this.__http,t=e.xhr,n=e.jsonpCallback;vi(e.clearTimeout)&&e.clearTimeout(),mi(t)?mi(n)||(this._window[n]=ei):(t.onreadystatechange=null,t.abort(),e.xhr=null),this.__subscribers=[]},t.prototype.then=function(t,n){return e.prototype.then.call(this,t,n)},t.prototype.catch=function(t){return e.prototype.catch.call(this,t)},t}(g);e.AjaxPromise=w;var T=function(){function e(){this.responseType={DEFAULT:"",ARRAYBUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},this.contentType={ENCODED_FORM:"application/x-www-form-urlencoded;charset=utf-8",JSON:"application/json;charset=utf-8",MULTIPART_FORM:"multipart/form-data",OCTET_STREAM:"application/octet-stream;charset=utf-8",XML:"application/xml;charset=utf-8",PLAIN_TEXT:"text/plain",HTML:"text/html"}}return e.prototype.ajax=function(e){var t=wr(p);return t.initialize(e),t.execute()},e.prototype.jsonp=function(e){var t=wr(p);return t.initialize(e),t.executeJsonp()},e.prototype.json=function(e){var t=wr(p);return t.initialize(ni(!1,!1,{},e,{responseType:"json"})),t.execute()},e.config={url:null,method:"GET",responseType:"",transforms:[],headers:{},withCredentials:!1,timeout:null,jsonpIdentifier:"callback",contentType:"application/json;charset=utf-8"},e}();function N(){return T.config}e.Http=T,ur.injectable(h,T),ur.injectable(p,C,null,bn),e.IHttpConfig=N,ur.injectable(_,N)}(Nr=e.async||(e.async={})),function(e){var t={},n={},i=function(){function e(e,t){this.__uid=e,this.__options=t,this.__size=0,mi(t)&&(this.__options={timeout:0}),n[e]={}}return e.create=function(n,i){var r=t[n];return mi(r)&&(r=t[n]=new e(n,i)),r},e.fetch=function(e){return t[e]},e.clear=function(){for(var e=Object.keys(t),n=e.length,i=0;i<n;++i)t[e[i]].clear();t={}},e.prototype.info=function(){return{uid:this.__uid,size:this.__size,options:this.__options}},e.prototype.put=function(e,t){var i=n[this.__uid][e];n[this.__uid][e]=t,gi(i)&&this.__size++;var r=this.__options.timeout;return di(r)&&r>0&&Ri(this.remove,r,[e],this),t},e.prototype.read=function(e){return n[this.__uid][e]},e.prototype.remove=function(e){Oi(n[this.__uid],e),this.__size--},e.prototype.clear=function(){n[this.__uid]={},this.__size=0},e.prototype.dispose=function(){this.clear(),Oi(t,this.__uid)},e}();function r(){return i}function o(){return e.managerCache}e.Cache=i,e.ICacheFactory=r,ur.injectable(P,r,null,Cn),e.managerCache=i.create("__managerCache"),e.IManagerCache=o,ur.injectable(O,o);var s=function(e){function t(){return e.call(this,"__templateCache")||this}return __extends(t,e),t.prototype.put=function(t,n){var i=this._Promise;if(e.prototype.put.call(this,t,i.resolve(n)),li(n))n=n.cloneNode(!0);else if(ai(n)){var r=document.createDocumentFragment();r.appendChild(n.cloneNode(!0)),n=r}else(ci(n)||mi(n))&&(n=tr(n));return i.resolve(n)},t.prototype.read=function(t){var n=this,i=e.prototype.read.call(this,t);return mi(i)?this._Promise.reject(null):i.then(function(e){return n.put(t,e)},function(e){return n._log.warn("Error retrieving template, "+t+", from promise."),null})},t._inject={_Promise:f,_log:E},t}(i);e.TemplateCache=s,ur.injectable(F,s);var a=function(){function e(e){var t=this;this._storage=e,Ei(function(e,n){t[n]=e},e)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._storage.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._storage.clear()},e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.key=function(e){return this._storage.key(e)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t),this[e]=this.getItem(e)},e}();e.BaseStorage=a;var l=function(e){function t(){return e.call(this,wr(G).localStorage)||this}return __extends(t,e),t}(a);e.LocalStorage=l,ur.injectable("$LocalStorage",l);var u=function(e){function t(){return e.call(this,wr(G).sessionStorage)||this}return __extends(t,e),t}(a);e.SessionStorage=u,ur.injectable("$SessionStorage",u)}(e.storage||(e.storage={}));var Rr,jr={"u+":{precedence:4,associativity:"rtl",fn:function(e,t,n){return+n(e,t)}},"+":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)+i(e,t)}},"u-":{precedence:4,associativity:"rtl",fn:function(e,t,n){return-n(e,t)}},"-":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)-i(e,t)}},"*":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)*i(e,t)}},"/":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)/i(e,t)}},"%":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)%i(e,t)}},"?":{precedence:15,associativity:"rtl",fn:function(){}},":":{precedence:15,associativity:"rtl",fn:function(){}},">":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>i(e,t)}},"<":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<i(e,t)}},"!":{precedence:4,associativity:"rtl",fn:function(e,t,n){return!n(e,t)}},"~":{precedence:4,associativity:"rtl",fn:function(e,t,n){return~n(e,t)}},"&":{precedence:10,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&i(e,t)}},"|":{precedence:12,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)|i(e,t)}},">>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>i(e,t)}},"<<":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<<i(e,t)}},">>>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>>i(e,t)}},"&&":{precedence:13,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&&i(e,t)}},"||":{precedence:14,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)||i(e,t)}},"==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)==i(e,t)}},"===":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)===i(e,t)}},"!=":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!=i(e,t)}},"!==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!==i(e,t)}},">=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>=i(e,t)}},"<=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<=i(e,t)}},"=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"++":{precedence:3,associativity:"",fn:function(e,t,n){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"--":{precedence:3,associativity:"",fn:function(e,t,n){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"+=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"-=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"*=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"/=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}},"%=":{precedence:17,associativity:"rtl",fn:function(e,t,n,i){plat.acquire(E).error(new Error("Assignment operators are not supported"))}}},Ar={"()":{precedence:2,associativity:null,fn:null},"[]":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},"{}":{precedence:1,associativity:null,fn:null}},Lr={"{":{precedence:1,associativity:null,fn:null},"}":{precedence:1,associativity:null,fn:null},"[":{precedence:2,associativity:null,fn:null},"]":{precedence:2,associativity:null,fn:null},"(":{precedence:2,associativity:null,fn:null},")":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},",":{precedence:18,associativity:null,fn:null},"'":{precedence:0,associativity:null,fn:null},'"':{precedence:0,associativity:null,fn:null}},Pr={false:!1,true:!0,null:null,undefined:"undefined"};function Or(e){return!mi(Ar[e])}function Fr(e){return!mi(jr[e])}function Mr(e){return!gi(Pr[e])}!function(e){var t=["push","pop","reverse","shift","sort","splice","unshift"],n=function(){function e(){this._compat=wr(d),this.__identifiers={},this.__identifierHash={},this.__lengthListeners={},this.__contextObjects={},this.__isArrayFunction=!1}return e.getManager=function(t){var n,i=e.__managers,r=t.uid,o=i[r];return mi(o)?((n=i[r]=new e).context=t,n):n=o},e.dispose=function(t){if(!mi(t)){var n=t.uid,i=e.__controls,r=i[n]||{},o=e.__managers,s=o[n];mi(s)||(s.dispose(),Oi(o,n));for(var a,l=Object.keys(r);l.length>0;)for(a=r[l.shift()];a.length>0;)a.shift()();Oi(i,n),t.hasOwnContext&&!mi(t.context)&&(e.unObserve(t.context),e.defineProperty(t,u,t.context,!0,!0,!0))}},e.removeArrayListeners=function(t,n){var i=e.arrayChangeListeners[t];mi(i)||Oi(i,n)},e.getContext=function(e,t){if(mi(e))return e;for(t=t.slice(0);t.length>0;)if(mi(e=e[t.shift()]))return e;return e},e.defineProperty=function(e,t,n,i,r,o){ti(e,t,n,i,r,o)},e.defineGetter=function(e,t,n,i,r){var o,s,a,l,u;o=e,s=t,a=n,l=i,u=r,Object.defineProperty(o,s,{get:function(){return a},enumerable:!0===l,configurable:!0===u})},e.pushRemoveListener=function(t,n,i){var r,o=e.__controls,s=o[n];mi(s)&&(s=o[n]={}),mi(r=s[t])&&(r=s[t]=[]),r.push(i)},e.spliceRemoveListener=function(t,n,i){var r,o=e.__controls[n];if(!mi(o)&&!mi(r=o[t])){var s=r.indexOf(i);-1!==s&&(r.splice(s,1),0===r.length&&Oi(o,t))}},e.removeIdentifier=function(t,n){for(var i,r=t.length,o=e.__controls,s=0;s<r;++s)mi(i=o[t[s]])||Oi(i,n)},e.createContext=function(t,n){var i=t.context;if(!ri(i)){if(!mi(i))return void e._log.warn("A child control is trying to create a child context that has a parent control with a primitive type context");i=t.context={}}for(var r,o,s=n.split(".");s.length>0;)mi(o=i[r=s.shift()])&&(o=di(Number(s[0]))?i[r]=[]:i[r]={}),i=o;return i},e.unObserve=function(e){ni(!0,!0,e)},e.prototype.getContext=function(e,t){return this._getContext(e.join("."),e,t)},e.prototype.observe=function(t,n){var i=this;if(_i(t))return ei;var r,o,s=t.split("."),a=s.pop(),l="length"===a,u=this._hasIdentifier(t),c=!mi(n);if(s.length>0?(r=s.join("."),o=this._getContext(r,s,!0)):(r=a,o=this.context),!ri(o))return c?(l&&(this.__lengthListeners[t]=n,e.pushRemoveListener(t,n.uid,function(){Oi(i.__lengthListeners,t)})),this._addObservableListener(t,n,l)):ei;this.__observedIdentifier=null,this.__contextObjects[t]=o[a];var h=this.__observedIdentifier,p=!mi(h),_=ei;if(p&&(u=!0),c){var f=ei,d=this._addObservableListener(t,n,l);p&&t!==h&&(f=this._addObservableListener(h,n,l)),_=function(){d(),f()}}var v=yi(o),m=_,g=ei,y=ei,b=Number(a);if(v&&b>=o.length)g=this.observe(r+".length",{uid:n.uid,listener:function(e,n){b>=e||(g(),i._define(t,o,a))}}),_=function(){m(),g()};else if(!u)if(v&&l){var C=s.pop(),x=this.getContext(s,!1);if(this.__observedIdentifier=null,Fi(x,C),ci(this.__observedIdentifier)&&(r=this.__observedIdentifier),c){var E=n.uid;g=this.observeArrayMutation(E,ei,r,o,null),y=this.observe(r,{uid:E,listener:function(e,t){g(),g=i.observeArrayMutation(E,ei,r,e,t)}})}_=function(){m(),y(),g()}}else this._define(t,o,a);return _},e.prototype.observeArrayMutation=function(e,t,n,i,r){if(yi(r)&&this._restoreArray(r),mi(i))return ei;var o=n.split("."),s=o.pop(),a=this.getContext(o,!1);this.__observedIdentifier=null,Fi(a,s),ci(this.__observedIdentifier)&&(n=this.__observedIdentifier);var l=[];return vi(t)&&l.push(this._pushArrayListener(e,n,t)),this._overwriteArray(n,i),function(){for(;l.length>0;)l.pop()()}},e.prototype.dispose=function(){this.context=null,this.__identifiers={},this.__identifierHash={},this.__contextObjects={}},e.prototype._pushArrayListener=function(t,n,i){var r=e.arrayChangeListeners,o=r[n];mi(o)&&(o=r[n]={});var s=o[t];mi(s)&&(s=o[t]=[]);var a=!1,l=function(){if(!a){a=!0,e.spliceRemoveListener(n,t,l);var u=s.indexOf(i);-1!==u&&(s.splice(u,1),0===s.length&&(Oi(o,t),_i(o)&&Oi(r,n)))}};return s.push(i),e.pushRemoveListener(n,t,l),l},e.prototype._restoreArray=function(e){var n=this._compat;if(n.setProto)Object.setPrototypeOf(e,Object.create(Array.prototype));else if(n.proto)e.__proto__=Object.create(Array.prototype);else for(var i=t.length,r=void 0,o=0;o<i;++o)e[r=t[o]]=Array.prototype[r]},e.prototype._overwriteArray=function(n,i){var r,o,s=this._compat,a=t.length;if(s.proto){var l=Object.create(Array.prototype);for(o=0;o<a;++o)l[r=t[o]]=this._overwriteArrayFunction(n,r);s.setProto?Object.setPrototypeOf(i,l):i.__proto__=l}else for(o=0;o<a;++o)e.defineProperty(i,r=t[o],this._overwriteArrayFunction(n,r),!1,!0,!0)},e.prototype._getContext=function(e,t,n){var i=this.__contextObjects[e];return mi(i)&&(i=!0===n?this.__contextObjects[e]=this._observeImmediateContext(t,e):this._getImmediateContext(t)),i},e.prototype._getImmediateContext=function(e){for(var t=this.context;e.length>0&&!mi(t=t[e.shift()]););return t},e.prototype._observeImmediateContext=function(e,t){return mi(this.__identifiers[t])&&this.observe(t,null),this._getImmediateContext(e)},e.prototype._getValues=function(e,t,n){for(var i,r,o,s=ri(t),a=ri(n);e.length>1&&(i=e.shift(),s&&mi(t=t[i])&&(s=!1),a&&mi(n=n[i])&&(a=!1),s||a););return i=e[0],mi(t)||(r=t[i]),mi(n)||(o=n[i]),{newValue:r,oldValue:o}},e.prototype._notifyChildProperties=function(e,t,n,i){for(var r,o,s,a,l,u,c,h,p,_,f,d=this,v=(i=i||Object.keys(this.__identifierHash[e]||{})).length,m={},g=e.length+1,y=0;y<v;++y){if(c="length"===(u=(a=(o=(r=i[y]).slice(g)).split(".")).pop()),_i(s=a.join("."))){if(p=n,_=mi(h=t)?void 0:h[u],f=mi(p)?void 0:p[u],c&&!yi(p)&&yi(h)){var b=this.__lengthListeners[r];if(!mi(b)){var C=b.uid,x=e.split("."),E=x.pop(),w=x.join("."),T=this._getContext(w,x,!1);this.__observedIdentifier=null,Fi(T,E),ci(this.__observedIdentifier)&&(w=this.__observedIdentifier);var N=this.observeArrayMutation(C,ei,w,h,null);this.observe(w,{uid:C,listener:function(e,t){N(),N=d.observeArrayMutation(C,ei,w,e,t)}}),Oi(this.__lengthListeners,r)}}}else mi(l=m[s])&&(l=m[s]=this._getValues(a,t,n)),h=l.newValue,p=l.oldValue,_=mi(h)?h:h[u],f=mi(p)?p:p[u];m[o]={newValue:_,oldValue:f},ri(h)&&(!yi(h)||h.length>u)&&this._define(r,h,u),this._execute(r,_,f)}m=null},e.prototype._addObservableListener=function(t,n,i){var r=this;if(!0===i){var o=t.split(".");o.pop();var s=o.pop(),a=this.getContext(o,!1);ri(a)&&(this.__observedIdentifier=null,Fi(a,s),ci(this.__observedIdentifier)&&(t=this.__observedIdentifier+(!0===i?".length":"")))}this.__add(t,n);var l=n.uid,u=function(){e.spliceRemoveListener(t,l,u),r._removeCallback(t,n)};return e.pushRemoveListener(t,l,u),u},e.prototype._define=function(e,t,n){ri(t[n])?this.__defineObject(e,t,n):this.__definePrimitive(e,t,n)},e.prototype._overwriteArrayFunction=function(t,n){var i=e.arrayChangeListeners[t]||{},r=this;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a,l,u,c,h,p,_=this.length,f=ii(this,!0),d="unshift"===n,v="shift"===n,m="splice"===n,g=v||d||m,y="sort"===n||"reverse"===n;g?(r.__isArrayFunction=!0,a=Array.prototype[n].apply(this,o),r.__isArrayFunction=!1,h=this.length,c=0,v?(u=0,p=_>0?[a]:[]):d?(u=o.length,p=[]):(u=o.length-2,c=o[0],p=a)):(a=Array.prototype[n].apply(this,o),h=this.length,y?l=f:"push"===n?(u=o.length,c=_,p=[]):"pop"===n&&(u=0,c=h,p=_>0?[a]:[])),(v||m||"pop"===n)&&e.unObserve(a);var b,C,x,E,w=Object.keys(i),T=w.length;for(x=0;x<T;++x)for(C=(b=i[w[x]]).length,E=0;E<C;++E)b[E]([{object:this,type:n,index:c,removed:p,addedCount:u,oldArray:l}]);return g?r._notifyChildProperties(t,this,f):r._execute(t+".length",h,_),a}},e.prototype._removeCallback=function(e,t){var n=this.__identifiers[e];if(!mi(n)){var i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&Oi(this.__contextObjects,e))}},e.prototype._hasIdentifier=function(e){return!_i(this.__identifiers[e])},e.prototype._execute=function(e,t,n){var i=this.__identifiers[e];if(gi(t)?Oi(this.__contextObjects,e):this.__contextObjects[e]=t,t!==n&&!mi(i))for(var r=i.slice(0),o=r.length,s=0;s<o;++s)r[s].listener(t,n)},e.prototype.__defineObject=function(t,n,i){var r=this,o=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=t,o},set:function(s){if(o!==s){var a=o;if(o=s,!r.__isArrayFunction){e.unObserve(a);var l,u=r.__identifierHash[t],c=!1;ri(u)&&(c=(l=Object.keys(u)).length>0),r._execute(t,o,a),c?(r._notifyChildProperties(t,o,a,l),ri(o)||r.__definePrimitive(t,n,i)):_i(r.__identifiers[t])?e.defineProperty(n,i,o,!0,!0,!0):ri(o)||r.__definePrimitive(t,n,i)}}}})},e.prototype.__definePrimitive=function(t,n,i){var r=this,o=n[i],s=!mi(o);yi(n)&&"length"===i||Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=t,o},set:function(a){if(o!==a){var l=o;if(o=a,!r.__isArrayFunction||!yi(n)){var u,c=r.__identifierHash[t],h=!1;ri(c)&&(h=(u=Object.keys(c)).length>0),r._execute(t,a,l),!h&&_i(r.__identifiers[t])?e.defineProperty(n,i,o,!0,!0,!0):ri(o)?(r.__defineObject(t,n,i),h&&r._notifyChildProperties(t,a,l,u)):s||(r.__definePrimitive(t,n,i),s=!0)}}}})},e.prototype.__add=function(e,t){var n=this.__identifiers[e],i=t.priority,r=!1;if(mi(n)&&(n=this.__identifiers[e]=[]),di(i)){for(var o=n.length,s=0;s<o;++s)if(i>n[s].priority){n.splice(s,0,t),r=!0;break}}else t.priority=-1;r||n.push(t),this.__addHashValues(e)},e.prototype.__addHashValues=function(e){var t=this.__identifierHash;if(!ri(t[e])){t[e]={};for(var n,i,r,o,s=e,a=[];-1!==(n=s.lastIndexOf("."));){for(i=t[s=s.slice(0,n)],o=a.length,mi(i)&&(i=t[s]={}),i[e]=!0,r=0;r<o;++r)i[a[r]]=!0;a.push(s)}}},e.arrayChangeListeners={},e.__managers={},e.__controls={},e}();function i(e){return n._log=e,n}e.ContextManager=n,e.IContextManagerStatic=i,ur.injectable(S,i,[E],gn),ur.injectable("$ContextManagerInstance",n,null,bn)}(e.observable||(e.observable={})),function(e){var t=function(){function e(){this.defaultPrevented=!1,this.stopped=!1}return e.prototype.initialize=function(e,t,n){this.name=e,this.direction=n||this._EventManager.UP,this.sender=t},e.prototype.preventDefault=function(){this.defaultPrevented||this._ContextManager.defineGetter(this,"defaultPrevented",!0)},e.prototype.stopPropagation=function(){this.direction===this._EventManager.UP&&(this.stopped=!0,this._EventManager.propagatingEvents[this.name]=!1)},e._inject={_EventManager:b,_ContextManager:S},e}();e.DispatchEvent=t,ur.injectable(g,t,null,bn);var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.dispatch=function(e,t){var n=wr(x);return n.initialize(e,t),r.sendEvent(n),n},t.prototype.initialize=function(t,n){e.prototype.initialize.call(this,t,n,this._EventManager.DIRECT)},t}(t);function i(){return n}e.LifecycleEvent=n,e.ILifecycleEventStatic=i,ur.injectable(C,i,null,gn),ur.injectable(x,n,null,bn);var r=function(){function e(){}return e.initialize=function(){if(!e.__initialized){e.__initialized=!0;for(var t,i=e.__lifecycleEventListeners,r=e._compat,o=e._document,s=e._window,a=e._dom,l=n.dispatch;i.length>0;)t=i.pop(),o.removeEventListener(t.name,t.value,!1);if(r.cordova){for(var u,c=["resume","online",wt],h=r.winJs,p=c.length,_=function(t){return function(){l(t,e)}},f=void 0,d=0;d<p;++d)f=_(u=c[d]),i.push({name:u,value:f}),a.addEventListener(o,u,f,!1);f=_(Et),i.push({name:"pause",value:f}),a.addEventListener(o,"pause",f,!1),f=_(xt),i.push({name:jt,value:f}),a.addEventListener(o,jt,f,!1),f=function(){return h||l(At,e),!0},i.push({name:At,value:f}),a.addEventListener(o,At,f,!1),h&&(f=function(){return l(At,e),!0},i.push({name:Lt,value:f}),s.WinJS.Application.addEventListener(Lt,f,!1))}else{if(r.amd)return;a.addEventListener(s,"load",function(){l(xt,e)})}}},e.dispose=function(t){Oi(e.__eventsListeners,t)},e.on=function(t,n,i,r){var o=e.__eventsListeners[t];mi(o)&&(o=e.__eventsListeners[t]={listeners:{},context:r});var s=o.listeners[n];return yi(s)||(s=o.listeners[n]=[]),s.push(i),function(){var e=s.indexOf(i);-1!==e&&s.splice(e,1)}},e.dispatch=function(t,n,i,r){var o=wr(g);return o.initialize(t,n,i),e.sendEvent(o,r),o},e.hasDirection=function(t){return t===e.UP||t===e.DOWN||t===e.DIRECT},e.sendEvent=function(t,n){var i=t.name,r=t.direction;switch(n=n||[],e.propagatingEvents[i]=!0,n=n||[],r){case e.UP:e._dispatchUp(t,n);break;case e.DOWN:e._dispatchDown(t,n);break;case e.DIRECT:e._dispatchDirect(t,n)}Oi(e.propagatingEvents,i)},e._dispatchUp=function(t,n){for(var i=t.name,r=t.sender;!mi(r)&&e.propagatingEvents[i];)mi(r.uid)?r=r.parent:(e.__executeEvent(r.uid,t,n),r=r.parent)},e._dispatchDown=function(t,n){var i,r=[],o=t.name;for(r.push(t.sender);r.length&&e.propagatingEvents[o];)mi((i=r.pop()).uid)||(e.__executeEvent(i.uid,t,n),mi(i.controls)||(r=r.concat(i.controls)))},e._dispatchDirect=function(t,n){for(var i,r=Object.keys(e.__eventsListeners),o=r.length,s=t.name,a=0;a<o&&e.propagatingEvents[s];++a)mi(i=e.__eventsListeners[r[a]])||mi(i.listeners[s])||e.__callListeners(i.context,t,i.listeners[s],n)},e.__executeEvent=function(t,n,i){var r=e.__eventsListeners[t];if(!mi(r)){var o=r.context,s=r.listeners[n.name];mi(s)||e.__callListeners(o,n,s,i)}},e.__callListeners=function(t,n,i,r){var o=n.name,s=i.length,a=-1;for(r=[n].concat(r);++a<s&&e.propagatingEvents[o];)try{i[a].apply(t,r)}catch(t){e._log.debug(t)}},e.UP="up",e.DOWN="down",e.DIRECT="direct",e.propagatingEvents={},e.__eventsListeners={},e.__lifecycleEventListeners=[],e.__initialized=!1,e}();function o(e,t,n,i,o){return r._log=e,r._compat=t,r._document=n,r._window=i,r._dom=o,r}e.EventManager=r,e.IEventManagerStatic=o,ur.injectable(b,o,[E,d,m,G,z],gn);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.dispatch=function(e,n,i,r){var o=wr(t);return o.initialize(e,n,null,i),o.logLevel=r,t._EventManager.sendEvent(o),o},t.prototype.initialize=function(t,n,i,r){e.prototype.initialize.call(this,t,n,this._EventManager.DIRECT),this.error=r},t}(t);function a(e){return s._EventManager=e,s}e.ErrorEvent=s,e.IErrorEventStatic=a,ur.injectable(y,a,[b],gn)}(Rr=e.events||(e.events={}));var Dr=function(){function e(){this.uid=Li(le),this.priority=0,this.dom=e._dom,this.utils=wr(H),this._log=e._log}return e.getRootControl=function(t){if(mi(t))return t;if(!mi(t.root))return t.root;for(;!mi(t.parent)&&!t.hasOwnContext;){if(!mi(t.root))return t.root;t=t.parent}return!t.hasOwnContext&&ri(t.context)&&e._log.debug("Root control: "+t.type+" found that sets its context to an Object but does not set the hasOwnContext flag to true. Please set the flag if the control intends to use its own context."),t},e.load=function(t){var n=e._Promise;if(mi(t))return n.resolve();var i=t;if(ci(i.absoluteContextPath)){if(vi(i.contextChanged))e._ContextManager.getManager(i.root).observe(i.absoluteContextPath,{uid:t.uid,priority:1e3,listener:function(e,n){zr.TemplateControl.contextChanged(t,e,n)}}),vi(i.zCC__plat)&&(i.zCC__plat(),Oi(i,"zCC__plat"));var r=i.element;ai(r)&&vi(r.removeAttribute)&&r.removeAttribute(Pt)}return vi(t.loaded)?n.resolve(t.loaded()):n.resolve()},e.dispose=function(t){var n=t;if(!mi(n))if(gi(n.templateControl)){if(n.hasOwnContext)zr.ViewControl.dispose(n);else if(n.controls)zr.TemplateControl.dispose(n);else if(vi(t.dispose)&&t.dispose(),e.removeEventListeners(t),e._ContextManager.dispose(t),t.element=null,e.removeParent(t),t.__injectable__type===gn){var i=vr[t.type];ur.control(t.type,t.constructor,i.dependencies,!0)}}else Br.dispose(n)},e.removeParent=function(e){if(!mi(e)){var t=e.parent;if(!mi(t)){var n=t.controls||[],i=n.indexOf(e);-1!==i&&n.splice(i,1),e.parent=null}}},e.removeEventListeners=function(t){if(!mi(t)){var n=e.__eventListeners,i=t.uid,r=n[i];if(yi(r)){for(var o=r.length;o-- >0;)r[o]();Oi(n,i)}}},e.getInstance=function(){return new e},e.__addRemoveListener=function(t,n){var i=e.__eventListeners;yi(i[t])?i[t].push(n):i[t]=[n]},e.__spliceRemoveListener=function(t,n){var i=e.__eventListeners[t];if(yi(i)){var r=i.indexOf(n);if(-1===r)return;i.splice(r,1)}},e.__getControls=function(t,n,i){var r,o=[],s=e.getRootControl(t);mi(s)||s[n]!==i||o.push(s);var a=s.controls;if(mi(a))return o;for(var l=[].concat(a);l.length>0;)(r=l.shift())[n]===i&&o.push(r),mi(r.controls)||(l=l.concat(r.controls));return o},e.prototype.initialize=function(){},e.prototype.loaded=function(){},e.prototype.getControlsByName=function(t){return e.__getControls(this,"name",t)},e.prototype.getControlsByType=function(t){return ci(t)?e.__getControls(this,"type",t):e.__getControls(this,"constructor",t)},e.prototype.addEventListener=function(t,n,i,r){if(!vi(i))return this._log.warn('"Control.addEventListener" must take a function as the third argument.'),ei;i=i.bind(this);var o=this.dom.addEventListener(t,n,i,r),s=this.uid;return e.__addRemoveListener(s,o),function(){o(),e.__spliceRemoveListener(s,o)}},e.prototype.observe=function(t,n){var i,r=this,o=ri(this.context)?this:this.parent,s=e.getRootControl(o);if(mi(o))return ei;if(mi(o.absoluteContextPath))return this._log.warn("Should not call plat.Control.observe prior to the control being loaded"),ei;if(_i(n))i=o.absoluteContextPath;else if(ci(n)){var a=(e._parser||wr(w)).parse(n);a.identifiers.length>1&&this._log.warn("Only a single identifier can be observed when calling the function plat.Control.observe");var l=a.identifiers[0];if("@"===l[0]){var c=l.split("."),h=c.shift().slice(1),p=c.length>0?"."+c.join("."):"";i=h===Dn?u+p:h===zn?o.absoluteContextPath+p:o.absoluteContextPath+"."+l}else i=o.absoluteContextPath+"."+l}else i=o.absoluteContextPath+"."+n;return(e._ContextManager||wr(S)).getManager(s).observe(i,{listener:function(e,i){t.call(r,e,i,n)},uid:this.uid})},e.prototype.observeArray=function(t,n){var i,r,o=ri(this.context)?this:this.parent,s=o.context;if(mi(o)||!ri(s))return ei;if(_i(n))i=s,r=o.absoluteContextPath;else if(ci(n)){var a=(e._parser||wr(w)).parse(n);i=a.evaluate(s),r=o.absoluteContextPath+"."+a.identifiers[0]}else i=s[n],r=o.absoluteContextPath+"."+n;if(!yi(i))return ei;if(!vi(t))return ei;t=t.bind(this);var l=(e._ContextManager||wr(S)).getManager(e.getRootControl(o)),u=this.uid,c=function(e){t(e,n)},h=l.observeArrayMutation(u,c,r,i,null),p=l.observe(r,{listener:function(e,t){h(),h=l.observeArrayMutation(u,c,r,e,t)},uid:u});return function(){h(),p()}},e.prototype.observeExpression=function(t,n){var i=this;if(_i(n))return ei;if(ci(n))n=(e._parser||wr(w)).parse(n);else if(!vi(n.evaluate))return ei;var r=mi(this.resources)?this.parent:this;if(mi(r)||!ci(r.absoluteContextPath))return ei;var o,s,a,l,u=n.aliases,c=u.length,h={},p=(e._ContextManager||wr(S)).getManager,_=zr.TemplateControl,f=_.findResource,d=_.evaluateExpression;for(l=0;l<c;++l)o=u[l],mi(s=f(r,o))||(a=s.resource.type)!==An&&a!==Fn||(h[o]=p(s.control));var v,m,g=n.identifiers,y=p(e.getRootControl(r)),b=r.absoluteContextPath,C=b+".",x={};for(c=g.length,l=0;l<c;++l)m=(v=g[l]).split(".")[0],"@"!==v[0]?x[C+v]=y:(o=m.slice(1))===zn?x[b+v.replace(m,"")]=y:o===Dn?x[v.replace(m,"context")]=y:(v=v.replace(m,"resources."+o+".value"),mi(h[o])||(x[v]=h[o]));c=(g=Object.keys(x)).length;var E=d(n,r),T=[],N=this.uid,k=function(){var e=d(n,r);t.call(i,e,E,n.expression),E=e};for(l=0;l<c;++l)v=g[l],T.push(x[v].observe(v,{uid:N,listener:k}));return function(){for(var e=T.length,t=0;t<e;++t)T[t]()}},e.prototype.evaluateExpression=function(e,t){return zr.TemplateControl.evaluateExpression(e,this.parent,t)},e.prototype.findProperty=function(t,n){var i,r=(e._parser||wr(w)).parse(t);for(mi(n)&&(n=this);!mi(n);){if(!mi(i=r.evaluate(n)))return{expresssion:r,control:n,value:i};n=n.parent}},e.prototype.dispatchEvent=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=e._EventManager||wr(b);o.hasDirection(n)||(gi(n)||i.unshift(n),n=o.UP);var s=this;mi(s.templateControl)||(s=s.templateControl),o.dispatch(t,s,n,i)},e.prototype.on=function(t,n){return(e._EventManager||wr(b)).on(this.uid,t,n,this)},e.prototype.dispose=function(){},e.__eventListeners={},e}();function $r(e,t,n,i,r,o){return Dr._parser=e,Dr._ContextManager=t,Dr._EventManager=n,Dr._Promise=i,Dr._dom=r,Dr._log=o,Dr}e.Control=Dr,e.IControlFactory=$r,ur.injectable(v,$r,[w,S,b,f,z,E],Cn);var zr,Br=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateControl=null,t}return __extends(t,e),t.dispose=function(e){Oi(e,"templateControl"),Dr.dispose(e)},t.getInstance=function(){return new t},t}(Dr);function Ur(){return Br}e.AttributeControl=Br,e.IAttributeControlFactory=Ur,ur.injectable("$AttributeControlFactory",Ur,null,Cn),function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=100,t.context=null,t.absoluteContextPath=null,t.hasOwnContext=!1,t.replaceWith="any",t}return __extends(t,e),t.evaluateExpression=function(e,n,i){if(_i(e))return e;if(ci(e))e=t._parser.parse(e);else if(!vi(e.evaluate))return e;return mi(n)?e.evaluate(null,i):e.aliases.length>0&&_i(i=t.getResources(n,e.aliases,i))?void 0:e.evaluate(n.context,i)},t.getResources=function(e,n,i){if(mi(e))return{};var r,o,s,a=n.length,l=t.__resourceCache[e.uid];mi(l)&&(l=t.__resourceCache[e.uid]={}),i=i||{};for(var u=0;u<a;++u)if("@"===(r=n[u])[0]&&(r=r.slice(1)),r!==zn)if(r!==Dn){if(mi(i[r])){if(mi(l[r]))s=t.findResource(e,r);else{var c=l[r].control,h=c.resources;s=mi(h)?t.findResource(e,r):{control:c,resource:h[r]}}if(mi(s)){if(-1!==e.type.indexOf(wn))continue;t._log.warn("Resource alias: "+r+" is not defined.")}else l[r]=s,o=s.resource,i[r]=mi(o)?o:o.value}}else i[r]=Dr.getRootControl(e).context;else i[r]=e.context;return i},t.findResource=function(e,t){var n;if(!mi(e)&&!mi(e.resources)&&ci(t)&&!_i(t)){"@"===t[0]&&(t=t.slice(1));var i=t===Dn;if(i||t===zn||t===$n){if(i&&(e=Dr.getRootControl(e)),mi(n=(e.resources||{})[t]))return;return{resource:n,control:e}}for(;!mi(e);){if(!mi(n=(e.resources||{})[t]))return{resource:n,control:e};e=e.parent}}},t.dispose=function(e){if(!mi(e)){var n=e.uid,i=e.controls,r=i&&i.slice(0),o=Dr._ContextManager,s=o.defineProperty;if(!mi(r))for(var a=r.length-1;a>=0;--a)Dr.dispose(r[a]);if(vi(e.dispose)&&e.dispose(),Dr.removeEventListeners(e),t.removeElement(e),t._ResourcesFactory.dispose(e),t._BindableTemplatesFactory.dispose(e),Oi(t.__resourceCache,e.uid),o.dispose(e),Rr.EventManager.dispose(e.uid),t._managerCache.remove(n),Dr.removeParent(e),s(e,"resources",null,!0,!0,!0),e.attributes=null,e.bindableTemplates=null,e.controls=[],e.root=null,e.innerTemplate=null,e.__injectable__type===gn){var l=vr[e.type];ur.control(e.type,e.constructor,l.dependencies,!0)}}},t.loadControl=function(e){for(var n,i=e.controls,r=i.length,o=0;o<r;++o)mi((n=i[o]).controls)?n.loaded():t.loadControl(n);e.loaded()},t.contextChanged=function(e,n,i){e.context=n,t.setContextResources(e),vi(e.contextChanged)&&e.contextChanged(n,i)},t.setContextResources=function(e){var n=e.context;mi(e.resources)&&(e.resources=t._ResourcesFactory.getInstance(),e.resources.initialize(e)),e.hasOwnContext&&(mi(e.resources.rootContext)?e.resources.add({root:{type:An,value:n}}):e.resources.rootContext.value=n),mi(e.resources.context)?e.resources.add({context:{type:An,value:n}}):e.resources.context.value=n},t.removeElement=function(e){if(!mi(e)){var t,n=e.element;if(null===e.replaceWith||""===e.replaceWith||li(n))return ir(e.startNode,e.endNode),void(e.elementNodes=e.startNode=e.endNode=null);mi(n)||(mi(t=n.parentNode)||t.removeChild(n),e.element=null)}},t.setAbsoluteContextPath=function(e,t){Dr._ContextManager.defineGetter(e,"absoluteContextPath",t,!1,!0)},t.determineTemplate=function(e,n){var i=t._templateCache,r=e.dom,o=t._Promise;if(mi(n)){if(mi(e.templateUrl)){if(mi(e.templateString))return o.reject(null);var s=e.type;return i.read(s).catch(function(t){return mi(t)&&(t=e.templateString),i.put(s,t)})}n=e.templateUrl}else;return r.getTemplate(n)},t.detach=function(e){if(!mi(e)&&!mi(e.controls)){for(var n=e.controls.slice(0),i=n.length,r=0;r<i;++r)Dr.dispose(n[r]);Dr.removeEventListeners(e),t.removeElement(e),t._ResourcesFactory.dispose(e,!0),Oi(t.__resourceCache,e.uid),Dr._ContextManager.dispose(e),Rr.EventManager.dispose(e.uid),t._managerCache.remove(e.uid),Dr.removeParent(e),e.controls=[],e.attributes=null}},t.getInstance=function(){return new t},t.prototype.contextChanged=function(e,t){},t.prototype.setTemplate=function(){},t.prototype.getResources=function(e,n){return t.getResources(this,e,n)},t.prototype.findResource=function(e){return t.findResource(this,e)},t.prototype.evaluateExpression=function(e,n){return t.evaluateExpression(e,this,n)},t.__resourceCache={},t}(Dr);function n(e,n,i,r,o,s,a,l){return t._ResourcesFactory=e,t._BindableTemplatesFactory=n,t._managerCache=i,t._templateCache=r,t._parser=o,t._http=s,t._Promise=a,t._log=l,t}e.TemplateControl=t,e.ITemplateControlFactory=n,ur.injectable(V,n,[U,$,O,F,w,h,f,E],Cn),ur.injectable(q,t,null,bn);var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=120,t._listeners=[],t}return __extends(t,e),t.prototype.onInput=function(e){var t=this._listeners;return t.push(e),function(){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},t.prototype.observeProperties=function(e){},t.prototype.inputChanged=function(e,t){if(e!==t)for(var n=this._listeners,i=n.length,r=0;r<i;++r)n[r](e,t)},t.prototype.dispose=function(){this._listeners=[]},t}(t);e.BindControl=i;var r=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasOwnContext=!0,t}return __extends(n,e),n.dispose=function(e){t.dispose(e)},n.getInstance=function(){return new n},n.prototype.canNavigateFrom=function(){},n.prototype.canNavigateTo=function(e,t){},n.prototype.navigatingFrom=function(){},n.prototype.navigatedTo=function(e,t){},n}(t);e.ViewControl=r;var c=function(){function e(){this._domEvents=wr(B)}return e.prototype.addEventListener=function(e,t,n,i){return this._domEvents.addEventListener(e,t,n,i)},e.prototype.appendChildren=function(e,t){return Yi(e,t)},e.prototype.cloneChildren=function(e,t){return Yi(e,t,!0)},e.prototype.clearNode=function(e){return Xi(e)},e.prototype.clearNodeBlock=function(e,t){return Gi(e,t)},e.prototype.setInnerHtml=function(e,t){return Ji(e,t)},e.prototype.insertBefore=function(e,t,n){return Ki(e,t,n)},e.prototype.replace=function(e){return Zi(e)},e.prototype.replaceWith=function(e,t){return er(e,t)},e.prototype.serializeHtml=function(e){return tr(e)},e.prototype.removeBetween=function(e,t){return nr(e,t)},e.prototype.removeAll=function(e,t){return ir(e,t)},e.prototype.addClass=function(e,t){return sr(e,t)},e.prototype.removeClass=function(e,t){return ar(e,t)},e.prototype.toggleClass=function(e,t){return function(e,t){var n=(e||{}).className;if(ci(n)&&ci(t)&&""!==t){var i,r=t.split(Bi);if(gi(e.classList)){var o=void 0;if(""===n)e.className=t;else if(n===t)return void(e.className="");for(;r.length>0;)if(""!==(i=r.shift())){if((o=new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g")).test(n)){e.className=n=n.replace(o,"");continue}e.className+=" "+i}}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.toggle(i)}}(e,t)},e.prototype.replaceClass=function(e,t,n){return function(e,t,n){var i=(e||{}).className;if(ci(i)&&ci(n)&&""!==n)if(gi(e.classList)){var r=new RegExp("^"+t+"\\s+","g"),o=new RegExp("\\s+"+t+"\\s+","g"),s=new RegExp("\\s+"+t+"$","g");e.className=i.replace(r,n+" ").replace(o," "+n+" ").replace(s," "+n)}else e.classList.add(n),e.classList.remove(t)}(e,t,n)},e.prototype.hasClass=function(e,t){return lr(e,t)},e.prototype.getTemplate=function(e){return t=e,s=s||(s=plat.acquire(F)),a=a||(a=plat.acquire(h)),s.put(t,s.read(t).catch(function(e){if(mi(e))return a.ajax({url:t})}).then(function(e){if(li(e))return s.put(t,e);if(!ri(e)||!ci(e.response))return(l=l||(l=plat.acquire(E))).warn("No template found at "+t),s.put(t);var n=e.response;return _i(n.trim())?s.put(t):s.put(t,n)}).catch(function(e){return Ii(function(){(l=l||(l=plat.acquire(E))).error(new Error("Failure to get template from "+t+"."))}),e}));var t},e.prototype.whenPresent=function(e,t){return function(e,t){if(!ai(t))return(l=l||(l=plat.acquire(E))).error(new Error("Attempting to check DOM presence of something that isn't a Node.")),ei;var n=(o=o||(o=plat.acquire(m))).body;if(ai(t.parentElement)&&n.contains(t))return e(),ei;var i=ji(function(){ai(t.parentElement)&&n.contains(t)&&(i(),e())},100);return i}(e,t)},e.prototype.whenVisible=function(e,t){return function(e,t){if(!ai(t))return(l=l||(l=plat.acquire(E))).error(new Error("Attempting to check visibility of something that isn't a Node.")),ei;var n=t.clientWidth,i=t.clientHeight;if(!di(n)||!di(i))return(l=l||(l=plat.acquire(E))).error(new Error("Attempting to check visibility of something that isn't an Element.")),ei;if(n>0&&i>0)return e(),ei;var r=ji(function(){t.clientWidth>0&&t.clientHeight>0&&(r(),e())},100);return r}(e,t)},e._inject={_domEvents:B},e}();e.Dom=c,ur.injectable(z,c);var p=function(){function e(){this._ResourcesFactory=wr(U),this._ControlFactory=wr(v),this._TemplateControlFactory=wr(V),this._ContextManager=wr(S),this._Promise=wr(f),this._managerCache=wr(O),this._document=wr(m),this._ElementManagerFactory=wr(j),this._BindableTemplatesFactory=wr($),this._log=wr(E),this.templates={},this.cache={},this.__compiledControls=[]}return e.create=function(t,n){var i=new e;return i.control=t,mi(n)||(i.templates=n.templates,i.cache=n.cache),i},e.dispose=function(e){if(!mi(e)){var t=e.bindableTemplates;!mi(t)&&vi(t.dispose)&&t.dispose()}},e.isBoundControl=function(e){if(mi(e))return!1;var t=e.parent;return!mi(t)&&0===e.type.indexOf(t.type+Tn)},e.prototype.once=function(e,t,n){var i,r=this;if(mi(e))return this._Promise.resolve(this._document.createDocumentFragment());if(ci(e))i=tr(e);else if(li(e))i=e;else if(i=this._document.createDocumentFragment(),ai(e))i.appendChild(e);else{if(!bi(e))return this._Promise.resolve(i);Yi(e,i)}if(mi(t)||di(t)||ci(t)){var o=this.control,s=this._managerCache.read(o.uid),a=this._ElementManagerFactory.getInstance(),l=this._createBoundControl("",i,t,n),u=this._createNodeMap(l,i,t);return o.controls.push(l),s.children=[],a.initialize(u,s),a.setUiControlTemplate(),a.fulfillAndLoad().then(function(){var e=r._document;return l.startNode=i.insertBefore(e.createComment(l.type+kn),i.firstChild),l.endNode=i.insertBefore(e.createComment(l.type+Sn),null),i})}this._log.warn(this.control.type+" cannot bind template with relativeIdentifier: "+t+". Identifier must be either a string or number")},e.prototype.bind=function(e,t,n){return this._bind(e,t,n)},e.prototype.add=function(e,t,n){if(_i(e))this._log.debug(this.control.type+" must use a valid key to add a template to BindableTemplates.");else if((mi(this.templates[e])||n)&&!mi(t))if(ci(t))this._compile(e,tr(t));else if(li(t))this._compile(e,t);else{var i=this._document.createDocumentFragment();if(ai(t))i.appendChild(t);else{if(!bi(t))return;Yi(t,i)}this._compile(e,i)}},e.prototype.replace=function(t,n,i,r){var o=this.control.controls[t];if(!e.isBoundControl(o))return this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" is not a bound control and thus cannot be replaced by BindableTemplates."),this._Promise.resolve([]);var s=o.endNode;return ai(s)&&ai(s.parentNode)?this._bind(n,i,r,t):(this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" had either no placeholding comment nodes or its comment nodes had no parent and thus cannot be replaced by BindableTemplates."),this._Promise.resolve([]))},e.prototype.dispose=function(){for(var e=this._TemplateControlFactory.dispose,t=this.__compiledControls,n=t.length,i=0;i<n;++i)e(t[i]);this.__compiledControls=[],this.control=null,this.cache={},this.templates={}},e.prototype._bind=function(e,t,n,i){var r=this,o=this.templates[e],s=mi(i);if(mi(o))this._log.error(new Error(this.control.type+" cannot bind template, no template stored with key: "+e));else{if(mi(t)||di(t)||ci(t))return o=o.then(function(i){var o=i.cloneNode(!0),a=r._createBoundControl(e,o,t,n),l=r._createNodeMap(a,o,t);return s&&r.control.controls.push(a),r._bindTemplate(e,l)}),s?o.then(null,function(e){return Ii(function(){ci(e)&&(e=new Error(e)),r._log.error(e)}),r._document.createDocumentFragment()}):o.then(function(e){var t=Array.prototype.slice.call(e.childNodes),n=r.control.controls[i],o=n.endNode,s=o.parentNode,a=o.nextSibling;return r._TemplateControlFactory.dispose(n),s.insertBefore(e,a),t}).then(null,function(e){return Ii(function(){ci(e)&&(e=new Error(e)),r._log.error(e)}),r._document.createDocumentFragment()});this._log.warn(this.control.type+" cannot bind template with relativeIdentifier: "+t+". Identifier must be either a string or number")}},e.prototype._bindTemplate=function(e,t){var n=this,i=t.uiControlNode.control,r=!1,o=vi(i.dispose)?i.dispose.bind(i):ei;return i.dispose=function(){r=!0,o(),i.dispose=o},this._bindNodeMap(e,t).then(function(){var e=n._document,o=t.element;return r?e.createDocumentFragment():(i.startNode=o.insertBefore(e.createComment(i.type+kn),o.firstChild),i.endNode=o.insertBefore(e.createComment(i.type+Sn),null),o)},function(e){return Ii(function(){ci(e)&&(e=new Error(e)),n._log.error(e)}),null})},e.prototype._bindNodeMap=function(e,t){var n=this.cache[e],i=t.uiControlNode.control,r=t.element,o=this._managerCache;return n.clone(r,o.read(this.control.uid),t),o.read(i.uid).bindAndLoad()},e.prototype._compile=function(e,t){var n=this._createBoundControl(e+wn,t),i=this._createNodeMap(n,t);this.__compiledControls.push(n),this._compileNodeMap(n,i,e)},e.prototype._compileNodeMap=function(e,t,n){var i=this,r=this._ElementManagerFactory.getInstance(),o=[];r.isClone=!0,r.initialize(t,null),r.setUiControlTemplate(),this.cache[n]=r,o.push(r.fulfillTemplate()),this.templates[n]=this._Promise.all(o).then(function(){var n=t.element,r=n.cloneNode(!0),o=i._document,s=e.startNode=o.createComment(e.type+kn),a=e.endNode=o.createComment(e.type+Sn);return n.insertBefore(s,n.firstChild),n.insertBefore(a,null),r})},e.prototype._createNodeMap=function(e,t,n){return{element:t,attributes:{},nodes:[],childContext:n,uiControlNode:{control:e,nodeName:e.type,expressions:[],injector:null}}},e.prototype._createBoundControl=function(e,t,n,i){var r=this._TemplateControlFactory.getInstance(),o=this._ResourcesFactory,s=this.control,a=this.cache[e],l=ri(a),c=o.getInstance();if(l){var h=a.getUiControl();c.initialize(r,h.resources),c.add(i)}else c.initialize(r,i);if(r.resources=c,o.addControlResources(r),r.bindableTemplates=this._BindableTemplatesFactory.create(r,s.bindableTemplates),r.parent=s,r.controls=[],r.element=t,r.type=s.type+Tn+e,r.root=this._ControlFactory.getRootControl(r),l){var p=this._ContextManager.getManager(r.root);r.absoluteContextPath=s.absoluteContextPath||u,mi(n)||(r.absoluteContextPath+="."+n),r.context=p.getContext(r.absoluteContextPath.split("."),!1)}return r},e}();function _(){return p}e.BindableTemplates=p,e.IBindableTemplatesFactory=_,ur.injectable($,_,null,Cn);var g=function(){function e(){this.__listeners={}}return e.getInstance=function(){return new e},e.prototype.initialize=function(e,t){this.__control=e;for(var n,i=Object.keys(t),r=this.__listeners,o=i.length,s=0;s<o;++s)this[n=i[s]]=t[n],r[n]=[]},e.prototype.observe=function(e,t){var n=this.__listeners[Pi(t)];return mi(n)?ei:(e=e.bind(this.__control),n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)})},e.prototype._attributeChanged=function(e,t,n){for(var i=this.__listeners[Pi(e)],r=i.length,o=0;o<r;++o)i[o](t,n)},e}();function y(){return g}e.Attributes=g,e.IAttributesFactory=y,ur.injectable("$AttributesInstance",g,null,bn),ur.injectable(D,y,null,Cn);var b=function(){function e(){this.__resources={},this.__bound=!1}return e.create=function(t,n){if(mi(n))return n;var i;switch(n.type.toLowerCase()){case Ln:var r=yr[n.value];mi(r)||(n.value=r.inject());break;case An:e._observeResource(t,n);break;case Pn:ci(i=n.value)&&(n.value=t.evaluateExpression(i));break;case Fn:break;case On:ci(i=n.value)&&(vi(i=t[i])?n.value=i.bind(t):(e._log.warn('Attempted to create a "function" type Resource, but the function '+i+"cannot be found on your control."),n.value=ei))}return n},e.addControlResources=function(t){t.resources.add({context:{value:t.context,type:An},control:{value:t,type:Pn}}),t.hasOwnContext&&e.__addRoot(t)},e.bindResources=function(t){var n=t.__resources;if(!mi(n)){for(var i,r=t.__controlInstance,o=Object.keys(n),s=e.__controlResources,a=o.length,l=0;l<a;++l)!0!==s[i=o[l]]&&(t[i]=n[i]=e.create(r,t[i]));t.__bound=!0}},e.dispose=function(t,n){var i=t.resources;if(!mi(i)){for(var r,o,s=Object.keys(i.__resources),a=s.length,l=e._ContextManager.defineProperty,u=0;u<a;++u)mi(o=i[r=s[u]])||o.type!==An&&o.type!==Fn||l(i,r,n?ii(o,!0):null,!0,!0,!0);e._removeListeners(i.__controlInstance)}},e.parseElement=function(t){for(var n,i,r,o,s,a=Array.prototype.slice.call(t.children),l=e._regex,u=l.whiteSpaceRegex,c=l.quotationRegex,h={},p=e.__resourceTypes;a.length>0;)p[o=(n=a.pop()).nodeName.toLowerCase()]&&(i={},mi(r=n.attributes.getNamedItem("alias"))||(i.alias=r.value,_i(s=n.textContent.replace(u,"$1"))||(i.value=o===Ln||o===Fn?s.replace(c,""):s,i.type=o,h[i.alias]=i)));return h},e.getInstance=function(){return new e},e._observeResource=function(t,n){var i=n.value,r=t.uid,o=e.__observableResourceRemoveListeners[r];if(mi(o)&&(o=e.__observableResourceRemoveListeners[r]=[]),ci(i)){mi(n.initialValue)?n.initialValue=i:i=n.initialValue;var s=t.observeExpression(function(e){n.value=e},i);n.value=t.evaluateExpression(i),o.push(s)}},e._removeListeners=function(t){if(!mi(t)){var n=t.uid,i=e.__observableResourceRemoveListeners[n];if(yi(i))for(var r=i.length,o=0;o<r;++o)i[o]();Oi(e.__observableResourceRemoveListeners,n)}},e.__addRoot=function(e){e.resources.add({root:{value:e,type:Pn,alias:Mn},rootContext:{value:e.context,type:An,alias:Dn}})},e.prototype.initialize=function(t,n){if(this.__controlInstance=t,!mi(n)){ai(n)?n=e.parseElement(n):ri(n.resources)&&(n=n.resources),this.__resources=n;for(var i,r=Object.keys(n),o=r.length,s=0;s<o;++s)this[i=r[s]]=n[i]}},e.prototype.add=function(t){if(!mi(t)){ai(t)&&(t=e.parseElement(t));for(var n,i,r=Object.keys(t),o=r.length,s=this.__controlInstance,a=this.__bound,l=e.create,u=0;u<o;++u)(n=t[i=r[u]]).alias=i,this[i]=this.__resources[i]=a?l(s,n):n}},e.INJECTABLE=Ln,e.OBJECT=Pn,e.OBSERVABLE=An,e.LITERAL=Fn,e.FUNCTION=On,e.__observableResourceRemoveListeners={},e}();function C(e,t,n){b._ContextManager=e,b._regex=t,b._log=n;var i={},r={};return i[$n]=i[zn]=i[Mn]=i[Dn]=!0,r[Ln]=r[Pn]=r[An]=r[On]=r[Fn]=!0,b.__controlResources=i,b.__resourceTypes=r,b}e.Resources=b,e.IResourcesFactory=C,ur.injectable(U,C,[S,T,E],Cn),ur.injectable("$ResourcesInstance",b,null,bn);var x=function(){function e(){this._gestures=e.gestures,this._androidVersion=gi(this._compat.ANDROID)?-1:this._compat.ANDROID,this._android44orBelow=this._androidVersion>-1&&Math.floor(this._androidVersion/10)<=44,this._inMouse=!1,this._subscribers={},this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__hasMoved=!1,this.__hasRelease=!1,this.__detectingMove=!1,this.__tapCount=0,this.__touchCount=0,this.__cancelDeferredTap=ei,this.__cancelDeferredHold=ei,this.__cancelRegex=/cancel/i,this.__pointerEndRegex=/up|cancel/i,this.__haveSwipeSubscribers=!1,this.__blurRemover=ei,this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__boundPreventDefaultClick=this.__preventDefaultClick.bind(this),this.__reverseMap={},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this.__pointerHash={},this.__pointerEvents=[],this.__listeners={},this.__getTypes(),this.initialize()}return e.prototype.addEventListener=function(e,t,n,i){var r=this,o=this._compat,s=o.mappedEvents[t],a=!mi(s),l=this.__mappedCount,u=this._gestures,c=!1;if(a&&(this.__reverseMap[s]=t,this.__registerElement(e,t),l[t]++,o.hasTouchEvents&&!this.__cancelRegex.test(s)&&(s=s.replace("touch","mouse").replace("start","down").replace("end","up"),this.__reverseMap[s]=t)),e.addEventListener(t,n,i),!gi(e["on"+t])||gi(u[t])||a)return function(){c||(a&&(l[t]>0&&l[t]--,r.__unregisterElement(e,t)),c=!0,e.removeEventListener(t,n,i))};var h=u.$swipe,p=u.$track,_=t;if(-1!==t.indexOf(p)){var f=u.$trackend;_=t===f?f:p}else-1!==t.indexOf(h)&&(_=h);return this._gestureCount[_]++,this.__registerElement(e,t),function(){c||(c=!0,r.__removeEventListener(e,t,n,i))}},e.prototype.initialize=function(){var e=this._isActive;!0!==e&&(this.__registerTypes(),mi(e)&&this.__appendGestureStyle(),this._isActive=!0)},e.prototype.dispose=function(){this.__unregisterTypes(),this.__blurRemover(),this.__blurRemover=ei,this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this._isActive=!1,this._subscribers={},this.__pointerEvents=[],this.__pointerHash={},this.__reverseMap={},this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__tapCount=this.__touchCount=0,this.__detectingMove=this.__hasMoved=this.__hasRelease=this.__haveSwipeSubscribers=!1,this.__lastMoveEvent=this.__lastTouchDown=this.__lastTouchUp=null,this.__swipeOrigin=this.__capturedTarget=this.__focusedElement=this.__delayedClickRemover=null,this.__cancelDeferredHold=this.__cancelDeferredTap=ei},e.prototype._onTouchStart=function(t){var n=this,i=t.type;if(this.__ignoreEvent[i])return this.__ignoreEvent[i]=!1,this.__delayedClickRemover[i](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),!1);if(this.__touchCount++>0)return!0;if("mousedown"!==i)this._inTouch=!0;else{if(!0===this._inTouch)return t.preventDefault(),!1;this._compat.hasTouchEvents&&(this._inMouse=!0)}if(mi(t=this.__standardizeEventObject(t)))return!0;this.__lastMoveEvent=null,this.__hasMoved=!1;var r=t.clientX,o=t.clientY,s=t.timeStamp,a=t.target,l=this._gestures;this.__lastTouchDown={_buttons:t._buttons,clientX:r,clientY:o,timeStamp:s,target:a,identifier:t.identifier},this.__swipeOrigin={clientX:r,clientY:o,xTimestamp:s,yTimestamp:s,xTarget:a,yTarget:a},this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(a,[l.$swipe,l.$swipedown,l.$swipeleft,l.$swiperight,l.$swipeup]).length>0);var u=this._gestureCount,c=u.$hold<=0,h=u.$release<=0;if(c&&h)return this.__handleMappedEvents(i,t,t),this.__registerMove(i),!0;var p,_,f,d=e.config.intervals.holdInterval;if(c)return this.__hasRelease=!1,this.__cancelDeferredHold=Ri(function(){n.__hasRelease=!0},d),this.__handleMappedEvents(i,t,t),this.__registerMove(i),!0;h?(f=!mi(p=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(_=function(){p.trigger(t),n.__cancelDeferredHold=ei}):(this.__hasRelease=!1,(f=!mi(p=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(_=function(){p.trigger(t),n.__hasRelease=!0,n.__cancelDeferredHold=ei})),f&&(this.__cancelDeferredHold=Ri(_,d)),this.__handleMappedEvents(i,t,t),this.__registerMove(i)},e.prototype._onTouchMove=function(t){this.__cancelDeferredHold(),this.__cancelDeferredHold=ei;var n=t.type;if(!0===this._inTouch&&"mousemove"===n)return!0;var i=this.__standardizeEventObject(t);if(mi(i))return!0;var r=this._gestureCount,o=r.$track<=0,s=r.$swipe<=0,a=e.config,l=this.__swipeOrigin,u=i.clientX,c=i.clientY;if(!(this.__hasMoved||this.__getDistance(l.clientX,u,l.clientY,c)>=a.distances.minScrollDistance))return this.__handleMappedEvents(n,t,i),!0;if(this.__hasMoved=!0,o&&s)return this.__handleMappedEvents(n,t,i),!0;var h=this.__lastMoveEvent||l,p=i.direction=this.__getDirection(u-h.clientX,c-h.clientY);this.__handleOriginChange(p);var _=Math.abs(u-l.clientX),f=Math.abs(c-l.clientY);i.velocity=this.__getVelocity(_,f,i.timeStamp-l.xTimestamp,i.timeStamp-l.yTimestamp),!s&&this._android44orBelow&&this.__haveSwipeSubscribers&&t.preventDefault(),o||this.__handleTrack(i,t),this.__handleMappedEvents(n,t,i),this.__lastMoveEvent=i},e.prototype._onTouchEnd=function(t){var n=this,i=t.type;if(this.__ignoreEvent[i])return this.__ignoreEvent[i]=!1,this.__delayedClickRemover[i](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),Ii(function(){var e=(n.__lastTouchUp||{}).target;n._document.body.contains(e)&&n.__handleInput(e)}),!1);var r=this.__hasMoved,o="mouseup"!==i;if(o){if("touchend"===i){if(r)!0===t.cancelable&&t.preventDefault();else{if(!0!==this._inTouch)return!0===t.cancelable&&t.preventDefault(),this.__preventClickFromTouch(),this.__touchCount=0,!0;t.target!==this.__focusedElement&&this.__handleInput(t.target)&&!0===t.cancelable&&t.preventDefault()}this.__preventClickFromTouch()}}else if(!gi(this._inTouch)){if(!this._inMouse)return!0===t.cancelable&&t.preventDefault(),!1;this._inMouse=!1}if(this.__cancelRegex.test(i))return this.__handleCanceled(t),!0;if(this.__touchCount<=0?this.__touchCount=0:this.__touchCount--,mi(t=this.__standardizeEventObject(t)))return!0;o&&(this._inTouch=!1),this.__touchCount>0&&(this.__touchCount=t._touches.length),this.__clearTempStates(),this.__hasRelease&&this.__handleRelease(t),this.__handleSwipe();var s=e.config,a=s.intervals,l=t.timeStamp,u=this.__lastTouchDown;if(r)return this.__handleTrackEnd(t),this.__handleMappedEvents(i,t,t),this.__tapCount=0,this.__capturedTarget=null,!0;if(mi(u)||l-u.timeStamp>a.tapInterval)return this.__handleMappedEvents(i,t,t),this.__tapCount=0,this.__capturedTarget=null,!0;var c=this.__lastTouchUp,h=t.clientX,p=t.clientY;this.__tapCount>0&&this.__getDistance(h,c.clientX,p,c.clientY)<=s.distances.maxDblTapDistance&&l-c.timeStamp<=a.dblTapInterval?this.__handleDbltap(t):this.__tapCount=0,this.__handleTap(t),this.__handleMappedEvents(i,t,t),this.__lastTouchUp=t,this.__capturedTarget=null},e.prototype.__clearTempStates=function(){this.__cancelDeferredHold(),this.__cancelDeferredHold=ei,this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1)},e.prototype.__resetTouchEnd=function(){this.__tapCount=this.__touchCount=0,this._inTouch=this.__hasRelease=!1,this.__pointerHash={},this.__pointerEvents=[],this.__capturedTarget=null},e.prototype.__handleCanceled=function(e){var t=e.touches||this.__pointerEvents,n=this.__getTouchIndex(t),i=e.type;e=n>=0?t[n]:this.__standardizeEventObject(e),this._inTouch=!1,this.__clearTempStates(),this.__hasMoved&&(this._android44orBelow&&this.__handleSwipe(),this.__handleTrackEnd(e)),this.__handleMappedEvents(i,e,e),this.__resetTouchEnd()},e.prototype.__handleMappedEvents=function(e,t,n){var i=this.__reverseMap[e];if(this.__mappedCount[i]>0){var r=this.__findFirstSubscriber(t.target,i);mi(r)||r.trigger(n)}},e.prototype.__handleTap=function(t){var n=this,i=t.target,r=this.__lastTouchDown||{},o=r.target;if(this.__tapCount++,!(this._gestureCount.$tap<=0||mi(o)||o!==i&&vi(o.contains)&&!o.contains(i)&&vi(i.contains)&&!i.contains(o))){var s=this._gestures,a=this.__findFirstSubscriber(i,s.$tap);if(!mi(a))return e.config.intervals.dblTapZoomDelay<=0||"mouse"===t.pointerType||"mouseup"===t.type?(t._buttons=r._buttons,void a.trigger(t)):void(this.__cancelDeferredTap=Ri(function(){t._buttons=r._buttons,a.trigger(t),n.__tapCount=0,n.__cancelDeferredTap=ei},e.config.intervals.dblTapZoomDelay))}},e.prototype.__handleDbltap=function(e){if(this.__tapCount=0,this.__cancelDeferredTap(),this.__cancelDeferredTap=ei,!(this._gestureCount.$dbltap<=0)){var t=this.__findFirstSubscriber(e.target,this._gestures.$dbltap);mi(t)||(e._buttons=this.__lastTouchDown._buttons,t.trigger(e),this.__tapCount=-1)}},e.prototype.__handleRelease=function(e){var t=this.__findFirstSubscriber(e.target,this._gestures.$release);mi(t)||t.trigger(e),this.__hasRelease=!1},e.prototype.__handleSwipe=function(){if(!(this._gestureCount.$swipe<=0)){var e=this.__lastMoveEvent;if(!mi(e)){for(var t=this.__swipeOrigin,n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY),r=this.__getRegisteredSwipes(e.direction,e.velocity,n,i);r.length>0;)r.pop().trigger(e);this.__lastMoveEvent=null}}},e.prototype.__handleTrack=function(e,t){var n=this._gestures,i=n.$track,r=e.direction,o=this.__capturedTarget||e.target,s=this.__findFirstSubscribers(o,[i,i+r.x,i+r.y]);this._android44orBelow&&(this.__findFirstSubscribers(o,[i,n.$trackdown,n.$trackup,n.$trackleft,n.$trackright,n.$trackend]).length>0&&t.preventDefault());if(s.length>0)for(this._androidVersion>-1&&t.preventDefault();s.length>0;)s.pop().trigger(e)},e.prototype.__handleTrackEnd=function(e){if(!(this._gestureCount.$trackend<=0)){var t=this.__capturedTarget||e.target,n=this.__findFirstSubscriber(t,this._gestures.$trackend);mi(n)||n.trigger(e)}},e.prototype.__getTypes=function(){var e,t,n,i=this._compat,r=i.mappedEvents,o=this.__listeners;if(i.hasPointerEvents)e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+" "+r.$touchcancel;else if(i.hasTouchEvents)e=this._startEvents=r.$touchstart+" mousedown",t=this._moveEvents=r.$touchmove+" mousemove",n=this._endEvents=r.$touchend+" mouseup "+r.$touchcancel;else{var s=r.$touchcancel;e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+(s?" "+s:"")}o[e]=this._onTouchStart.bind(this),o[t]=this._onTouchMove.bind(this),o[n]=this._onTouchEnd.bind(this)},e.prototype.__registerTypes=function(){this.__registerType(this._startEvents),this.__registerType(this._endEvents),this._document.addEventListener("dragstart",this.__preventDefault,!1)},e.prototype.__unregisterTypes=function(){this.__unregisterType(this._startEvents),this.__unregisterType(this._endEvents),this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1),this._document.removeEventListener("dragstart",this.__preventDefault,!1)},e.prototype.__registerType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;r-- >0;)n.addEventListener(i[r],t,!1)},e.prototype.__unregisterType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;r-- >0;)n.removeEventListener(i[r],t,!1)},e.prototype.__registerMove=function(e){var t=this._gestureCount;("touchstart"===e||this.__mappedCount.$touchmove>0||t.$track>0||t.$trackend>0||t.$swipe>0)&&(this.__registerType(this._moveEvents),this.__detectingMove=!0)},e.prototype.__registerElement=function(t,n){var i,r,o=t.__plat;if(mi(o)?(i=Li("domEvent_"),t.__plat=o={domEvent:i}):mi(o.domEvent)&&(i=Li("domEvent_"),o.domEvent=i),mi(i)){var s=this._subscribers[o.domEvent];return gi(s[n])?(r=new R(t,n),s[n]=r):s[n].count++,void s.gestureCount++}var a={gestureCount:1};r=new R(t,n),a[n]=r,this._subscribers[i]=a,gi(t.className)||sr(t,e.config.styleConfig[0].className),this.__removeSelections(t)},e.prototype.__unregisterElement=function(e,t){var n=e.__plat;if(!mi(n)&&!mi(n.domEvent)){var i=n.domEvent,r=this._subscribers[i],o=r[t];mi(o)||(o.count--,0===o.count&&Oi(r,t),r.gestureCount--,0===r.gestureCount&&(Oi(this._subscribers,i),this.__removeElement(e)))}},e.prototype.__setTouchPoint=function(e){var t=e.type,n=this._compat;n.hasPointerEvents||n.hasMsPointerEvents?this.__updatePointers(e,this.__pointerEndRegex.test(t)):e.pointerType=-1===t.indexOf("mouse")?"touch":"mouse"},e.prototype.__setCapture=function(e){mi(this.__capturedTarget)&&!si(e)&&(this.__capturedTarget=e)},e.prototype.__updatePointers=function(e,t){var n,i=e.pointerId,r=this.__pointerHash,o=r[i];if(t)gi(o)||((n=this.__pointerEvents.indexOf(o))>-1&&this.__pointerEvents.splice(n,1),Oi(this.__pointerHash,i));else{if(1===i&&!_i(r))return;e.identifier=e.pointerId,gi(o)||(n=this.__pointerEvents.indexOf(o))<0?this.__pointerEvents.push(e):this.__pointerEvents.splice(n,1,e),r[i]=e}},e.prototype.__findFirstSubscriber=function(e,t){var n,i;if(!mi(e))do{if(!gi(n=e.__plat)&&!gi(n.domEvent)&&!gi(i=this._subscribers[n.domEvent][t]))return i}while(!mi(e=e.parentNode))},e.prototype.__findFirstSubscribers=function(e,t){if(mi(e))return[];var n,i,r,o,s,a=[];do{if(!gi(n=e.__plat)&&!gi(n.domEvent))for(i=this._subscribers[n.domEvent],r=Object.keys(i);r.length>0;)o=r.pop(),-1!==(s=t.indexOf(o))&&(a.push(i[o]),t.splice(s,1))}while(t.length>0&&!mi(e=e.parentNode));return a},e.prototype.__removeEventListener=function(e,t,n,i){var r=this._gestures;e.removeEventListener(t,n,i);var o=r.$swipe,s=r.$track,a=t;if(-1!==t.indexOf(s)){var l=r.$trackend;a=t===l?l:s}else-1!==t.indexOf(o)&&(a=o);this._gestureCount[a]--,this.__unregisterElement(e,t)},e.prototype.__removeElement=function(t){this.__returnSelections(t),gi(t.className)||ar(t,e.config.styleConfig[0].className);var n=t.__plat;Oi(n,"domEvent"),_i(n)&&Oi(t,"__plat")},e.prototype.__standardizeEventObject=function(e){this.__setTouchPoint(e);var t,n=-1!==this._startEvents.indexOf(e.type),i=e.touches||this.__pointerEvents,r=e.changedTouches,o=!gi(r),s=e.timeStamp;if(o)if(n)t=e.preventDefault.bind(e),(e=r[0]).preventDefault=t;else{var a=this.__getTouchIndex(r);if(a>=0)t=e.preventDefault.bind(e),(e=r[a]).preventDefault=t;else if(this.__getTouchIndex(i)>=0)return null}return n&&this.__setCapture(e.target),this.__normalizeButtons(e),e._touches=i,e.offset=this.__getOffset(e),(gi(e.timeStamp)||s>e.timeStamp)&&(e.timeStamp=s),e},e.prototype.__normalizeButtons=function(e){var t;if(di(e.buttons)&&0!==e.buttons)t=e.buttons;else if(di(e.which)&&e.which>0)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}e._buttons=t},e.prototype.__getTouchIndex=function(e){for(var t=(this.__lastTouchDown||{}).identifier,n=e.length,i=0;i<n;++i)if(e[i].identifier===t)return i;return-1},e.prototype.__getOffset=function(e){var t,n,i=this.__capturedTarget||e.target;if(si(i))return{x:e.clientX,y:e.clientY};if(!gi(e.offsetX)&&!gi(e.offsetY)&&i===e.target)return{x:e.offsetX,y:e.offsetY};if(vi(i.getBoundingClientRect)){var r=i.getBoundingClientRect();t=r.left,n=r.top}else for(t=i.offsetLeft,n=i.offsetTop;!mi(i=i.offsetParent);)t+=i.offsetLeft,n+=i.offsetTop;return{x:e.clientX-t,y:e.clientY-n}},e.prototype.__getDistance=function(e,t,n,i){var r=t-e,o=i-n;return Math.sqrt(r*r+o*o)},e.prototype.__getVelocity=function(e,t,n,i){var r=0,o=0;return n>0&&(r=e/n||0),i>0&&(o=t/i||0),{x:r,y:o}},e.prototype.__getDirection=function(e,t){var n=Math.abs(e),i=Math.abs(t),r=(this.__lastMoveEvent||{}).direction||{},o=0===e?r.x||"none":e<0?"left":"right",s=0===t?r.y||"none":t<0?"up":"down";return{x:o,y:s,primary:n===i?r.primary||"none":n>i?o:s}},e.prototype.__handleOriginChange=function(e){var t=this.__lastMoveEvent;if(!mi(t)){var n=t.direction,i=n.x===e.x,r=n.y===e.y;if(!i||!r){var o=this.__swipeOrigin,s=this._gestures,a=[s.$swipe,s.$swipedown,s.$swipeleft,s.$swiperight,s.$swipeup];i||(o.clientX=t.clientX,o.xTimestamp=t.timeStamp,o.xTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.xTarget,a).length>0)),r||(o.clientY=t.clientY,o.yTimestamp=t.timeStamp,o.yTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.yTarget,a).length>0))}}},e.prototype.__getRegisteredSwipes=function(t,n,i,r){var o,s=this._gestures.$swipe,a=e.config.velocities.minSwipeVelocity,l=[s],u=this.__swipeOrigin||{};return i>r?(o=u.xTarget,n.x>=a&&l.push(s+t.x)):r>i&&(o=u.yTarget,n.y>=a&&l.push(s+t.y)),this.__findFirstSubscribers(o,l)},e.prototype.__isHorizontal=function(e){return"left"===e||"right"===e},e.prototype.__appendGestureStyle=function(){var t,n,i=this._document;if(!this._compat.platCss)if(!mi(i.styleSheets)&&i.styleSheets.length>0){var r=i.styleSheets[0];for(n=(t=e.config.styleConfig).length;n-- >0;)r.insertRule(this.__createStyle(t[n]),0)}else{var o=i.head,s=i.createElement("style"),a="";for(s.type="text/css",n=(t=e.config.styleConfig).length;n-- >0;)a=this.__createStyle(t[n])+a;s.textContent=a,o.appendChild(s)}},e.prototype.__createStyle=function(e){var t=e.styles||[],n=t.length,i="."+e.className+" { ",r="";n=t.length;for(var o=0;o<n;++o)r+=t[o]+";";return i+=r+" } "},e.prototype.__blurFocusedElement=function(){var e=this.__focusedElement||{};vi(e.blur)&&e.blur()},e.prototype.__waitForBlur=function(e){var t=this;this.__blurRemover=this.addEventListener(e,"blur",function(){t.__blurRemover(),t.__blurRemover=ei,e===t.__focusedElement&&(t.__focusedElement=null)},!1)},e.prototype.__clickTarget=function(e){var t=this,n=!1,i=function(){n=!0,e.removeEventListener("click",i,!1)};e.addEventListener("click",i,!1),Ii(function(){n||(e.removeEventListener("click",i,!1),t._document.body.contains(e)&&vi(e.click)&&e.click())})},e.prototype.__handleInput=function(e){this.__blurRemover();var t=e.nodeName;if(!ci(t))return this.__focusedElement=null,void this.__blurFocusedElement();var n=!0;switch(t.toLowerCase()){case"input":switch(e.type){case"range":this.__blurFocusedElement();break;case"text":case"password":case"email":case"number":case"tel":case"search":case"url":e.focus(),this.__waitForBlur(e);break;default:this.__blurFocusedElement(),this.__clickTarget(e)}break;case"a":case"button":case"label":this.__blurFocusedElement(),this.__clickTarget(e);break;case"textarea":e.focus(),this.__waitForBlur(e);break;case"select":n=!1;break;default:this.__blurFocusedElement(),this.__clickTarget(e)}return this.__focusedElement=e,n},e.prototype.__preventClickFromTouch=function(){var t=this._document,n=this.__ignoreEvent,i=this.__boundPreventDefaultClick,r=e.config.intervals.delayedClickInterval;r<=0||(this.__delayedClickRemover={mousedown:Ri(function(){n.mousedown=!1},r),mouseup:Ri(function(){n.mouseup=!1},r),click:Ri(function(){t.removeEventListener("click",i,!0)},r)},n.mousedown=n.mouseup=!0,Ii(function(){t.addEventListener("click",i,!0)}))},e.prototype.__preventDefaultClick=function(e){return e.preventDefault(),e.stopImmediatePropagation(),this._document.removeEventListener("click",this.__boundPreventDefaultClick,!0),this.__delayedClickRemover.click(),!1},e.prototype.__removeSelections=function(e){ai(e)&&(gi(e.onselectstart)||e.addEventListener("selectstart",this.__preventDefault,!1),gi(e.ondragstart)||e.addEventListener("dragstart",this.__preventDefault,!1))},e.prototype.__returnSelections=function(e){ai(e)&&(gi(e.onselectstart)||e.removeEventListener("selectstart",this.__preventDefault,!1),gi(e.ondragstart)||e.removeEventListener("dragstart",this.__preventDefault,!1))},e.prototype.__preventDefault=function(e){var t=e.target.nodeName;return ci(t)&&(t=t.toLowerCase()),"input"===t||"textarea"===t||(e.preventDefault(),!1)},e._inject={_document:m,_compat:d},e.config={intervals:{tapInterval:300,dblTapInterval:300,holdInterval:400,dblTapZoomDelay:0,delayedClickInterval:400},distances:{minScrollDistance:3,maxDblTapDistance:10},velocities:{minSwipeVelocity:.645},styleConfig:[{className:"plat-gesture",styles:["-moz-user-select: none","-khtml-user-select: none","-webkit-touch-callout: none","-webkit-user-select: none","-webkit-user-drag: none","-webkit-tap-highlight-color: transparent","-webkit-overflow-scrolling: touch","-ms-user-select: none","-ms-touch-action: manipulation","touch-action: manipulation"]},{className:"plat-no-touch-action",styles:["-ms-touch-action: none","touch-action: none"]}]},e.gestures={$tap:qt,$dbltap:Ht,$hold:Gt,$release:Jt,$swipe:Kt,$swipeleft:Zt,$swiperight:en,$swipeup:tn,$swipedown:nn,$track:rn,$trackleft:on,$trackright:sn,$trackup:an,$trackdown:ln,$trackend:un},e}();function N(){return x.config}e.DomEvents=x,ur.injectable(B,x),e.IDomEventsConfig=N,ur.injectable("$IDomEventsConfig",N);var I=function(){function e(){this._document=wr(m)}return e.prototype.initialize=function(e,t,n){this.element=e,this.event=t,this.eventType=ci(n)?n:"CustomEvent"},e.prototype.trigger=function(e,t,n){var i=this._document.createEvent(this.eventType);return ri(e)&&ni(!1,!1,i,e),i.initCustomEvent(this.event,!0,!0,mi(t)?0:t),(n||this.element).dispatchEvent(i)},e}();e.DomEvent=I,ur.injectable("$DomEventInstance",I,null,bn);var R=function(e){function t(t,n){var i=e.call(this)||this;return i.count=0,i.element=t,i.event=n,i.count++,i}return __extends(t,e),t.prototype.trigger=function(e){var t=this._document.createEvent("CustomEvent"),n=this.element,i=e.target;this.__extendEventObject(t,e),t.initCustomEvent(this.event,!0,!0,0);var r=si(n)||n.contains(i)?i.dispatchEvent(t):n.dispatchEvent(t);return r||e.preventDefault(),r},t.prototype.__extendEventObject=function(e,t){var n=t.pointerType;e.clientX=t.clientX,e.clientY=t.clientY,e.offsetX=t.offset.x,e.offsetY=t.offset.y,e.direction=t.direction||{x:"none",y:"none",primary:"none"},e.touches=t._touches,e.velocity=t.velocity||{x:0,y:0},e.identifier=t.identifier||0,e.pointerType=di(n)?this.__convertPointerType(n,t.type):n,e.screenX=t.screenX,e.screenY=t.screenY,e.pageX=t.pageX,e.pageY=t.pageY,e.buttons=t._buttons},t.prototype.__convertPointerType=function(e,t){switch(e){case MSPointerEvent.MSPOINTER_TYPE_MOUSE:return"mouse";case MSPointerEvent.MSPOINTER_TYPE_PEN:return"pen";case MSPointerEvent.MSPOINTER_TYPE_TOUCH:return"touch"}return-1===t.indexOf("mouse")?"touch":"mouse"},t}(I);!function(e){var t=function(){function e(){this._animatedElements={}}return e.prototype.create=function(e,t,n){return this._create(e,t,n,{key:null})},e.prototype.animate=function(e,t,n){return this._animate(e,t,n,{key:null})},e.prototype.enter=function(e,t,n,i,r){return this._animate(e,t,r,{key:"enter",parent:n,refChild:i})},e.prototype.leave=function(e,t,n){return this._animate(e,t,n,{key:"leave"})},e.prototype.move=function(e,t,n,i,r){return this._animate(e,t,r,{key:"move",parent:n,refChild:i})},e.prototype.show=function(e,t,n){return this._animate(e,t,n,{key:"show"})},e.prototype.hide=function(e,t,n){return this._animate(e,t,n,{key:"hide"})},e.prototype.all=function(e){for(var t=this,i=e.length,r=[],o=new n(function(n){t._Promise.all(e).then(function(){n()})}),s=0;s<i;++s)r=r.concat(e[s].getInstances());return o.initialize(r),o.then(ei)},e.prototype.resolve=function(){var e=new n(function(t){t(function(){return e})});return e},e.prototype._animate=function(e,t,n,i){var r=this._create(e,t,n,i),o=r.current;return r.previous.then(function(){Ai(function(){o.start()})}),o},e.prototype._create=function(e,t,i,r){var o,s=this,a=xr[t],l=[],u=[];if((!this._compat.animationSupported||gi(a))&&gi(a=Er[t]))return e=this.__constructAnimatableElements(e,{inject:ei},u,l),this._handlePreInitFunctionality(e,u,r),this._handlePostInitFunctionality(e,u,r),this._handleEndFunctionality(e,u,r),{previous:o=this.resolve(),current:o};e=this.__constructAnimatableElements(e,a,u,l);var c=u.length;if(0===c)return this._handlePreInitFunctionality(e,u,r),this._handlePostInitFunctionality(e,u,r),this._handleEndFunctionality(e,u,r),{previous:o=this.resolve(),current:o};this._handlePreInitFunctionality(e,u,r);var h,p=Li("animation_"),_=this.__setAnimationId(p,u),f=new n(function(t){var n=s._Promise;h=n.all(_).then(function(){for(var o=[],a=0;a<c;++a)o.push(l[a].instantiate(u[a],i));s._handlePostInitFunctionality(e,u,r);var h=n.all(o),_=s.__isParentAnimating(u),d=s.__generateAnimatedElement(p,u,f);if(!mi(_)){s._handleEndFunctionality(e,u,r),d.animationEnd(!0);var v=s._animatedElements[_],m=pi(v.promise)?function(){return v.promise}:function(){return f};h.then(function(){t(m)})}s.__stopChildAnimations(u),d.promise=f,h.then(function(){s._handleEndFunctionality(e,u,r),d.animationEnd(),t(function(){return f})})})});return f.initialize(l),{previous:h,current:f}},e.prototype._handlePreInitFunctionality=function(e,t,n){switch(n.key){case"move":for(var i=0;i<length;++i)or(e[i])}},e.prototype._handlePostInitFunctionality=function(e,t,n){var i,r;switch(n.key){case"enter":case"move":var o,s=n.refChild;if(ai(s)?o=s.parentNode:(o=n.parent,s=null),!ai(o))break;for(i=e.length,r=0;r<i;++r)o.insertBefore(e[r],s);break;case"show":for(i=t.length,r=0;r<i;++r)t[r].removeAttribute(Pt)}},e.prototype._handleEndFunctionality=function(e,t,n){var i,r;switch(n.key){case"leave":for(i=e.length,r=0;r<i;++r)or(e[r]);break;case"hide":for(i=t.length,r=0;r<i;++r)t[r].setAttribute(Pt,"")}},e.prototype.__setAnimationId=function(e,t){for(var n,i,r,o=this._animatedElements,s=[],a=t.length,l=0;l<a;++l)gi(i=(r=t[l]).__plat)?(r.__plat={animation:e},sr(r,Ot)):gi(i.animation)?(i.animation=e,sr(r,Ot)):(gi(n=o[i.animation])||(s.push(n.promise),n.animationEnd(!0)),i.animation=e);return s},e.prototype.__generateAnimatedElement=function(e,t,n){var i=this._animatedElements;return i[e]={animationEnd:function(r){var o,s,a,l=t.length;if(!0===r)return n.cancel(),void Oi(i,e);for(var u=0;u<l;++u)gi(a=(o=(s=t[u]).__plat||{}).animation)||a!==e||(ar(s,Ot),Oi(o,"animation"),_i(o)&&Oi(s,"__plat"));Oi(i,e)}}},e.prototype.__isParentAnimating=function(e){for(var t,n=e[0];!si(n=n.parentNode)&&!mi(n)&&n.nodeType===Node.ELEMENT_NODE;)if(lr(n,Ot)){var i=n.__plat;if(ci(t=(i||{}).animation)){if(!mi(this._animatedElements[t]))return t;Oi(i,"animation"),_i(i)&&Oi(n,"__plat"),ar(n,Ot)}}},e.prototype.__stopChildAnimations=function(e){for(var t,n,i,r=this._animatedElements,o=Array.prototype.slice,s=0;s<e.length;++s)for(t=o.call(e[s].querySelectorAll("."+Ot));t.length>0;)mi(i=(t.pop().__plat||{}).animation)||vi((n=r[i]||{}).animationEnd)&&n.animationEnd(!0)},e.prototype.__constructAnimatableElements=function(e,t,n,i){if(!yi(e))if(li(e))e=Array.prototype.slice.call(e.childNodes);else if(bi(e))e=Array.prototype.slice.call(e);else{if(!ai(e)||e.nodeType!==Node.ELEMENT_NODE)return[];e=[e]}for(var r,o=e.length,s=0;s<o;++s)ai(r=e[s])&&r.nodeType===Node.ELEMENT_NODE&&(n.push(r),i.push(t.inject()));return e},e._inject={_compat:d,_Promise:f,_document:m},e}();e.Animator=t,ur.injectable(M,t);var n=function(e){function t(t,n){var i=e.call(this,t)||this;return i._Promise=wr(f),i.__animationState=0,i.__animationInstances=[],mi(n)||(i.__animationInstances=n.__animationInstances,i.__animationState=n.__animationState),i}return __extends(t,e),t.prototype.initialize=function(e){_i(this.__animationInstances)&&(yi(e)?this.__animationInstances=e:ri(e)&&(this.__animationInstances=[e]))},t.prototype.getInstances=function(){return this.__animationInstances},t.prototype.start=function(){if(!(this.__animationState>0)){for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;++i)vi((e=t[i]).start)&&e.start();this.__animationState=1}},t.prototype.pause=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;++r)vi((e=t[r]).pause)&&n.push(e.pause());return this._Promise.all(n).then(ei)},t.prototype.resume=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;++r)vi((e=t[r]).resume)&&n.push(e.resume());return this._Promise.all(n).then(ei)},t.prototype.cancel=function(){if(2===this.__animationState)return this;for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;++i)vi((e=t[i]).cancel)&&e.cancel(),vi(e.end)&&e.end();return this.__animationState=2,this},t.prototype.isCanceled=function(){return 2===this.__animationState},t.prototype.then=function(t){return e.prototype.then.call(this,t)},t.prototype.catch=function(t){return e.prototype.catch.call(this,t)},t}(Nr.Promise);e.AnimationPromise=n;var i=function(){function e(){this.__eventListeners=[]}return e.prototype.initialize=function(){},e.prototype.start=function(){},e.prototype.end=function(){for(var e=this.__eventListeners;e.length>0;)e.pop()();vi(this._resolve)&&(this._resolve(),this._resolve=null)},e.prototype.pause=function(){return this._Promise.resolve()},e.prototype.resume=function(){return this._Promise.resolve()},e.prototype.cancel=function(){this.end()},e.prototype.addEventListener=function(e,t,n){if(!vi(t))return this._log.warn('An animation\'s "addEventListener" must take a function as the second argument.'),ei;t=t.bind(this);var i=this.dom.addEventListener(this.element,e,function(e){e.stopPropagation(),t(e)},n),r=this.__eventListeners;return r.push(i),function(){i();var e=r.indexOf(i);-1!==e&&r.splice(e,1)}},e.prototype.instantiate=function(e,t){var i=this;this.element=e,this.options=t;var r=new n(function(e){i._resolve=e,i.initialize()});return r.initialize(this),r},e._inject={_window:G,_compat:d,_log:E,_Promise:f,dom:z,utils:H},e}();e.BaseAnimation=i;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationEvents=t._compat.animationEvents,t}return __extends(t,e),t.prototype.animationStart=function(e){return this.addEventListener(this._animationEvents.$animationStart,e,!1)},t.prototype.animationEnd=function(e){return this.addEventListener(this._animationEvents.$animationEnd,e,!1)},t.prototype.animationIteration=function(e){return this.addEventListener(this._animationEvents.$animationIteration,e,!1)},t.prototype.transitionStart=function(e){return this.addEventListener(this._animationEvents.$transitionStart,e,!1)},t.prototype.transitionEnd=function(e){return this.addEventListener(this._animationEvents.$transitionEnd,e,!1)},t}(i);e.CssAnimation=r;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ft,t._cancelAnimation=ei,t}return __extends(t,e),t.prototype.initialize=function(){sr(this.element,this.className+Nn)},t.prototype.start=function(){var e=this;this._cancelAnimation=Ai(function(){var t=e.element,n=e.className;if(null===t.offsetParent)return e._dispose(),void e.end();sr(t,n);var i=e._animationEvents.$animation,r=e.options||{},o=e._window.getComputedStyle(t,r.pseudo),s=o[i+"Name"];if(""===s||"none"===s||"paused"===o[i+"PlayState"])return e._dispose(),void e.end();r.preserveInit||ar(t,n+Nn),e._cancelAnimation=e.animationEnd(function(){e._cancelAnimation=Ai(function(){e._dispose(),e.end()})})})},t.prototype.pause=function(){var e=this;if(this._cancelAnimation===ei)return this._Promise.resolve();var t=this._compat.animationEvents;return new this._Promise(function(n){Ai(function(){e._cancelAnimation!==ei&&(e.element.style[t.$animation+"PlayState"]="paused"),n()})})},t.prototype.resume=function(){var e=this;if(this._cancelAnimation===ei)return this._Promise.resolve();var t=this._compat.animationEvents;return new this._Promise(function(n){Ai(function(){e._cancelAnimation!==ei&&(e.element.style[t.$animation+"PlayState"]="running"),n()})})},t.prototype.cancel=function(){this._cancelAnimation(),this._dispose(),this.end()},t.prototype._dispose=function(){var e=this.className;ar(this.element,e+" "+e+Nn),this._cancelAnimation=ei},t}(r);e.SimpleCssAnimation=o,ur.animation(Ft,o);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Bt,t}return __extends(t,e),t}(o);e.FadeIn=s,ur.animation(Bt,s);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ut,t}return __extends(t,e),t}(o);e.FadeOut=a,ur.animation(Ut,a);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Dt,t}return __extends(t,e),t}(o);e.Enter=l,ur.animation(Dt,l);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=$t,t}return __extends(t,e),t}(o);e.Leave=u,ur.animation($t,u);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=zt,t}return __extends(t,e),t}(o);e.Move=c,ur.animation(zt,c);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Mt,t._animationCanceled=ei,t._normalizeRegex=/-/g,t._nonNumRegex=/[^\-0-9\.]/g,t._normalizedKeys={},t._transitionCount=0,t._count=0,t._started=!1,t._usingCss=!1,t}return __extends(t,e),t.prototype.initialize=function(){sr(this.element,this.className+Nn)},t.prototype.start=function(){var e=this;this._animationCanceled=Ai(function(){var t=e.element,n=e.className;null===t.offsetParent&&(e._animate(),e._dispose(),e.end()),sr(t,n),e._started=!0;for(var i,r=e.utils,o=e._animationEvents.$transition,s=e.options||{},a=e._window.getComputedStyle(t,s.pseudo),l=e._properties=a[o+"Property"].split(","),u=a[o+"Duration"].split(","),c=l.length,h=c,p=!1;c-- >0;)""===(i=l[c])||"none"===i?l.splice(c,1):h>1&&"all"===i&&(e._log.debug('Improper transition declaration on class "'+t.className+'"'),l.splice(c,1));if(0===l.length)p=!0;else{for(c=u.length;c-- >0&&(""===(i=u[c])||"0s"===i););c<0&&(p=!0)}if(p)return e._animate(),e._dispose(),void e.end();r.isNumber(s.count)&&s.count>0&&(e._count=s.count),!1===s.preserveInit&&ar(t,n+Nn),e._animationCanceled=e.transitionEnd(e._done),e._animate()||(r.isEmpty(s.properties)?e.__cssTransition(a,u):(e._dispose(),e.end()))})},t.prototype.cancel=function(){this._animationCanceled(),this._started||this._animate(),this._dispose(),this.end()},t.prototype._dispose=function(){var e=this.className;ar(this.element,e+" "+e+Nn),this._animationCanceled=ei},t.prototype._done=function(e){var t=e.propertyName;if(ci(t)){var n=++this._transitionCount;if(t=t.replace(this._normalizeRegex,"").toLowerCase(),n<this._count||!this._usingCss&&!0===this._normalizedKeys[t]&&n<this._properties.length)return}this._dispose(),this.end()},t.prototype._animate=function(){for(var e,t,n,i=this.element.style||{},r=(this.options||{}).properties||{},o=Object.keys(r),s=o.length,a=this._normalizedKeys,l=this._normalizeRegex,u=0;o.length>0;)t=i[e=o.shift()],ci(n=r[e])?(i[e]=n,t===i[e]?u++:a[e.replace(l,"").toLowerCase()]=!0):u++;return u<s},t.prototype.__cssTransition=function(e,t){var n,i,r,o,s=this,a=this._animationEvents.$transition,l=e[a+"Delay"].split(","),u=this._properties,c=u.length,h=this._normalizedKeys,p=this._normalizeRegex,_=0,f=0,d=!1,v=this.utils.defer.bind(this,function(t,n){s._animationCanceled!==ei&&("all"!==t&&e[t]===n||(d=!0),++f<c||d||(s._dispose(),s.end()))});for(this._usingCss=!0,this._count=this._count||c;_<c;++_)n=u[_]=u[_].trim(),i=t.length>_?t[_].trim():t[t.length-1].trim(),r=l.length>_?l[_].trim():l[l.length-1].trim(),h[n.replace(p,"").toLowerCase()]=!0,o=e[n],v(this._toMs(i)+this._toMs(r),[n,o])},t.prototype._toMs=function(e){var t=this._nonNumRegex,n=e.match(t)[0],i=Number(e.replace(t,""));return this.utils.isNumber(i)?"s"===n?1e3*i:"ms"===n?i:0:0},t}(r);e.SimpleCssTransition=h,ur.animation(Mt,h)}(e.animations||(e.animations={})),function(n){var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=this._router=this._Router.currentRouter(),t=this._getParentViewport();mi(t)||mi(t._router)||(this._parentRouter=t._router).addChild(e),this._navigator.initialize(e)},t.prototype.loaded=function(){var e=this;(this._animate=ri(this.options)&&!0===this.options.value.animate)&&this.dom.addClass(this.element,rt+"-animate"),this._Promise.resolve(this._router.finishNavigating).then(function(){e._router.register(e)})},t.prototype.canNavigateTo=function(e){var t=this,n=this._Router.currentRouter,i=n(),r=!0,o=this._Injector.getDependency(e.delegate.view),s=o.inject(),a=e.parameters,l=n();if(!ri(s))return this._Promise.resolve(null);if(i!==l){l.initialize(this._router);var u=wr(k);s.navigator=u,u.initialize(l)}else s.navigator=this._navigator;return vi(s.canNavigateTo)&&(r=s.canNavigateTo(a,e.query)),this._Promise.resolve(r).then(function(e){return t._nextInjector=o,t._nextView=s,e})},t.prototype.canNavigateFrom=function(){var e=this.controls[0],t=!0;return ri(e)&&vi(e.canNavigateFrom)&&(t=e.canNavigateFrom()),this._Promise.resolve(t)},t.prototype.navigateTo=function(e){var t=this._nextInjector||this._Injector.getDependency(e.delegate.view),n=this._createNodeMap(t),i=this.element,r=n.element,o=(e.parameters,e.query),s=n.uiControlNode.control;if(this._nextInjector=this._nextView=void 0,this._animate){var a=this._animator,l=this.dom;this._navigator.isBackNavigation()?(l.addClass(r,Vt),a.enter(r,Dt,i).then(function(){l.removeClass(r,Vt)})):a.enter(r,Dt,i)}else i.insertBefore(r,null);var u=this._managerCache.read(this.uid),c=this._ElementManagerFactory.getInstance();return u.children=[],c.initialize(n,u),vi(s.navigatedTo)&&s.navigatedTo(e.parameters,o),c.setUiControlTemplate(),s.hasOwnContext?c.observeRootContext(s,c.fulfillAndLoad):c.fulfillAndLoad()},t.prototype.navigateFrom=function(){var e=this,t=this.controls[0],n=ri(t);return(n&&vi(t.navigatingFrom)?this._Promise.resolve(t.navigatingFrom()):this._Promise.resolve()).catch(function(t){if(ri(t))return ci(t.message)?void e._log.debug(e.type+" error: "+t.message):void e._log.debug(e.type+" error: "+JSON.stringify(t));e._log.debug(t)}).then(function(){if(e._animate&&n){var i=t.element;e._navigator.isBackNavigation()&&e.dom.addClass(i,Vt),e._animator.leave(i,$t).then(function(){Dr.dispose(t)})}else Dr.dispose(t)})},t.prototype.dispose=function(){this._router.unregister(this),this._navigator.dispose()},t.prototype._createNodeMap=function(e){var t=this._nextView||e.inject(),n=this._document,i=e.name,r=t.replaceWith,o=_i(r)||"any"===r?n.createElement("div"):n.createElement(r);return o.setAttribute(ot,i),o.className=st,{element:o,attributes:{},nodes:[],uiControlNode:{control:t,nodeName:i,expressions:[],injector:e}}},t.prototype._getParentViewport=function(){for(var e=this.parent,t=this.type;!mi(e)&&e.type!==t;)e=e.parent;return e},t._inject={_Router:Y,_Promise:f,_Injector:oe,_ElementManagerFactory:j,_document:m,_managerCache:O,_animator:M,_navigator:k},t}(t);n.Viewport=r,ur.control(rt,r);var o=function(e){function n(){var t=e.call(this)||this;t.replaceWith=null,t.__isFirst=!1;var n=wr(P);return t.__templateControlCache=n.create(pt),t}return __extends(n,e),n.prototype.initialize=function(){var e=(this.options||{}).value||{},t=this._id=e.id;if(mi(t))this._log.warn(this.type+" instantiated without an id option");else{this._url=e.templateUrl;var n=this.__templateControlCache.read(t);mi(n)?(this.__isFirst=!0,this._initializeTemplate()):this.__templatePromise=n}},n.prototype.loaded=function(){this.__isFirst||this._waitForTemplateControl(this.__templatePromise)},n.prototype.dispose=function(){if(this.__isFirst){var e=this.__templateControlCache;e.remove(this._id),0===e.info().size&&e.dispose()}},n.prototype._initializeTemplate=function(){var e=this,n=this._id;if(!mi(n)){var i,r,o=this.endNode.parentNode,s=this._url;mi(s)?(i=this._document.createDocumentFragment(),Yi(this.elementNodes,i)):(i=this._templateCache.read(s),Gi(this.elementNodes,o)),this.elementNodes=[],pi(i)?r=i.catch(function(n){if(mi(n))return t.determineTemplate(e,s)}).then(function(t){return e.bindableTemplates.add(n,t.cloneNode(!0)),e}):(this.bindableTemplates.add(n,i.cloneNode(!0)),r=this._Promise.resolve(this)),this.__templateControlCache.put(n,r)}},n.prototype._waitForTemplateControl=function(e){var t=this;pi(e)&&e.then(function(e){return mi(t._url)||t._url===e._url||t._log.warn("The specified url: "+t._url+" does not match the original "+t.type+' with id: "'+t._id+'". The original url will be loaded.'),t.__mapBindableTemplates(e),t.bindableTemplates.bind(t._id)}).then(function(e){var n=t.endNode;Ki(n.parentNode,e,n)}).catch(function(e){Ii(function(){t._log.warn("Problem resolving "+t.type+" url: "+e.response)})})},n.prototype.__mapBindableTemplates=function(e){var t=this.bindableTemplates;t.cache=e.bindableTemplates.cache,t.templates=e.bindableTemplates.templates},n._inject={_Promise:f,_templateCache:F,_document:m},n}(t);n.Template=o,ur.control(it,o);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.innerTemplate=Yi(this.element.childNodes)},t.prototype.loaded=function(){this.element.appendChild(this.innerTemplate.cloneNode(!0))},t}(t);n.Ignore=s,ur.control(tt,s);var a=function(e){function n(){var t=e.call(this)||this;return t.priority=120,t._aliases={index:cn.index,even:cn.even,odd:cn.odd,first:cn.first,last:cn.last},t._blockLength=0,t._addQueue=[],t._itemLength=0,t.__listenerSet=!1,t.itemsLoaded=new t._Promise(function(e,n){t.__resolveFn=e,t.__rejectFn=n}).catch(ei),t}return __extends(n,e),n.prototype.setTemplate=function(){this.bindableTemplates.add("item",this.element.childNodes)},n.prototype.contextChanged=function(e,t){yi(e)?this._setListener():e=[],this._executeEvent([{object:e,type:"splice"}])},n.prototype.loaded=function(){var e=this.options,t=this._animate=ri(e)&&!0===e.value.animate,n=this.context;if(this._container=this.element,t&&(this._animationQueue=[]),this._setAliases(),yi(n)){var i=this._addQueue,r=n.length,o=this._addItems(0,r,0).then(function(){var e=i.indexOf(o);-1!==e&&i.splice(e,1)});i.push(o),this._setListener()}},n.prototype.dispose=function(){this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._animationQueue=this._addQueue=null},n.prototype._setAliases=function(){var e=this.options;if(!gi(e)){var t=e.value.aliases;if(ri(t))for(var n,i=this._aliases,r=Object.keys(i),o=r.length,s=0;s<o;++s)ci(n=t[r[s]])&&(i[r[s]]=n)}},n.prototype._addItems=function(e,t,n){var i=this,r=+(e+t),o=[],s=e;for(this._itemLength+=t;e<r;)o.push(this._bindItem(e++));return o.length>0&&(this.itemsLoaded=this._Promise.all(o).then(function(e){if(i._setBlockLength(e),n>0)for(var t=e.length,r=i._container,o=0;o<t;++o)o<n?i._appendAnimatedItem(e[o]):r.insertBefore(e[o],null);else i._appendItems(e);i._updateResource(s-1),vi(i.__resolveFn)&&(i.__resolveFn(),i.__resolveFn=i.__rejectFn=null)}).catch(function(e){Ii(function(){ci(e)&&(e=new Error(e)),i._log.error(e)})})),this.itemsLoaded},n.prototype._appendItems=function(e){Yi(e,this._container)},n.prototype._appendAnimatedItem=function(e){if(ai(e)){var t=this._animationQueue,n={animation:this._animator.enter(e,Dt,this._container).then(function(){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}),op:null};t.push(n)}},n.prototype._removeItems=function(e,n){for(var i=t.dispose,r=this.controls,o=e+n;o-- >e;)i(r[o]);this._updateResource(r.length-1)},n.prototype._bindItem=function(e){return this.bindableTemplates.bind("item",e,this._getAliases(e))},n.prototype._setBlockLength=function(e){this._blockLength>0||0===e.length||(this._blockLength=e[0].childNodes.length)},n.prototype._updateResource=function(e){var t=this.controls;e<0||e>=t.length||t[e].resources.add(this._getAliases(e))},n.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},n.prototype._executeEvent=function(e){var t="_"+e[0].type;vi(this[t])&&this[t](e)},n.prototype._getAliases=function(e){var t=0==(1&e),n={},i=this._aliases,r=Fn;return n[i.index]={value:e,type:r},n[i.even]={value:t,type:r},n[i.odd]={value:!t,type:r},n[i.first]={value:0===e,type:r},n[i.last]={value:e===this.context.length-1,type:r},n},n.prototype._push=function(e){var t=e[0],n=this._addQueue,i=t.addedCount,r=this._addItems(t.index,i,this._animate?i:0).then(function(){var e=n.indexOf(r);-1!==e&&n.splice(e,1)});n.push(r)},n.prototype._pop=function(e){var t=this,n=e[0],i=n.object.length;if(0!==n.removed.length){var r=n.object.length;this._itemLength>0&&this._itemLength--,this._Promise.all(this._addQueue).then(function(){t._animate?t._animateItems(i,1,$t,"leave",!1).then(function(){t._removeItems(r,1)}):t._removeItems(r,1)})}},n.prototype._unshift=function(e){var t=e[0],n=t.addedCount,i=this._addQueue;if(this._animate){var r=this._animationQueue,o=r.length;this._animateItems(0,n,Dt,null,o>0&&"clone"===r[o-1].op)}var s=this._addItems(t.object.length-n,n,0).then(function(){var e=i.indexOf(s);-1!==e&&i.splice(e,1)});i.push(s)},n.prototype._shift=function(e){var t=this,n=this._addQueue,i=e[0];if(0!==i.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,$t,"clone",!0)]));var r=i.object.length;this._itemLength>0&&this._itemLength--,this._Promise.all(n).then(function(){t._removeItems(r,1)})}},n.prototype._splice=function(e){var t,n=this,i=e[0],r=i.addedCount,o=this._addQueue,s=this._itemLength,a=this._animate;if(mi(r)){a&&this._cancelCurrentAnimations();var l=i.object.length,u=s-l;l>s?(t=this._addItems(s,-u,0).then(function(){var e=o.indexOf(t);-1!==e&&o.splice(e,1)}),o.push(t)):s>l&&(s>=u?this._itemLength-=u:this._itemLength=0,this._Promise.all(o).then(function(){n._removeItems(s-u,u)}))}else{var c=i.removed.length,h=this._animationQueue;if(r>c){var p=r-c,_=void 0;if(a){_=r;var f=h.length,d=i.index;s<r-d&&(_=s-d),this._animateItems(d,_,Dt,null,f>0&&"clone"===h[f-1].op),_=r-_}else _=0;t=this._addItems(i.object.length-p,p,_).then(function(){var e=o.indexOf(t);-1!==e&&o.splice(e,1)}),o.push(t)}else if(c>r){var v=r>0;a&&!v&&0===o.length&&(o=o.concat([this._animateItems(i.index,c,$t,"clone",!0)]));var m=c-r;s>=m?this._itemLength-=m:this._itemLength=0,this._Promise.all(o).then(function(){if(a&&v){var e=h.length;n._animateItems(i.index,r,Dt,null,e>0&&"clone"===h[e-1].op)}n._removeItems(s-m,m)})}}},n.prototype._calculateBlockLength=function(e,t){return this._blockLength},n.prototype._animateItems=function(e,t,n,i,r){var o=this._calculateBlockLength();if(0===o)return this._Promise.resolve();var s=e*o;switch(i){case"clone":return this._handleClonedContainerAnimation(s,t*o+s,n,!0===r);case"leave":return this._handleLeave(s,t*o+s,n);default:return this._handleSimpleAnimation(s,t*o+s,n,!0===r)}},n.prototype._handleSimpleAnimation=function(e,t,n,i){var r=this._container,o=Array.prototype.slice.call(r.childNodes,e,t);if(0===o.length)return this._Promise.resolve();var s=this._animationQueue,a=this._animator.create(o,n),l=a.current.then(function(){var e=s.indexOf(c);-1!==e&&s.splice(e,1)}),u=function(){return a.previous.then(function(){l.start()}),l},c={animation:l,op:null};if(i&&s.length>0){var h=this._cancelCurrentAnimations().then(u);return s.push(c),h}return s.push(c),u()},n.prototype._handleLeave=function(e,t,n){var i=this._container,r=Array.prototype.slice.call(i.childNodes,e,t);if(0===r.length)return this._Promise.resolve();var o=this._animationQueue,s=this._animator.leave(r,n).then(function(){var e=o.indexOf(a);-1!==e&&o.splice(e,1)}),a={animation:s,op:"leave"};return o.push(a),s},n.prototype._handleClonedContainerAnimation=function(e,t,n,i){var r=this._container,o=r.cloneNode(!0),s=Array.prototype.slice.call(o.childNodes,e,t);if(0===s.length)return this._Promise.resolve();var a,l=this._animationQueue,u=this._animator.create(s,n),c=u.current.then(function(){var e=l.indexOf(p);e>-1&&l.splice(e,1),mi(a)||a.replaceChild(r,o)}),h=function(){return mi(a=r.parentNode)||c.isCanceled()?c:(a.replaceChild(o,r),u.previous.then(function(){c.start()}),c)},p={animation:c,op:"clone"};if(i&&l.length>0){var _=this._cancelCurrentAnimations().then(h);return l.push(p),_}return l.push(p),h()},n.prototype._cancelCurrentAnimations=function(){for(var e=this._animationQueue,t=[],n=e.length,i=0;i<n;++i)t.push(e[i].animation.cancel());return this._Promise.all(t)},n._inject={_animator:M,_Promise:f},n}(t);n.ForEach=a,ur.control(Ke,a);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith=_t,t._structuredDataElements=[],t}return __extends(t,e),t.prototype.initialize=function(){var e=this;this.on(It,function(){e._removeAllElements()})},t.prototype.setTemplate=function(){var e=ft,t="title",n="author",i="description",r=yt,o=bt;this.element.setAttribute("prefix","og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"),this._titleElement=this._createElement(t),this._ogTitleElement=this._createElement(e,r+t),this._twitterTitleElement=this._createElement(e,o+t),this._descriptionElement=this._createElement(e,i),this._ogDescriptionElement=this._createElement(e,r+i),this._twitterDescriptionElement=this._createElement(e,o+i),this._ogUrlElement=this._createElement(e,"og:url"),this._twitterUrlElement=this._createElement(e,o+"url"),this._authorElement=this._createElement(e,n),this._googleAuthorElement=this._createElement("link",n),this._fbAuthorElement=this._createElement(e,"article:"+n),this._twitterCreatorElement=this._createElement(e,o+"creator"),this._ogTypeElement=this._createElement(e,"og:type")},t.prototype.title=function(e){return ci(e)?(this._titleElement.innerText=e,this._setContent([this._ogTitleElement,this._twitterTitleElement],e),e):this._getContent(this._titleElement)},t.prototype.description=function(e){return ci(e)?(this._setContent([this._descriptionElement,this._ogDescriptionElement,this._twitterDescriptionElement],e),e):this._getContent(this._descriptionElement)},t.prototype.url=function(e){return ci(e)?(this._setContent([this._ogUrlElement,this._twitterUrlElement],e),e):this._getContent(this._ogUrlElement)},t.prototype.author=function(e){return ci(e)?(this._setContent([this._authorElement],e),e):this._getContent(this._authorElement)},t.prototype.googleAuthor=function(e){return ci(e)?(this._setContent([this._googleAuthorElement],e),e):this._getContent(this._googleAuthorElement)},t.prototype.fbAuthor=function(e){return ci(e)?(this._setContent([this._fbAuthorElement],e),e):this._getContent(this._fbAuthorElement)},t.prototype.twitterCreator=function(e){return ci(e)?(this._setContent([this._twitterCreatorElement],e),e):this._getContent(this._twitterCreatorElement)},t.prototype.fbType=function(e){return ci(e)?(this._setContent([this._ogTypeElement],e),e):this._getContent(this._ogTypeElement)},t.prototype.images=function(e){var t=this;if(yi(e)){var n,i,r=ft,o=this.element;Ei(function(e){e=t._browser.urlUtils(e).href,2!==o.querySelectorAll(r+'[content="'+e+'"]').length&&(n=t._createElement(r,"og:"+mt,!0),i=t._createElement(r,"twitter:"+mt,!0),t._setContent([n,i],e))},e)}},t.prototype.videos=function(e){var t=this;if(yi(e)){var n,i=this._browser,r=this.element;Ei(function(e){e=i.urlUtils(e).href,1!==r.querySelectorAll('meta[content="'+e+'"]').length&&(n=t._createElement("meta","og:video",!0),t._setContent([n],e))},e)}},t.prototype.structuredData=function(e){if(!_i(e)){var t=this._document.createElement("script"),n=this._titleElement.nextSibling;t.setAttribute("type","application/ld+json"),t.textContent=JSON.stringify(e),this._structuredDataElements.push(t),this.dom.insertBefore(this.element,t,n)}},t.prototype.blogPostings=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e.length;n<i;++n)this.structuredData(e[n])},t.prototype.loaded=function(){this.url(this._browser.url())},t.prototype.navigated=function(e){this.url(e)},t.prototype._getContent=function(e){var t=e.nodeName.toLowerCase();return"title"===t?e.innerText:t===ft?e.getAttribute(Ct):t===dt?e.getAttribute("href"):void 0},t.prototype._setContent=function(e,t){for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=this._titleElement.nextSibling,a=this.dom,l=0;l<o;++l)(n=e[l]).nodeName.toLowerCase()===ft?n.setAttribute("content",t):n.setAttribute("href",t),-1===r.indexOf(n)&&a.insertBefore(i,n,s)},t.prototype._createElement=function(e,t,n){var i,r=ci(t),o=!r||0!==t.indexOf(yt)&&0!==t.indexOf(gt)?"name":vt,s=this.element;return e===dt&&(o="rel"),!n&&r?i=s.querySelector(e+"["+o+'="'+t+'"]'):n||(i=s.querySelector(e)),ai(i)||(i=this._document.createElement(e)),r&&i.setAttribute(o,t),i},t.prototype._removeAllElements=function(){var e=Array.prototype.slice,t=this._document.head.querySelectorAll('meta[property^="og:"]'),n=this._document.head.querySelectorAll('meta[name^="'+bt+'"]');this._removeElements.apply(this,[this._descriptionElement,this._authorElement,this._googleAuthorElement].concat(e.call(t),e.call(n),e.call(this._structuredDataElements))),this._structuredDataElements=[]},t.prototype._removeElements=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=0;s<o;++s)n=e[s],-1!==r.indexOf(n)&&i.removeChild(n)},t._inject={_document:m,_browser:Q},t}(e.TemplateControl);n.Head=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.dom.clearNode(this.element)},t.prototype.loaded=function(){var e=this.options;ri(e)&&(this._onOptionsChanged(e.value),e.observe(this._onOptionsChanged))},t.prototype._onOptionsChanged=function(e,t){var n=this;if(e!==t)if(ri(e)){var i=e.html;if(i!==this._html){this._html=i;var r=ci(i);if(mi(i)||r&&""===i.trim())this.controls.length>0?this._TemplateControlFactory.dispose(this.controls[0]):this.dom.clearNode(this.element);else if(r)if(!0!==e.compile)Ji(this.element,i);else{var o=this.controls.length>0;this.bindableTemplates.once(i).then(function(e){o?n._TemplateControlFactory.dispose(n.controls[0]):n.dom.clearNode(n.element),n.element.insertBefore(e,null)})}else this._log.debug("Trying to bind a non-string value to "+this.type+".")}}else this._log.debug("plat-options for "+this.type+" must be an object.")},t._inject={_TemplateControlFactory:V},t}(t);n.InnerHtml=u,ur.control(Ze,u);var c=function(e){function n(){var t=e.call(this)||this;return t.replaceWith="select",t.priority=120,t.groups={},t.itemsLoaded=new t._Promise(function(e,n){t.__resolveFn=e,t.__rejectFn=n}).catch(ei),t}return __extends(n,e),n.prototype.setTemplate=function(){this.bindableTemplates.add("option",this.element.childNodes);var e=(this.options||{}).value||{},t=e.default;if(ri(t)){var n=this._document.createElement("option"),i=t.value,r=t.textContent;n.value=gi(i)?r:i,n.textContent=gi(r)?i:r,this.element.insertBefore(n,null)}if(mi(e.group))this._isGrouped=!1;else{var o=this._group=e.group,s=this._document.createElement("optgroup");s.label=vn+o+mn,this.bindableTemplates.add("group",s),this._isGrouped=!0}},n.prototype.contextChanged=function(e,t){var n=this;if(!_i(e)&&yi(e)){var i=yi(e)?e.length:0,r=yi(t)?t.length:0;this._setListener(),i>r?this._addItems(i-r,r):i<r&&this._removeItems(r-i),this.itemsLoaded.then(this._observeChange.bind(this))}else _i(t)||this.itemsLoaded.then(function(){n._removeItems(n.controls.length)}).then(this._observeChange.bind(this))},n.prototype.loaded=function(){if(gi(this._isGrouped)){var e=(this.options||{}).value||{};this._isGrouped=!mi(this._group=e.group)}this._defaultOption=this.element.firstElementChild;var t=this.context;yi(t)&&(this._addItems(t.length,0),this._setListener())},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._defaultOption=null},n.prototype.observeProperties=function(e){var t=this,n=this.element;if(this._binder=e,n.multiple){if(mi(e.evaluate())){var i=[];this.inputChanged(i,this.__lastValue),this.__lastValue=i}e.observeProperty(this._setSelectedIndices),e.observeArrayChange(function(){t._setSelectedIndices(e.evaluate(),null,null)})}else e.observeProperty(this._setSelectedIndex);this.addEventListener(n,"change",this._observeChange,!1)},n.prototype._setSelectedIndex=function(e,t,n,i){var r=this,o=this.element,s=o.value;if(mi(e))return!0!==i&&this._document.body.contains(o)?void(o.selectedIndex=-1):void this.itemsLoaded.then(function(){if(mi(r._binder.evaluate())){var e=o.value;r.inputChanged(e,r.__lastValue),r.__lastValue=e}});ci(e)||(di(e)?(this._propertyType="number",e=e.toString()):fi(e)?(this._propertyType="boolean",e=e.toString()):(e=vi(e.toString)?e.toString():Object.prototype.toString.call(e),this._log.info('Trying to bind the invalid value "'+e+'" to a '+this.type+"."))),s!==e&&this.itemsLoaded.then(function(){if(r._document.body.contains(o))o.value=r.__lastValue=e,o.value===e&&-1!==o.selectedIndex||(o.selectedIndex=-1);else{if(o.value=e,o.value!==e){o.value=s;var t=r._castValue(o.value);r.inputChanged(t,r.__lastValue),r.__lastValue=t}r.__lastValue=e}})},n.prototype._setSelectedIndices=function(e,t,n,i){var r=this;this.itemsLoaded.then(function(){var t,n=r.element.options,o=mi(n)?0:n.length,s=mi(e);if(!s&&yi(e)){for(var a,l,u,c=1/0;o-- >0;)a=(t=n[o]).value,-1===e.indexOf(a)?di(l=Number(a))&&-1!==(u=e.indexOf(l))?(u<c&&(r._propertyType="number",c=u),t.selected=!0):"true"===a&&-1!==(u=e.indexOf(!0))||"false"===a&&-1!==(u=e.indexOf(!1))?(u<c&&(r._propertyType="boolean",c=u),t.selected=!0):t.selected=!1:t.selected=!0;r.__lastValue=e}else{if(!0===i&&mi(r._binder.evaluate())){var h=r._getSelectedValues();r.inputChanged(h,r.__lastValue),r.__lastValue=h}for(;o-- >0;){if(t=n[o],!s&&t.value===""+e)return void(t.selected=!0);t.selected=!1}r.__lastValue=e}})},n.prototype._observeChange=function(){var e=this.element,t=e.multiple?this._getSelectedValues():this._castValue(e.value);t!==this.__lastValue&&(this.inputChanged(t,this.__lastValue),this.__lastValue=t)},n.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;++r)(e=t[r]).selected&&i.push(this._castValue(e.value));return i},n.prototype._castValue=function(e){var t,n=this._propertyType;if(mi(n))return e;switch(n){case"number":t=_i(e)?null:Number(e);break;case"boolean":switch(e){case"true":t=!0;break;case"false":case"0":case"null":case"undefined":t=!1;break;default:t=!!e}break;default:t=e}return t},n.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},n.prototype._executeEvent=function(e){var t="_"+e[0].type;vi(this[t])&&this[t](e)},n.prototype._addItems=function(e,t){for(var n=this,i=this.bindableTemplates,r=[],o=this._insertOption;e-- >0;)r.push(i.bind("option",t).then(o.bind(this,t++)));return r.length>0&&(this.itemsLoaded=this._Promise.all(r).then(function(){vi(n.__resolveFn)&&(n.__resolveFn(),n.__resolveFn=n.__rejectFn=null)}).catch(function(e){Ii(function(){ci(e)&&(e=new Error(e)),n._log.error(e)})})),this.itemsLoaded},n.prototype._insertOption=function(e,t){var n=this.element;if(this._isGrouped){var i=this.groups,r=(this.context[e]||{})[this._group],o=i[r];return mi(o)?i[r]=this.bindableTemplates.bind("group",e).then(function(e){return(o=i[r]=e.childNodes[1]).insertBefore(t,null),n.insertBefore(e,null),o}):pi(o)?o.then(function(e){e.insertBefore(t,null)}):(o.insertBefore(t,null),this._Promise.resolve())}return n.insertBefore(t,null),this._Promise.resolve()},n.prototype._removeItems=function(e){for(var n=t.dispose,i=this.controls;e-- >0;)n(i.pop())},n.prototype._removeItem=function(){this._isGrouped?this._resetSelect():this._removeItems(1)},n.prototype._resetSelect=function(){this._removeItems(this.controls.length),this.groups={},mi(this._defaultOption)||this.element.insertBefore(this._defaultOption.cloneNode(!0),null),this._addItems(this.context.length,0)},n.prototype._push=function(e){var t=e[0];this._addItems(t.addedCount,t.index)},n.prototype._pop=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},n.prototype._unshift=function(e){if(this._isGrouped)this._resetSelect();else{var t=e[0],n=t.addedCount;this._addItems(n,t.object.length-n-1)}},n.prototype._shift=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},n.prototype._splice=function(e){var t=this;if(this._isGrouped)this._resetSelect();else{var n=e[0],i=n.addedCount,r=n.removed.length;i>r?this._addItems(i-r,n.object.length-i-1):r>i&&this.itemsLoaded.then(function(){t._removeItems(r-i)})}},n.prototype._sort=function(e){this._isGrouped&&this._resetSelect()},n.prototype._reverse=function(e){this._isGrouped&&this._resetSelect()},n._inject={_Promise:f,_document:m},n}(i);n.Select=c,ur.control(nt,c);var h=function(e){function t(){var t=e.call(this)||this;t._animate=!1,t.__condition=!0,t.__firstTime=!0,t.__isBound=!1;var n=t._document;return t.commentNode=n.createComment(et+Tn+"placeholder"),t.fragmentStore=n.createDocumentFragment(),t}return __extends(t,e),t.prototype.contextChanged=function(){var e=this.options.value;if(!_i(e))return this._setter(e)},t.prototype.setTemplate=function(){this.bindableTemplates.add("template",Array.prototype.slice.call(this.element.childNodes))},t.prototype.loaded=function(){var e=this.options;ri(e)?this._animate=!0===e.value.animate:(this._log.warn("No condition specified in "+me+" for "+this.type+"."),this.options={value:{condition:!0},observe:ei});var t=this.contextChanged();return this.__removeListener=this.options.observe(this._setter),t},t.prototype.dispose=function(){vi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null),vi(this.__cancelFrame)&&(this.__cancelFrame(),this.__cancelFrame=null),this.commentNode=null,this.fragmentStore=null},t.prototype._setter=function(e){var t,n,i,r=this,o=!!e.condition;return o!==this.__condition||this.__firstTime?(o?(t=this.__leavePromise,n=function(){return r.__leavePromise=null,r._addItem()}):(t=this.__enterPromise,n=function(){return r.__enterPromise=null,r._removeItem()}),i=mi(t)?n():this._animate&&vi(t.cancel)?t.cancel().then(n):t.then(n),this.__firstTime=!1,this.__condition=o,i):this._Promise.resolve(null)},t.prototype._addItem=function(){var e=this,t=this.__isBound;return t&&!ai(this.commentNode.parentNode)?this._Promise.resolve(null):t?mi(this.__initialBind)?this._animate?this._animateEntrance():this._elementEntrance():this.__initialBind=this.__initialBind.then(function(){return e.__initialBind=null,e._animate?e._animateEntrance():e._elementEntrance()}):(this.__isBound=!0,this.__initialBind=this.bindableTemplates.bind("template").then(function(t){e.__initialBind=null;var n=e.element;return n.parentNode===e.fragmentStore||mi(n.parentNode)?(n.insertBefore(t,null),e._animate?e._animateEntrance():e._elementEntrance()):e._animate?(e.__enterPromise=e._animator.animate(n,Dt).then(function(){e.__enterPromise=null}),n.insertBefore(t,null),e.__enterPromise):void n.insertBefore(t,null)}))},t.prototype._elementEntrance=function(){var e=this,t=this.commentNode,n=t.parentNode;return ai(n)?(this.__enterPromise=new this._Promise(function(i){e.__cancelFrame=Ai(function(){n.insertBefore(e.element,t),i()})}).then(function(){e.__enterPromise=null}),this.__enterPromise):this._Promise.resolve()},t.prototype._animateEntrance=function(){var e=this,t=this.commentNode,n=t.parentNode;return ai(n)?(this.__enterPromise=this._animator.enter(this.element,Dt,n,t).then(function(){e.__enterPromise=null}),this.__enterPromise):this._animator.resolve().then(ei)},t.prototype._removeItem=function(){var e=this;return mi(this.__initialBind)?this._animate?this._animateLeave():this._elementLeave():this.__initialBind=this.__initialBind.then(function(){return e.__initialBind=null,e._animate?e._animateLeave():e._elementLeave()})},t.prototype._elementLeave=function(){var e=this;return this.__leavePromise=new this._Promise(function(t){e.__cancelFrame=Ai(function(){var n=e.element,i=n.parentNode,r=n.nextSibling;ai(i)?(ai(e.commentNode.parentNode)||i.insertBefore(e.commentNode,r),e.fragmentStore.insertBefore(n,null),t()):t()})}).then(function(){e.__leavePromise=null}),this.__leavePromise},t.prototype._animateLeave=function(){var e=this,t=this.element;return this.__leavePromise=this._animator.leave(t,$t).then(function(){var n=t.parentNode,i=t.nextSibling;e.__leavePromise=null,ai(e.commentNode.parentNode)||n.insertBefore(e.commentNode,i),e.fragmentStore.insertBefore(t,null)}),this.__leavePromise},t._inject={_animator:M,_Promise:f,_document:m},t}(t);n.If=h,ur.control(et,h);var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="a",t._router=t._Router.currentRouter(),t._allowClick=!1,t}return __extends(t,e),t.prototype.initialize=function(){this._removeClickListener=this.dom.addEventListener(this.element,"click",this._handleClick.bind(this),!1)},t.prototype.loaded=function(){var e=this.options,t=this.setHref.bind(this);if(!ri(e))return this._log.warn("No options specified for "+this.type+". Please send in options of type plat.ui.controls.ILinkOptions."),(e=this.options={}).value={view:""},void this.setHref();ri(e.value)||(e.value={view:""}),this.addEventListener(this.element,qt,this._handleTap,!1),t(),e.observe(t)},t.prototype.setHref=function(){var e=this.getHref();_i(e)||(this.element.href=e)},t.prototype.getHref=function(){if(!mi(this._router)){var e=this.options.value,t=e.view;if(!0!==e.isUrl){var n=e.parameters,i=e.query;if(_i(t))return t;t=this._router.generate(t,n,i)}return this._browser.formatUrl(t)}},t.prototype._handleClick=function(e){if(this._allowClick)this._allowClick=!1;else{var t;if(di(e.buttons)&&0!==e.buttons)t=e.buttons;else if(di(e.which)&&e.which>0)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}1===t&&e.preventDefault()}},t.prototype._handleTap=function(e){var t=this;if(1===e.buttons){var n=this.getHref();if(!gi(n)){var i=this.element.target;if(_i(i)||"_self"===i)return e.preventDefault(),void Ai(function(){t._browser.url(n)});this._allowClick=!0,this.element.click()}}},t.prototype.dispose=function(){Ri(this._removeClickListener,3e3)},t._inject={_Router:Y,_Injector:oe,_browser:Q,_window:G},t}(t);n.Link=p,ur.control(Je,p)}(e.controls||(e.controls={}))}(zr=e.ui||(e.ui={})),function(e){var t=function(){function e(){}return e.prototype.compile=function(e,t){var n,i,r,o=e.childNodes,s=!mi(t)?this._managerCache.read(t.uid):null,a=this._ElementManagerFactory.create;if(o=gi(o)?vi(e.push)?e:Array.prototype.slice.call(e):Array.prototype.slice.call(o),mi(s)){n=o.length;for(var l=0;l<n;++l)(r=o[l]).nodeType===Node.ELEMENT_NODE&&(mi(a(r))||this.compile(r)),l+=(i=o.length)-n,n=i}else this._compileNodes(o,s)},e.prototype._compileNodes=function(e,t){for(var n,i,r,o=e.length,s=this._ElementManagerFactory.create,a=this._CommentManagerFactory.create,l=this._TextManagerFactory.create,u=0;u<o;++u){switch((n=e[u]).nodeType){case Node.ELEMENT_NODE:mi(i=s(n,t))||this._compileNodes(Array.prototype.slice.call(n.childNodes),i);break;case Node.TEXT_NODE:l(n,t);break;case Node.COMMENT_NODE:a(n,t)}u+=(r=e.length)-o,o=r}},e._inject={_ElementManagerFactory:j,_TextManagerFactory:L,_CommentManagerFactory:R,_managerCache:O},e}();e.Compiler=t,ur.injectable(I,t);var n=function(){function e(){this.isClone=!1}return e.hasMarkup=function(t){return e._markupRegex.test(t)},e.findMarkup=function(t){var n,i,r,o,s=vn.length,a=mn.length,l=mn[a-1],u=[],c=e._wrapExpression,h=e._parser;for(t=t.replace(e._newLineRegex,"");-1!==(n=t.indexOf(vn))&&-1!==(i=t.indexOf(mn));){for(0!==n&&u.push(c(t.slice(0,n)));t[i++]!==l||t[i]===l;);"="===(r=t.slice(n+s,i-a))[0]?((o=h.parse(r.slice(1).trim())).oneTime=!0,u.push(o)):u.push(h.parse(r.trim())),t=t.slice(i)}return n>=0&&i>=0?u.push(c(t.slice(i))):""!==t&&u.push(c(t)),u},e.build=function(t,n){for(var i,r="",o=t.length,s={},a=e._TemplateControlFactory.evaluateExpression,l=0;l<o;++l)if(ri(i=a(t[l],n,s)))try{r+=JSON.stringify(i,null,4)}catch(t){mi(t.description)||(t.description="Cannot stringify object: "+t.description),t.message="Cannot stringify object: "+t.message,e._log.warn(t)}else mi(i)||(r+=i);return r},e.observeExpressions=function(t,n,i){for(var r,o,s,a,l=e.__findUniqueIdentifiers(t),u=l.identifiers,c=l.oneTimeIdentifiers,h={listener:i,uid:n.uid};u.length>0;)mi(s=(o=e.__getObservationDetails(u.pop(),n)).manager)||s.observe(o.absoluteIdentifier,h);for(;c.length>0;)if(r=c.pop(),!mi(s=(o=e.__getObservationDetails(r,n)).manager)&&!o.isDefined){a=o.absoluteIdentifier;var p=s.observe(a,h),_=s.observe(a,{uid:n.uid,listener:function(){p(),_()}})}},e._wrapExpression=function(e){return{evaluate:function(){return e},identifiers:[],aliases:[],expression:e}},e.__findUniqueIdentifiers=function(e){var t,n=e.length;if(1===n)return!0===(t=e[0]).oneTime?{identifiers:[],oneTimeIdentifiers:t.identifiers.slice(0)}:{identifiers:t.identifiers.slice(0),oneTimeIdentifiers:[]};for(var i,r,o,s,a,l={},u={},c=[],h=[],p=0;p<n;++p)for(a=(t=e[p]).oneTime,s=(i=t.identifiers).length,o=0;o<s;++o)if(r=i[o],a){if(!0===l[r])continue;u[r]||(u[r]=!0,h.push(r))}else l[r]||(l[r]=!0,c.push(r)),!0===u[r]&&(u[r]=!1,h.splice(h.indexOf(r),1));return{identifiers:c,oneTimeIdentifiers:h}},e.__getObservationDetails=function(t,n){var i,r=e._ContextManager,o=t.split("."),s="",a=!1;if("@"===t[0]){var l=void 0,u={},c=o.shift().slice(1);if(o.length>0&&(s="."+o.join(".")),mi(l=u[c])&&(l=u[c]=n.findResource(c)),!mi(l)&&!mi(l.resource)){var h=l.resource.type;c===zn?(i=r.getManager(Dr.getRootControl(n)),s=n.absoluteContextPath+s):c===Dn?(i=r.getManager(u[c].control),s="context"+s):h!==An&&h!==Fn||(i=r.getManager(u[c].control),s="resources."+c+".value"+s)}}else(a=!gi(r.getContext(n.context,o)))||gi(r.getContext(n,o))?(i=r.getManager(Dr.getRootControl(n)),s=n.absoluteContextPath+"."+t):i=null;return{absoluteIdentifier:s,manager:i,isDefined:a}},e.prototype.initialize=function(e,t){this.nodeMap=e,this.parent=t,mi(t)||(this.isClone=t.isClone,t.children.push(this))},e.prototype.getParentControl=function(){for(var e,t=this.parent;mi(e)&&!mi(t);)e=t.getUiControl(),t=t.parent;return e},e.prototype.clone=function(e,t){return 1},e.prototype.bind=function(){},e}();function i(e,t,i,r,o){return n._markupRegex=e.markupRegex,n._newLineRegex=e.newLineRegex,n._ContextManager=t,n._parser=i,n._TemplateControlFactory=r,n._log=o,n}e.NodeManager=n,e.INodeManagerStatic=i,ur.injectable(A,i,[T,S,w,V,E],gn);var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=[],t.type="element",t.replace=!1,t.hasOwnContext=!1,t}return __extends(t,e),t.create=function(e,n){var i,r=e.nodeName.toLowerCase(),o=r,s=vr[r]||mr[r],a=!0,l=!1;if(mi(s)&&(e.hasAttribute(ot)?(r=e.getAttribute(ot).toLowerCase(),s=vr[r]||mr[r],a=!1):e.hasAttribute(ht+ot)&&(r=e.getAttribute(ht+ot).toLowerCase(),s=vr[r]||mr[r],a=!1)),!mi(s)){var u=s.inject();i={control:u,resourceElement:t.locateResources(e),nodeName:r,expressions:[],injector:s},l=!0,a&&e.setAttribute(ot,r);var c=u.replaceWith,h="any"===c&&a;if(!_i(c)&&("any"!==c||h)&&c.toLowerCase()!==o){h&&(c="div");var p=t._document.createElement(c);p.nodeType===Node.ELEMENT_NODE&&(e=er(e,p))}}var _=t._collectAttributes(e.attributes),f=t.getInstance();return _.element=e,!l&&ci(_.childContext)?(s=yr[q],l=!0,_.uiControlNode={control:s.inject(),resourceElement:null,nodeName:ut,expressions:[],injector:s}):_.uiControlNode=i,f.initialize(_,n),_.hasControl||l?(f.setUiControlTemplate(),l?null:f):(f.bind=function(){return[]},f)},t.locateResources=function(e){for(var t,n,i=Array.prototype.slice.call(e.childNodes);i.length>0;)if((n=(t=i.shift()).nodeName.toLowerCase())===at||n==="x-"+at)return e.removeChild(t);return null},t.clone=function(e,n,i,r,o){mi(o)&&(o=t._cloneNodeMap(e.nodeMap,i,n.getUiControl()||n.getParentControl(),r));var s=t.getInstance(),a=!mi(r);return s.nodeMap=o,s.parent=n,mi(n)||n.children.push(s),s.replace=e.replace,s.replaceNodeLength=e.replaceNodeLength,s.hasOwnContext=e.hasOwnContext,s.isClone=!0,o.hasControl||a||(s.bind=function(){return[]}),a&&t._managerCache.put(r.uid,s),s},t.cloneUiControl=function(e,n){var i=e.uiControlNode;if(!mi(i)&&!mi(i.injector)){var r=i.control,o=i.injector.inject(),s=t._ResourcesFactory.getInstance(),a=t._AttributesFactory.getInstance();return o.parent=n,n.controls.push(o),o.controls=[],a.initialize(o,e.attributes),o.attributes=a,s.initialize(o,r.resources),o.resources=s,t._ResourcesFactory.addControlResources(o),mi(r.innerTemplate)||(o.innerTemplate=r.innerTemplate.cloneNode(!0)),o.type=r.type,o.bindableTemplates=t._BindableTemplatesFactory.create(o,r.bindableTemplates),o.replaceWith=r.replaceWith,o}},t.createAttributeControls=function(e,n,i,r,o){var s,a=e.nodes,l=!0===o?r:e.element;if(ai(l)){if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0===o?t._copyAttributeNodes(a):[];s=l.attributes}var u,c,h,p,_,f,d=e.attributes,v=[],m=a.length;for(f=0;f<m;++f)_=(c=a[f]).nodeName,p=null,mi(h=c.injector)||(p=h.inject(),c.control=p,p.parent=n,p.element=l,(u=t._AttributesFactory.getInstance()).initialize(p,d),p.attributes=u,p.type=_,ci(p.uid)||(p.uid=Li(le)),p.templateControl=i),!0===o&&(v.push({control:p,expressions:c.expressions,node:s?s.getNamedItem(_)||s.getNamedItem(ht+_):null,nodeName:_,injector:h}),mi(p)||(mi(n)||n.controls.push(p),vi(p.initialize)&&p.initialize()));if(!o)for(a.sort(function(e,t){var n=e.control,i=t.control;if(mi(n))return 1;if(mi(i))return-1;var r=di(n.priority)?n.priority:0;return(di(i.priority)?i.priority:0)-r}),f=0;f<m;++f)mi(p=(c=a[f]).control)||(mi(n)||n.controls.push(p),vi(p.initialize)&&p.initialize());return v},t.getInstance=function(){var e=new t;return e._Promise=wr(f),e._ContextManager=n._ContextManager,e._compiler=wr(I),e._CommentManagerFactory=wr(R),e._ControlFactory=wr(v),e._TemplateControlFactory=n._TemplateControlFactory,e._BindableTemplatesFactory=t._BindableTemplatesFactory,e._log=t._log,e},t._collectAttributes=function(e){for(var i,r,o,s,a,l,u,c,h=[],p=n.hasMarkup,_=n.findMarkup,f=n._parser,d=!1,v=e.length,m={},g=0;g<v;++g)o=(i=e[g]).value,r=i.name.replace(/^data-/i,"").toLowerCase(),c=vr[r]||mr[r],r===lt?""!==o&&(1!==(s=f.parse(o)).identifiers.length&&t._log.warn("Incorrect "+lt+": "+o+", must contain a single identifier."),a=s.identifiers[0]):r!==ot&&(u=(l=p(o))?_(o):[],d||!l&&mi(c)||(d=!0),h.push({control:null,node:i,nodeName:r,expressions:u,injector:c})),m[Pi(r)]=o;return{element:null,attributes:m,nodes:h,childContext:a,hasControl:d}},t._copyAttributeNodes=function(e){for(var t,n=[],i=e.length,r=0;r<i;++r)t=e[r],n.push({expressions:t.expressions,nodeName:t.nodeName});return n},t._cloneNode=function(e,t,n){return{control:n,injector:e.injector,expressions:e.expressions,node:t,nodeName:e.nodeName}},t._cloneNodeMap=function(e,n,i,r){var o=e.hasControl,s={attributes:e.attributes,childContext:e.childContext,nodes:[],element:n,uiControlNode:mi(e.uiControlNode)?null:t._cloneNode(e.uiControlNode,n,r),hasControl:o};return o&&(s.nodes=t.createAttributeControls(e,i,r,n,!0)),s},t.prototype.clone=function(e,n,i){var r,o,s,a,l=this.replace,u=this.children,c=mi(i)?null:i.uiControlNode.control,h=!mi(c);if(h||(h=!mi(c=t.cloneUiControl(this.nodeMap,n.getUiControl()||n.getParentControl()))),l){var p=e.parentNode.childNodes,_=Array.prototype,f=_.indexOf.call(p,e);r=_.slice.call(p,f+1,f+this.replaceNodeLength),o=t.clone(this,n,null,c,i),c.elementNodes=r,c.startNode=e,c.endNode=r.pop(),s=u.shift(),a=u.shift(),s.clone(c.startNode,o),a.clone(c.endNode,o),vi(c.initialize)&&c.initialize()}else r=Array.prototype.slice.call(e.childNodes),i=(o=t.clone(this,n,e,c,i)).nodeMap,h&&(c.element=e,vi(c.initialize)&&c.initialize());for(var d=u.length,v=0,m=0;m<d;++m)v+=u[m].clone(r[v],o);return l?(u.unshift(a),u.unshift(s),v+2):1},t.prototype.initialize=function(n,i,r){e.prototype.initialize.call(this,n,i);var o,s=n.uiControlNode,a=!mi(s);a&&(this._populateUiControl(),o=s.control,this.hasOwnContext=o.hasOwnContext),n.hasControl&&t.createAttributeControls(n,this.getParentControl(),o),!r&&a&&vi(o.initialize)&&o.initialize()},t.prototype.bind=function(){var e=this,t=this.nodeMap,n=this.getParentControl(),i=t.uiControlNode,r=[];if(!mi(i)){var o,s=i.control,a=t.childContext,l=this._ContextManager.getManager,c=mi(n)?u:n.absoluteContextPath,h=this._TemplateControlFactory,p=!s.hasOwnContext;if(r.push(s),p&&!mi(a))if("@"===a[0]){var _=a.split("."),f=_.shift().slice(1),d=h.findResource(s,f);if(ri(d)){var v=d.resource;a=_.length>0?"."+_.join("."):"",f===zn?c+=a:f===Dn?c=u+a:v.type===An||v.type===Fn?(c="resources."+f+".value"+a,s.root=d.control):this._log.warn('Only resources of type "observable" can be set as context.')}else this._log.warn("Could not set the context of "+s.type+' with the resource specified as "'+a+'".')}else c+="."+a;ri(s.root)||(s.root=this._ControlFactory.getRootControl(s)||s),o=l(s.root);var m=!1;p?(s.context=o.getContext(c.split("."),!1),m=gi(s.context)&&!this._BindableTemplatesFactory.isBoundControl(s)):c=u,m?this.contextPromise=new this._Promise(function(t,n){var i=o.observe(c,{uid:s.uid,listener:function(n,r){gi(n)||(i(),s.context=n,e._beforeLoad(s,c),t())}})}):this._beforeLoad(s,c)}return this._observeControlIdentifiers(t.nodes,n,r,t.element),r},t.prototype.setUiControlTemplate=function(e){var t=this,n=this.nodeMap.uiControlNode;if(mi(n))mi(this.parent)&&this.bindAndLoad();else{var i=n.control;this.templatePromise=this._TemplateControlFactory.determineTemplate(i,e).then(function(e){t.templatePromise=null,t._initializeControl(i,e.cloneNode(!0))},function(e){if(t.templatePromise=null,mi(e)){var n=e;t._BindableTemplatesFactory.isBoundControl(i)&&(n=Yi(i.element.childNodes)),t._initializeControl(i,n)}else Ii(function(){ci(e)&&(e=new Error(e)),t._log.error(e)})})}},t.prototype.getUiControl=function(){var e=this.nodeMap.uiControlNode;if(!mi(e))return e.control},t.prototype.fulfillTemplate=function(){var e=this;return mi(this.templatePromise)?this._fulfillChildTemplates():this.templatePromise.then(function(){return e._fulfillChildTemplates()})},t.prototype.fulfillAndLoad=function(){var e=this;return this.fulfillTemplate().then(function(){return e.bindAndLoad()}).catch(function(t){Ii(function(){ci(t)&&(t=new Error(t)),e._log.error(t)})})},t.prototype.bindAndLoad=function(){var e=this,t=this.bind();return(pi(this.contextPromise)?this.contextPromise.then(function(){return e._bindChildren()}):this._bindChildren()).then(function(){return e._loadControls(t,e.getUiControl())}).catch(function(t){Ii(function(){ci(t)&&(t=new Error(t)),e._log.error(t)})})},t.prototype.observeRootContext=function(e,t){var n=this;return t=t.bind(this),mi(e.context)?new this._Promise(function(i){var r=n._ContextManager.getManager(e).observe(u,{listener:function(){r(),t().then(i)},uid:e.uid})}).catch(function(e){Ii(function(){ci(e)&&(e=new Error(e)),n._log.error(e)})}):t()},t.prototype._beforeLoad=function(e,n){var i=this._ContextManager.getManager(e.root),r=this._TemplateControlFactory;e.zCC__plat=i.observe(n,{uid:e.uid,priority:1e3,listener:function(t,n){e.context=t}}),r.setAbsoluteContextPath(e,n),r.setContextResources(e),t._ResourcesFactory.bindResources(e.resources)},t.prototype._bindChildren=function(){for(var e,t=this.children,n=t.length,i=[],r=0;r<n;++r)(e=t[r]).hasOwnContext?this.isClone?i.push(e.observeRootContext(e.getUiControl(),e.bindAndLoad)):i.push(e.observeRootContext(e.getUiControl(),e.fulfillAndLoad)):gi(e.children)?e.bind():i.push(e.bindAndLoad());return this._Promise.all(i)},t.prototype._loadControls=function(e,t){var n,i,r,o,s=e.length,a=this._ControlFactory.load,l=mi(t);if(l)o=0;else{var u=t.priority;r=di(u)?u:100,o=1}for(;o<s;++o)(n=e[o]).templateControl=t,!l&&r>n.priority&&(l=!0,i=a(t)),a(n);return l||(i=a(t)),i},t.prototype._populateUiControl=function(){var e=this.nodeMap,n=this.getParentControl(),i=e.uiControlNode,r=i.control,o=r.uid,s=r.resources,a=e.element,l=Array.prototype.slice.call(a.childNodes),u=t._AttributesFactory.getInstance(),c=this.replace=null===r.replaceWith||""===r.replaceWith;ci(o)||(o=r.uid=Li(le)),t._managerCache.put(o,this),mi(n)||r.parent===n||(n.controls.push(r),r.parent=n),vi(a.setAttribute)&&a.setAttribute(Pt,""),r.element=a,r.controls=[],u.initialize(r,e.attributes),r.attributes=u,ri(s)&&vi(s.add)?s.add(i.resourceElement):((s=t._ResourcesFactory.getInstance()).initialize(r,i.resourceElement),r.resources=s),t._ResourcesFactory.addControlResources(r),r.type=i.nodeName,r.bindableTemplates=r.bindableTemplates||this._BindableTemplatesFactory.create(r),!(l.length>0)||_i(r.templateString)&&_i(r.templateUrl)||(r.innerTemplate=Yi(l)),c&&this._replaceElement(r,e)},t.prototype._replaceElement=function(e,n){var i=n.element,r=i.parentNode,o=t._document,s=e.type,a=e.uid,l=e.startNode=o.createComment(s+" "+a+kn),u=e.endNode=o.createComment(s+" "+a+Sn),c=this._CommentManagerFactory.create;c(l,this),c(u,this),r.insertBefore(l,i),r.insertBefore(u,i.nextSibling),e.elementNodes=Zi(i),e.element=n.element=null},t.prototype._initializeControl=function(e,n){var i,r=this.nodeMap.element,o=this.replace;if(!mi(n)){var s=t.locateResources(n);mi(s)||e.resources.add(t._ResourcesFactory.parseElement(s)),o?(i=e.endNode,e.elementNodes=Array.prototype.slice.call(n.childNodes),Ki(i.parentNode,n,i)):Ki(r,n,r.lastChild)}if(vi(e.setTemplate)&&e.setTemplate(),o){this._compiler.compile(e.elementNodes,e);var a=e.startNode,l=a.parentNode,u=Array.prototype.slice.call(l.childNodes);i=e.endNode,e.elementNodes=u.slice(u.indexOf(a)+1,u.indexOf(i)),this.replaceNodeLength=e.elementNodes.length+2}else this._compiler.compile(r,e);mi(e.parent)&&this.fulfillAndLoad()},t.prototype._observeControlIdentifiers=function(e,t,i,r){for(var o,s,a,l=e.length,u=!mi(t),c=0,p=this.replace,_=[];c<l;++c)s=(o=e[c]).control,u&&o.expressions.length>0&&(a=h.getInstance(),_.push(a),a.initialize(r,o,t,i,p),n.observeExpressions(o.expressions,t,a.attributeChanged.bind(a))),mi(s)||i.push(s);for(l=_.length,c=0;c<l;++c)_[c].attributeChanged()},t.prototype._fulfillChildTemplates=function(){for(var e,t=this,n=this.children,i=n.length,r=[],o=0;o<i;++o)gi((e=n[o]).children)||r.push(e.fulfillTemplate());return this._Promise.all(r).catch(function(e){Ii(function(){ci(e)&&(e=new Error(e)),t._log.error(e)})})},t._inject={_Promise:f,_ContextManager:S,_compiler:I,_CommentManagerFactory:R,_ControlFactory:v,_TemplateControlFactory:V,_BindableTemplatesFactory:$,_log:E},t}(n);function o(e,t,n,i,o,s){return r._document=e,r._managerCache=t,r._ResourcesFactory=n,r._AttributesFactory=i,r._BindableTemplatesFactory=o,r._log=s,r}e.ElementManager=r,e.IElementManagerFactory=o,ur.injectable(j,o,[m,O,U,D,$,E],Cn),ur.injectable("$ElementManagerInstance",r,null,bn);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="text",t}return __extends(t,e),t.create=function(e,i){var r=e.nodeValue,o=new t;if(n.hasMarkup(r)){var s={nodes:[{node:e,expressions:n.findMarkup(r)}]};return o.initialize(s,i),o}return o.initialize(null,i),o.bind=ei,o},t._cloneNodeMap=function(e,t){var n=e.nodes[0];return{nodes:[{expressions:n.expressions,nodeName:n.nodeName,node:t}]}},t._clone=function(e,n,i){var r=e.nodeMap,o=new t;return mi(r)?(o.initialize(null,i),o.bind=ei):o.initialize(t._cloneNodeMap(r,n),i),o},t.prototype.clone=function(e,n){return t._clone(this,e,n),1},t.prototype.bind=function(){var e=this.getParentControl(),t=this.nodeMap.nodes[0],i=t.node,r=t.expressions;n.observeExpressions(t.expressions,e,this._setText.bind(this,i,e,r)),this._setText(i,e,r)},t.prototype._setText=function(e,t,i){e.nodeValue=n.build(i,t||{})},t}(n);function a(){return s}e.TextManager=s,e.ITextManagerFactory=a,ur.injectable(L,a,null,Cn),ur.injectable("$TextManagerInstance",s,null,bn);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="comment",t}return __extends(t,e),t.create=function(e,n){var i=new t;return i.initialize({nodes:[{node:e}]},n),i},t.prototype.clone=function(e,n){return t.create(e,n),1},t}(n);function c(){return l}e.CommentManager=l,e.ICommentManagerFactory=c,ur.injectable(R,c,null,Cn),ur.injectable("$CommentManagerInstance",l,null,bn);var h=function(){function e(){this._lastValues={}}return e.getInstance=function(){var t=new e;return t._NodeManager=wr(A),t},e.prototype.initialize=function(e,t,n,i,r){this.element=e,this.node=t,this.parent=n,this._controls=i,this.replace=r,t.nodeName!==xn?this.attributeChanged=this._staticAttributeChanged:this.attributeChanged=this._dynamicAttributeChanged},e.prototype._dynamicAttributeChanged=function(){var e,t,n=this.node,i=n.node,r=this._NodeManager,o=i.value,s=r.build(n.expressions,this.parent).trim().split(/\s+/),a=this._lastValues,l=this.element,u=s.length;if(r.hasMarkup(o)){for(var c=void 0,h=void 0,p=(vn.length,mn.length),_=mn[p-1];-1!==(c=o.indexOf(vn))&&-1!==(h=o.indexOf(mn));){for(;o[h++]!==_||o[h]===_;);o=o.slice(0,c).trim()+" "+o.slice(h).trim()}i.value=o.trim()}for(t=0;t<u;++t)a[s[t]]=!0;for(u=(s=Object.keys(a)).length,t=0;t<u;++t)a[e=s[t]]?(sr(l,e),a[e]=!1):(Oi(a,e),ar(l,e));this._notifyAttributes(n.nodeName,i.value)},e.prototype._staticAttributeChanged=function(){this._controls;var e=this.node,t=Pi(e.nodeName),n=this._NodeManager.build(e.expressions,this.parent);this._notifyAttributes(t,n),this.replace||(e.node.value=n)},e.prototype._notifyAttributes=function(e,t){for(var n,i,r=this._controls,o=r.length,s=0;s<o;++s)i=(n=r[s].attributes)[e],n[e]=t,n._attributeChanged(e,t,i)},e}();e.AttributeManager=h}(e.processing||(e.processing={})),function(e){var t=function(){function e(){this.uid=Li(le),this.isRoot=!1,this._removeUrlListener=ei,this._ignoreOnce=!1,this._backNavigate=!1}return e.prototype.initialize=function(t){this._router=t,ri(t)&&t.isRoot&&!ri(e._root)&&(this.isRoot=!0,e._root=this,this._observeUrl())},e.prototype.navigate=function(e,t){var n,i=this;return t=ri(t)?t:{},this.finishNavigating().then(function(){if(!ci(n=t.isUrl?e:i._generate(e,t.parameters,t.query))){var r=new Error("Cannot serialize url from input parameters, check your view reference.");i._log.error(r)}return i._navigate(n,t.replace)})},e.prototype.finishNavigating=function(){var t=e._root._router;return t.navigating?t.finishNavigating.catch(ei):this._Promise.resolve()},e.prototype.goBack=function(t){var n=this;t=ri(t)?t:{};var i=Number(t.length);return di(i)||(i=1),this.isRoot?this.finishNavigating().then(function(){return n._backNavigate=!0,n._goBack(i)}):e._root.goBack(t)},e.prototype.isBackNavigation=function(){return this.isRoot?this._backNavigate:e._root.isBackNavigation()},e.prototype.dispose=function(){this._removeUrlListener(),Oi(this,"router")},e.prototype._navigate=function(t,n){var i=this;return this.isRoot?new this._Promise(function(e,r){i._resolveNavigate=e,i._rejectNavigate=r,i._browser.url()===i._browser.url(t,n)&&i._resolveNavigate()}):e._root._navigate(t,n)},e.prototype._goBack=function(e){var t=this;return new this._Promise(function(n,i){t._resolveNavigate=n,t._rejectNavigate=i,t._browser.back(e)})},e.prototype._observeUrl=function(){var e=this;if(ri(this._router)){var t,n=this._EventManager,i=wr(_t),r=ri(i)&&vi(i.navigated),o=function(n){e._previousUrl=t;var i=e._history,r=i.state;e._ignoreOnce=!0,mi(r.previousLocation)||r.previousLocation===t?i.go(-1):i.go(1),e._backNavigate=!1,vi(e._rejectNavigate)&&e._rejectNavigate(n),_i(n)||e._log.warn(n)};this._previousUrl=this._browser.url(),n.dispose(this.uid),n.on(this.uid,At,function(){n.dispatch("backButtonPressed",e,n.DIRECT).defaultPrevented||e.goBack()}),n.on(this.uid,Rt,function(s,a){if(e._ignoreOnce)return e._ignoreOnce=!1,void(vi(e._resolveNavigate)&&(e._backNavigate=!1,e._resolveNavigate()));t=e._previousUrl,n.dispatch(St,e,n.DIRECT,[a]).defaultPrevented?o(new Error("Navigation prevented during "+St+" event")):e.finishNavigating().then(function(){return n.dispatch(It,e,n.DIRECT,[a]),e._router.navigate(a.pathname,a.query)}).then(function(){e._previousUrl=a.pathname,vi(e._resolveNavigate)&&(e._backNavigate=!1,e._resolveNavigate()),r&&i.navigated(a.href),n.dispatch("navigated",e,n.DIRECT,[a])},o)})}},e.prototype._generate=function(e,t,n){if(!mi(this._router))return _i(e)?e:this._router.generate(e,t,n)},e._inject={_Promise:f,_Injector:oe,_browserConfig:W,_browser:Q,_EventManager:b,_window:G,_log:E,_history:se},e}();function n(e){return e.history}e.Navigator=t,ur.injectable(k,t,null,bn),e.History=n,ur.injectable(se,n,[G]);var i,r=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),o={},s={},a={},l=function(){function e(){this.type=hn,this.name="",this.regex=""}return e.parse=function(t,n,r){if(!(ci(t)&&yi(n)&&ri(r)))return[];"/"===t[0]&&(t=t.slice(1));for(var l,u,c,h=t.split("/"),p=h.length,_=e.__findSegment,f=[],d=e._regex,v=0;v<p;++v)""===(l=h[v])?(ri(i)||(i=wr(K)),f.push(i)):(c=l.match(d.dynamicSegmentsRegex))?(u=c[1],f.push(_(u,ee,o)),n.push(u),r.dynamics++):(c=l.match(d.splatSegmentRegex))?(u=c[1],f.push(_(u,te,s)),n.push(u),r.splats++):(f.push(_(l,Z,a)),r.statics++);return f},e.__findSegment=function(e,t,n){var i=n[e];return ri(i)||(i=n[e]=wr(t)).initialize(e),i},e.prototype.initialize=function(e){this.name=e},e.prototype.reduceCharacters=function(e,t){return ri(this._specification)&&(t=e(t,this._specification)),t},e.prototype.generate=function(e){return this.name},e}();function u(e){return l._regex=e,l}e.BaseSegment=l,e.IBaseSegmentFactory=u,ur.injectable(J,u,[T],Cn),ur.injectable(K,l,null,bn);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=_n,t}return __extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.regex=this.name.replace(r,"\\$1")},t.prototype.reduceCharacters=function(e,t){for(var n=this.name,i=n.length,r=t,o=0;o<i;++o)r=e(r,{validCharacters:n[o]});return r},t}(l);e.StaticSegment=c,ur.injectable(Z,c,null,bn);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=pn,t}return __extends(t,e),t.prototype.generate=function(e){if(ri(e))return e[this.name]},t}(l);e.VariableSegment=h,ur.injectable("$VariableSegmentInstance",h,null,bn);var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=fn,t.regex="(.+)",t._specification={invalidCharacters:"",repeat:!0},t}return __extends(t,e),t}(h);e.SplatSegment=p,ur.injectable(te,p,null,bn);var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=dn,t.regex="([^/]+)",t._specification={invalidCharacters:"/",repeat:!0},t}return __extends(t,e),t}(h);e.DynamicSegment=_,ur.injectable(ee,_,null,bn);var d=function(){function e(){this.initialize()}return e.compile=function(e,t){return e.reduceCharacters(function(e,t){return e.add(t)},t)},e.link=function(e,t){for(var n,i,r,o,s,a=e.delegates,l=e.regex,u=a.length,c=t.match(l),h=1,p=[],_=0;_<u;++_){for(i={},r=0,o=(n=(s=a[_]).names).length;r<o;++r)i[n[r]]=c[h++];p.push({delegate:s.delegate,parameters:i,isDynamic:o>0})}return p},e.recognize=function(e,t){for(var n,i=[],r=t.length,o=0;o<r;++o)n=t[o],i=i.concat(n.match(e));return i},e.sort=function(e){return yi(e)?e.sort(function(e,u){if(t=e.types,o=u.types,n=t.splats,s=o.splats,n!==s)return n-s;if(i=t.statics,r=t.dynamics,a=o.statics,l=o.dynamics,n>0){if(i!==a)return a-i;if(r!==l)return l-r}return r!==l?r-l:i!==a?a=i:0}):e;var t,n,i,r,o,s,a,l},e.prototype.initialize=function(e){this.specification=e,this.nextStates=[]},e.prototype.add=function(t){var n=this._find(t);return ri(n)?n:((n=wr(e)).initialize(t),this.nextStates.push(n),t.repeat&&n.nextStates.push(n),n)},e.prototype.match=function(e){var t,n,i=[];return this._someChildren(function(r){t=r.specification,ci(n=t.validCharacters)&&n.indexOf(e)>-1?i.push(r):ci(n=t.invalidCharacters)&&-1===n.indexOf(e)&&i.push(r)}),i},e.prototype._find=function(e){var t,n,i=e.validCharacters,r=e.invalidCharacters;return this._someChildren(function(e){if((t=e.specification).validCharacters===i&&t.invalidCharacters===r)return n=e,!0}),n},e.prototype._someChildren=function(e){for(var t=this.nextStates,n=t.length,i=0;i<n;++i)if(!0===e(t[i]))return!0;return!1},e}();function v(){return d}e.State=d,e.IStateStatic=v,ur.injectable(ne,v,null,gn),ur.injectable(ie,d,null,bn);var m=function(){function e(){this._namedRoutes={}}return e.prototype.register=function(e,t){if(yi(e)){for(var n,i=this._rootState,r=e.length,o=["^"],s={statics:0,dynamics:0,splats:0},a=[],l=[],u=0;u<r;++u)n=this._parse(e[u],a,s),l=l.concat(n),i=this._compile(n,i,o);(i=this._finalize(i,o)).delegates=a,i.regex=new RegExp(o.join("")+"$"),i.types=s,ri(t)&&ci(t.name)&&(this._namedRoutes[this._toLowerCase(t.name)]={segments:l,delegates:a})}},e.prototype.recognize=function(e){var t,n;return e=this._addLeadingSlash(e),(t=this._hasTrailingSlash(e))&&(e=e.substr(0,e.length-1)),n=this._filter(this._findStates(e)),this._link(n[0],e,t)},e.prototype.generate=function(e,t){e=this._toLowerCase(e);var n,i,r=this._namedRoutes[e],o="";if(ri(r)){i=(n=r.segments).length;for(var s=0;s<i;s++){var a=n[s];a.type!==hn&&(o+="/",o+=a.generate(t))}return o=this._addLeadingSlash(o)}},e.prototype.delegatesFor=function(e){e=this._toLowerCase(e);var t,n=this._namedRoutes[e];return ri(n)&&yi(t=n.delegates)?t.slice(0):[]},e.prototype.exists=function(e){return ri(this._namedRoutes[this._toLowerCase(e)])},e.prototype._toLowerCase=function(e){return ci(e)?e.toLowerCase():e},e.prototype._finalize=function(e,t){return e===this._rootState&&(e=e.add({validCharacters:"/"}),t.push("/")),e},e.prototype._parse=function(e,t,n){var i=[];return t.push({delegate:e.delegate,names:i}),this._BaseSegmentFactory.parse(e.pattern,i,n)},e.prototype._compile=function(e,t,n){for(var i,r=e.length,o=this._State.compile,s=0;s<r;++s)(i=e[s]).type!==hn&&(t=o(i,t=t.add({validCharacters:"/"})),n.push("/"+i.regex));return t},e.prototype._addLeadingSlash=function(e){return"/"!==(e=decodeURI(e))[0]&&(e="/"+e),e},e.prototype._hasTrailingSlash=function(e){var t=e.length;return t>1&&"/"===e[t-1]},e.prototype._findStates=function(e){for(var t=[this._rootState],n=this._State.recognize,i=e.length,r=0;r<i&&0!==(t=n(e[r],t)).length;++r);return t},e.prototype._filter=function(e){for(var t,n=e.length,i=[],r=0;r<n;++r)yi((t=e[r]).delegates)&&i.push(t);return this._State.sort(i)},e.prototype._link=function(e,t,n){if(ri(e)&&yi(e.delegates))return n&&this._isDynamic(e)&&(t+="/"),this._State.link(e,t)},e.prototype._isDynamic=function(e){return"(.+)$"===e.regex.source.slice(-5)},e._inject={_BaseSegmentFactory:J,_State:ne,_rootState:ie},e}();e.RouteRecognizer=m,ur.injectable(re,m,null,bn);var g="/*childRoute",y=g.length,C=function(){function e(){this.navigating=!1,this.children=[],this.isRoot=!1,this._paramTransforms={},this._queryTransforms={},this._interceptors={},this._ports=[],this._resolve=this._Promise.resolve.bind(this._Promise),this._reject=this._Promise.reject.bind(this._Promise),this.uid=Li(le),this.isRoot=mi(e.currentRouter()),e.currentRouter(this),this.initialize()}return e.currentRouter=function(t){return mi(t)||(e.__currentRouter=t),e.__currentRouter},e.prototype.initialize=function(e){this.parent=e},e.prototype.addChild=function(e){return mi(e)||this.children.indexOf(e)>-1?e:(e.initialize(this),this.children.push(e),e)},e.prototype.removeChild=function(t){var n=this.children,i=n.indexOf(t);i<0||(n.splice(i,1),e.currentRouter()===t&&e.currentRouter(this))},e.prototype.register=function(e){var t=this,n=this._ports;return mi(e)||n.indexOf(e)>-1?this._resolve():(n.push(e),ri(this.currentRouteInfo)?(this.navigating=!0,this._resolve(this.finishNavigating).catch(ei).then(function(){var e=ii(t.currentRouteInfo,!0);return t.finishNavigating=t._canNavigateTo(e).then(function(n){if(n)return t.currentRouteInfo=void 0,t._performNavigation(e)}).then(function(){t.navigating=!1,t.currentRouteInfo=e},function(){t.navigating=!1})})):this._resolve())},e.prototype.unregister=function(e){var t=this._ports,n=t.indexOf(e);n<0||(t.splice(n,1),0!==t.length||mi(this.parent)||this.parent.removeChild(this))},e.prototype.configure=function(e,t){var n=this;return yi(e)?Ei(function(e){n._configureRoute(e)},e):this._configureRoute(e),!1!==t?this._forceNavigate():this._resolve()},e.prototype.unknown=function(e){return this._unknownHandler=e,this},e.prototype.param=function(e,t,n){return this._addHandler(e,t,n,this._paramTransforms)},e.prototype.queryParam=function(e,t,n){return this._addHandler(e,t,n,this._queryTransforms)},e.prototype.intercept=function(e,t){gi(t)&&(t="*");var n=t;"*"!==t&&(t=this._Injector.convertDependency(t)),t===Rn&&(t=n);var i=this._interceptors[t];return yi(i)||(i=this._interceptors[t]=[]),i.push(e),this},e.prototype.navigate=function(e,t,n,i){var r=this;!1===i&&(i=!ri(this.currentRouteInfo)),ri(t)||(t={});var o=this._resolve,s=Di(t);if("/"===e&&(e=""),n=!0===n,!ci(e)||this.navigating||!n&&e===this._previousUrl&&s===this._previousQuery)return this.navigating?this.finishNavigating.then(function(){return r.navigate(e,t,n)}):o();var a,l,u,c=this._recognizer,h=c.recognize(e),p=_i(h);p||((a=h[0]).query=t);var _=this._isSameRoute(a);if(p||_){var f=e;if(_&&(u=c.generate(a.delegate.alias||a.delegate.view,a.parameters),f=f.replace(u,"")),"/"===f||""===f?(f="",Si(function(e){return!_i(h=e._recognizer.recognize(f))},this.children)):h=this._childRecognizer.recognize(f),_i(h)){if(p){if(this._previousUrl=f,this._previousQuery=s,this.currentRouteInfo=a,vi(this._unknownHandler)){var d={segment:e,view:void 0};return o(this._unknownHandler(d)).then(function(){var t=d.view;if(!gi(t))return r.configure({pattern:e,view:t})})}return o()}h=c.recognize(e),(a=h[0]).query=t,l=a.delegate.pattern}else if((a=h[0]).query=t,l=(l=a.delegate.pattern).slice(0,l.length-y),!p||this._isSameRoute(a))return this.navigating=!0,this.finishNavigating=this._navigateChildren(a).then(function(){r._previousUrl=e,r._previousQuery=s,r.navigating=!1},function(e){throw r.navigating=!1,e})}else l=a.delegate.pattern;u=c.generate(a.delegate.alias||a.delegate.view,a.parameters);var v=this._previousSegment;this._previousSegment=u,this.navigating=!0;var m=this._nextRouteInfo=ii(a,!0);return this.finishNavigating=this._canNavigate(a,i).then(function(t){if(!t)throw r.navigating=!1,new Error("Not cleared to navigate");return r._previousUrl=e,r._previousQuery=s,r._performNavigation(a)}).then(function(){r._previousPattern=l,r._previousSegment=u,r.currentRouteInfo=m,r.navigating=!1},function(e){throw r._previousSegment=v,r.navigating=!1,e})},e.prototype.generate=function(e,t,n){var i=e;(e=this._Injector.convertDependency(e))===Rn&&(e=i);for(var r=this,o="";!mi(r)&&!r._recognizer.exists(e);)r=r.parent;if(mi(r))throw new Error("Route for "+e+" does not exist.");for(var s,a=r._recognizer.generate(e,t);!mi(r=r.parent);)o=(s=mi(s=r._previousSegment)||"/"===s?"":s)+o;return o+a+Di(n)},e.prototype._configureRoute=function(e){var t=this._Injector.convertDependency(e.view),n=e.alias||t;if(t!==Rn){e.view=t,e.alias=n||t;var i={pattern:e.pattern,delegate:e},r=e.pattern+g,o={pattern:r,delegate:{pattern:r,view:t,alias:n}};this._recognizer.register([i],{name:n}),this._childRecognizer.register([o])}},e.prototype._addHandler=function(e,t,n,i){gi(n)&&(n="*");var r=n;if("*"!==n&&(n=this._Injector.convertDependency(n)),n===Rn&&(n=r),_i(n)||_i(t))return this;var o=i[n];ri(o)||(o=i[n]={});var s=o[t];return yi(s)||(s=o[t]=[]),s.push(e),this},e.prototype._forceNavigate=function(){var e,t=this;this._resolve;if(this.navigating)return this.finishNavigating.then(function(){return t._forceNavigate()});if(this.isRoot&&_i(this._previousUrl)){var n=this._browser.urlUtils();this._previousUrl=n.pathname,e=n.query}return _i(this._previousQuery)||(e=Mi(this._previousQuery)),this.navigate(this._previousUrl,e,!0)},e.prototype._navigateChildren=function(e,t){void 0===t&&(t=!0);var n=this._getChildRoute(e);return mi(n)?this._resolve():Ti(function(i){return i.navigate(n,e.query,void 0,t)},this.children).then(ei)},e.prototype._getChildRoute=function(e){if(!mi(e)){var t=e.parameters.childRoute;return ci(t)||(t=""),"/"+t}},e.prototype._performNavigation=function(e){var t=this,n=this._isSameRoute(this._nextRouteInfo);return this._performNavigateFrom(n).then(function(){if(!n)return Ti(function(t){return t.navigateTo(e)},t._ports)}).then(function(){return t._navigateChildren(e,!1)})},e.prototype._performNavigateFrom=function(e){var t=this;return Ti(function(e){return e._performNavigateFrom()},this.children).then(function(){if(!e)return Ti(function(e){return e.navigateFrom()},t._ports)}).then(ei)},e.prototype._canNavigate=function(e,t){var n=this;void 0===t&&(t=!0);var i=this._isSameRoute(this._nextRouteInfo);return t?this._canNavigateFrom(i).then(function(t){return t&&n._canNavigateTo(e,i)}):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return n._callInterceptors(e)}).then(function(){return!0},function(){return!0})},e.prototype._canNavigateFrom=function(e){var t=this;return this._Promise.all(this.children.reduce(function(e,t){return e.concat(t._canNavigateFrom())},[])).then($i).then(function(n){return!n||e?[n]:Ti(function(e){return e.canNavigateFrom()},t._ports)}).then($i)},e.prototype._canNavigateTo=function(e,t){var n=this;return _i(this._ports)?this._resolve(!0):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return n._callInterceptors(e)}).then(function(i){return!1===i||t?[i]:Ti(function(t){return t.canNavigateTo(e)},n._ports)}).then($i)},e.prototype._callAllHandlers=function(e,t,n){var i=this;return this._callHandlers(this._queryTransforms["*"],n,void 0,!0).then(function(){return i._callHandlers(i._queryTransforms[e],n,void 0,!0)}).then(function(){return i._callHandlers(i._paramTransforms["*"],t,n)}).then(function(){return i._callHandlers(i._paramTransforms[e],t,n)}).then(ei)},e.prototype._callHandlers=function(e,t,n,i){var r=this._resolve;return ri(t)||(t={}),Ti(function(e,o){return ki(function(e){return!0!==i&&gi(t[o])?r():r(e(t[o],t,n))},e)},e).then(ei)},e.prototype._callInterceptors=function(e){var t=this,n=this._resolve;return ki(function(t){return n(t(e))},this._interceptors["*"]).then($i).then(function(i){return i?Ti(function(t){return n(t(e))},t._interceptors[e.delegate.alias]):[i]}).then($i)},e.prototype._isSameRoute=function(e){var t=ii(this.currentRouteInfo,!0);if(e=ii(e,!0),this._sanitizeRouteInfo(t),this._sanitizeRouteInfo(e),!ri(t)||!ri(e))return!1;var n=t.delegate,i=e.delegate,r=Di(t.parameters),o=Di(e.parameters),s=Di(t.query),a=Di(e.query);return n.view===i.view&&n.alias===i.alias&&n.pattern===i.pattern&&r===o&&(s===a||this.children.length>0)},e.prototype._sanitizeRouteInfo=function(e){if(ri(e)&&e.parameters.hasOwnProperty("childRoute")){var t=e.delegate,n=t.pattern;t.pattern=n.slice(0,n.length-y),Oi(e.parameters,"childRoute")}},e.prototype._clearInfo=function(){this._previousSegment=void 0,this._previousPattern=void 0,this._previousUrl=void 0,this._previousQuery=void 0,this.currentRouteInfo=void 0,this.navigating=!1,Ei(function(e){e._clearInfo()},this.children)},e._inject={_Promise:f,_Injector:oe,_EventManager:b,_browser:Q,_browserConfig:W,_recognizer:re,_childRecognizer:re},e}();function x(){return C}e.Router=C,ur.injectable("$Router",C,null,bn),e.IRouterStatic=x,ur.injectable(Y,x)}(e.routing||(e.routing={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=Pi(this.type),t=this.attributes[e];_i(t)||this._isPrecompiled()||(this._label=t,this._define(t))},t.prototype.dispose=function(){for(var e=this._label,t=this.parent;!gi(e)&&ri(t);)ri(t[e])&&ai(t[e].element)&&t[e].element===this.element&&Oi(t,e),t=t.parent},t.prototype._define=function(e){var t=this.templateControl;mi(t)||(t.name=e);for(var n=this.parent,i={element:this.element,control:t};ri(n);){ri(n[e])||(n[e]=i),n=n.parent}},t.prototype._isPrecompiled=function(){for(var e=this.parent;!mi(e);){if(-1!==e.type.indexOf(wn))return!0;e=e.parent}return!1},t}(Br);e.Name=t,ur.control(ve,t);var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._aliases=[],t}return __extends(t,e),t.prototype.loaded=function(){mi(this.element)||(this.attribute=Pi(this.type),this._setListener())},t.prototype._setListener=function(){var e=this.attributes[this.attribute];_i(this.event)||_i(e)||(this._parseArgs(e),this._addEventListeners())},t.prototype._addEventListeners=function(){this.addEventListener(this.element,this.event,this._onEvent,!1)},t.prototype._buildExpression=function(){var e,t,n,i=this.parent,r=this.templateControl,o=this._listener,s=ei;if(mi(r)?mi(i)||(t=i.getResources(this._aliases),n=i.context):(t=r.getResources(this._aliases),mi(i)||(n=i.context)),"@"===o[0]){if(!mi(t)){var a=o.split("."),l=t[a[0].slice(1)];if(ri(l)){a.shift();for(var u=void 0;a.length>1&&!mi(l[u=a.shift()]);)l=l[u];1===a.length?vi(l[u=a.shift()])&&(e=l,s=l[u]):this._log.warn('Invalid path for function "'+o+'"')}else vi(l)&&(s=l)}}else{var c=this.findProperty(o,this.templateControl);if(mi(c))return this._log.warn("Could not find property "+o+" on any associated control."),{fn:ei,context:{},args:[]};var h=c.expresssion.identifiers;if(h.length>1)return this._log.warn("Cannot have more than one identifier in a "+this.type+"'s expression."),{fn:ei,context:{},args:[]};var p=h[0].split("."),_=c.control;if(p.pop(),p.length>0)for(var f=void 0;p.length>0&&!mi(_[f=p.shift()]);)_=_[f];s=c.value,e=_}return{fn:s,context:e,args:mi(this._args)?[]:this._args.evaluate(n,t)}},t.prototype._onEvent=function(e){var t=this._buildExpression(),n=t.fn;vi(n)?n.apply(t.context,t.args.concat(e)):this._log.warn("Cannot find registered event method "+this._listener+" for control: "+this.type)},t.prototype._parseArgs=function(e){if(!_i(e)){var t,n=this._regex.argumentRegex.exec(e),i=[];if(mi(n))t=e;else if(t=e.slice(0,n.index),""!==n[1]){var r=this._parser.parse("["+n[1]+"]");i=r.aliases,this._args=r}if("@"===t[0]){var o=t.slice(1).split(".")[0];-1===i.indexOf(o)&&i.push(o)}this._listener=t,this._aliases=i}},t._inject={_parser:w,_regex:T},t}(Br);e.SimpleEventControl=n;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=qt,t}return __extends(t,e),t}(n);e.Tap=i;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="blur",t}return __extends(t,e),t}(n);e.Blur=r;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="change",t}return __extends(t,e),t}(n);e.Change=o;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="copy",t}return __extends(t,e),t}(n);e.Copy=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="cut",t}return __extends(t,e),t}(n);e.Cut=a;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="paste",t}return __extends(t,e),t}(n);e.Paste=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Ht,t}return __extends(t,e),t}(n);e.DblTap=c;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="focus",t}return __extends(t,e),t}(n);e.Focus=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Qt,t}return __extends(t,e),t}(n);e.TouchStart=p;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Wt,t}return __extends(t,e),t}(n);e.TouchEnd=_;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Yt,t}return __extends(t,e),t}(n);e.TouchMove=f;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Xt,t}return __extends(t,e),t}(n);e.TouchCancel=v;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Gt,t}return __extends(t,e),t}(n);e.Hold=g;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Jt,t}return __extends(t,e),t}(n);e.Release=y;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Kt,t}return __extends(t,e),t}(n);e.Swipe=b;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Zt,t}return __extends(t,e),t}(n);e.SwipeLeft=C;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=en,t}return __extends(t,e),t}(n);e.SwipeRight=x;var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=tn,t}return __extends(t,e),t}(n);e.SwipeUp=E;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=nn,t}return __extends(t,e),t}(n);e.SwipeDown=N;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=rn,t}return __extends(t,e),t}(n);e.Track=k;var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=on,t}return __extends(t,e),t}(n);e.TrackLeft=I;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=sn,t}return __extends(t,e),t}(n);e.TrackRight=R;var j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=an,t}return __extends(t,e),t}(n);e.TrackUp=j;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=ln,t}return __extends(t,e),t}(n);e.TrackDown=A;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=un,t}return __extends(t,e),t}(n);e.TrackEnd=L;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="submit",t}return __extends(t,e),t.prototype._onEvent=function(t){this.element.hasAttribute("action")||t.preventDefault(),e.prototype._onEvent.call(this,t)},t}(n);e.Submit=P;var O=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="input",e}return __extends(n,t),n.prototype._addEventListeners=function(){var t,n=this,i=this.element,r=this._compat,o=!1,s=!1,a=function(e){o||n._onEvent(e)},l=function(e){vi(t)||(t=Ii(function(){a(e),t=null}))};gi(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(e){o=!1,a(e)},!1)),this.addEventListener(i,"input",function(e){s=!0,a(e)},!1),this.addEventListener(i,"change",function(e){s?s=!1:a(e)},!1),r.hasEvent("input")||(this.addEventListener(i,"keydown",function(t){var n=t.keyCode,i=e.KeyCodes;n===i.lwk||n===i.rwk||n>=i.shift&&n<=i.escape||n>i.space&&n<=i.down||l(t)},!1),this.addEventListener(i,"cut",l,!1),this.addEventListener(i,"paste",l,!1))},n._inject={_compat:d},n}(n);e.React=O,ur.control(we,i),ur.control(Te,r),ur.control(Ne,o),ur.control(ke,s),ur.control(Se,a),ur.control(Ie,l),ur.control(Re,c),ur.control(je,h),ur.control(Ae,P),ur.control(Le,p),ur.control(Pe,_),ur.control(Oe,f),ur.control(Fe,v),ur.control(Me,g),ur.control(De,y),ur.control($e,b),ur.control(ze,C),ur.control(Be,x),ur.control(Ue,E),ur.control(Ve,N),ur.control(qe,k),ur.control(He,I),ur.control(Qe,R),ur.control(We,j),ur.control(Ye,A),ur.control(Xe,L),ur.control(Ge,O),e.KeyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,"caps lock":20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,"left arrow":37,up:38,"up arrow":38,right:39,"right arrow":39,down:40,"down arrow":40,insert:45,delete:46,0:48,zero:48,")":48,"right parenthesis":48,1:49,one:49,"!":49,exclamation:49,"exclamation point":49,2:50,two:50,"@":50,at:50,3:51,three:51,"#":51,"number sign":51,hash:51,pound:51,4:52,four:52,$:52,dollar:52,"dollar sign":52,5:53,five:53,"%":53,percent:53,"percent sign":53,6:54,six:54,"^":54,caret:54,7:55,seven:55,"&":55,ampersand:55,8:56,eight:56,"*":56,asterisk:56,9:57,nine:57,"(":57,"left parenthesis":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lwk:91,"left window key":91,rwk:92,"right window key":92,select:93,"select key":93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"num lock":144,"scroll lock":145,";":186,"semi-colon":186,":":186,colon:186,"=":187,equal:187,"equal sign":187,"+":187,plus:187,",":188,comma:188,"<":188,lt:188,"less than":188,"left angle bracket":188,"-":189,dash:189,_:189,underscore:189,".":190,period:190,">":190,gt:190,"greater than":190,"right angle bracket":190,"/":191,"forward slash":191,"?":191,"question mark":191,"`":192,"grave accent":192,"~":192,tilde:192,"[":219,"open bracket":219,"{":219,"open brace":219,"\\":220,"back slash":220,"|":220,pipe:220,"]":221,"close bracket":221,"}":221,"close brace":221,"'":222,"single quote":222,'"':222,"double quote":222};var F=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.keyCodes={},e}return __extends(n,t),n.prototype._setListener=function(){var e=this.attribute;if(!_i(this.event)&&!_i(e)){var n=this.attributes[e].trim();if("{"===n[0]){var i=this.evaluateExpression(n)||{method:""},r=this._filterArgs(i);return this._setKeyCodes(r),void this.addEventListener(this.element,this.event,this._onEvent,!1)}t.prototype._setListener.call(this)}},n.prototype._filterArgs=function(e){var t=e.key,n=e.keys;return this._parseArgs(e.method),yi(n)?n:ci(n)?[n]:yi(t)?t:ci(t)?[t]:void(mi(e.char)&&mi(e.chars)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},n.prototype._onEvent=function(e){this._compareKeys(e)&&t.prototype._onEvent.call(this,e)},n.prototype._compareKeys=function(e){var t=this.keyCodes,n=e.keyCode||e.which;return _i(t)||!0===t[n]},n.prototype._setKeyCodes=function(t){yi(t)||(t=[]);for(var n,i=t.length,r=this.keyCodes,o=0;o<i;++o)r[di(n=t[o])?n:e.KeyCodes[n.toLowerCase()]]=!0},n}(n);e.KeyCodeEventControl=F;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,e),t}(F);e.KeyDown=M;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,e),t.prototype._onEvent=function(t){var n=this,i=t.keyCode||t.which;if(e.prototype._compareKeys.call(this,t)&&(i>=48&&i<=90||i>=186||i>=96&&i<=111))var r=this.addEventListener(this.element,"keypress",function(t){r(),e.prototype._onEvent.call(n,t)},!1)},t.prototype._compareKeys=function(e){return!0},t}(F);e.KeyPress=D;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keyup",t}return __extends(t,e),t}(F);e.KeyUp=$;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keypress",t}return __extends(t,e),t.prototype._filterArgs=function(e){var t=e.char,n=e.chars;return this._parseArgs(e.method),yi(n)?n:ci(n)?[n]:yi(t)?t:ci(t)?[t]:void(mi(e.key)&&mi(e.keys)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},t.prototype._onEvent=function(t){var n,i=this.keyCodes,r=t.charCode||t.which;if(r)n=String.fromCharCode(r);else if(!(n=t.key))return;(_i(i)||!0===i[n])&&e.prototype._onEvent.call(this,t)},t.prototype._compareKeys=function(e){return!0},t.prototype._setKeyCodes=function(e){yi(e)||(e=[]);for(var t,n=e.length,i=this.keyCodes,r=0;r<n;++r)i[di(t=e[r])?String.fromCharCode(t):t]=!0},t}(F);e.CharPress=z,ur.control(pe,M),ur.control(_e,D),ur.control(fe,$),ur.control(de,z);var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t._stopSetter=ei,t}return __extends(t,e),t.prototype.loaded=function(){mi(this.element)||(this.attribute=Pi(this.type),this.setter(),this.__removeListener=this.attributes.observe(this.setter,this.attribute))},t.prototype.contextChanged=function(){mi(this.element)||this.setter()},t.prototype.dispose=function(){this._stopSetter(),vi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null)},t.prototype.setter=function(){var e=this;this._stopSetter(),this._stopSetter=Ai(function(){var t=e.element,n=e.property;if(ai(t))switch(e.attributes[e.attribute]){case"false":case"0":case"null":case"":t.setAttribute(n,""),t[n]=!1,t.removeAttribute(n);break;default:t.setAttribute(n,n),t[n]=!0}})},t}(Br);e.SetAttributeControl=B;var U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="checked",t}return __extends(t,e),t}(B);e.Checked=U;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="disabled",t}return __extends(t,e),t}(B);e.Disabled=V;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="selected",t}return __extends(t,e),t}(B);e.Selected=q;var H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="readonly",t}return __extends(t,e),t}(B);e.ReadOnly=H;var W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="display",t.value="none",t.importance="important",t._initialValue="",t}return __extends(t,e),t.prototype.initialize=function(){var e=(this.element.style||{getPropertyValue:ei}).getPropertyValue(this.property);this._setValue(this.value,this.importance),_i(e)||"none"===e||(this._initialValue=e)},t.prototype.setter=function(){var e=this;this._stopSetter(),this._stopSetter=Ai(function(){if(ai(e.element))switch(e.attributes[e.attribute]){case"false":case"0":case"null":case"":e._setValue(e.value,e.importance);break;default:e._setValue(e._initialValue)}})},t.prototype._setValue=function(e,t){var n=this.property,i=this.element.style||{setProperty:ei,removeProperty:ei,getPropertyValue:ei,getPropertyPriority:ei},r=i.getPropertyValue(n),o=i.getPropertyPriority(n);e===r&&t===o||(_i(e)?i.removeProperty(n):i.setProperty(n,e,t))},t}(B);e.Visible=W;var Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="style",t._styleRegex=/(.*?):(.*)/,t._urlRegex=/url\([^\)]*\)/gi,t._urlReplace="[PLAT-STYLE-URL]",t.__addedStyles=[],t.__oldStyles={},t}return __extends(t,e),t.prototype.setter=function(){var e=this;this._stopSetter();var t=this.element,n=this.attributes[this.attribute];_i(n)||mi(t)||(this._stopSetter=Ai(function(){var i=[],r=e._urlReplace;n=n.replace(e._urlRegex,function(e){return i.push(e),r});var o,s,a,l,u=t.style,c=e.__addedStyles,h=e.__oldStyles,p=[],_=n.split(";"),f=_.length,d=e._styleRegex,v={};for(l=0;l<f;++l)mi(a=d.exec(_[l]))||a.length<3||0===(o=a[1].trim()).length||gi(u[o])||(-1===c.indexOf(o)&&(h[o]=u[o]),p.push(o),s=a[2].trim(),i.length>0&&-1!==s.indexOf(r)&&(s=s.replace(r,i.shift())),v[o]=s);for(f=c.length;f-- >0;)o=c[f],-1===p.indexOf(o)&&(v[o]=h[o],c.splice(f,1));var m=Object.keys(v);for(f=m.length;f-- >0;)u[o=m[f]]=v[o];e.__addedStyles=c.concat(p)}))},t}(B);e.Style=Y,ur.control(ge,U),ur.control(ye,V),ur.control(be,q),ur.control(Ce,H),ur.control(xe,W),ur.control(Ee,Y);var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];_i(n)||mi(e)||gi(e[t])||(e[t]=n)},t}(B);e.ElementPropertyControl=X;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="href",t}return __extends(t,e),t}(X);e.Href=G;var J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="src",t}return __extends(t,e),t.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];_i(n)||mi(e)||gi(e[t])||(e[t]=this._browser.urlUtils(n))},t._inject={_browser:Q},t}(X);e.Src=J,ur.control(ce,G),ur.control(he,J);var K=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=100,e._supportsTwoWayBinding=!1,e._dateRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/,e._dateTimeLocalRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])T(0[1-9]|1[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9])(?:\.([0-9]+))?)?/,e.__fileSupported=wr(d).fileSupported,e.__fileNameRegex=wr(T).fileNameRegex,e.__isSelf=!1,e}return __extends(n,t),n.prototype.initialize=function(){this._determineType()},n.prototype.loaded=function(){var e=this.parent;if(!mi(e)&&!mi(this.element)){var t=Pi(this.type),n=this._parser,i=this._expression=n.parse(this.attributes[t]),r=i.identifiers;if(1!==r.length)return this._log.warn("Only 1 identifier allowed in a "+this.type+" expression."),void(this._contextExpression=null);var o=r[0].split(".");if(this._property=o.pop(),i.aliases.length>0){var s=i.aliases[0],a=e.findResource(s),l=void 0;if(ri(a)){if((l=a.resource.type)!==An&&l!==Fn)return}else a={resource:{}};s===zn||s===Dn?this._contextExpression=n.parse(o.join(".")):(this._property="value",this._contextExpression={evaluate:function(){return a.resource},aliases:[],identifiers:[],expression:""})}else o.length>0?this._contextExpression=n.parse(o.join(".")):this._contextExpression={evaluate:function(){return e.context},aliases:[],identifiers:[],expression:""};this._supportsTwoWayBinding&&this.templateControl.observeProperties(this),this._watchExpression(),mi(this._addEventType)||this._addEventType()}},n.prototype.contextChanged=function(){this._watchExpression()},n.prototype.dispose=function(){this._addEventType=null},n.prototype.evaluate=function(){var e=this._expression;if(!gi(e))return this.evaluateExpression(e)},n.prototype.observeProperty=function(e,t,n){return this._observeProperty(e,t,n)},n.prototype.observeArrayChange=function(e,t){return this._observeProperty(e,t,!1,!0)},n.prototype._addTextEventListener=function(){var t,n=this,i=this.element,r=this._compat,o=!1,s=function(){o||n._propertyChanged()},a=function(){vi(t)||(t=Ii(function(){s(),t=null}))};gi(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(){o=!1,s()},!1)),r.hasEvent("input")?this.addEventListener(i,"input",s,!1):(this.addEventListener(i,"keydown",function(t){var n=t.keyCode||t.which,i=e.KeyCodes;n===i.lwk||n===i.rwk||n>=i.shift&&n<=i.escape||n>i.space&&n<=i.down||a()},!1),this.addEventListener(i,"cut",a,!1),this.addEventListener(i,"paste",a,!1)),this.addEventListener(i,"change",s,!1)},n.prototype._addChangeEventListener=function(){this.addEventListener(this.element,"change",this._propertyChanged,!1)},n.prototype._addButtonEventListener=function(){this.addEventListener(this.element,qt,this._propertyChanged,!1)},n.prototype._addRangeEventListener=function(){var e=this.element;this._compat.hasEvent("input")&&this.addEventListener(e,"input",this._propertyChanged,!1),this.addEventListener(e,"change",this._propertyChanged,!1)},n.prototype._getChecked=function(){return this.element.checked},n.prototype._getValue=function(){return this.element.value},n.prototype._getTextContent=function(){return this.element.textContent},n.prototype._getDate=function(){var e=this.element.value,t=this._dateRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(4===n.length)return new Date(Number(n[1]),Number(n[2])-1,Number(n[3]))}return e},n.prototype._getDateTimeLocal=function(){var e=this.element.value,t=this._dateTimeLocalRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(8===n.length)return mi(n[6])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5])):mi(n[7])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6])):new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6]),Number(n[7]))}return e},n.prototype._getFile=function(){var e=this.element,t=e.value;return this.__fileSupported?e.files.length>0?e.files[0]:null:{name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:ei,msClose:ei,slice:function(){return{}}}},n.prototype._getFiles=function(){var e=this.element;if(this.__fileSupported)return Array.prototype.slice.call(e.files);for(var t,n=e.value.split(/,|;/g),i=n.length,r=[],o=function(){return{}},s=0;s<i;++s)t=n[s],r.push({name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:ei,msClose:ei,slice:o});return r},n.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;++r)(e=t[r]).selected&&i.push(e.value);return i},n.prototype._setText=function(e,t,n){if(!this.__isSelf)return mi(e)&&(e="",!0===n)?(mi(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setRange=function(e,t,n){if(!this.__isSelf)return _i(e)&&(e=""===e?"0":0,!0===n)?(_i(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setHidden=function(e,t,n){if(!this.__isSelf)return _i(e)&&(e="",!0===n)?(_i(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setValue=function(e){var t=this.element;ci(e)||(di(e)?(this._propertyType="number",e=e.toString()):fi(e)&&(this._propertyType="boolean",e=e.toString())),t.value!==e&&(t.value=e)},n.prototype._setChecked=function(e,t,n){if(!this.__isSelf)return fi(e)||(e=!!e,!0!==n)?void(this.element.checked=e):(this.element.checked=e,void this._propertyChanged())},n.prototype._setRadio=function(e){var t=this.element;this.__isSelf||(mi(e)?t.checked&&this._propertyChanged():(ci(e)||(di(e)?(this._propertyType="number",e=e.toString()):fi(e)&&(this._propertyType="boolean",e=e.toString())),t.checked=t.value===e))},n.prototype._setDate=function(e,t,n){if(!this.__isSelf){if(!Ci(e))return this._dateRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2);this._setValue(e.getFullYear()+"-"+r+"-"+i)}},n.prototype._setDateTimeLocal=function(e,t,n){if(!this.__isSelf){if(!Ci(e))return this._dateTimeLocalRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2),o=("0"+e.getHours()).slice(-2),s=("0"+e.getMinutes()).slice(-2),a=("0"+e.getSeconds()).slice(-2),l=e.getMilliseconds();this._setValue(e.getFullYear()+"-"+r+"-"+i+"T"+o+":"+s+":"+a+"."+l)}},n.prototype._setSelectedIndex=function(e,t,n){if(!this.__isSelf){var i=this.element,r=i.value;if(mi(e))return!0!==n&&this._document.body.contains(i)?void(i.selectedIndex=-1):void this._propertyChanged();if(ci(e)||(di(e)?(this._propertyType="number",e=e.toString()):fi(e)?(this._propertyType="boolean",e=e.toString()):this._log.info("Trying to bind an invalid value to a <select> element using a "+this.type+".")),r!==e){if(!this._document.body.contains(i))return i.value=e,void(i.value!==e&&(i.value=r,this._propertyChanged()));i.value=e,i.value===e&&-1!==i.selectedIndex||(i.selectedIndex=-1)}}},n.prototype._setSelectedIndices=function(e,t,n){if(!this.__isSelf){var i,r=this.element.options,o=mi(r)?0:r.length,s=mi(e);if(!s&&yi(e))for(var a,l,u,c=1/0;o-- >0;)a=(i=r[o]).value,-1===e.indexOf(a)?di(l=Number(a))&&-1!==(u=e.indexOf(l))?(u<c&&(this._propertyType="number",c=u),i.selected=!0):"true"===a&&-1!==(u=e.indexOf(!0))||"false"===a&&-1!==(u=e.indexOf(!1))?(u<c&&(this._propertyType="boolean",c=u),i.selected=!0):i.selected=!1:i.selected=!0;else for(!0===n&&this._propertyChanged();o-- >0;){if(i=r[o],!s&&i.value===""+e)return void(i.selected=!0);i.selected=!1}}},n.prototype._determineType=function(){if(!this._observingBindableProperty()){var e=this.element;if(!mi(e))switch(e.nodeName.toLowerCase()){case"input":switch(e.type){case"button":case"submit":case"reset":case"image":this._addEventType=this._addButtonEventListener,this._getter=this._getValue;break;case"checkbox":this._addEventType=this._addChangeEventListener,this._getter=this._getChecked,this._setter=this._setChecked;break;case"radio":this._initializeRadio();break;case"range":this._addEventType=this._addRangeEventListener,this._getter=this._getValue,this._setter=this._setRange;break;case"date":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDate,this._setter=this._setDate;break;case"datetime-local":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDateTimeLocal,this._setter=this._setDateTimeLocal;break;case"file":this._propertyType="nullable";var t=e.multiple;this._addEventType=this._addChangeEventListener,this._getter=t?this._getFiles:this._getFile;break;case"hidden":this._getter=this._getValue,this._setter=this._setHidden;break;case"number":this._propertyType="number";default:this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText}break;case"textarea":this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText;break;case"select":this._initializeSelect();break;case"button":this._addEventType=this._addButtonEventListener,this._getter=this._getTextContent}}},n.prototype._watchExpression=function(){var e,t=this,n=this._contextExpression,i=this.evaluateExpression(n);if(!ri(i)){if(!(mi(i)&&n.identifiers.length>0))return void this._log.warn(this.type+" is trying to index into a primitive type. "+this._contextExpression.expression+" is already defined and not an object when trying to evaluate "+this.type+'="'+this._expression.expression+'"');i=this._createContext(n.identifiers[0])}if(vi(this._setter)){this._setter===this._setSelectedIndices&&(mi(i[e=this._property])&&(i[e]=[]),this.observeArray(function(e){t._setter(e[0].object,null,!0)},n+"."+e));var r=this._expression;this.observeExpression(function(e,n){t._setter(e,n)},r),this._setter(this.evaluateExpression(r),void 0,!0)}},n.prototype._createContext=function(e){var t=e.split("."),n=t.shift().slice(1),i=this.parent;return n===Dn?(e=t.join("."),i=this.parent.root):n===u&&(e=t.join(".")),this._ContextManager.createContext(i,e)},n.prototype._castProperty=function(e,t){var n;if(mi(t=t||this._propertyType))return e;if(ri(e))if(yi(e)){var i=e.length;n=[];for(var r=0;r<i;++r)n.push(this._castProperty(e[r],t))}else if(Ci(e)||ui(e)||pi(e)||oi(e)||ai(e))n=e;else{var o=Object.keys(e),s=void 0;for(n={};o.length>0;)n[s=o.pop()]=e[s]}else switch(t){case"string":n=ci(e)?e:vi(e.toString)?e.toString():Object.prototype.toString.call(e);break;case"number":n=_i(e)?null:Number(e);break;case"boolean":switch(e){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!e}break;case"nullable":_i(e)&&(n=null);break;default:n=e}return n},n.prototype._propertyChanged=function(){if(!mi(this._contextExpression)){var e=this.evaluateExpression(this._contextExpression);if(ri(e)){var t=this._property,n=this._castProperty(this._getter());e[t]!==n&&(this.__isSelf=!0,e[t]=n,this.__isSelf=!1)}}},n.prototype._initializeRadio=function(){var e=this.element;if(this._addEventType=this._addChangeEventListener,this._getter=this._getValue,this._setter=this._setRadio,!e.hasAttribute("name")){var t=Pi(this.type),n=this.attributes[t];e.setAttribute("name",n)}e.hasAttribute("value")||e.setAttribute("value","")},n.prototype._initializeSelect=function(){var e,t=this.element,n=t.multiple,i=t.options,r=i.length;this._addEventType=this._addChangeEventListener,n?(this._getter=this._getSelectedValues,this._setter=this._setSelectedIndices):(this._getter=this._getValue,this._setter=this._setSelectedIndex);for(var o=0;o<r;++o)(e=i[o]).hasAttribute("value")||e.setAttribute("value",e.textContent)},n.prototype._observingBindableProperty=function(){var e=this,t=this.templateControl;return!!(ri(t)&&vi(t.onInput)&&vi(t.observeProperties))&&(t.onInput(function(t){e._getter=function(){return t},e._propertyChanged()}),this._supportsTwoWayBinding=!0)},n.prototype._observeProperty=function(e,t,n,i){var r,o,s=this;if(_i(t))r=this._expression.expression;else if(di(t))r=this._expression.expression+"."+t;else{var a=this._parser,l=a.parse(t).identifiers;if(1!==l.length)return void this._log.warn("Only 1 identifier path allowed when observing changes to a bound property's child with a control implementing observable.ISupportTwoWayBinding and working with "+this.type);var u=(r=a.parse(this._expression.expression+"."+l[0]).identifiers[0]).split(".");u.pop();var c=u.join("."),h=this.evaluateExpression(c);if(!ri(h)){if(!mi(h))return void this._log.warn("A control implementing observable.ISupportTwoWayBinding is trying to index into a primitive type when trying to evaluate "+this.type+'="'+this._expression.expression+'"');h=this._ContextManager.createContext(this.parent,c)}}if(e=e.bind(this.templateControl),n=!0===n,!0===i)o=this.observeArray(function(n){e(n,t)},r);else{o=this.observe(function(i,r){s.__isSelf||i===r||(n&&(s._propertyType=s._getPropertyType(i)),e(i,r,t))},r);var p=this.evaluateExpression(r);n&&(this._propertyType=this._getPropertyType(p)),e(p,void 0,t,!0)}return o},n.prototype._getPropertyType=function(e){return ri(e)?e:ci(e)?"string":di(e)?"number":fi(e)?"boolean":void 0},n._inject={_parser:w,_ContextManager:S,_compat:d,_document:m},n}(Br);e.Bind=K,ur.control(ue,K);var Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t.priority=200,t._listeners=[],t._boundAddListener=t._addListener.bind(t),t}return __extends(t,e),t.prototype.initialize=function(){this.attribute=Pi(this.type),this._setProperty(this._getValue())},t.prototype.loaded=function(){this._observeProperty(),this._setProperty(this._getValue())},t.prototype.dispose=function(){vi(this._removeListener)&&this._removeListener(),this._listeners=[]},t.prototype._setProperty=function(e,t){var n=this.templateControl;mi(n)||(this._ContextManager.defineGetter(n,this.property,{value:e,observe:this._boundAddListener},!0,!0),this._callListeners(e,t))},t.prototype._callListeners=function(e,t){for(var n=this._listeners,i=n.length,r=0;r<i;++r)n[r](e,t)},t.prototype._addListener=function(e){var t=this._listeners;return e=e.bind(this.templateControl),t.push(e),function(){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},t.prototype._getValue=function(){if(!mi(this.templateControl))return this.evaluateExpression(this.attributes[this.attribute])},t.prototype._observeProperty=function(){mi(this.templateControl)||(this._removeListener=this.observeExpression(this._setProperty,this.attributes[this.attribute]))},t._inject={_ContextManager:S},t}(Br);e.ObservableAttributeControl=Z;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="options",t}return __extends(t,e),t}(Z);e.Options=ee,ur.control(me,ee)}(e.controls||(e.controls={}));var Vr=function(){function e(){this.uid=Li(le),this._log=e._log,(this.navigator=wr(k)).initialize(wr(Y).currentRouter())}return e.start=function(){if(!e._compat.isCompatible)return e._log.error(new Error("PlatypusTS only supports modern browsers where Object.defineProperty is defined"));e.__addPlatCss();var t=e._EventManager;t.dispose(jn),t.on(jn,xt,e.__ready),t.on(jn,Tt,e.__shutdown),t.initialize()},e.registerApp=function(t){!mi(e.app)&&ci(e.app.uid)&&e._EventManager.dispose(e.app.uid),e.__injector=t},e.load=function(t){var n=e._LifecycleEvent,i=e._compiler,r=e._document.body,o=e._document.head;return n.dispatch(kt,e),mi(t)?(r.setAttribute(Pt,""),void Ii(function(){i.compile([o]),i.compile([r]),r.removeAttribute(Pt)})):vi(t.setAttribute)?(t.setAttribute(Pt,""),void Ii(function(){i.compile([t]),t.removeAttribute(Pt)})):void Ii(function(){i.compile([t])})},e.__ready=function(t){cr.Injector.initialize(),e.__registerAppEvents(t),t.defaultPrevented||e.load()},e.__shutdown=function(){var t=navigator.app,n=e._LifecycleEvent;if(!mi(t)&&vi(t.exitApp)){if(n.dispatch(Nt,e).defaultPrevented)return;t.exitApp()}},e.__registerAppEvents=function(t){var n=e.__injector;if(!mi(n)&&vi(n.inject)){var i=e.app=n.inject();i.on(Et,i.suspend),i.on("resume",i.resume),i.on("online",i.online),i.on(wt,i.offline),i.on("error",i.error),i.on(Nt,i.exiting),vi(i.ready)&&i.ready(t)}},e.__addPlatCss=function(){var t=e._document;if(!e._compat.platCss)if(!mi(t.styleSheets)&&t.styleSheets.length>0)t.styleSheets[0].insertRule("[plat-hide] { display: none !important; }",0);else{var n=document.createElement("style");n.textContent="[plat-hide] { display: none !important; }",document.head.appendChild(n)}},e.prototype.suspend=function(e){},e.prototype.resume=function(e){},e.prototype.error=function(e){},e.prototype.ready=function(e){},e.prototype.exiting=function(e){},e.prototype.online=function(e){},e.prototype.offline=function(e){},e.prototype.dispatchEvent=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=e._EventManager||wr(b);r.dispatch(t,this,r.DIRECT,n)},e.prototype.on=function(t,n){return(e._EventManager||wr(b)).on(this.uid,t,n,this)},e.prototype.load=function(t){e.load(t)},e.prototype.exit=function(){this.dispatchEvent(Tt)},e.app=null,e}();function qr(e,t,n,i,r,o){return Vr._compat=e,Vr._EventManager=t,Vr._document=n,Vr._compiler=i,Vr._LifecycleEvent=r,Vr._log=o,Vr}function Hr(e){return e.app}e.App=Vr,e.IAppStatic=qr,ur.injectable(c,qr,[d,b,m,I,C,E],gn),e.IApp=Hr,ur.injectable("$App",Hr,[c],bn)}(plat||(plat={})),module.exports=plat;