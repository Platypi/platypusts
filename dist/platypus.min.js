"use strict";var plat,__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();!function(e){"use strict;";var t,n,i,r,o,s,a,l,u="context",c="$AppStatic",h="$Http",p="$HttpRequestInstance",_="$HttpConfig",f="$Promise",d="$Compat",v="$ControlFactory",m="$Document",g="$DispatchEventInstance",y="$ErrorEventStatic",b="$EventManagerStatic",C="$LifecycleEventStatic",x="$LifecycleEventInstance",E="$Log",w="$Parser",T="$Regex",N="$Tokenizer",k="$NavigatorInstance",S="$ContextManagerStatic",I="$Compiler",R="$CommentManagerFactory",j="$ElementManagerFactory",A="$NodeManagerStatic",L="$TextManagerFactory",P="$CacheFactory",O="$ManagerCache",F="$TemplateCache",M="$Animator",D="$AttributesFactory",$="$BindableTemplatesFactory",z="$Dom",B="$DomEvents",U="$ResourcesFactory",V="$TemplateControlFactory",q="$TemplateControlInstance",H="$Utils",Q="$Browser",Y="$BrowserConfig",W="$RouterStatic",X="$UrlUtilsInstance",G="$Window",J="$BaseSegmentFactory",K="$BaseSegmentInstance",Z="$StaticSegmentInstance",ee="$DynamicSegmentInstance",te="$SplatSegmentInstance",ne="$StateStatic",ie="$StateInstance",re="$RouteRecognizerInstance",oe="$InjectorStatic",se="$History",ae="$Location",le="plat-",ue=le+"bind",ce=le+"href",he=le+"src",pe=le+"keydown",_e=le+"keypress",fe=le+"keyup",de=le+"charpress",ve=le+"name",me=le+"options",ge=le+"checked",ye=le+"disabled",be=le+"selected",Ce=le+"readonly",xe=le+"visible",Ee=le+"style",we=le+"tap",Te=le+"blur",Ne=le+"change",ke=le+"copy",Se=le+"cut",Ie=le+"paste",Re=le+"dbltap",je=le+"focus",Ae=le+"submit",Le=le+"touchstart",Pe=le+"touchend",Oe=le+"touchmove",Fe=le+"touchcancel",Me=le+"hold",De=le+"release",$e=le+"swipe",ze=le+"swipeleft",Be=le+"swiperight",Ue=le+"swipeup",Ve=le+"swipedown",qe=le+"track",He=le+"trackleft",Qe=le+"trackright",Ye=le+"trackup",We=le+"trackdown",Xe=le+"trackend",Ge=le+"react",Je=le+"link",Ke=le+"foreach",Ze=le+"html",et=le+"if",tt=le+"ignore",nt=le+"select",it=le+"template",rt=le+"viewport",ot=le+"control",st=le+"viewcontrol",at=le+"resources",lt=le+u,ut=it+"-"+u,ct=le+"callback",ht="data-",pt="__templateControlCache",_t="head",ft="meta",dt="link",vt="property",mt="image",gt="article:",yt="og:",bt="twitter:",Ct="content",xt="ready",Et="suspend",wt="offline",Tt="shutdown",Nt="exiting",kt="beforeLoad",St="beforeNavigate",It="navigating",Rt="urlChanged",jt="deviceReady",At="backbutton",Lt="backclick",Pt=le+"hide",Ot=le+"animating",Ft=le+"animation",Mt=le+"transition",Dt=le+"enter",$t=le+"leave",zt=le+"move",Bt=le+"fadein",Ut=le+"fadeout",Vt=le+"back-nav",qt="$tap",Ht="$dbltap",Qt="$touchstart",Yt="$touchend",Wt="$touchmove",Xt="$touchcancel",Gt="$hold",Jt="$release",Kt="$swipe",Zt="$swipeleft",en="$swiperight",tn="$swipeup",nn="$swipedown",rn="$track",on="$trackleft",sn="$trackright",an="$trackup",ln="$trackdown",un="$trackend",cn={index:"index",even:"even",odd:"odd",first:"first",last:"last"},hn="base",pn="variable",_n="static",fn="splat",dn="dynamic",vn="{{",mn="}}",gn="static",yn="singleton",bn="instance",Cn="factory",xn="class",En="-compiled",wn="-@",Tn="-init",Nn=": start node",kn=": end node",Sn="noop",In="__app__",Rn="observable",jn="injectable",An="object",Ln="function",Pn="literal",On="root",Fn="rootContext",Mn="control",Dn=u,$n="function"==typeof Array.isArray,zn={},Bn=Object.prototype.toString,Un="[object ",Vn=Un+"Error]",qn=Un+"File]",Hn=Un+"Array]",Qn=Un+"Boolean]",Yn=Un+"Date]",Wn=Un+"Number]",Xn=Un+"RegExp]",Gn=Un+"String]",Jn=Un+"Promise]";function Kn(){}function Zn(e,t,n,i,r,o){Object.defineProperty(e,t,{value:n,enumerable:!0===i,configurable:!0===r,writable:!0===o})}function ei(e,t,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return di(n)?n:(r=fi(t)?t:t?function(e,t,n){Zn(e,t,n,!0,!0,!0)}:function(e,t,n){e[t]=n},hi(o)&&o.push(n),Ci(function(t,o){ni(t)&&Ci(function(o){if(i=t[o],e){if(mi(i))return mi(n[o])||(n[o]=[]),void ei(e,r,n[o],i);if(yi(i))return void r(n,o,new Date(i.getTime()));if(ui(i))return void r(n,o,new RegExp(i));if(oi(i))return void r(n,o,i.cloneNode(!0));if(ai(i))return void r(n,o,i);if(ni(i))return ni(n[o])||(n[o]={}),void ei(e,r,n[o],i)}r(n,o,i)},Object.keys(t))},o),n)}function ti(e,t){if(!ni(e))return e;if(yi(e))return new Date(e.getTime());if(ui(e))return new RegExp(e);if(oi(e))return e.cloneNode(t);if(ai(e))return e;if(n=e,Bn.call(n)===Vn)return new e.constructor(e.message);var n,i={};return mi(e)&&(i=[]),pi(t)&&t?ei(!0,!1,i,e):ei(!1,!1,i,e)}function ni(e){return null!=e&&"object"==typeof e}function ii(e){return!!(e&&e.document&&e.setInterval)}function ri(e){return!(!e||e.nodeType!==Node.DOCUMENT_NODE)}function oi(e){return!(!e||"number"!=typeof e.nodeType)}function si(e){return!(!e||e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)}function ai(e){return ni(e)&&Bn.call(e)===qn}function li(e){return"string"==typeof e||ni(e)&&Bn.call(e)===Gn}function ui(e){return ni(e)&&Bn.call(e)===Xn}function ci(e){return ni(e)&&(Bn.call(e)===Jn||fi(e.then))}function hi(e){return!!di(e)||(li(e)||mi(e)?0===e.length:!!ni(e)&&0===Object.keys(e).length)}function pi(e){return!0===e||!1===e||ni(e)&&Bn.call(e)===Qn}function _i(e){return("number"==typeof e||ni(e)&&Bn.call(e)===Wn)&&!isNaN(e)}function fi(e){return"function"==typeof e}function di(e){return null==e}function vi(e){return void 0===e}function mi(e){return $n?Array.isArray(e):Bn.call(e)===Hn}function gi(e){return!(di(e)||ii(e)||fi(e))&&(li(e)||e.length>=0)}function yi(e){return"object"==typeof e&&Bn.call(e)===Yn}function bi(e,t,n){var i=[];return di(t)?i:fi(t.filter)?t.filter(e,n):(Ci(function(t,n,r){e(t,n,r)&&i.push(t)},t),i)}function Ci(e,t,n){if(di(t)||!ni(t)&&!gi(t))return t;var i,r,o;if(fi(t.forEach))return t.forEach(e,n);if(gi(t))for(o=t.length,i=0;i<o;i+=1)e.call(n,t[i],i,t);else{var s=Object.keys(t);for(o=s.length;s.length>0;)r=s.shift(),e.call(n,t[r],r,t)}return t}function xi(e,t,n){var i=[];return di(t)?i:fi(t.map)?t.map(e,n):(Ci(function(r,o){i.push(e.call(n,r,o,t))},t),i)}function Ei(n,i,r){ni(t)||(t=e.acquire(f));var o=xi(n,i,r);return t.all(o)}function wi(n,i,r,o){ni(t)||(t=e.acquire(f));var s=t.resolve([]);if(!mi(i))return s;n=n.bind(r);var a=function(e,t,i,r){return e.then(function(e){return n(t,i,r).then(function(t){return e.concat(t)})})};return!0===o?i.reduceRight(a,s):i.reduce(a,s)}function Ti(e,t,n){return wi(e,t,n)}function Ni(e,t,n){if(di(t)||fi(t))return!1;var i,r,o;if(fi(t.some))return t.some(e,n);if(gi(t)){for(o=t.length,i=0;i<o;i+=1)if(!0===e.call(n,t[i],i,t))return!0}else{var s=Object.keys(t);for(o=s.length;s.length>0;)if(r=s.shift(),!0===e.call(n,t[r],r,t))return!0}return!1}function ki(e,t,n){return Si(e,0,t,n)}function Si(e,t,n,i){var r=setTimeout(function(){e.apply(i,n)},t);return function(){clearTimeout(r)}}function Ii(e,t,n,i){var r=setInterval(function(){e.apply(i,n)},t);return function(){clearInterval(r)}}function Ri(t,i){ni(n)||(n=e.acquire(d));var r=n.requestAnimationFrame;if(vi(r))return ki(function(){t.call(i,Date.now())});var o=r(t.bind(i)),s=n.cancelAnimationFrame;return fi(s)||(s=Kn),function(){s(o)}}function ji(e){di(e)&&(e="");var t=zn[e];di(t)&&(t=zn[e]=["0","/"]);for(var n,i=t.length;i>0;){if(57===(n=t[i-=1].charCodeAt(0)))return t[i]="A",r();if(90===n)return t[i]="a",r();if(122!==n)return t[i]=String.fromCharCode(n+1),r();t[i]="0"}function r(){return e+t.join("")}return t.unshift("0"),r()}function Ai(t){return!li(t)||hi(t)?t:(t=t.charAt(0).toLowerCase()+t.slice(1),ui(i)||(i=e.acquire(T).camelCaseRegex),t.replace(i,function(e,t,n,i){return _i(i)&&i>0?n.toUpperCase():n}))}function Li(e,t){return di(e)||delete e[t],e}function Pi(e,t){return di(e)?e:e[t]}function Oi(e){if(!hi(e)){for(var t,n=(e=e.replace(/^\?+/,"")).split("&"),i={},r=n.length,o=0;o<r;o+=1)i[(t=n[o].split("="))[0]]=t[1];return i}}function Fi(e){var t="";return hi(t+=xi(function(e,t){return t+"="+e},e).join("&"))||(t="?"+t),t}function Mi(e){return mi(e)?e.reduce(function(e,t){return e&&!1!==t},!0):!pi(e)||e}var Di=/<([\w:]+)/,$i=/\s+/g,zi=[1,'<select multiple="multiple">',"</select>"],Bi=[1,"<table>","</table>"],Ui=[3,"<table><tbody><tr>","</tr></tbody></table>"],Vi=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],qi=ei(!1,!1,{},{thead:Bi,tbody:Bi,tfoot:Bi,colgroup:Bi,caption:Bi,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:Ui,th:Ui},{option:zi,optgroup:zi,legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],text:Vi,circle:Vi,ellipse:Vi,line:Vi,path:Vi,polygon:Vi,polyline:Vi,rect:Vi,_default:[0,"",""]});function Hi(t,n,i){ni(o)||(o=e.acquire(m));var r=si(n),s=!oi(n),a=r?n:o.createDocumentFragment();s&&(n=a);var l,u=mi(t)?t:Array.prototype.slice.call(t),c=u.length;if(!0===i){var h=void 0;for(l=0;l<c;l+=1)h=u[l].cloneNode(!0),a.insertBefore(h,null)}else for(l=0;l<c;l+=1)a.insertBefore(u[l],null);return r||s||n.appendChild(a),n}function Qi(e){for(var t=Array.prototype.slice.call(e.childNodes);t.length>0;)e.removeChild(t.pop())}function Yi(e,t){if(fi(e.push)||(e=Array.prototype.slice.call(e)),di(t))for(var n;e.length>0;)di(t=(n=e.pop()).parentNode)||t.removeChild(n);else!function(e,t){for(;e.length>0;)t.removeChild(e.pop())}(e,t)}function Wi(t,i){if(Qi(t),!hi(i)){var r=function(t){ni(n)||(n=e.acquire(d)),ni(o)||(o=e.acquire(m));var i=Di.exec(t),r=o.createElement("div");if(di(i))return(r=tr(r,t)).removeChild(r.lastChild);t=t.trim();var s=i[1],a=qi[s];if(n.pushState&&vi(a))return tr(r,t);if("body"===s)return(r=tr(o.createElement("html"),t)).removeChild(r.lastChild);mi(a)||(a=qi._default);var l=a[0];for(r=tr(r,""+a[1]+t+a[2]);l>0;)l-=1,r=r.lastChild;return r}(i);return r.childNodes.length>0?Hi(r.childNodes,t):t.insertBefore(r,null),t}}function Xi(t,n,i){if(!di(t)&&ni(n)){var r;if(vi(i)&&(i=null),oi(n))return r=n,n=Array.prototype.slice.call(r.childNodes),t.insertBefore(r,i),n;fi(n.push)||(n=Array.prototype.slice.call(n)),ni(o)||(o=e.acquire(m));var s=n.length;r=o.createDocumentFragment();for(var a=0;a<s;a+=1)r.insertBefore(n[a],null);return t.insertBefore(r,i),n}}function Gi(e){var t=e.parentNode,n=Xi(t,e.childNodes,e);return t.removeChild(e),n}function Ji(e,t){if(di(t))return t;if(e.nodeType===Node.ELEMENT_NODE)for(var n=e.attributes,i=n.length,r=void 0,o=0;o<i;o+=1)r=n[o],t.setAttribute(r.name,r.value);var s=e.parentNode;return Xi(t,e.childNodes),s.replaceChild(t,e),t}function Ki(t){ni(o)||(o=e.acquire(m));var n=o.createDocumentFragment();return hi(t)||Wi(n,t),n}function Zi(e,t){if(!di(e)){var n,i=e.nextSibling,r=e.parentNode;if(di(t)&&(t=null),!di(r)&&(di(t)||t.parentNode===r))for(;i!==t;)n=i.nextSibling,r.removeChild(i),i=n}}function er(e,t){di(e)||(Zi(e,t),nr(e),nr(t))}function tr(t,i){return ni(n)||(n=e.acquire(d)),n.msApp?MSApp.execUnsafeLocalFunction(function(){t.innerHTML=i}):t.innerHTML=i,t}function nr(e){if(oi(e)){var t=e.parentNode;di(t)||t.removeChild(e)}}function ir(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){if(hi(n))return void(e.className=t);for(;r.length>0;)""!==(i=r.shift())&&(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g").test(n)||(e.className+=" "+i))}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.add(i)}}function rr(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){if(n===t)return void(e.className="");for(;r.length>0;)""!==(i=r.shift())&&(e.className=n=n.replace(new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g"),""))}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.remove(i)}}function or(e,t){ni(e)||(e={});var n=e.className;if(!li(n)||!li(t)||""===t)return!1;var i,r=t.split($i);if(vi(e.classList)){if(""===n)return!1;if(n===t)return!0;for(;r.length>0;)if(""!==(i=r.shift())&&!new RegExp("^"+i+"\\s|\\s"+i+"$|\\s"+i+"\\s","g").test(n))return!1;return!0}for(;r.length>0;)if(""!==(i=r.shift())&&!e.classList.contains(i))return!1;return!0}var sr,ar,lr,ur,cr,hr,pr,_r={},fr={},dr={},vr={},mr={},gr={},yr={},br={};function Cr(e){for(var t,n=mi(e),i=(t=n?ar.Injector.getDependencies(e):ar.Injector.getDependencies([e])).length,r=[],o=0;o<i;o+=1)r.push(t[o].inject());return n?r:r[0]}!function(e){function t(t,n,i,r,o,s){var a=t[n]=new ar.Injector(n,i,r,o);return!0===s&&(gr[n]=a),e}e.app=function(t,n,i){var r=Cr(oe);return Cr(c).registerApp(new r(t,n,i)),e},e.control=function(e,n,i,r){if(!li(e))throw new Error("A Control must be registered with a string name");return"head"===(e=e.toLowerCase())&&(r=!0),t(_r,e,n,i,r?gn:void 0)},e.viewControl=function(e,n,i){if(!li(e))throw new Error("A ViewControl must be registered with a string name");return e=e.toLowerCase(),t(fr,e,n,i)},e.injectable=function(e,n,i,r){if(li(r)){if((r=r.toLowerCase())===Cn||r===gn||r===xn)return t(vr,e,n,i,r,!0);if(r!==yn&&r!==bn)throw new Error("Invalid injectable type "+r+" during injectable registration.")}else r=yn;return t(vr,e,n,i,r,!1)},e.injectable.STATIC=gn,e.injectable.SINGLETON=yn,e.injectable.INSTANCE=bn,e.injectable.FACTORY=Cn,e.injectable.CLASS=xn,e.animation=function(n,i,r,o){if(li(o)&&"css"!==(o=o.toLowerCase())&&"js"!==o)throw new Error('Invalid animationType "'+o+'" during animation registration.');return t("js"===o?br:yr,n,i,r,e.injectable.INSTANCE)},e.animation.CSS="css",e.animation.JS="js"}(sr=e.register||(e.register={})),lr=ar=e.dependency||(e.dependency={}),cr=function(){function e(t,n,i,r){void 0===r&&(r=null),this.type=null,this.name=t,this.Constructor=n,this.type=r;var o,s=this.dependencies=e.convertDependencies(i),a=s.indexOf(Sn);if(Object.defineProperty(n,"__injectorName",{value:t,enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(n,"__injectorDependencies",{value:s.slice(0),enumerable:!1,configurable:!0,writable:!0}),a>-1){var l=i[a];if(di(l))throw new TypeError("The dependency for "+t+" at index "+a+" is undefined, did you forget to include a file?");throw new TypeError("Could not resolve dependency "+l.slice(9,l.indexOf("("))+" for "+t+". Are you using a static injectable Type?")}if(li(o=e.__findCircularReferences(this)))throw new Error("Circular dependency detected from "+this.name+" to "+o+".");if(t===c){var u=this.inject();this.dependencies=s,u.start()}}return e.initialize=function(){for(var e=gr,t=Object.keys(e),n=t.length,i=0;i<n;i+=1)e[t[i]].inject();gr={}},e.getDependencies=function(t){if(di(t)||hi(t))return[];for(var n=[],i=t.length,r=0;r<i;r+=1)n.push(e.getDependency(t[r]));return n},e.getDependency=function(t){return di(t)||t===Sn?e.__noop():e.isInjector(t)?t:e.__locateInjector(t)},e.convertDependencies=function(t){if(!mi(t))return[];for(var n=e.convertDependency,i=[],r=t.length,o=0;o<r;o+=1)i.push(n(t[o]));return i},e.convertDependency=function(t){return di(t)?Sn:e.__getInjectorName(t)},e.isInjector=function(e){return fi(e.inject)&&!vi(e.type)&&!vi(e.name)&&!vi(e.Constructor)},e.__getInjectorName=function(t){if(di(t))return Sn;if(li(t))return t;var n=t,i=ni(n._inject)?n._inject:{};if(li(n.__injectorName)&&(t=n.__injectorName),!li(t))return new e(t,n,i.dependencies);var r=e.__findInjector(t,[vr,mr,gr,fr,_r,yr,br]);return!ni(r)&&li(t)&&(r=mr[t]=new e(t,n,n._inject.dependencies)),ni(r)?r.name:Sn},e.__construct=function(t,n,i){if(di(t)||di(t.prototype))return t;var r,o=Object.create(t.prototype),s=i===bn;s&&(r=dr[t.__injectorName]),ni(r)||(r=e.__walk(o,Object.getPrototypeOf(o),{}),s&&(dr[t.__injectorName]=r));for(var a=Cr(xi(function(e){return e},r)),l=Object.keys(r),u=l.length,c=0;c<u;c+=1)o[l[c]]=a[c];var h=o.constructor.apply(o,n);return vi(h)?o:h},e.__walk=function(t,n,i){var r=n.constructor,o={};return ni(r._inject)&&r!==Object&&(o=e.__walk(t,Object.getPrototypeOf(n),i)),ei(!1,!1,{},i,o,ti(r._inject,!0))},e.__locateInjector=function(t){if(!di(t)){var n=t;li(t.__injectorName)&&(n=t.__injectorName);var i=e.__findInjector(n,[vr,mr,gr,fr,_r,yr,br]);return ni(i)||(fi(t)?(li(n)||(n=ji(le)),i=new e(n,t,ni(t._inject)?t._injectorDependencies:[]),mr[n]=i):i=e.__wrap(t)),i}},e.__findInjector=function(t,n){if(!di(t)){if(t===e||t===oe){var i=e.__wrap(e);return i.name=oe,i}if(li(t))for(var r=0,o=n;r<o.length;r++){var s=o[r];if(!di(s[t]))return s[t];if(!di(s[t.toLowerCase()]))return s[t.toLowerCase()]}}},e.__wrap=function(e){return{inject:function(){return e},name:"wrapped",dependencies:[],Constructor:e}},e.__noop=function(){return{inject:Kn,type:Sn,name:Sn,dependencies:[],Constructor:Kn}},e.__findCircularReferences=function(t){if(ni(t)&&mi(t.dependencies))for(var n,i,r,o=t.name,s=t.dependencies,a=[{name:o,dependencies:s.slice(0)}],l=e.__locateInjector;a.length>0;){r=(s=(n=a.pop()).dependencies).length;for(var u=0;u<r;u+=1){if((i=s[u])===o)return n.name;ni(t=l(i))&&mi(t.dependencies)&&a.push({name:t.name,dependencies:t.dependencies.slice(0)})}}},e.prototype.inject=function(){for(var t,n,i=[],r=this.type,o=this.dependencies,s=o.length,a=0;a<s;a+=1)t=e.getDependency(o[a]),i.push(t.inject());return n=e.__construct(this.Constructor,i,r),li(r)&&r!==bn&&this._wrapInjector(n),n.__injectable__type=r,n},e.prototype._wrapInjector=function(e){return this.inject=function(){return e},this},e}(),lr.Injector=cr,(ur=lr.injectors||(lr.injectors={})).control=_r,ur.viewControl=fr,ur.injectable=vr,ur.staticInjectable=gr,ur.animation=yr,ur.jsAnimation=br,vi(window)||(vi(window.plat)&&(window.plat=e),vi(window.module)&&(window.module={})),e.acquire=Cr,hr=e.debug||(e.debug={}),pr=function(){function e(){this.ERROR=5,this.WARN=4,this.INFO=3,this.DEBUG=2,this.TRACE=1,this._level=this.INFO}return e.prototype.error=function(e){throw this._log(e,this.ERROR),e},e.prototype.warn=function(e){this._log(e,this.WARN)},e.prototype.info=function(e){this._log(e,this.INFO)},e.prototype.debug=function(e){this._log(e,this.DEBUG)},e.prototype.trace=function(e){this._log(e,this.TRACE)},e.prototype.setLogLevel=function(e){switch(li(e)&&(e=this[e.toUpperCase()]),e){case this.ERROR:case this.WARN:case this.INFO:case this.DEBUG:case this.TRACE:this._level=e;break;default:this._level=this.INFO}},e.prototype._log=function(t,n){if(this._shouldLog(n)){li(t)&&(t=new Error(t));var i=this._ErrorEvent;di(i)&&(i=this._ErrorEvent=Cr(y)),i.dispatch("error",e,t,n)}},e.prototype._shouldLog=function(e){return _i(e)||(e=this.INFO),this._level<e},e}(),hr.Log=pr,sr.injectable(E,pr);var xr=function(){function e(){this.__events={},this.__defineBooleans(),this.__defineMappedEvents(),this.__defineVendorDependencies(),this.__determineCss()}return e.prototype.hasEvent=function(e){var t=this.__events,n=t[e];if(vi(n)){var i=this._document.createElement("div");n="input"===e&&9===this.IE?t[e]=!1:t[e]=!vi(i["on"+e])}return n},e.prototype.__defineBooleans=function(){var e=this._window,t=this._history,n=e.define,i=e.MSApp,r=e.WinJS,o=e.navigator;ni(o)||(o={});var s=o.userAgent;li(s)||(s=""),s=s.toLowerCase();var a=/android ((?:\d|\.)+)/.exec(s);gi(a)||(a=[]);var l=a[1];if(li(l)&&!/iemobile/i.test(s)&&(l=parseInt(l.replace(/\./g,""),10)),this.isCompatible=fi(Object.defineProperty)&&fi(this._document.querySelector),this.cordova=!di(e.cordova),this.pushState=!(di(t)||di(t.pushState)),this.fileSupported=!(vi(e.File)||vi(e.FormData)),this.amd=fi(n)&&!di(n.amd),this.msApp=ni(i)&&fi(i.execUnsafeLocalFunction),this.winJs=ni(r)&&ni(r.Application),this.indexedDb=!di(e.indexedDB),this.proto=ni({}.__proto__),this.getProto=fi(Object.getPrototypeOf),this.setProto=fi(Object.setPrototypeOf),this.hasTouchEvents=!vi(e.ontouchstart),this.hasPointerEvents=!!o.pointerEnabled,this.hasMsPointerEvents=!!o.msPointerEnabled,_i(l))this.ANDROID=l;else{var u=/msie (\d+)/.exec(s),c=/trident\/.*; rv:(\d+)/.exec(s);gi(u)||(u=[]),gi(c)||(c=[]);var h=parseInt(u[1],10);_i(h)||(h=parseInt(c[1],10)),_i(h)&&(this.IE=h)}},e.prototype.__defineMappedEvents=function(){this.hasPointerEvents?this.mappedEvents={$touchstart:"pointerdown",$touchend:"pointerup",$touchmove:"pointermove",$touchcancel:"pointercancel"}:this.hasMsPointerEvents?this.mappedEvents={$touchstart:"MSPointerDown",$touchend:"MSPointerUp",$touchmove:"MSPointerMove",$touchcancel:"MSPointerCancel"}:this.hasTouchEvents?this.mappedEvents={$touchstart:"touchstart",$touchend:"touchend",$touchmove:"touchmove",$touchcancel:"touchcancel"}:this.mappedEvents={$touchstart:"mousedown",$touchend:"mouseup",$touchmove:"mousemove",$touchcancel:null}},e.prototype.__defineVendorDependencies=function(){var e,t,n,i,r=this._window,o=this._document.documentElement,s=r.getComputedStyle(o,""),a=Array.prototype.slice.call(s).join("").match(/-(moz|webkit|ms)-/);mi(a)&&a.length>1?(i=(e=mi(a)&&a.length>1?a[1]:"")[0].toUpperCase()+e.slice(1),t="WebKit|Moz|MS".match(new RegExp("("+e+")","i"))[1],n="-"+e+"-"):vi(s.OLink)?e=i=t=n="":(e="o",i=t="O",n="-o-"),this.vendorPrefix={dom:t,lowerCase:e,css:n,upperCase:i},this.requestAnimationFrame=r.requestAnimationFrame,fi(this.requestAnimationFrame)||(this.requestAnimationFrame=r[e+"RequestAnimationFrame"]),this.cancelAnimationFrame=r.cancelAnimationFrame,fi(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[e+"CancelRequestAnimationFrame"]),fi(this.cancelAnimationFrame)||(this.cancelAnimationFrame=r[e+"CancelAnimationFrame"]);var l=o.style;!(vi(this.ANDROID)||Math.floor(this.ANDROID/10)>=44)||vi(l.animation)||vi(l.transition)?(vi(l[i+"Animation"])||vi(l[i+"Transition"]))&&(vi(l[e+"Animation"])||vi(l[e+"Transition"]))&&(vi(l[t+"Animation"])||vi(l[t+"Transition"]))||(this.animationSupported=!0,this.animationEvents={$animation:e+"Animation",$animationStart:e+"AnimationStart",$animationEnd:e+"AnimationEnd",$animationIteration:e+"AnimationIteration",$transition:e+"Transition",$transitionStart:e+"TransitionStart",$transitionEnd:e+"TransitionEnd"}):(this.animationSupported=!0,this.animationEvents={$animation:"animation",$animationStart:"animationstart",$animationEnd:"animationend",$animationIteration:"animationiteration",$transition:"transition",$transitionStart:"transitionstart",$transitionEnd:"transitionend"})},e.prototype.__determineCss=function(){var e=this._document,t=e.head,n=e.createElement("div");n.setAttribute(Pt,""),t.insertBefore(n,null);var i=this._window.getComputedStyle(n),r=i.display,o=i.visibility;this.platCss="none"===r||"hidden"===o,t.removeChild(n)},e._inject={_window:G,_history:se,_document:m},e}();e.Compat=xr,sr.injectable(d,xr);var Er,wr=function(){function t(){}return t.prototype.noop=function(){},t.prototype.extend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ei.apply(null,[!1,!1,e].concat(t))},t.prototype.deepExtend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return ei.apply(null,[!0,!1,e].concat(t))},t.prototype.clone=function(e,t){return ti(e,t)},t.prototype.isObject=function(e){return ni(e)},t.prototype.isWindow=function(e){return ii(e)},t.prototype.isDocument=function(e){return ri(e)},t.prototype.isNode=function(e){return oi(e)},t.prototype.isDocumentFragment=function(e){return si(e)},t.prototype.isString=function(e){return li(e)},t.prototype.isRegExp=function(e){return ui(e)},t.prototype.isPromise=function(e){return ci(e)},t.prototype.isEmpty=function(e){return hi(e)},t.prototype.isBoolean=function(e){return pi(e)},t.prototype.isNumber=function(e){return _i(e)},t.prototype.isFile=function(e){return ai(e)},t.prototype.isFunction=function(e){return fi(e)},t.prototype.isNull=function(e){return di(e)},t.prototype.isUndefined=function(e){return vi(e)},t.prototype.isArray=function(e){return mi(e)},t.prototype.isArrayLike=function(e){return gi(e)},t.prototype.isDate=function(e){return yi(e)},t.prototype.filter=function(e,t,n){return bi(e,t,n)},t.prototype.where=function(e,t){return n=e,bi(function(e){return!Ni(function(t,n){return e[n]!==t},n)},t);var n},t.prototype.forEach=function(e,t,n){return Ci(e,t,n)},t.prototype.map=function(e,t,n){return xi(e,t,n)},t.prototype.mapAsync=function(e,t,n){return Ei(e,t,n)},t.prototype.mapAsyncInOrder=function(e,t,n){return Ti(e,t,n)},t.prototype.mapAsyncInDescendingOrder=function(e,t,n){return wi(e,t,n,!0)},t.prototype.pluck=function(e,t){return n=e,xi(function(e){return e[n]},t);var n},t.prototype.some=function(e,t,n){return Ni(e,t,n)},t.prototype.postpone=function(e,t,n){return Si(e,0,t,n)},t.prototype.defer=function(e,t,n,i){return Si(e,t,n,i)},t.prototype.setInterval=function(e,t,n,i){return Ii(e,t,n,i)},t.prototype.requestAnimationFrame=function(e,t){return Ri(e,t)},t.prototype.uniqueId=function(e){return ji(e)},t.prototype.camelCase=function(e){return Ai(e)},t.prototype.delimit=function(t,n){return o=n,!li(i=t)||hi(i)?i:(di(o)&&(o=""),ui(r)||(r=e.acquire(T).capitalCaseRegex),i.replace(r,function(e,t){return _i(t)&&t>0?o+e.toLowerCase():e.toLowerCase()}));var i,o},t}();function Tr(){return window}function Nr(e){return e.document}e.Utils=wr,sr.injectable(H,wr),e.Window=Tr,sr.injectable(G,Tr),e.Document=Nr,sr.injectable(m,Nr,[G]),function(e){var t=function(){function e(){this.markupRegex=new RegExp(vn+"[\\S\\s]*"+mn),this.argumentRegex=/\((.*)\)/,this.initialUrlRegex=/\/[^\/]*\.(?:html|htm)/,this.protocolRegex=/:\/\//,this.invalidVariableRegex=/[^a-zA-Z0-9@_$]/,this.fileNameRegex=/.*(?:\/|\\)/,this.shiftedKeyRegex=/[A-Z!@#$%^&*()_+}{":?><|~]/,this.fullUrlRegex=/^(?:[a-z0-9\-]+:)(?:\/\/)?|(?:\/\/)/i,this.validateEmail=new RegExp('^(([^<>()[\\]\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),this.validateTelephone=/^\+?[0-9\.\(\)\s-]*$/,this.dynamicSegmentsRegex=/^:([^\/]+)$/,this.splatSegmentRegex=/^\*([^\/]+)$/}return Object.defineProperty(e.prototype,"newLineRegex",{get:function(){return/\r|\n/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optionalRouteRegex",{get:function(){return/\((.*?)\)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"namedParameterRouteRegex",{get:function(){return/(\(\?)?:\w+/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wildcardRouteRegex",{get:function(){return/\*\w*/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"escapeRouteRegex",{get:function(){return/[\-{}\[\]+?.,\\\^$|#\s]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"camelCaseRegex",{get:function(){return/([\-_\.\s])(\w+?)/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capitalCaseRegex",{get:function(){return/[A-Z]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"whiteSpaceRegex",{get:function(){return/("[^"]*?"|'[^']*?')|[\s\r\n\t\v]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quotationRegex",{get:function(){return/'|"/g},enumerable:!0,configurable:!0}),e}();e.Regex=t,sr.injectable(T,t);var n=function(){function e(){this.__previousChar="",this.__variableRegex=Cr(T).invalidVariableRegex,this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]}return e.prototype.createTokens=function(e){if(di(e))return[];this._input=e;for(var t,n=e.length,i=this._isSpace,r=this._isAlphaNumeric,o=0,s=!1,a=0;a<n;a+=1)if(!i(t=e[a])){if(r(t))a=this.__handleAlphaNumeric(a,t);else if(di(Rr[t]))if(Lr(t))switch(t){case"?":s=!0,o+=1,this.__handleQuestion(t);break;case":":o=this.__handleColon(t,o);break;default:a=this.__handleOtherOperator(a,t)}else";"===t&&this._throwError("Unexpected semicolon");else switch(t){case".":a=this.__handlePeriod(a,t);break;case"{":this.__handleLeftBrace(t);break;case"}":this.__handleRightBrace(t);break;case"[":this.__handleLeftBracket(t);break;case"]":this.__handleRightBracket(t);break;case"(":this.__handleLeftParenthesis(t);break;case")":this.__handleRightParenthesis(t);break;case",":this.__handleComma(t);break;case"'":case'"':a=this.__handleStringLiteral(a,t)}this.__previousChar=t}s&&o>0?this._throwError("Improper ternary expression"):this.__objArgCount.length>0&&this._throwError("Improper object literal"),this.__popRemainingOperators();var l=this.__outputQueue;return this._resetTokenizer(),l},e.prototype._checkType=function(e,t){return t?this._isNumeric(e):this._isAlphaNumeric(e)},e.prototype._lookAhead=function(e,t,n){var i,r=this._input,o=r.length;for(t+=1;t<o&&(i=r[t],this._checkType(i,n));)e+=i,t+=1;return e},e.prototype._lookAheadForOperatorFn=function(e,t){var n=this._input,i=n.length,r=e;for(t+=1;t<i&&Lr(r+=n[t]);)e=r,t+=1;return e},e.prototype._lookAheadForDelimiter=function(e,t){var n,i=this._input,r=i.length,o="";for(n=i[t+=1];t<r&&n!==e;)o+=n,n=i[t+=1];return o},e.prototype._popStackForVal=function(e,t,n){for(var i=this.__outputQueue,r=this.__operatorStack;e.val!==t;)i.push(r.shift()),e=r[0],0===r.length&&this._throwError(n)},e.prototype._isValEqual=function(e,t){return di(e)||di(e.val)?di(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return di(e)||di(e.val)?!di(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetTokenizer=function(){this._input=null,this.__previousChar="",this.__outputQueue=[],this.__operatorStack=[],this.__argCount=[],this.__objArgCount=[],this.__lastColonChar=[],this.__lastCommaChar=[]},e.prototype._throwError=function(e){this._log.error(new Error(e+" in "+this._input))},e.prototype._isNumeric=function(e){return e>="0"&&e<="9"},e.prototype._isSpace=function(e){return" "===e||"\r"===e||"\n"===e||"\t"===e||"\v"===e||" "===e},e.prototype._isAlphaNumeric=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"@"===e||"_"===e||"$"===e},e.prototype._isStringValidVariable=function(e){return!this.__variableRegex.test(e)},e.prototype.__handleAlphaNumeric=function(e,t){var n=this._isNumeric(t),i=this._lookAhead(t,e,n);return this.__outputQueue.push(n?{val:Number(i),args:0}:{val:i,args:-1}),e+i.length-1},e.prototype.__handlePeriod=function(e,t){var n,i=this.__outputQueue,r=this.__operatorStack,o=i.length-1,s=this.__previousChar;return o<0||this._isSpace(s)||!di(Sr[s])||"("===s||","===s?(e+=(n=this._lookAhead(t,e,!0)).length-1,i.push({val:parseFloat(n),args:0})):this._isValEqual(r[0],t)?i.push({val:t,args:0}):di(i[o])||!_i(Number(i[o].val))||this._isValEqual(i[o-1],t)?r.unshift({val:t,args:0}):(e+=(n=this._lookAhead(t,e,!0)).length-1,i[o].val+=parseFloat(n)),e},e.prototype.__handleLeftBrace=function(e){this.__operatorStack.unshift({val:e,args:0}),this.__objArgCount.push(0),this.__lastColonChar.push(e),this.__lastCommaChar.push(e)},e.prototype.__handleRightBrace=function(e){var t=this.__operatorStack,n=t[0],i=this.__objArgCount.pop();di(n)&&this._throwError("Improper object literal"),this._popStackForVal(n,"{","Improper object literal"),t.shift(),this.__lastColonChar.pop(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"{}",args:i})},e.prototype.__handleLeftBracket=function(e){var t=this.__previousChar,n=this.__operatorStack;this._isValEqual(n[0],".")&&this.__outputQueue.push(n.shift()),n.unshift({val:e,args:0}),this.__argCount.push({num:0,isArray:!("]"===t||")"===t||this._isAlphaNumeric(t))}),this.__lastCommaChar.push(e)},e.prototype.__handleRightBracket=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();(di(n)||di(i))&&this._throwError("Brackets mismatch"),i.isArray||(i.num-=1),this._popStackForVal(n,"[","Brackets mismatch"),t.shift(),this.__lastCommaChar.pop(),this.__outputQueue.push({val:"[]",args:"["===this.__previousChar?-1:i.num+1})},e.prototype.__handleLeftParenthesis=function(e){var t,n=this.__previousChar,i=this.__operatorStack;if(this._isAlphaNumeric(n)||"]"===n||")"===n){var r=this.__outputQueue,o=r[r.length-1],s=di(o)?void 0:o.val;"[]"===s?(i.unshift(r.pop()),i.unshift(r.pop())):"()"===s||this._isNumeric(s)||i.unshift(r.pop()),t=0}else t=-1;this.__argCount.push({num:t}),i.unshift({val:e,args:t}),this.__lastCommaChar.push(e)},e.prototype.__handleRightParenthesis=function(e){var t=this.__operatorStack,n=t[0],i=this.__argCount.pop();if(di(n)&&this._throwError("Parentheses mismatch"),this._popStackForVal(n,"(","Parentheses mismatch"),t.shift(),this.__lastCommaChar.pop(),!di(i)&&i.num>=0){var r=i.num;"("===this.__previousChar?this.__removeFnFromStack(r)&&this.__outputQueue.push({val:"()",args:0}):this.__removeFnFromStack(r+1)&&this.__outputQueue.push({val:"()",args:r+1})}},e.prototype.__handleComma=function(e){var t=this.__lastCommaChar,n=t[t.length-1];if("("===n||"["===n){var i=this.__argCount,r=i.length;r>0?i[r-1].num+=1:this._throwError("Mismatch with "+n)}var o=this.__operatorStack[0];di(o)&&this._throwError("Unexpected comma"),this._popStackForVal(o,n,"Unexpected comma")},e.prototype.__handleStringLiteral=function(e,t){var n=this._lookAheadForDelimiter(t,e),i=this.__operatorStack,r=i[0];return!di(r)&&("["===r.val||"("===r.val&&r.args>=0)?i.unshift({val:n,args:0}):this.__outputQueue.push({val:n,args:0}),e+n.length+1},e.prototype.__handleQuestion=function(e){this.__lastColonChar.push(e),this.__determinePrecedence(e)},e.prototype.__handleColon=function(e,t){var n=this.__lastColonChar,i=n[n.length-1],r=this.__outputQueue;if("?"===i){var o=this.__operatorStack,s=o[0];di(s)&&this._throwError("Ternary mismatch"),t-=1,n.pop(),this._popStackForVal(s,"?","Ternary mismatch"),r.push(o.shift()),o.unshift({val:e,args:-2})}else if("{"===i){var a=this.__objArgCount,l=r.length-1;a[a.length-1]+=1,l<0&&this._throwError("Unexpected colon"),r[l].args=1}else this._throwError("Unexpected colon");return t},e.prototype.__handleOtherOperator=function(e,t){var n=this._lookAheadForOperatorFn(t,e);return this.__determinePrecedence(n),e+n.length-1},e.prototype.__popRemainingOperators=function(){for(var e,t,n=this.__outputQueue,i=this.__operatorStack;i.length>0;)"("!==(t=(e=i.shift()).val)&&")"!==t||this._throwError("Parentheses mismatch"),n.push(e)},e.prototype.__determineOperator=function(e){switch(e){case"+":case"-":if(0===this.__outputQueue.length||Lr(this.__previousChar))return Sr["u"+e];default:return Sr[e]}},e.prototype.__determinePrecedence=function(e){var t,n,i=this.__determineOperator(e),r=i.precedence,o="ltr"===i.associativity,s=this.__operatorStack,a=this.__outputQueue;if(0!==s.length){do{if("."!==(n=s[0].val)){if(di(t=Sr[n])||!(t.precedence<r||o&&t.precedence===r))return void s.unshift({val:e,args:i.fn.length-2});a.push(s.shift())}else a.push(s.shift())}while(s.length>0);s.unshift({val:e,args:i.fn.length-2})}else s.unshift({val:e,args:i.fn.length-2})},e.prototype.__removeFnFromStack=function(e){for(var t,n=this.__outputQueue,i=this.__operatorStack,r=i[0],o=this._isValEqual,s=this._isValUnequal,a=!1;!di(r)&&s(r,"([")&&(this._isStringValidVariable(r.val)||o(r.val,".[]")||Ar(r.val));)-1!==(t=i.shift()).args||o(t,".[]")||(t.args=-2),n.push(t),r=i[0],a=!0;return a||s(n[n.length-e-1],"()")||(a=!0),a},e._inject={_log:E},e}();e.Tokenizer=n,sr.injectable(N,n);var i=function(){function e(){this._tokens=[],this.__cache={},this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={},this.__fnEvalConstant="var initialContext;return "}return e.prototype.parse=function(e){var t=this.__cache[e];if(!di(t))return{expression:t.expression,identifiers:t.identifiers.slice(0),aliases:t.aliases.slice(0),evaluate:t.evaluate};if(this._tokens=this._tokenizer.createTokens(e),0===(t=this._evaluate(e)).identifiers.length){var n=t.evaluate(null);t.evaluate=function(){return n}}return this.__cache[e]=t,t},e.prototype.clearCache=function(e){li(e)?Li(this.__cache,e):this.__cache={}},e.prototype._evaluate=function(e){for(var t,n,i,r=this._tokens,o=r.length,s=this.__tempIdentifiers,a=this.__codeArray,l=!1,c=0;c<o;c+=1)if(n=(t=r[c]).val,i=t.args,Ar(n))switch(n){case"()":l=this.__handleFunction(c,i,l);break;case"{}":a.push(this.__convertObject(i)),s.push(".");break;default:i<0?(a.push("[]"),s.push(".")):i>0?(a.push(this.__convertArrayLiteral(i)),s.push(".")):l=this.__indexIntoObject(c,n,l)}else if(Lr(n))if(0===i)a.push(this.__convertPrimitive(c,n,i));else switch(n){case"?":this.__handleQuestion();break;case":":this.__handleColon();break;case"+":case"-":1===i&&(n="u"+n);default:this.__handleOperator(n,i)}else i<0?a.push(this.__convertFunction(c,n,l)):a.push(this.__convertPrimitive(c,n,i));this._popRemainingIdentifiers(),this._makeIdentifiersUnique();var h={evaluate:new Function(u,"aliases",""+this.__fnEvalConstant+(0===a.length?'"'+e+'"':a.join(""))+";"),expression:e,identifiers:this.__identifiers.slice(0),aliases:Object.keys(this.__aliases)};return this._resetParser(),h},e.prototype._peek=function(e){return this._tokens[e+1]},e.prototype._lookBack=function(e){return this._tokens[e-1]},e.prototype._popRemainingIdentifiers=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers;n.length>0;)"."!==(e=n.pop())&&t.push(e)},e.prototype._makeIdentifiersUnique=function(){for(var e,t=this.__identifiers,n=[],i={};t.length>0;)i[e=t.pop()]||(i[e]=!0,n.push(e));this.__identifiers=n},e.prototype._isValEqual=function(e,t){return di(e)||di(e.val)?di(t):""===e.val?""===t:-1!==t.indexOf(e.val)},e.prototype._isValUnequal=function(e,t){return di(e)||di(e.val)?!di(t):""===e.val?""!==t:-1===t.indexOf(e.val)},e.prototype._resetParser=function(){this._tokens=[],this.__codeArray=[],this.__identifiers=[],this.__tempIdentifiers=[],this.__aliases={}},e.prototype._throwError=function(e){this._log.error(new Error(e))},e.prototype.__convertPrimitive=function(e,t,n){if(n>0)return this.__tempIdentifiers.push("."),t;var i=_i(Number(t)),r=this._peek(e),o=!(di(r)||r.args>=1),s=this._isValEqual;return Pr(t)||li(t)&&(i||this._isValUnequal(r,"[]()")||s(r,"[]")&&!o)?(this.__tempIdentifiers.push("."),'"'+t+'"'):(!i||s(r,".[]")&&o?this.__tempIdentifiers.push(t):this.__tempIdentifiers.push("."),t)},e.prototype.__convertFunction=function(e,t,n){if("@"===t[0])this.__aliases[t.slice(1)]=!0;else if(Pr(t))return this.__tempIdentifiers.push("."),t;var i=this._peek(e),r=this._isValEqual;if(r(this._tokens[e-1],"()")&&r(i,".[]")?this.__tempIdentifiers.push("."):this.__tempIdentifiers.push(t),di(i))return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))';switch(i.val){case".":case"()":return t;default:if(!n)return"(initialContext = ("+this.__findInitialContext.toString()+')(context,aliases,"'+t+'"))'}},e.prototype.__convertObject=function(e){for(var t,n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="{";s<e;)s+=1,n=o.pop(),a+=',"'+o.pop()+'":'+n,r.length>1&&(t=r.pop(),r.pop(),"."!==t&&i.push(t));return a.replace(",","")+"}"},e.prototype.__convertArrayLiteral=function(e){for(var t,n=this.__identifiers,i=this.__tempIdentifiers,r=this.__codeArray,o=0,s="";o<e;)o+=1,s=r.pop()+","+s,i.length>0&&"."!==(t=i.pop())&&n.push(t);return"["+s.slice(0,-1)+"]"},e.prototype.__handleFunction=function(e,t,n){var i,r,o=this.__identifiers,s=this.__tempIdentifiers,a=this.__codeArray,l=this._lookBack(e),u=!di(l)&&(-2===l.args||this._isValEqual(l,".[]")),c=0,h="",p="",_="",f=!1;for(u&&(p=a.pop(),_=s.pop());c<t;)c+=1,h=a.pop()+","+h,s.length>0&&"."!==(i=s.pop())&&(o.push(i),f=!0);if(r=t>0?".call(initialContext || context,"+h.slice(0,h.length-1)+")":".call(initialContext || context)",n)if(n=!1,a.length>0){var d=a.pop(),v=s.length-1;v<0||"."===s[v]||""===_?""!==_&&f&&"["!==d[0]&&"]"!==d[d.length-1]&&(o[o.length-1]+="."+_):(s[v]+="."+_,o.push(s.pop())),r=hi(p)?d+r:"(("+this.__indexIntoContext.toString()+")("+d+',"'+p+'") || (function () {}))'+r}else this._throwError("Improper expression or context");else u?(r="(initialContext = (("+this.__findInitialContext.toString()+')(context,aliases,"'+p+'") || (function () {}))'+r+")",o.push(p)):r=a.pop()+r;a.push(r);var m=s.length;return this._isValEqual(this._peek(e),"[]")&&m>0&&"."!==s[m-1]&&o.push(s.pop()),n},e.prototype.__indexIntoObject=function(e,t,n){var i=this._isValEqual;if(i(this._peek(e),"()"))return!0;var r,o=this.__codeArray,s=this.__identifiers,a=this.__tempIdentifiers,l=this._lookBack(e),u=a.pop(),c=!di(u),h=o.pop();return c&&"@"===u[0]?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",s.push(u),a.length>0&&s.push(a.pop())):i(l,"++--()[]*/%?:>=<=&&||!===")?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",a.push(".")):"[]"!==t||di(l)||l.args>=0?(h="("+this.__indexIntoContext.toString()+")("+o.pop()+',"'+h+'")',(r=a.length-1)>=0?"."!==a[r]&&(a[r]+="."+u):c&&"."!==u&&"."!==t&&s.push(u)):(h="("+this.__indexIntoContext.toString()+")("+o.pop()+","+h+")",(r=a.length-1)>=0&&"."!==a[r]&&s.push(a.pop()),s.push(u)),o.push(h),n},e.prototype.__handleQuestion=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o+=1)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+"?"+r)},e.prototype.__handleColon=function(){for(var e,t=this.__identifiers,n=this.__tempIdentifiers,i=this.__codeArray,r=i.pop(),o=0;o<2&&n.length>0;o+=1)"."!==(e=n.pop())&&t.push(e);i.push(i.pop()+":"+r)},e.prototype.__handleOperator=function(e,t){for(var n,i=this.__identifiers,r=this.__tempIdentifiers,o=this.__codeArray,s=0,a="";s<t;)s+=1,a="function (context, aliases) { return "+o.pop()+"; },"+a,r.length>0&&"."!==(n=r.pop())&&i.push(n);r.push("."),o.push("("+Sr[e].fn.toString()+")(context, aliases,"+a.slice(0,a.length-1)+")")},e.prototype.__findInitialContext=function(e,t,n){return"@"===n[0]&&null!==t&&"object"==typeof t?t[n.slice(1)]:null!==e&&"object"==typeof e?e[n]:void 0},e.prototype.__indexIntoContext=function(e,t){if(null!==e&&"object"==typeof e)return e[t]},e._inject={_tokenizer:N,_log:E},e}();e.Parser=i,sr.injectable(w,i)}(e.expressions||(e.expressions={})),function(e){function t(e){return e.location}e.Location=t,sr.injectable(ae,t,[G]);var n=function(){function e(){this.uid=ji(le),this.__lastUrl=this._location.href,this.__protocol=this.urlUtils().protocol,this.__initializing=!1,this._EventManager.on(this.uid,kt,this.initialize,this),this._compat.msApp&&(this._stack=[])}return e.prototype.initialize=function(){var e=this._compat;this._EventManager.dispose(this.uid),this.__initializing=!0,Cr(X);var t=this.url(),n=t,i=this._urlChanged.bind(this),r=this._dom,o=this._window;n!==t&&this.url(n,!0),e.pushState&&r.addEventListener(o,"popstate",i,!1),r.addEventListener(o,"hashchange",i,!1),this.__initializing=!1},e.prototype.url=function(e,t){var n=this._location;return li(e)&&!this._isLastUrl(e)&&(!t&&mi(this._stack)&&this._stack.push(n.href),this._setUrl(e,t)),hi(this.__currentUrl)?n.href:this.__currentUrl},e.prototype.back=function(e){_i(e)||(e=1);var t=this._stack;if(mi(t)&&t.length>1)return this._stack=t=t.slice(0,t.length-(e-1)),this.url(t.pop()),void t.pop();this._history.go(-e)},e.prototype.forward=function(e){_i(e)||(e=1),this._history.go(e)},e.prototype.urlUtils=function(t){li(t)||(t=this.url());var n=Cr(X),i=e.config,r=i.hashPrefix;return li(r)||(r=""),i.routingType===i.HASH&&(t=t.replace(new RegExp("#"+r+"/?"),"")),n.initialize(t),n},e.prototype.isCrossDomain=function(e){if(!li(e))return!1;var t=this.urlUtils(e),n=this.urlUtils();return t.protocol!==n.protocol||t.hostname!==n.hostname||t.port!==n.port},e.prototype.formatUrl=function(t){var n=e.config,i=n.baseUrl;if(!li(t))return"";if(t===i)return t;var r=!this._regex.fullUrlRegex.test(t)||t.indexOf(i)>-1;if("/"===t[0]&&(t=t.slice(1)),r){if(n.routingType===n.HASH){var o=0===t.indexOf(this.__protocol+":"),s=n.hashPrefix;li(s)||(s="");var a="#"+s,l=new RegExp(a+"|#/");"/"!==t[t.length-1]&&-1===t.indexOf("?")&&(t+="/"),l.test(t)||(t=o?""+t+a+"/":a+("/"!==t[0]?"/":"")+t)}-1===t.indexOf(i)&&(t=i+t)}return t},e.prototype._urlChanged=function(){var e=this;if(!this.__initializing){this.__currentUrl=null;var t=this.urlUtils(),n=this._trimSlashes(t.href);if(this.__lastUrl!==n){this.__lastUrl=n;var i=this._EventManager;ki(function(){i.dispatch(Rt,e,i.DIRECT,[t])})}}},e.prototype._setUrl=function(t,n){t=this.formatUrl(t);var i=this.urlUtils(t),r=e.config.baseUrl,o=this._history,s=this._location;if(-1!==i.href.indexOf(r))if(this._regex.fullUrlRegex.test(t)||"/"===t[0]||(t=r+t),this._compat.pushState){if(n){var a=o.state;ni(a)||(a={}),o.replaceState({previousLocation:a.previousLocation},"",t)}else o.pushState({previousLocation:this.urlUtils().pathname},"",t);this.__initializing||this._urlChanged()}else this.__currentUrl=t,n?s.replace(t):s.href=t;else s.href=t},e.prototype._isLastUrl=function(e){var t=this.__lastUrl;return li(e)&&(hi(e)&&(e="/"),e=this._trimSlashes(this.urlUtils(e).href)),e===t},e.prototype._trimSlashes=function(e){return li(e)&&"/"===e[e.length-1]?e.slice(0,-1):e},e._inject={_EventManager:b,_compat:d,_regex:T,_window:G,_location:ae,_history:se,_dom:z},e.config={HASH:"hash",STATE:"state",routingType:"hash",hashPrefix:"!",baseUrl:""},e}();function i(){return n.config}e.Browser=n,sr.injectable(Q,n),e.IBrowserConfig=i,sr.injectable(Y,i);var r=function(){function e(){var t=this._browserConfig,n=t.baseUrl;if(hi(n)||!this._regex.fullUrlRegex.test(n)){var i=this._window.location.href.replace(this._regex.initialUrlRegex,"/");for(li(n)?0===n.indexOf("/")&&(n=n.slice(1)):n="",n=e.__getBaseUrl(i)+n;"/"===n[n.length-1];)n=n.slice(0,-1);t.baseUrl=n+"/"}}return e.__getQuery=function(e){return Oi(e)},e.__getBaseUrl=function(e){var t=Cr(T),n=Cr(ae),i=n.protocol,r=(n.host,n.origin);return"file:"===i||i.indexOf("wmapp")>-1||i.indexOf("ms-appx")>-1?r=n.href:vi(r)&&(r=n.protocol+"//"+n.host),(r=r.replace(t.initialUrlRegex,"")).split("?")[0].split("#")[0]+"/"},e.prototype.initialize=function(t){li(t)||(t=""),oi(e.__urlUtilsElement)||(e.__urlUtilsElement=this._document.createElement("a"));var n,i=e.__urlUtilsElement,r=this._browserConfig;"/"===t[0]&&0!==t.indexOf("//")&&(t=t.slice(1)),this._regex.fullUrlRegex.test(t)||(t=r.baseUrl+t),i.setAttribute("href",t),t=i.href,i.setAttribute("href",t),t=i.href,this.href=t,this.protocol=li(i.protocol)?i.protocol.replace(/:$/,""):"",this.host=i.host,this.search=li(i.search)?i.search.replace(/^\?/,""):"",this.hash=li(i.hash)?i.hash.replace(/^#/,""):"",this.hostname=i.hostname,this.port=i.port,n=(n=hi(r.baseUrl)?"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname:t.replace(r.baseUrl,"/")).replace(this._regex.initialUrlRegex,"/"),this.pathname=n.split("?")[0].split("#")[0],this.query=e.__getQuery(this.search)},e.prototype.toString=function(){return this.href},e._inject={_EventManager:b,_document:m,_window:G,_compat:d,_regex:T,_browserConfig:Y},e}();e.UrlUtils=r,sr.injectable(X,r,null,bn)}(e.web||(e.web={})),function(e){var t,n,i,r,o,s=[],a="undefined"!=typeof window?window:{},l=a.MutationObserver;ni(l)||(l=a.WebKitMutationObserver),"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?t=function(){process.nextTick(g)}:l?(n=Cr(m),i=Cr(G),r=n.createElement("div"),(o=new l(g)).observe(r,{attributes:!0}),i.addEventListener("unload",function(){o.disconnect(),o=null},!1),t=function(){r.setAttribute("drainQueue","drainQueue")}):t=function(){ki(g)};var u,c,v=function(){function e(t){if(!fi(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof e))throw new TypeError('Failed to construct "Promise": Please use the "new" operator, this object constructor cannot be called as a function.');this.__subscribers=[],e.__invokeResolveFunction(t,this)}return e.all=function(t){return mi(t)?new e(function(e,n){var i,r=[],o=t.length;function s(e){return function(t){return a(e,t)}}function a(t,n){r[t]=n,0===(o-=1)&&e(r)}0===o&&e([]);for(var l=0;l<t.length;l+=1)ci(i=t[l])?i.then(s(l),n):a(l,i)}):e.all([t])},e.race=function(t){return mi(t)?new e(function(e,n){for(var i,r=0;r<t.length;r+=1)ni(i=t[r])&&"function"==typeof i.then?i.then(e,n):e(i)}):e.race([t])},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.__invokeResolveFunction=function(t,n){function i(t){e.__reject(n,t)}try{t(function(t){e.__resolve(n,t)},i)}catch(e){i(e)}},e.__invokeCallback=function(t,n,i,r){var o,s,a,l,c=fi(i);if(c)try{o=i(r),a=!0}catch(e){l=!0,s=e}else o=r,a=!0;e.__handleThenable(n,o)||(c&&a?e.__resolve(n,o):l?e.__reject(n,s):t===u.FULFILLED?e.__resolve(n,o):t===u.REJECTED&&e.__reject(n,o))},e.__publish=function(t,n){for(var i,r,o=t.__subscribers,s=t.__detail,a=0;a<o.length;a+=3)i=o[a],r=o[a+n],e.__invokeCallback(n,i,r,s);t.__subscribers=null},e.__publishFulfillment=function(t){e.__publish(t,t.__state=u.FULFILLED)},e.__publishRejection=function(t){e.__publish(t,t.__state=u.REJECTED)},e.__reject=function(t,n){t.__state===u.PENDING&&(t.__state=u.SEALED,t.__detail=n,e.config.async(e.__publishRejection,t))},e.__fulfill=function(t,n){t.__state===u.PENDING&&(t.__state=u.SEALED,t.__detail=n,e.config.async(e.__publishFulfillment,t))},e.__resolve=function(t,n){t===n?e.__fulfill(t,n):e.__handleThenable(t,n)||e.__fulfill(t,n)},e.__handleThenable=function(t,n){var i;if(t===n)return e.__reject(t,new TypeError("A promises callback cannot return the same promise.")),!0;if(ci(n))try{return n.then.call(n,function(r){if(i)return!0;i=!0,n!==r?e.__resolve(t,r):e.__fulfill(t,r)},function(n){if(i)return!0;i=!0,e.__reject(t,n)}),!0}catch(n){return!!i||(e.__reject(t,n),!0)}return!1},e.__subscribe=function(e,t,n,i){var r=e.__subscribers,o=r.length;r[o]=t,r[o+u.FULFILLED]=n,r[o+u.REJECTED]=i},e.prototype.then=function(t,n){var i=this,r=new this.constructor(Kn,this);if(di(this.__state))e.__subscribe(this,r,t,n);else{var o=arguments;e.config.async(function(){e.__invokeCallback(i.__state,r,o[i.__state-1],i.__detail)})}return r},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.toString=function(){return"[object Promise]"},e.config={async:function(e,n){1===s.push([e,n])&&t()}},e}();function g(){for(var e=0,t=s;e<t.length;e++){var n=t[e];(0,n[0])(n[1])}s=[]}function y(e){return!di(e.Promise)&&fi(e.Promise.all)&&fi(e.Promise.race)&&fi(e.Promise.resolve)&&fi(e.Promise.reject)?e.Promise:v}e.Promise=v,(c=u||(u={}))[c.PENDING=void 0]="PENDING",c[c.SEALED=0]="SEALED",c[c.FULFILLED=1]="FULFILLED",c[c.REJECTED=2]="REJECTED",e.IPromise=y,sr.injectable(f,y,[G],xn);var b=function(){function e(){var e=Cr(d);this.__fileSupported=e.fileSupported}return e.prototype.initialize=function(e){this.__options=ei(!1,!1,{},this._config,e)},e.prototype.execute=function(){var e=this.__options,t=e.url;if(!li(t)||hi(t.trim()))return this._invalidOptions();e.url=this._browser.urlUtils(t).toString();var n=!1;return e.isCrossDomain||!1?n=!0:(this.xhr=new XMLHttpRequest,vi(this.xhr.withCredentials)&&(n=this._browser.isCrossDomain(t))),n?(this.xhr=null,this.jsonpCallback=e.jsonpCallback,di(this.jsonpCallback)&&(this.jsonpCallback=ji("plat_callback")),this.executeJsonp()):this._sendXhrRequest()},e.prototype.executeJsonp=function(){var e=this,t=this.__options,n=t.url;if(!li(n)||hi(n.trim()))return this._invalidOptions();t.url=this._browser.urlUtils(n).toString(),di(this.jsonpCallback)&&(this.jsonpCallback=t.jsonpCallback,di(this.jsonpCallback)&&(this.jsonpCallback=ji(ct)));var i=new x(function(i,r){var o=e._window,s=e._document,a=s.createElement("script"),l=e.jsonpCallback,u=t.jsonpIdentifier;li(u)||(u="callback"),a.src=n+(n.indexOf("?")>-1?"&":"?")+u+"="+l;var c=o[l];o[l]=function(t){fi(e.clearTimeout)&&e.clearTimeout(),s.head.removeChild(a),vi(c)?Li(o,l):o[l]=c,i({response:t,status:200})},s.head.appendChild(a);var h=t.timeout;_i(h)&&h>0&&(e.clearTimeout=ki(function(){e.clearTimeout=Si(function(){r(new C({response:"Request timed out in "+h+"ms for "+n,status:408})),o[l]=Kn},h-1)}))});return i.initialize(this),i},e.prototype._xhrOnReadyStateChange=function(){var e=this.xhr;if(4===e.readyState){var t=e.status;if(0===t){var n=e.response;if(di(n))try{n=e.responseText}catch(e){}return!hi(n)}return t>=200&&t<300||304===t}},e.prototype._sendXhrRequest=function(){var e=this,t=this.xhr,n=this.__options,i=n.method,r=n.url,o=new x(function(o,s){t.onreadystatechange=function(){var t=e._xhrOnReadyStateChange();if(!di(t)){var i=e._formatResponse(n.responseType,t);t?o(i):s(new C(i)),e.xhr=n=null}},li(i)||(e._log.info('AjaxOptions method was not of type string. Defaulting to "GET".'),i="GET"),t.open(i.toUpperCase(),r,!0,n.user,n.password);var a=n.responseType;if(e.__fileSupported||""===a||"text"===a||(a=""),"json"===a)try{t.responseType=a}catch(e){t.responseType=""}t.withCredentials=n.withCredentials;var l=n.overrideMimeType,u=n.data;if(li(l)&&!hi(l)&&t.overrideMimeType(l),di(u)||""===u)e.__setHeaders(),t.send();else{var c=n.transforms;gi(c)||(c=[]);var h=c.length,p=n.contentType,_=li(p)&&!hi(p);if(h>0){for(var f=0;f<h;f+=1)u=c[f](u,t);_&&t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)}else if(ni(u))if(_){var d=p.toLowerCase();-1!==d.indexOf("x-www-form-urlencoded")?(u=e.__serializeFormData(),t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)):-1!==d.indexOf("multipart/form-data")?e.__fileSupported?(u=e.__appendFormData(),e.__setHeaders(),t.send(u)):e.__submitFramedFormData().then(function(e){o(e)},function(){e.xhr=null}):(u=JSON.stringify(u),t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u))}else e.__setHeaders(),t.send(u);else _&&t.setRequestHeader("Content-Type",p),e.__setHeaders(),t.send(u)}var v=n.timeout;_i(v)&&v>0&&(e.clearTimeout=ki(function(){e.clearTimeout=Si(function(){s(new C({response:"Request timed out in "+v+"ms for "+n.url,status:408,getAllResponseHeaders:function(){return t.getAllResponseHeaders()},xhr:t})),t.onreadystatechange=null,t.abort(),e.xhr=null},v-1)}))});return o.initialize(this),o},e.prototype._invalidOptions=function(){var e=this;return new x(function(t,n){e._log.warn("Attempting a request without specifying a url"),n(new C({response:"Attempting a request without specifying a url",status:null,getAllResponseHeaders:null,xhr:null}))})},e.prototype._formatResponse=function(e,t){var n=this.xhr,i=n.status,r=n.response;if(di(r))try{r=n.responseText}catch(e){}if(0===i&&(i=t?200:404),n.onreadystatechange=null,fi(this.clearTimeout)&&this.clearTimeout(),"json"===e&&li(r))try{r=JSON.parse(r)}catch(e){}return{response:r,status:i,getAllResponseHeaders:function(){return n.getAllResponseHeaders()},xhr:n}},e.prototype.__setHeaders=function(){var e=this.__options.headers;ni(e)||(e={});var t,n,i=Object.keys(e),r=this.xhr,o=i.length;for(n=0;n<o;n+=1)t=i[n],r.setRequestHeader(t,e[t])},e.prototype.__serializeFormData=function(){for(var e,t,n=this.__options.data,i=Object.keys(n),r=[];i.length>0;)di(t=n[e=i.pop()])?t="":ni(t)&&(yi(t)?t=t.toISOString():ai(t)?(this._log.warn('Invalid File entry with key "'+e+'"'),t="[object File]"):(this._log.warn('Invalid form entry with key "'+e+'" and value "'+t+'"'),t=JSON.stringify(t))),r.push(encodeURIComponent(e)+"="+encodeURIComponent(t));return r.join("&").replace(/%20/g,"+")},e.prototype.__appendFormData=function(){for(var e,t,n=this.__options.data,i=new FormData,r=Object.keys(n);r.length>0;)if(di(t=n[e=r.pop()]))i.append(e,"");else if(ni(t))if(yi(t))i.append(e,t.toISOString());else if(ai(t)){var o=t.name;li(o)||(o=t.fileName),li(o)||(o="blob"),i.append(e,t,o)}else this._log.warn('Invalid form entry with key "'+e+'" and value "'+t+'"'),i.append(e,JSON.stringify(t));else i.append(e,t);return i},e.prototype.__submitFramedFormData=function(){var e,t=this,n=this.__options,i=n.data,r=n.url,o=this._document,s=o.body,a=Cr(f),l=o.createElement("form"),u=o.createElement("iframe"),c=ji("iframe_target"),h=Object.keys(i);for(u.name=l.target=c,u.src="javascript:false;",l.enctype=l.encoding="multipart/form-data",l.action=r,l.method="POST",l.style.display="none";h.length>0;)e=h.pop(),l.insertBefore(this.__createInput(e,i[e]),null);return new a(function(e,n){t.xhr.abort=function(){u.onload=null,s.removeChild(l),s.removeChild(u),n()},u.onload=function(){var n=u.contentDocument.body.innerHTML;s.removeChild(l),s.removeChild(u),e({response:n,status:200,getAllResponseHeaders:function(){return""}}),t.xhr=u.onload=null},s.insertBefore(l,null),s.insertBefore(u,null),l.submit()})},e.prototype.__createInput=function(e,t){var n=this._document,i=n.createElement("input");if(i.type="hidden",i.name=e,di(t))i.value="";else if(ni(t))if(!fi(t.slice)||vi(t.name)||vi(t.path))this._log.info('Invalid form entry with key "'+e+'" and value "'+t+'"'),i.value=JSON.stringify(t);else{var r=n.querySelectorAll('input[type="file"][name="'+e+'"]'),o=r.length;if(0===o)this._log.info('Could not find input[type="file"] with [name="'+e+'"]. Stringifying data instead.'),i.value=JSON.stringify(t);else if(1===o){var s=(i=r[0]).cloneNode(!0);i.parentNode.insertBefore(s,i)}else{for(var a=void 0,l=t.path;o>0;)if((a=r[o-=1]).value===l){var u=(i=a).cloneNode(!0);i.parentNode.insertBefore(u,i);break}-1===o&&(this._log.info('Could not find input[type="file"] with [name="'+e+'"] and [value="'+t.path+'"]. Stringifying data instead.'),i.value=JSON.stringify(t))}}else i.value=t;return i},e._inject={_browser:Q,_window:G,_document:m,_config:_,_log:E},e}();e.HttpRequest=b;var C=function(){function e(e){this.name="AjaxError",Error.apply(this),this.response=this.message=e.response,this.status=e.status,this.getAllResponseHeaders=e.getAllResponseHeaders,this.xhr=e.xhr}return e.prototype.toString=function(){var e=this.response,t=e;return ni(e)&&!e.hasOwnProperty("toString")&&(t=JSON.stringify(e)),"Request failed with status: "+this.status+" and response: "+t},e}();e.AjaxError=C,C.prototype=Error.prototype;var x=function(e){function t(t,n){var i=e.call(this,t)||this;return i._window=Cr(G),di(n)||(i.__http=n.__http),i}return __extends(t,e),t.prototype.initialize=function(e){ni(e)&&di(this.__http)&&(this.__http=e)},t.prototype.cancel=function(){var e=this.__http,t=e.xhr,n=e.jsonpCallback;fi(e.clearTimeout)&&e.clearTimeout(),di(t)?di(n)||(this._window[n]=Kn):(t.onreadystatechange=null,t.abort(),e.xhr=null),this.__subscribers=[]},t.prototype.then=function(t,n){return e.prototype.then.call(this,t,n)},t.prototype.catch=function(t){return e.prototype.catch.call(this,t)},t}(v);e.AjaxPromise=x;var w=function(){function e(){this.responseType={DEFAULT:"",ARRAYBUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},this.contentType={ENCODED_FORM:"application/x-www-form-urlencoded;charset=utf-8",JSON:"application/json;charset=utf-8",MULTIPART_FORM:"multipart/form-data",OCTET_STREAM:"application/octet-stream;charset=utf-8",XML:"application/xml;charset=utf-8",PLAIN_TEXT:"text/plain",HTML:"text/html"}}return e.prototype.ajax=function(e){var t=Cr(p);return t.initialize(e),t.execute()},e.prototype.jsonp=function(e){var t=Cr(p);return t.initialize(e),t.executeJsonp()},e.prototype.json=function(e){var t=Cr(p);return t.initialize(ei(!1,!1,{},e,{responseType:"json"})),t.execute()},e.config={url:null,method:"GET",responseType:"",transforms:[],headers:{},withCredentials:!1,timeout:null,jsonpIdentifier:"callback",contentType:"application/json;charset=utf-8"},e}();function T(){return w.config}e.Http=w,sr.injectable(h,w),sr.injectable(p,b,null,bn),e.IHttpConfig=T,sr.injectable(_,T)}(Er=e.async||(e.async={})),function(e){var t={},n={},i=function(){function e(e,t){this.__uid=e,this.__options=t,this.__size=0,di(t)&&(this.__options={timeout:0}),n[e]={}}return e.create=function(n,i){var r=t[n];return di(r)&&(r=t[n]=new e(n,i)),r},e.fetch=function(e){return t[e]},e.clear=function(){for(var e=Object.keys(t),n=e.length,i=0;i<n;i+=1)t[e[i]].clear();t={}},e.prototype.info=function(){return{uid:this.__uid,size:this.__size,options:this.__options}},e.prototype.put=function(e,t){var i=n[this.__uid][e];n[this.__uid][e]=t,vi(i)&&(this.__size+=1);var r=this.__options.timeout;return _i(r)&&r>0&&Si(this.remove,r,[e],this),t},e.prototype.read=function(e){return n[this.__uid][e]},e.prototype.remove=function(e){Li(n[this.__uid],e),this.__size-=1},e.prototype.clear=function(){n[this.__uid]={},this.__size=0},e.prototype.dispose=function(){this.clear(),Li(t,this.__uid)},e}();function r(){return i}function o(){return e.managerCache}e.Cache=i,e.ICacheFactory=r,sr.injectable(P,r,null,Cn),e.managerCache=i.create("__managerCache"),e.IManagerCache=o,sr.injectable(O,o);var s=function(e){function t(){return e.call(this,"__templateCache")||this}return __extends(t,e),t.prototype.put=function(t,n){var i=this._Promise;if(e.prototype.put.call(this,t,i.resolve(n)),si(n))n=n.cloneNode(!0);else if(oi(n)){var r=document.createDocumentFragment();r.appendChild(n.cloneNode(!0)),n=r}else(li(n)||di(n))&&(n=Ki(n));return i.resolve(n)},t.prototype.read=function(t){var n=this,i=e.prototype.read.call(this,t);return di(i)?this._Promise.reject(null):i.then(function(e){return n.put(t,e)},function(e){return n._log.warn("Error retrieving template, "+t+", from promise."),null})},t._inject={_Promise:f,_log:E},t}(i);e.TemplateCache=s,sr.injectable(F,s);var a=function(){function e(e){var t=this;this._storage=e,Ci(function(e,n){t[n]=e},e)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._storage.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._storage.clear()},e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.key=function(e){return this._storage.key(e)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t),this[e]=this.getItem(e)},e}();e.BaseStorage=a;var l=function(e){function t(){return e.call(this,Cr(G).localStorage)||this}return __extends(t,e),t}(a);e.LocalStorage=l,sr.injectable("$LocalStorage",l);var u=function(e){function t(){return e.call(this,Cr(G).sessionStorage)||this}return __extends(t,e),t}(a);e.SessionStorage=u,sr.injectable("$SessionStorage",u)}(e.storage||(e.storage={}));var kr,Sr={"u+":{precedence:4,associativity:"rtl",fn:function(e,t,n){return+n(e,t)}},"+":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)+i(e,t)}},"u-":{precedence:4,associativity:"rtl",fn:function(e,t,n){return-n(e,t)}},"-":{precedence:6,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)-i(e,t)}},"*":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)*i(e,t)}},"/":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)/i(e,t)}},"%":{precedence:5,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)%i(e,t)}},"?":{precedence:15,associativity:"rtl",fn:function(){}},":":{precedence:15,associativity:"rtl",fn:function(){}},">":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>i(e,t)}},"<":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<i(e,t)}},"!":{precedence:4,associativity:"rtl",fn:function(e,t,n){return!n(e,t)}},"~":{precedence:4,associativity:"rtl",fn:function(e,t,n){return~n(e,t)}},"&":{precedence:10,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&i(e,t)}},"|":{precedence:12,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)|i(e,t)}},">>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>i(e,t)}},"<<":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<<i(e,t)}},">>>":{precedence:7,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>>>i(e,t)}},"&&":{precedence:13,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)&&i(e,t)}},"||":{precedence:14,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)||i(e,t)}},"==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)==i(e,t)}},"===":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)===i(e,t)}},"!=":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!=i(e,t)}},"!==":{precedence:9,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)!==i(e,t)}},">=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)>=i(e,t)}},"<=":{precedence:8,associativity:"ltr",fn:function(e,t,n,i){return n(e,t)<=i(e,t)}},"=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"++":{precedence:3,associativity:"",fn:function(t,n,i){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"--":{precedence:3,associativity:"",fn:function(t,n,i){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"+=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"-=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"*=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"/=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}},"%=":{precedence:17,associativity:"rtl",fn:function(t,n,i,r){e.acquire(E).error(new Error("Assignment operators are not supported"))}}},Ir={"()":{precedence:2,associativity:null,fn:null},"[]":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},"{}":{precedence:1,associativity:null,fn:null}},Rr={"{":{precedence:1,associativity:null,fn:null},"}":{precedence:1,associativity:null,fn:null},"[":{precedence:2,associativity:null,fn:null},"]":{precedence:2,associativity:null,fn:null},"(":{precedence:2,associativity:null,fn:null},")":{precedence:2,associativity:null,fn:null},".":{precedence:2,associativity:null,fn:null},",":{precedence:18,associativity:null,fn:null},"'":{precedence:0,associativity:null,fn:null},'"':{precedence:0,associativity:null,fn:null}},jr={false:!1,true:!0,null:null,undefined:"undefined"};function Ar(e){return!di(Ir[e])}function Lr(e){return!di(Sr[e])}function Pr(e){return!vi(jr[e])}!function(e){var t=["push","pop","reverse","shift","sort","splice","unshift"],n=function(){function e(){this._compat=Cr(d),this.__identifiers={},this.__identifierHash={},this.__lengthListeners={},this.__contextObjects={},this.__isArrayFunction=!1}return e.getManager=function(t){var n,i=e.__managers,r=t.uid,o=i[r];return di(o)?((n=i[r]=new e).context=t,n):n=o},e.dispose=function(t){if(!di(t)){var n=t.uid,i=e.__controls,r=e.__managers,o=r[n],s=i[n];ni(s)||(s={}),di(o)||(o.dispose(),Li(r,n));for(var a,l=Object.keys(s);l.length>0;)for(a=s[l.shift()];a.length>0;)a.shift()();Li(i,n),t.hasOwnContext&&!di(t.context)&&(e.unObserve(t.context),e.defineProperty(t,u,t.context,!0,!0,!0))}},e.removeArrayListeners=function(t,n){var i=e.arrayChangeListeners[t];di(i)||Li(i,n)},e.getContext=function(e,t){if(di(e))return e;for(t=t.slice(0);t.length>0;)if(di(e=e[t.shift()]))return e;return e},e.defineProperty=function(e,t,n,i,r,o){Zn(e,t,n,i,r,o)},e.defineGetter=function(e,t,n,i,r){var o,s,a,l,u;o=e,s=t,a=n,l=i,u=r,Object.defineProperty(o,s,{get:function(){return a},enumerable:!0===l,configurable:!0===u})},e.pushRemoveListener=function(t,n,i){var r,o=e.__controls,s=o[n];di(s)&&(s=o[n]={}),di(r=s[t])&&(r=s[t]=[]),r.push(i)},e.spliceRemoveListener=function(t,n,i){var r,o=e.__controls[n];if(!di(o)&&!di(r=o[t])){var s=r.indexOf(i);-1!==s&&(r.splice(s,1),0===r.length&&Li(o,t))}},e.removeIdentifier=function(t,n){for(var i,r=t.length,o=e.__controls,s=0;s<r;s+=1)di(i=o[t[s]])||Li(i,n)},e.createContext=function(t,n){var i=t.context;if(!ni(i)){if(!di(i))return void e._log.warn("A child control is trying to create a child context that has a parent control with a primitive type context");i=t.context={}}for(var r,o,s=n.split(".");s.length>0;)di(o=i[r=s.shift()])&&(o=_i(Number(s[0]))?i[r]=[]:i[r]={}),i=o;return i},e.unObserve=function(e){ei(!0,!0,e)},e.prototype.getContext=function(e,t){return this._getContext(e.join("."),e,t)},e.prototype.observe=function(t,n){var i=this;if(hi(t))return Kn;var r,o,s=t.split("."),a=s.pop(),l="length"===a,u=!di(n),c=this._hasIdentifier(t);if(s.length>0?(r=s.join("."),o=this._getContext(r,s,!0)):(r=a,o=this.context),!ni(o))return u?(l&&(this.__lengthListeners[t]=n,e.pushRemoveListener(t,n.uid,function(){Li(i.__lengthListeners,t)})),this._addObservableListener(t,n,l)):Kn;this.__observedIdentifier=null,this.__contextObjects[t]=o[a];var h=this.__observedIdentifier,p=!di(h),_=Kn;if(p&&(c=!0),u){var f=this._addObservableListener(t,n,l),d=Kn;p&&t!==h&&(d=this._addObservableListener(h,n,l)),_=function(){f(),d()}}var v=mi(o),m=_,g=Number(a),y=Kn,b=Kn;if(v&&g>=o.length)y=this.observe(r+".length",{uid:n.uid,listener:function(e,n){g>=e||(y(),i._define(t,o,a))}}),_=function(){m(),y()};else if(!c)if(v&&l){var C=s.pop(),x=this.getContext(s,!1);if(this.__observedIdentifier=null,Pi(x,C),li(this.__observedIdentifier)&&(r=this.__observedIdentifier),u){var E=n.uid;y=this.observeArrayMutation(E,Kn,r,o,null),b=this.observe(r,{uid:E,listener:function(e,t){y(),y=i.observeArrayMutation(E,Kn,r,e,t)}})}_=function(){m(),b(),y()}}else this._define(t,o,a);return _},e.prototype.observeArrayMutation=function(e,t,n,i,r){if(mi(r)&&this._restoreArray(r),di(i))return Kn;var o=n.split("."),s=o.pop(),a=this.getContext(o,!1);this.__observedIdentifier=null,Pi(a,s),li(this.__observedIdentifier)&&(n=this.__observedIdentifier);var l=[];return fi(t)&&l.push(this._pushArrayListener(e,n,t)),this._overwriteArray(n,i),function(){for(;l.length>0;)l.pop()()}},e.prototype.dispose=function(){this.context=null,this.__identifiers={},this.__identifierHash={},this.__contextObjects={}},e.prototype._pushArrayListener=function(t,n,i){var r=e.arrayChangeListeners,o=r[n];di(o)&&(o=r[n]={});var s=o[t];di(s)&&(s=o[t]=[]);var a=!1,l=function(){if(!a){a=!0,e.spliceRemoveListener(n,t,l);var u=s.indexOf(i);-1!==u&&(s.splice(u,1),0===s.length&&(Li(o,t),hi(o)&&Li(r,n)))}};return s.push(i),e.pushRemoveListener(n,t,l),l},e.prototype._restoreArray=function(e){var n=this._compat;if(n.setProto)Object.setPrototypeOf(e,Object.create(Array.prototype));else if(n.proto)e.__proto__=Object.create(Array.prototype);else for(var i=t.length,r=void 0,o=0;o<i;o+=1)e[r=t[o]]=Array.prototype[r]},e.prototype._overwriteArray=function(n,i){var r,o,s=this._compat,a=t.length;if(s.proto){var l=Object.create(Array.prototype);for(o=0;o<a;o+=1)l[r=t[o]]=this._overwriteArrayFunction(n,r);s.setProto?Object.setPrototypeOf(i,l):i.__proto__=l}else for(o=0;o<a;o+=1)r=t[o],e.defineProperty(i,r,this._overwriteArrayFunction(n,r),!1,!0,!0)},e.prototype._getContext=function(e,t,n){var i=this.__contextObjects[e];return di(i)&&(i=!0===n?this.__contextObjects[e]=this._observeImmediateContext(t,e):this._getImmediateContext(t)),i},e.prototype._getImmediateContext=function(e){for(var t=this.context;e.length>0&&!di(t=t[e.shift()]););return t},e.prototype._observeImmediateContext=function(e,t){return di(this.__identifiers[t])&&this.observe(t,null),this._getImmediateContext(e)},e.prototype._getValues=function(e,t,n){for(var i,r,o,s=ni(t),a=ni(n);e.length>1&&(i=e.shift(),s&&di(t=t[i])&&(s=!1),a&&di(n=n[i])&&(a=!1),s||a););return i=e[0],di(t)||(r=t[i]),di(n)||(o=n[i]),{newValue:r,oldValue:o}},e.prototype._notifyChildProperties=function(e,t,n,i){var r=this;if(!ni(i)){var o=this.__identifierHash[e];ni(o)||(o={}),i=Object.keys(o)}for(var s,a,l,u,c,h,p,_,f,d,v,m=i.length,g=e.length+1,y={},b=function(o){if(_=i[o],f=_.slice(g),v=f.split("."),a=v.pop(),l="length"===a,hi(d=v.join("."))){if(c=n,h=di(u=t)?void 0:u[a],p=di(c)?void 0:c[a],l&&!mi(c)&&mi(u)){var m=C.__lengthListeners[_];if(!di(m)){var b=m.uid,x=e.split("."),E=x.pop(),w=x.join("."),T=C._getContext(w,x,!1);C.__observedIdentifier=null,Pi(T,E),li(C.__observedIdentifier)&&(w=C.__observedIdentifier);var N=C.observeArrayMutation(b,Kn,w,u,null);C.observe(w,{uid:b,listener:function(e,t){N(),N=r.observeArrayMutation(b,Kn,w,e,t)}}),Li(C.__lengthListeners,_)}}}else di(s=y[d])&&(s=y[d]=C._getValues(v,t,n)),u=s.newValue,c=s.oldValue,h=di(u)?u:u[a],p=di(c)?c:c[a];y[f]={newValue:h,oldValue:p},ni(u)&&(!mi(u)||u.length>a)&&C._define(_,u,a),C._execute(_,h,p)},C=this,x=0;x<m;x+=1)b(x);y=null},e.prototype._addObservableListener=function(t,n,i){var r=this;if(!0===i){var o=t.split(".");o.pop();var s=o.pop(),a=this.getContext(o,!1);ni(a)&&(this.__observedIdentifier=null,Pi(a,s),li(this.__observedIdentifier)&&(t=this.__observedIdentifier+(!0===i?".length":"")))}this.__add(t,n);var l=n.uid,u=function(){e.spliceRemoveListener(t,l,u),r._removeCallback(t,n)};return e.pushRemoveListener(t,l,u),u},e.prototype._define=function(e,t,n){ni(t[n])?this.__defineObject(e,t,n):this.__definePrimitive(e,t,n)},e.prototype._overwriteArrayFunction=function(t,n){var i=this,r=e.arrayChangeListeners[t];return ni(r)||(r={}),function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a,l,u,c,h,p,_=this.length,f=ti(this,!0),d="unshift"===n,v="shift"===n,m="splice"===n,g=v||d||m,y="sort"===n||"reverse"===n;g?(i.__isArrayFunction=!0,p=Array.prototype[n].apply(this,o),i.__isArrayFunction=!1,c=this.length,u=0,v?(l=0,h=_>0?[p]:[]):d?(l=o.length,h=[]):(l=o.length-2,u=o[0],h=p)):(p=Array.prototype[n].apply(this,o),c=this.length,y?a=f:"push"===n?(l=o.length,u=_,h=[]):"pop"===n&&(l=0,u=c,h=_>0?[p]:[])),(v||m||"pop"===n)&&e.unObserve(p);var b,C,x,E,w=Object.keys(r),T=w.length;for(x=0;x<T;x+=1)for(C=(b=r[w[x]]).length,E=0;E<C;E+=1)b[E]([{object:this,type:n,index:u,removed:h,addedCount:l,oldArray:a}]);return g?i._notifyChildProperties(t,this,f):i._execute(t+".length",c,_),p}},e.prototype._removeCallback=function(e,t){var n=this.__identifiers[e];if(!di(n)){var i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&Li(this.__contextObjects,e))}},e.prototype._hasIdentifier=function(e){return!hi(this.__identifiers[e])},e.prototype._execute=function(e,t,n){var i=this.__identifiers[e];if(vi(t)?Li(this.__contextObjects,e):this.__contextObjects[e]=t,t!==n&&!di(i))for(var r=i.slice(0),o=r.length,s=0;s<o;s+=1)r[s].listener(t,n)},e.prototype.__defineObject=function(t,n,i){var r=this,o=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=t,o},set:function(s){if(o!==s){var a=o;if(o=s,!r.__isArrayFunction){e.unObserve(a);var l,u=r.__identifierHash[t],c=!1;ni(u)&&(c=(l=Object.keys(u)).length>0),r._execute(t,o,a),c?(r._notifyChildProperties(t,o,a,l),ni(o)||r.__definePrimitive(t,n,i)):hi(r.__identifiers[t])?e.defineProperty(n,i,o,!0,!0,!0):ni(o)||r.__definePrimitive(t,n,i)}}}})},e.prototype.__definePrimitive=function(t,n,i){var r=this,o=n[i],s=!di(o);mi(n)&&"length"===i||Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.__observedIdentifier=t,o},set:function(a){if(o!==a){var l=o;if(o=a,!r.__isArrayFunction||!mi(n)){var u,c=r.__identifierHash[t],h=!1;ni(c)&&(h=(u=Object.keys(c)).length>0),r._execute(t,a,l),!h&&hi(r.__identifiers[t])?e.defineProperty(n,i,o,!0,!0,!0):ni(o)?(r.__defineObject(t,n,i),h&&r._notifyChildProperties(t,a,l,u)):s||(r.__definePrimitive(t,n,i),s=!0)}}}})},e.prototype.__add=function(e,t){var n=t.priority,i=this.__identifiers[e],r=!1;if(di(i)&&(i=this.__identifiers[e]=[]),_i(n)){for(var o=i.length,s=0;s<o;s+=1)if(n>i[s].priority){i.splice(s,0,t),r=!0;break}}else t.priority=-1;r||i.push(t),this.__addHashValues(e)},e.prototype.__addHashValues=function(e){var t=this.__identifierHash;if(!ni(t[e])){t[e]={};var n,i,r,o,s=[],a=e;for(n=a.lastIndexOf(".");-1!==n;){for(i=t[a=a.slice(0,n)],o=s.length,di(i)&&(i=t[a]={}),i[e]=!0,r=0;r<o;r+=1)i[s[r]]=!0;s.push(a),n=a.lastIndexOf(".")}}},e.arrayChangeListeners={},e.__managers={},e.__controls={},e}();function i(e){return n._log=e,n}e.ContextManager=n,e.IContextManagerStatic=i,sr.injectable(S,i,[E],gn),sr.injectable("$ContextManagerInstance",n,null,bn)}(e.observable||(e.observable={})),function(e){var t=function(){function e(){this.defaultPrevented=!1,this.stopped=!1}return e.prototype.initialize=function(e,t,n){this.name=e,li(n)?this.direction=n:this.direction=this._EventManager.UP,this.sender=t},e.prototype.preventDefault=function(){this.defaultPrevented||this._ContextManager.defineGetter(this,"defaultPrevented",!0)},e.prototype.stopPropagation=function(){this.direction===this._EventManager.UP&&(this.stopped=!0,this._EventManager.propagatingEvents[this.name]=!1)},e._inject={_EventManager:b,_ContextManager:S},e}();e.DispatchEvent=t,sr.injectable(g,t,null,bn);var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.dispatch=function(e,t){var n=Cr(x);return n.initialize(e,t),r.sendEvent(n),n},t.prototype.initialize=function(t,n){e.prototype.initialize.call(this,t,n,this._EventManager.DIRECT)},t}(t);function i(){return n}e.LifecycleEvent=n,e.ILifecycleEventStatic=i,sr.injectable(C,i,null,gn),sr.injectable(x,n,null,bn);var r=function(){function e(){}return e.initialize=function(){if(!e.__initialized){e.__initialized=!0;for(var t,i=e.__lifecycleEventListeners,r=e._compat,o=e._document,s=e._window,a=e._dom,l=n.dispatch;i.length>0;)t=i.pop(),o.removeEventListener(t.name,t.value,!1);if(r.cordova){for(var u,c=["resume","online",wt],h=r.winJs,p=c.length,_=function(t){return function(){l(t,e)}},f=void 0,d=0;d<p;d+=1)f=_(u=c[d]),i.push({name:u,value:f}),a.addEventListener(o,u,f,!1);f=_(Et),i.push({name:"pause",value:f}),a.addEventListener(o,"pause",f,!1),f=_(xt),i.push({name:jt,value:f}),a.addEventListener(o,jt,f,!1),f=function(){return h||l(At,e),!0},i.push({name:At,value:f}),a.addEventListener(o,At,f,!1),h&&(f=function(){return l(At,e),!0},i.push({name:Lt,value:f}),s.WinJS.Application.addEventListener(Lt,f,!1))}else{if(r.amd)return;a.addEventListener(s,"load",function(){l(xt,e)})}}},e.dispose=function(t){Li(e.__eventsListeners,t)},e.on=function(t,n,i,r){var o=e.__eventsListeners[t];di(o)&&(o=e.__eventsListeners[t]={listeners:{},context:r});var s=o.listeners[n];return mi(s)||(s=o.listeners[n]=[]),s.push(i),function(){var e=s.indexOf(i);-1!==e&&s.splice(e,1)}},e.dispatch=function(t,n,i,r){var o=Cr(g);return o.initialize(t,n,i),e.sendEvent(o,r),o},e.hasDirection=function(t){return t===e.UP||t===e.DOWN||t===e.DIRECT},e.sendEvent=function(t,n){var i=t.name,r=t.direction;switch(mi(n)||(n=[]),e.propagatingEvents[i]=!0,r){case e.UP:e._dispatchUp(t,n);break;case e.DOWN:e._dispatchDown(t,n);break;case e.DIRECT:e._dispatchDirect(t,n)}Li(e.propagatingEvents,i)},e._dispatchUp=function(t,n){for(var i=t.name,r=t.sender;!di(r)&&e.propagatingEvents[i];)di(r.uid)?r=r.parent:(e.__executeEvent(r.uid,t,n),r=r.parent)},e._dispatchDown=function(t,n){var i,r=t.name,o=[];for(o.push(t.sender);!hi(o.length)&&e.propagatingEvents[r];)di((i=o.pop()).uid)||(e.__executeEvent(i.uid,t,n),di(i.controls)||(o=o.concat(i.controls)))},e._dispatchDirect=function(t,n){for(var i,r=Object.keys(e.__eventsListeners),o=r.length,s=t.name,a=0;a<o&&e.propagatingEvents[s];a+=1)di(i=e.__eventsListeners[r[a]])||di(i.listeners[s])||e.__callListeners(i.context,t,i.listeners[s],n)},e.__executeEvent=function(t,n,i){var r=e.__eventsListeners[t];if(!di(r)){var o=r.context,s=r.listeners[n.name];di(s)||e.__callListeners(o,n,s,i)}},e.__callListeners=function(t,n,i,r){var o=n.name,s=i.length,a=-1;for(r=[n].concat(r),a+=1;a<s&&e.propagatingEvents[o];){try{i[a].apply(t,r)}catch(t){e._log.debug(t)}a+=1}},e.UP="up",e.DOWN="down",e.DIRECT="direct",e.propagatingEvents={},e.__eventsListeners={},e.__lifecycleEventListeners=[],e.__initialized=!1,e}();function o(e,t,n,i,o){return r._log=e,r._compat=t,r._document=n,r._window=i,r._dom=o,r}e.EventManager=r,e.IEventManagerStatic=o,sr.injectable(b,o,[E,d,m,G,z],gn);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.dispatch=function(e,n,i,r){var o=Cr(t);return o.initialize(e,n,null,i),o.logLevel=r,t._EventManager.sendEvent(o),o},t.prototype.initialize=function(t,n,i,r){e.prototype.initialize.call(this,t,n,this._EventManager.DIRECT),this.error=r},t}(t);function a(e){return s._EventManager=e,s}e.ErrorEvent=s,e.IErrorEventStatic=a,sr.injectable(y,a,[b],gn)}(kr=e.events||(e.events={}));var Or=function(){function e(){this.uid=ji(le),this.priority=0,this.dom=e._dom,this.utils=Cr(H),this._log=e._log}return e.getRootControl=function(t){if(di(t))return t;if(!di(t.root))return t.root;for(;!di(t.parent)&&!t.hasOwnContext;){if(!di(t.root))return t.root;t=t.parent}return!t.hasOwnContext&&ni(t.context)&&e._log.debug("Root control: "+t.type+" found that sets its context to an Object but does not set the this.hasOwnContext = true."),t},e.load=function(t){var n=e._Promise;if(di(t))return n.resolve();var i=t;if(li(i.absoluteContextPath)){if(fi(i.contextChanged))e._ContextManager.getManager(i.root).observe(i.absoluteContextPath,{uid:t.uid,priority:1e3,listener:function(e,n){Mr.TemplateControl.contextChanged(t,e,n)}}),fi(i.zCC__plat)&&(i.zCC__plat(),Li(i,"zCC__plat"));var r=i.element;oi(r)&&fi(r.removeAttribute)&&r.removeAttribute(Pt)}return fi(t.loaded)?n.resolve(t.loaded()):n.resolve()},e.dispose=function(t){var n=t;if(!di(n))if(vi(n.templateControl)){if(n.hasOwnContext)Mr.ViewControl.dispose(n);else if(n.controls)Mr.TemplateControl.dispose(n);else if(fi(t.dispose)&&t.dispose(),e.removeEventListeners(t),e._ContextManager.dispose(t),t.element=null,e.removeParent(t),t.__injectable__type===gn){var i=_r[t.type];sr.control(t.type,t.constructor,i.dependencies,!0)}}else Dr.dispose(n)},e.removeParent=function(e){if(!di(e)){var t=e.parent;if(!di(t)){var n=t.controls;mi(n)||(n=[]);var i=n.indexOf(e);-1!==i&&n.splice(i,1),e.parent=null}}},e.removeEventListeners=function(t){if(!di(t)){var n=e.__eventListeners,i=t.uid,r=n[i];if(mi(r)){for(var o=r.length;o>0;)r[o-=1]();Li(n,i)}}},e.getInstance=function(){return new e},e.__addRemoveListener=function(t,n){var i=e.__eventListeners;mi(i[t])?i[t].push(n):i[t]=[n]},e.__spliceRemoveListener=function(t,n){var i=e.__eventListeners[t];if(mi(i)){var r=i.indexOf(n);if(-1===r)return;i.splice(r,1)}},e.__getControls=function(t,n,i){var r,o=[],s=e.getRootControl(t);di(s)||s[n]!==i||o.push(s);var a=s.controls;if(di(a))return o;for(var l=[].concat(a);l.length>0;)(r=l.shift())[n]===i&&o.push(r),di(r.controls)||(l=l.concat(r.controls));return o},e.prototype.initialize=function(){},e.prototype.loaded=function(){},e.prototype.getControlsByName=function(t){return e.__getControls(this,"name",t)},e.prototype.getControlsByType=function(t){return li(t)?e.__getControls(this,"type",t):e.__getControls(this,"constructor",t)},e.prototype.addEventListener=function(t,n,i,r){if(!fi(i))return this._log.warn('"Control.addEventListener" must take a function as the third argument.'),Kn;i=i.bind(this);var o=this.dom.addEventListener(t,n,i,r),s=this.uid;return e.__addRemoveListener(s,o),function(){o(),e.__spliceRemoveListener(s,o)}},e.prototype.observe=function(t,n){var i,r=this,o=ni(this.context)?this:this.parent,s=e.getRootControl(o);if(di(o))return Kn;if(di(o.absoluteContextPath))return this._log.warn("Should not call plat.Control.observe prior to the control being loaded"),Kn;var a=e._parser;if(ni(a)||(a=Cr(w)),hi(n))i=o.absoluteContextPath;else if(li(n)){var l=a.parse(n);l.identifiers.length>1&&this._log.warn("Only a single identifier can be observed when calling the function plat.Control.observe");var c=l.identifiers[0];if("@"===c[0]){var h=c.split("."),p=h.shift().slice(1),_=h.length>0?"."+h.join("."):"";i=p===Fn?u+_:p===Dn?o.absoluteContextPath+_:o.absoluteContextPath+"."+c}else i=o.absoluteContextPath+"."+c}else i=o.absoluteContextPath+"."+n;var f=e._ContextManager;return ni(f)||(f=Cr(S)),f.getManager(s).observe(i,{listener:function(e,i){t.call(r,e,i,n)},uid:this.uid})},e.prototype.observeArray=function(t,n){var i,r,o=ni(this.context)?this:this.parent,s=o.context;if(di(o)||!ni(s))return Kn;var a=e._parser;if(ni(a)||(a=Cr(w)),hi(n))i=s,r=o.absoluteContextPath;else if(li(n)){var l=a.parse(n);i=l.evaluate(s),r=o.absoluteContextPath+"."+l.identifiers[0]}else i=s[n],r=o.absoluteContextPath+"."+n;if(!mi(i))return Kn;if(!fi(t))return Kn;t=t.bind(this);var u=e._ContextManager;ni(u)||(u=Cr(S));var c=u.getManager(e.getRootControl(o)),h=this.uid,p=function(e){t(e,n)},_=c.observeArrayMutation(h,p,r,i,null),f=c.observe(r,{listener:function(e,t){_(),_=c.observeArrayMutation(h,p,r,e,t)},uid:h});return function(){_(),f()}},e.prototype.observeExpression=function(t,n){var i=this;if(hi(n))return Kn;var r=e._parser;if(ni(r)||(r=Cr(w)),li(n))n=r.parse(n);else if(!fi(n.evaluate))return Kn;var o=di(this.resources)?this.parent:this;if(di(o)||!li(o.absoluteContextPath))return Kn;var s=e._ContextManager;ni(s)||(s=Cr(S));var a,l,u,c,h=n.aliases,p={},_=s.getManager,f=Mr.TemplateControl,d=f.findResource,v=f.evaluateExpression,m=h.length;for(c=0;c<m;c+=1)a=h[c],di(l=d(o,a))||(u=l.resource.type)!==Rn&&u!==Pn||(p[a]=_(l.control));var g,y,b=_(e.getRootControl(o)),C=o.absoluteContextPath,x=C+".",E={},T=n.identifiers;for(m=T.length,c=0;c<m;c+=1)y=(g=T[c]).split(".")[0],"@"!==g[0]?E[x+g]=b:(a=y.slice(1))===Dn?E[C+g.replace(y,"")]=b:a===Fn?E[g.replace(y,"context")]=b:(g=g.replace(y,"resources."+a+".value"),di(p[a])||(E[g]=p[a]));m=(T=Object.keys(E)).length;var N=v(n,o),k=[],I=this.uid,R=function(){var e=v(n,o);t.call(i,e,N,n.expression),N=e};for(c=0;c<m;c+=1)g=T[c],k.push(E[g].observe(g,{uid:I,listener:R}));return function(){for(var e=k.length,t=0;t<e;t+=1)k[t]()}},e.prototype.evaluateExpression=function(e,t){return Mr.TemplateControl.evaluateExpression(e,this.parent,t)},e.prototype.findProperty=function(t,n){var i=e._parser;ni(i)||(i=Cr(w));var r,o=i.parse(t);for(di(n)&&(n=this);!di(n);){if(!di(r=o.evaluate(n)))return{expression:o,control:n,value:r};n=n.parent}},e.prototype.dispatchEvent=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=e._EventManager;ni(o)||(o=Cr(b)),o.hasDirection(n)||(vi(n)||i.unshift(n),n=o.UP);var s=this;di(s.templateControl)||(s=s.templateControl),o.dispatch(t,s,n,i)},e.prototype.on=function(t,n){var i=e._EventManager;return ni(i)||(i=Cr(b)),i.on(this.uid,t,n,this)},e.prototype.dispose=function(){},e.__eventListeners={},e}();function Fr(e,t,n,i,r,o){return Or._parser=e,Or._ContextManager=t,Or._EventManager=n,Or._Promise=i,Or._dom=r,Or._log=o,Or}e.Control=Or,e.IControlFactory=Fr,sr.injectable(v,Fr,[w,S,b,f,z,E],Cn);var Mr,Dr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateControl=null,t}return __extends(t,e),t.dispose=function(e){Li(e,"templateControl"),Or.dispose(e)},t.getInstance=function(){return new t},t}(Or);function $r(){return Dr}e.AttributeControl=Dr,e.IAttributeControlFactory=$r,sr.injectable("$AttributeControlFactory",$r,null,Cn),function(t){var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=100,t.context=null,t.absoluteContextPath=null,t.hasOwnContext=!1,t.replaceWith="any",t}return __extends(t,e),t.evaluateExpression=function(e,n,i){if(hi(e))return e;if(li(e))e=t._parser.parse(e);else if(!fi(e.evaluate))return e;return di(n)?e.evaluate(null,i):e.aliases.length>0&&hi(i=t.getResources(n,e.aliases,i))?void 0:e.evaluate(n.context,i)},t.getResources=function(e,n,i){if(di(e))return{};var r,o,s,a=n.length,l=t.__resourceCache[e.uid];di(l)&&(l=t.__resourceCache[e.uid]={}),ni(i)||(i={});for(var u=0;u<a;u+=1)if("@"===(r=n[u])[0]&&(r=r.slice(1)),r!==Dn)if(r!==Fn){if(di(i[r])){if(di(l[r]))s=t.findResource(e,r);else{var c=l[r].control,h=c.resources;s=di(h)?t.findResource(e,r):{control:c,resource:h[r]}}if(di(s)){if(-1!==e.type.indexOf(En))continue;t._log.warn("Resource alias: "+r+" is not defined.")}else l[r]=s,o=s.resource,i[r]=di(o)?o:o.value}}else i[r]=Or.getRootControl(e).context;else i[r]=e.context;return i},t.findResource=function(e,t){var n;if(!di(e)&&!di(e.resources)&&li(t)&&!hi(t)){"@"===t[0]&&(t=t.slice(1));var i=t===Fn;if(i||t===Dn||t===Mn){if(i&&(e=Or.getRootControl(e)),ni(e.resources)&&(n=e.resources[t]),di(n))return;return{resource:n,control:e}}for(;!di(e);){if(ni(e.resources)&&(n=e.resources[t]),!di(n))return{resource:n,control:e};e=e.parent}}},t.dispose=function(e){if(!di(e)){var n=e.uid,i=e.controls,r=mi(i)?i.slice(0):i,o=Or._ContextManager,s=o.defineProperty;if(!di(r))for(var a=r.length-1;a>=0;a-=1)Or.dispose(r[a]);if(fi(e.dispose)&&e.dispose(),Or.removeEventListeners(e),t.removeElement(e),t._ResourcesFactory.dispose(e),t._BindableTemplatesFactory.dispose(e),Li(t.__resourceCache,e.uid),o.dispose(e),kr.EventManager.dispose(e.uid),t._managerCache.remove(n),Or.removeParent(e),s(e,"resources",null,!0,!0,!0),e.attributes=null,e.bindableTemplates=null,e.controls=[],e.root=null,e.innerTemplate=null,e.__injectable__type===gn){var l=_r[e.type];sr.control(e.type,e.constructor,l.dependencies,!0)}}},t.loadControl=function(e){for(var n,i=e.controls,r=i.length,o=0;o<r;o+=1)di((n=i[o]).controls)?n.loaded():t.loadControl(n);e.loaded()},t.contextChanged=function(e,n,i){e.context=n,t.setContextResources(e),fi(e.contextChanged)&&e.contextChanged(n,i)},t.setContextResources=function(e){var n=e.context;di(e.resources)&&(e.resources=t._ResourcesFactory.getInstance(),e.resources.initialize(e)),e.hasOwnContext&&(di(e.resources.rootContext)?e.resources.add({root:{type:Rn,value:n}}):e.resources.rootContext.value=n),di(e.resources.context)?e.resources.add({context:{type:Rn,value:n}}):e.resources.context.value=n},t.removeElement=function(e){if(!di(e)){var t,n=e.element;if(null===e.replaceWith||""===e.replaceWith||si(n))return er(e.startNode,e.endNode),void(e.elementNodes=e.startNode=e.endNode=null);di(n)||(di(t=n.parentNode)||t.removeChild(n),e.element=null)}},t.setAbsoluteContextPath=function(e,t){Or._ContextManager.defineGetter(e,"absoluteContextPath",t,!1,!0)},t.determineTemplate=function(e,n){var i=t._templateCache,r=e.dom,o=t._Promise;if(di(n)){if(di(e.templateUrl)){if(di(e.templateString))return o.reject(null);var s=e.type;return i.read(s).catch(function(t){return di(t)&&(t=e.templateString),i.put(s,t)})}n=e.templateUrl}else;return r.getTemplate(n)},t.detach=function(e){if(!di(e)&&!di(e.controls)){for(var n=e.controls.slice(0),i=n.length,r=0;r<i;r+=1)Or.dispose(n[r]);Or.removeEventListeners(e),t.removeElement(e),t._ResourcesFactory.dispose(e,!0),Li(t.__resourceCache,e.uid),Or._ContextManager.dispose(e),kr.EventManager.dispose(e.uid),t._managerCache.remove(e.uid),Or.removeParent(e),e.controls=[],e.attributes=null}},t.getInstance=function(){return new t},t.prototype.contextChanged=function(e,t){},t.prototype.setTemplate=function(){},t.prototype.getResources=function(e,n){return t.getResources(this,e,n)},t.prototype.findResource=function(e){return t.findResource(this,e)},t.prototype.evaluateExpression=function(e,n){return t.evaluateExpression(e,this,n)},t.__resourceCache={},t}(Or);function i(e,t,i,r,o,s,a,l){return n._ResourcesFactory=e,n._BindableTemplatesFactory=t,n._managerCache=i,n._templateCache=r,n._parser=o,n._http=s,n._Promise=a,n._log=l,n}t.TemplateControl=n,t.ITemplateControlFactory=i,sr.injectable(V,i,[U,$,O,F,w,h,f,E],Cn),sr.injectable(q,n,null,bn);var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=120,t._listeners=[],t}return __extends(t,e),t.prototype.onInput=function(e){var t=this._listeners;return t.push(e),function(){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},t.prototype.observeProperties=function(e){},t.prototype.inputChanged=function(e,t){if(e!==t)for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](e,t)},t.prototype.dispose=function(){this._listeners=[]},t}(n);t.BindControl=r;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasOwnContext=!0,t}return __extends(t,e),t.dispose=function(e){n.dispose(e)},t.getInstance=function(){return new t},t.prototype.canNavigateFrom=function(){},t.prototype.canNavigateTo=function(e,t){},t.prototype.navigatingFrom=function(){},t.prototype.navigatedTo=function(e,t){},t}(n);t.ViewControl=c;var p=function(){function t(){this._domEvents=Cr(B)}return t.prototype.addEventListener=function(e,t,n,i){return this._domEvents.addEventListener(e,t,n,i)},t.prototype.appendChildren=function(e,t){return Hi(e,t)},t.prototype.cloneChildren=function(e,t){return Hi(e,t,!0)},t.prototype.clearNode=function(e){Qi(e)},t.prototype.clearNodeBlock=function(e,t){Yi(e,t)},t.prototype.setInnerHtml=function(e,t){return Wi(e,t)},t.prototype.insertBefore=function(e,t,n){return Xi(e,t,n)},t.prototype.replace=function(e){return Gi(e)},t.prototype.replaceWith=function(e,t){return Ji(e,t)},t.prototype.serializeHtml=function(e){return Ki(e)},t.prototype.removeBetween=function(e,t){Zi(e,t)},t.prototype.removeAll=function(e,t){er(e,t)},t.prototype.addClass=function(e,t){ir(e,t)},t.prototype.removeClass=function(e,t){rr(e,t)},t.prototype.toggleClass=function(e,t){!function(e,t){ni(e)||(e={});var n=e.className;if(li(n)&&li(t)&&""!==t){var i,r=t.split($i);if(vi(e.classList)){var o=void 0;if(""===n)e.className=t;else if(n===t)return void(e.className="");for(;r.length>0;)if(""!==(i=r.shift())){if((o=new RegExp("^"+i+"\\s+|\\s+"+i+"$|\\s+"+i+"\\s+","g")).test(n)){e.className=n=n.replace(o,"");continue}e.className+=" "+i}}else for(;r.length>0;)""!==(i=r.shift())&&e.classList.toggle(i)}}(e,t)},t.prototype.replaceClass=function(e,t,n){!function(e,t,n){ni(e)||(e={});var i=e.className;if(li(i)&&li(n)&&""!==n)if(vi(e.classList)){var r=new RegExp("^"+t+"\\s+","g"),o=new RegExp("\\s+"+t+"\\s+","g"),s=new RegExp("\\s+"+t+"$","g");e.className=i.replace(r,n+" ").replace(o," "+n+" ").replace(s," "+n)}else e.classList.add(n),e.classList.remove(t)}(e,t,n)},t.prototype.hasClass=function(e,t){return or(e,t)},t.prototype.getTemplate=function(t){return n=t,ni(s)||(s=e.acquire(F)),ni(a)||(a=e.acquire(h)),s.put(n,s.read(n).catch(function(e){if(di(e))return a.ajax({url:n})}).then(function(t){if(si(t))return s.put(n,t);if(!ni(t)||!li(t.response))return ni(l)||(l=e.acquire(E)),l.warn("No template found at "+n),s.put(n);var i=t.response;return hi(i.trim())?s.put(n):s.put(n,i)}).catch(function(t){return ki(function(){ni(l)||(l=e.acquire(E)),l.error(new Error("Failure to get template from "+n+"."))}),t}));var n},t.prototype.whenPresent=function(t,n){return function(t,n){if(!oi(n))return ni(l)||(l=e.acquire(E)),l.error(new Error("Attempting to check DOM presence of something that isn't a Node.")),Kn;ni(o)||(o=e.acquire(m));var i=o.body;if(oi(n.parentElement)&&i.contains(n))return t(),Kn;var r=Ii(function(){oi(n.parentElement)&&i.contains(n)&&(r(),t())},100);return r}(t,n)},t.prototype.whenVisible=function(t,n){return function(t,n){if(!oi(n))return ni(l)||(l=e.acquire(E)),l.error(new Error("Attempting to check visibility of something that isn't a Node.")),Kn;var i=n.clientWidth,r=n.clientHeight;if(!_i(i)||!_i(r))return ni(l)||(l=e.acquire(E)),l.error(new Error("Attempting to check visibility of something that isn't an Element.")),Kn;if(i>0&&r>0)return t(),Kn;var o=Ii(function(){n.clientWidth>0&&n.clientHeight>0&&(o(),t())},100);return o}(t,n)},t._inject={_domEvents:B},t}();t.Dom=p,sr.injectable(z,p);var _=function(){function e(){this._ResourcesFactory=Cr(U),this._ControlFactory=Cr(v),this._TemplateControlFactory=Cr(V),this._ContextManager=Cr(S),this._Promise=Cr(f),this._managerCache=Cr(O),this._document=Cr(m),this._ElementManagerFactory=Cr(j),this._BindableTemplatesFactory=Cr($),this._log=Cr(E),this.templates={},this.cache={},this.__compiledControls=[]}return e.create=function(t,n){var i=new e;return i.control=t,di(n)||(i.templates=n.templates,i.cache=n.cache),i},e.dispose=function(e){if(!di(e)){var t=e.bindableTemplates;!di(t)&&fi(t.dispose)&&t.dispose()}},e.isBoundControl=function(e){if(di(e))return!1;var t=e.parent;return!di(t)&&0===e.type.indexOf(t.type+wn)},e.prototype.once=function(e,t,n){var i,r=this;if(di(e))return this._Promise.resolve(this._document.createDocumentFragment());if(li(e))i=Ki(e);else if(si(e))i=e;else if(i=this._document.createDocumentFragment(),oi(e))i.appendChild(e);else{if(!gi(e))return this._Promise.resolve(i);Hi(e,i)}if(di(t)||_i(t)||li(t)){var o=this.control,s=this._managerCache.read(o.uid),a=this._ElementManagerFactory.getInstance(),l=this._createBoundControl("",i,t,n),u=this._createNodeMap(l,i,t);return o.controls.push(l),s.children=[],a.initialize(u,s),a.setUiControlTemplate(),a.fulfillAndLoad().then(function(){var e=r._document;return l.startNode=i.insertBefore(e.createComment(l.type+Nn),i.firstChild),l.endNode=i.insertBefore(e.createComment(l.type+kn),null),i})}this._log.warn(this.control.type+" using relativeIdentifier: "+t+", need a string or number")},e.prototype.bind=function(e,t,n){return this._bind(e,t,n)},e.prototype.add=function(e,t,n){if(hi(e))this._log.debug(this.control.type+" must use a valid key to add a template to BindableTemplates.");else if((di(this.templates[e])||n)&&!di(t))if(li(t))this._compile(e,Ki(t));else if(si(t))this._compile(e,t);else{var i=this._document.createDocumentFragment();if(oi(t))i.appendChild(t);else{if(!gi(t))return;Hi(t,i)}this._compile(e,i)}},e.prototype.replace=function(t,n,i,r){var o=this.control.controls[t];if(!e.isBoundControl(o))return this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" is not a bound control."),this._Promise.resolve([]);var s=o.endNode;return oi(s)&&oi(s.parentNode)?this._bind(n,i,r,t):(this._log.warn("The child control of "+this.control.type+" at the specified index: "+t+" needs place-holding comment nodes."),this._Promise.resolve([]))},e.prototype.dispose=function(){for(var e=this._TemplateControlFactory.dispose,t=this.__compiledControls,n=t.length,i=0;i<n;i+=1)e(t[i]);this.__compiledControls=[],this.control=null,this.cache={},this.templates={}},e.prototype._bind=function(e,t,n,i){var r=this,o=this.templates[e],s=di(i);if(di(o))this._log.error(new Error(this.control.type+" cannot bind template, no template stored with key: "+e));else{if(di(t)||_i(t)||li(t))return o=o.then(function(i){var o=i.cloneNode(!0),a=r._createBoundControl(e,o,t,n),l=r._createNodeMap(a,o,t);return s&&r.control.controls.push(a),r._bindTemplate(e,l)}),s?o.then(null,function(e){return ki(function(){li(e)&&(e=new Error(e)),r._log.error(e)}),r._document.createDocumentFragment()}):o.then(function(e){var t=Array.prototype.slice.call(e.childNodes),n=r.control.controls[i],o=n.endNode,s=o.parentNode,a=o.nextSibling;return r._TemplateControlFactory.dispose(n),s.insertBefore(e,a),t}).then(null,function(e){return ki(function(){li(e)&&(e=new Error(e)),r._log.error(e)}),r._document.createDocumentFragment()});this._log.warn(this.control.type+" trying to bind: "+t+". Identifier must be either a string or number")}},e.prototype._bindTemplate=function(e,t){var n=this,i=t.uiControlNode.control,r=!1,o=fi(i.dispose)?i.dispose.bind(i):Kn;return i.dispose=function(){r=!0,o(),i.dispose=o},this._bindNodeMap(e,t).then(function(){var e=n._document,o=t.element;return r?e.createDocumentFragment():(i.startNode=o.insertBefore(e.createComment(i.type+Nn),o.firstChild),i.endNode=o.insertBefore(e.createComment(i.type+kn),null),o)},function(e){return ki(function(){li(e)&&(e=new Error(e)),n._log.error(e)}),null})},e.prototype._bindNodeMap=function(e,t){var n=this.cache[e],i=t.uiControlNode.control,r=t.element,o=this._managerCache;return n.clone(r,o.read(this.control.uid),t),o.read(i.uid).bindAndLoad()},e.prototype._compile=function(e,t){var n=this._createBoundControl(e+En,t),i=this._createNodeMap(n,t);this.__compiledControls.push(n),this._compileNodeMap(n,i,e)},e.prototype._compileNodeMap=function(e,t,n){var i=this,r=this._ElementManagerFactory.getInstance(),o=[];r.isClone=!0,r.initialize(t,null),r.setUiControlTemplate(),this.cache[n]=r,o.push(r.fulfillTemplate()),this.templates[n]=this._Promise.all(o).then(function(){var n=t.element,r=n.cloneNode(!0),o=i._document,s=e.startNode=o.createComment(e.type+Nn),a=e.endNode=o.createComment(e.type+kn);return n.insertBefore(s,n.firstChild),n.insertBefore(a,null),r})},e.prototype._createNodeMap=function(e,t,n){return{element:t,attributes:{},nodes:[],childContext:n,uiControlNode:{control:e,nodeName:e.type,expressions:[],injector:null}}},e.prototype._createBoundControl=function(e,t,n,i){var r=this._TemplateControlFactory.getInstance(),o=this._ResourcesFactory,s=this.control,a=this.cache[e],l=ni(a),c=o.getInstance();if(l){var h=a.getUiControl();c.initialize(r,h.resources),c.add(i)}else c.initialize(r,i);if(r.resources=c,o.addControlResources(r),r.bindableTemplates=this._BindableTemplatesFactory.create(r,s.bindableTemplates),r.parent=s,r.controls=[],r.element=t,r.type=s.type+wn+e,r.root=this._ControlFactory.getRootControl(r),l){var p=this._ContextManager.getManager(r.root);r.absoluteContextPath=s.absoluteContextPath,li(r.absoluteContextPath)||(r.absoluteContextPath=u),di(n)||(r.absoluteContextPath+="."+n),r.context=p.getContext(r.absoluteContextPath.split("."),!1)}return r},e}();function g(){return _}t.BindableTemplates=_,t.IBindableTemplatesFactory=g,sr.injectable($,g,null,Cn);var y=function(){function e(){this.__listeners={}}return e.getInstance=function(){return new e},e.prototype.initialize=function(e,t){this.__control=e;for(var n,i=Object.keys(t),r=this.__listeners,o=i.length,s=0;s<o;s+=1)this[n=i[s]]=t[n],r[n]=[]},e.prototype.observe=function(e,t){var n=this.__listeners[Ai(t)];return di(n)?Kn:(e=e.bind(this.__control),n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)})},e.prototype._attributeChanged=function(e,t,n){for(var i=this.__listeners[Ai(e)],r=i.length,o=0;o<r;o+=1)i[o](t,n)},e}();function b(){return y}t.Attributes=y,t.IAttributesFactory=b,sr.injectable("$AttributesInstance",y,null,bn),sr.injectable(D,b,null,Cn);var C=function(){function e(){this.__resources={},this.__bound=!1}return e.create=function(t,n){if(di(n))return n;var i;switch(n.type.toLowerCase()){case jn:var r=vr[n.value];di(r)||(n.value=r.inject());break;case Rn:e._observeResource(t,n);break;case An:li(i=n.value)&&(n.value=t.evaluateExpression(i));break;case Pn:break;case Ln:li(i=n.value)&&(fi(i=t[i])?n.value=i.bind(t):(e._log.warn('Attempted to create a "function" type Resource, but the function '+i+" cannot be found on your control."),n.value=Kn))}return n},e.addControlResources=function(t){t.resources.add({context:{value:t.context,type:Rn},control:{value:t,type:An}}),t.hasOwnContext&&e.__addRoot(t)},e.bindResources=function(t){var n=t.__resources;if(!di(n)){for(var i,r=t.__controlInstance,o=Object.keys(n),s=e.__controlResources,a=o.length,l=0;l<a;l+=1)!0!==s[i=o[l]]&&(t[i]=n[i]=e.create(r,t[i]));t.__bound=!0}},e.dispose=function(t,n){var i=t.resources;if(!di(i)){for(var r,o,s=Object.keys(i.__resources),a=s.length,l=e._ContextManager.defineProperty,u=0;u<a;u+=1)di(o=i[r=s[u]])||o.type!==Rn&&o.type!==Pn||l(i,r,n?ti(o,!0):null,!0,!0,!0);e._removeListeners(i.__controlInstance)}},e.parseElement=function(t){for(var n,i,r,o,s,a=Array.prototype.slice.call(t.children),l=e._regex,u=l.whiteSpaceRegex,c=l.quotationRegex,h={},p=e.__resourceTypes;a.length>0;)p[o=(n=a.pop()).nodeName.toLowerCase()]&&(i={},di(r=n.attributes.getNamedItem("alias"))||(i.alias=r.value,hi(s=n.textContent.replace(u,"$1"))||(i.value=o===jn||o===Pn?s.replace(c,""):s,i.type=o,h[i.alias]=i)));return h},e.getInstance=function(){return new e},e._observeResource=function(t,n){var i=t.uid,r=n.value,o=e.__observableResourceRemoveListeners[i];if(di(o)&&(o=e.__observableResourceRemoveListeners[i]=[]),li(r)){di(n.initialValue)?n.initialValue=r:r=n.initialValue;var s=t.observeExpression(function(e){n.value=e},r);n.value=t.evaluateExpression(r),o.push(s)}},e._removeListeners=function(t){if(!di(t)){var n=t.uid,i=e.__observableResourceRemoveListeners[n];if(mi(i))for(var r=i.length,o=0;o<r;o+=1)i[o]();Li(e.__observableResourceRemoveListeners,n)}},e.__addRoot=function(e){e.resources.add({root:{value:e,type:An,alias:On},rootContext:{value:e.context,type:Rn,alias:Fn}})},e.prototype.initialize=function(t,n){if(this.__controlInstance=t,!di(n)){oi(n)?n=e.parseElement(n):ni(n.resources)&&(n=n.resources),this.__resources=n;for(var i,r=Object.keys(n),o=r.length,s=0;s<o;s+=1)this[i=r[s]]=n[i]}},e.prototype.add=function(t){if(!di(t)){oi(t)&&(t=e.parseElement(t));for(var n,i,r=Object.keys(t),o=r.length,s=this.__controlInstance,a=this.__bound,l=e.create,u=0;u<o;u+=1)(n=t[i=r[u]]).alias=i,this[i]=this.__resources[i]=a?l(s,n):n}},e.INJECTABLE=jn,e.OBJECT=An,e.OBSERVABLE=Rn,e.LITERAL=Pn,e.FUNCTION=Ln,e.__observableResourceRemoveListeners={},e}();function x(e,t,n){C._ContextManager=e,C._regex=t,C._log=n;var i={},r={};return i[Mn]=i[Dn]=i[On]=i[Fn]=!0,r[jn]=r[An]=r[Rn]=r[Ln]=r[Pn]=!0,C.__controlResources=i,C.__resourceTypes=r,C}t.Resources=C,t.IResourcesFactory=x,sr.injectable(U,x,[S,T,E],Cn),sr.injectable("$ResourcesInstance",C,null,bn);var N=function(){function e(){this._gestures=e.gestures,this._androidVersion=vi(this._compat.ANDROID)?-1:this._compat.ANDROID,this._android44orBelow=this._androidVersion>-1&&Math.floor(this._androidVersion/10)<=44,this._inMouse=!1,this._subscribers={},this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__hasMoved=!1,this.__hasRelease=!1,this.__detectingMove=!1,this.__tapCount=0,this.__touchCount=0,this.__cancelDeferredTap=Kn,this.__cancelDeferredHold=Kn,this.__cancelRegex=/cancel/i,this.__pointerEndRegex=/up|cancel/i,this.__haveSwipeSubscribers=!1,this.__blurRemover=Kn,this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__boundPreventDefaultClick=this.__preventDefaultClick.bind(this),this.__reverseMap={},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this.__pointerHash={},this.__pointerEvents=[],this.__listeners={},this.__getTypes(),this.initialize()}return e.prototype.addEventListener=function(e,t,n,i){var r=this,o=this._compat,s=o.mappedEvents[t],a=!di(s),l=this.__mappedCount,u=this._gestures,c=!1;if(a&&(this.__reverseMap[s]=t,this.__registerElement(e,t),l[t]+=1,o.hasTouchEvents&&!this.__cancelRegex.test(s)&&(s=s.replace("touch","mouse").replace("start","down").replace("end","up"),this.__reverseMap[s]=t)),e.addEventListener(t,n,i),!vi(e["on"+t])||vi(u[t])||a)return function(){c||(a&&(l[t]>0&&(l[t]-=1),r.__unregisterElement(e,t)),c=!0,e.removeEventListener(t,n,i))};var h=u.$swipe,p=u.$track,_=t;if(-1!==t.indexOf(p)){var f=u.$trackend;_=t===f?f:p}else-1!==t.indexOf(h)&&(_=h);return this._gestureCount[_]+=1,this.__registerElement(e,t),function(){c||(c=!0,r.__removeEventListener(e,t,n,i))}},e.prototype.initialize=function(){var e=this._isActive;!0!==e&&(this.__registerTypes(),di(e)&&this.__appendGestureStyle(),this._isActive=!0)},e.prototype.dispose=function(){this.__unregisterTypes(),this.__blurRemover(),this.__blurRemover=Kn,this._gestureCount={$tap:0,$dbltap:0,$hold:0,$release:0,$swipe:0,$track:0,$trackend:0},this.__mappedCount={$touchstart:0,$touchmove:0,$touchend:0,$touchcancel:0},this._isActive=!1,this._subscribers={},this.__pointerEvents=[],this.__pointerHash={},this.__reverseMap={},this.__ignoreEvent={mousedown:!1,mouseup:!1},this.__tapCount=this.__touchCount=0,this.__detectingMove=this.__hasMoved=this.__hasRelease=this.__haveSwipeSubscribers=!1,this.__lastMoveEvent=this.__lastTouchDown=this.__lastTouchUp=null,this.__swipeOrigin=this.__capturedTarget=this.__focusedElement=this.__delayedClickRemover=null,this.__cancelDeferredHold=this.__cancelDeferredTap=Kn},e.prototype._onTouchStart=function(t){var n=this,i=t.type;if(this.__ignoreEvent[i])return this.__ignoreEvent[i]=!1,this.__delayedClickRemover[i](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),!1);if(this.__touchCount>0)return this.__touchCount+=1,!0;if(this.__touchCount+=1,"mousedown"!==i)this._inTouch=!0;else{if(!0===this._inTouch)return t.preventDefault(),!1;this._compat.hasTouchEvents&&(this._inMouse=!0)}if(di(t=this.__standardizeEventObject(t)))return!0;this.__lastMoveEvent=null,this.__hasMoved=!1;var r=t.clientX,o=t.clientY,s=t.timeStamp,a=t.target,l=this._gestures;this.__lastTouchDown={_buttons:t._buttons,clientX:r,clientY:o,timeStamp:s,target:a,identifier:t.identifier},this.__swipeOrigin={clientX:r,clientY:o,xTimestamp:s,yTimestamp:s,xTarget:a,yTarget:a},this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(a,[l.$swipe,l.$swipedown,l.$swipeleft,l.$swiperight,l.$swipeup]).length>0);var u=this._gestureCount,c=u.$hold<=0,h=u.$release<=0;if(c&&h)return this.__handleMappedEvents(i,t,t),this.__registerMove(i),!0;var p,_,f,d=e.config.intervals.holdInterval;if(c)return this.__hasRelease=!1,this.__cancelDeferredHold=Si(function(){n.__hasRelease=!0},d),this.__handleMappedEvents(i,t,t),this.__registerMove(i),!0;h?(f=!di(p=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(_=function(){p.trigger(t),n.__cancelDeferredHold=Kn}):(this.__hasRelease=!1,(f=!di(p=this.__findFirstSubscriber(t.target,this._gestures.$hold)))&&(_=function(){p.trigger(t),n.__hasRelease=!0,n.__cancelDeferredHold=Kn})),f&&(this.__cancelDeferredHold=Si(_,d)),this.__handleMappedEvents(i,t,t),this.__registerMove(i)},e.prototype._onTouchMove=function(t){this.__cancelDeferredHold(),this.__cancelDeferredHold=Kn;var n=t.type;if(!0===this._inTouch&&"mousemove"===n)return!0;var i=this.__standardizeEventObject(t);if(di(i))return!0;var r=this._gestureCount,o=r.$track<=0,s=r.$swipe<=0,a=e.config,l=this.__swipeOrigin,u=i.clientX,c=i.clientY,h=this.__hasMoved;if(h||(h=this.__getDistance(l.clientX,u,l.clientY,c)>=a.distances.minScrollDistance),!h)return this.__handleMappedEvents(n,t,i),!0;if(this.__hasMoved=!0,o&&s)return this.__handleMappedEvents(n,t,i),!0;var p=this.__lastMoveEvent;ni(p)||(p=l);var _=i.direction=this.__getDirection(u-p.clientX,c-p.clientY);this.__handleOriginChange(_);var f=Math.abs(u-l.clientX),d=Math.abs(c-l.clientY);i.velocity=this.__getVelocity(f,d,i.timeStamp-l.xTimestamp,i.timeStamp-l.yTimestamp),!s&&this._android44orBelow&&this.__haveSwipeSubscribers&&t.preventDefault(),o||this.__handleTrack(i,t),this.__handleMappedEvents(n,t,i),this.__lastMoveEvent=i},e.prototype._onTouchEnd=function(t){var n=this,i=t.type;if(this.__ignoreEvent[i])return this.__ignoreEvent[i]=!1,this.__delayedClickRemover[i](),t.target===this.__focusedElement||(!0===t.cancelable&&t.preventDefault(),ki(function(){var e=n.__lastTouchUp;ni(e)||(e={});var t=e.target;n._document.body.contains(t)&&n.__handleInput(t)}),!1);var r=this.__hasMoved,o="mouseup"!==i;if(o){if("touchend"===i){if(r)!0===t.cancelable&&t.preventDefault();else{if(!0!==this._inTouch)return!0===t.cancelable&&t.preventDefault(),this.__preventClickFromTouch(),this.__touchCount=0,!0;t.target!==this.__focusedElement&&this.__handleInput(t.target)&&!0===t.cancelable&&t.preventDefault()}this.__preventClickFromTouch()}}else if(!vi(this._inTouch)){if(!this._inMouse)return!0===t.cancelable&&t.preventDefault(),!1;this._inMouse=!1}if(this.__cancelRegex.test(i))return this.__handleCanceled(t),!0;if(this.__touchCount<=0?this.__touchCount=0:this.__touchCount-=1,di(t=this.__standardizeEventObject(t)))return!0;o&&(this._inTouch=!1),this.__touchCount>0&&(this.__touchCount=t._touches.length),this.__clearTempStates(),this.__hasRelease&&this.__handleRelease(t),this.__handleSwipe();var s=e.config,a=s.intervals,l=t.timeStamp,u=this.__lastTouchDown;if(r)return this.__handleTrackEnd(t),this.__handleMappedEvents(i,t,t),this.__tapCount=0,this.__capturedTarget=null,!0;if(di(u)||l-u.timeStamp>a.tapInterval)return this.__handleMappedEvents(i,t,t),this.__tapCount=0,this.__capturedTarget=null,!0;var c=this.__lastTouchUp,h=t.clientX,p=t.clientY;this.__tapCount>0&&this.__getDistance(h,c.clientX,p,c.clientY)<=s.distances.maxDblTapDistance&&l-c.timeStamp<=a.dblTapInterval?this.__handleDbltap(t):this.__tapCount=0,this.__handleTap(t),this.__handleMappedEvents(i,t,t),this.__lastTouchUp=t,this.__capturedTarget=null},e.prototype.__clearTempStates=function(){this.__cancelDeferredHold(),this.__cancelDeferredHold=Kn,this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1)},e.prototype.__resetTouchEnd=function(){this.__tapCount=this.__touchCount=0,this._inTouch=this.__hasRelease=!1,this.__pointerHash={},this.__pointerEvents=[],this.__capturedTarget=null},e.prototype.__handleCanceled=function(e){var t=e.touches;ni(t)||(t=this.__pointerEvents);var n=this.__getTouchIndex(t),i=e.type;e=n>=0?t[n]:this.__standardizeEventObject(e),this._inTouch=!1,this.__clearTempStates(),this.__hasMoved&&(this._android44orBelow&&this.__handleSwipe(),this.__handleTrackEnd(e)),this.__handleMappedEvents(i,e,e),this.__resetTouchEnd()},e.prototype.__handleMappedEvents=function(e,t,n){var i=this.__reverseMap[e];if(this.__mappedCount[i]>0){var r=this.__findFirstSubscriber(t.target,i);di(r)||r.trigger(n)}},e.prototype.__handleTap=function(t){var n=this,i=t.target,r=this.__lastTouchDown;ni(r)||(r={});var o=r.target;if(this.__tapCount+=1,!(this._gestureCount.$tap<=0||di(o)||o!==i&&fi(o.contains)&&!o.contains(i)&&fi(i.contains)&&!i.contains(o))){var s=this._gestures,a=this.__findFirstSubscriber(i,s.$tap);if(!di(a))return e.config.intervals.dblTapZoomDelay<=0||"mouse"===t.pointerType||"mouseup"===t.type?(t._buttons=r._buttons,void a.trigger(t)):void(this.__cancelDeferredTap=Si(function(){t._buttons=r._buttons,a.trigger(t),n.__tapCount=0,n.__cancelDeferredTap=Kn},e.config.intervals.dblTapZoomDelay))}},e.prototype.__handleDbltap=function(e){if(this.__tapCount=0,this.__cancelDeferredTap(),this.__cancelDeferredTap=Kn,!(this._gestureCount.$dbltap<=0)){var t=this.__findFirstSubscriber(e.target,this._gestures.$dbltap);di(t)||(e._buttons=this.__lastTouchDown._buttons,t.trigger(e),this.__tapCount=-1)}},e.prototype.__handleRelease=function(e){var t=this.__findFirstSubscriber(e.target,this._gestures.$release);di(t)||t.trigger(e),this.__hasRelease=!1},e.prototype.__handleSwipe=function(){if(!(this._gestureCount.$swipe<=0)){var e=this.__lastMoveEvent;if(!di(e)){for(var t=this.__swipeOrigin,n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY),r=this.__getRegisteredSwipes(e.direction,e.velocity,n,i);r.length>0;)r.pop().trigger(e);this.__lastMoveEvent=null}}},e.prototype.__handleTrack=function(e,t){var n=this._gestures,i=n.$track,r=e.direction,o=this.__capturedTarget;ni(o)||(o=e.target);var s=this.__findFirstSubscribers(o,[i,i+r.x,i+r.y]);this._android44orBelow&&(this.__findFirstSubscribers(o,[i,n.$trackdown,n.$trackup,n.$trackleft,n.$trackright,n.$trackend]).length>0&&t.preventDefault());if(s.length>0)for(this._androidVersion>-1&&t.preventDefault();s.length>0;)s.pop().trigger(e)},e.prototype.__handleTrackEnd=function(e){if(!(this._gestureCount.$trackend<=0)){var t=this.__capturedTarget;ni(t)||(t=e.target);var n=this.__findFirstSubscriber(t,this._gestures.$trackend);di(n)||n.trigger(e)}},e.prototype.__getTypes=function(){var e,t,n,i=this._compat,r=i.mappedEvents,o=this.__listeners;if(i.hasPointerEvents)e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+" "+r.$touchcancel;else if(i.hasTouchEvents)e=this._startEvents=r.$touchstart+" mousedown",t=this._moveEvents=r.$touchmove+" mousemove",n=this._endEvents=r.$touchend+" mouseup "+r.$touchcancel;else{var s=r.$touchcancel;e=this._startEvents=r.$touchstart,t=this._moveEvents=r.$touchmove,n=this._endEvents=r.$touchend+(hi(s)?"":" "+s)}o[e]=this._onTouchStart.bind(this),o[t]=this._onTouchMove.bind(this),o[n]=this._onTouchEnd.bind(this)},e.prototype.__registerTypes=function(){this.__registerType(this._startEvents),this.__registerType(this._endEvents),this._document.addEventListener("dragstart",this.__preventDefault,!1)},e.prototype.__unregisterTypes=function(){this.__unregisterType(this._startEvents),this.__unregisterType(this._endEvents),this.__detectingMove&&(this.__unregisterType(this._moveEvents),this.__detectingMove=!1),this._document.removeEventListener("dragstart",this.__preventDefault,!1)},e.prototype.__registerType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;r>0;)r-=1,n.addEventListener(i[r],t,!1)},e.prototype.__unregisterType=function(e){for(var t=this.__listeners[e],n=this._document,i=e.split(" "),r=i.length;r>0;)r-=1,n.removeEventListener(i[r],t,!1)},e.prototype.__registerMove=function(e){var t=this._gestureCount;("touchstart"===e||this.__mappedCount.$touchmove>0||t.$track>0||t.$trackend>0||t.$swipe>0)&&(this.__registerType(this._moveEvents),this.__detectingMove=!0)},e.prototype.__registerElement=function(t,n){var i,r,o=t.__plat;if(di(o)?(i=ji("domEvent_"),t.__plat=o={domEvent:i}):di(o.domEvent)&&(i=ji("domEvent_"),o.domEvent=i),di(i)){var s=this._subscribers[o.domEvent];return vi(s[n])?(r=new A(t,n),s[n]=r):s[n].count+=1,void(s.gestureCount+=1)}var a={gestureCount:1};r=new A(t,n),a[n]=r,this._subscribers[i]=a,vi(t.className)||ir(t,e.config.styleConfig[0].className),this.__removeSelections(t)},e.prototype.__unregisterElement=function(e,t){var n=e.__plat;if(!di(n)&&!di(n.domEvent)){var i=n.domEvent,r=this._subscribers[i],o=r[t];di(o)||(o.count-=1,0===o.count&&Li(r,t),r.gestureCount-=1,0===r.gestureCount&&(Li(this._subscribers,i),this.__removeElement(e)))}},e.prototype.__setTouchPoint=function(e){var t=e.type,n=this._compat;n.hasPointerEvents||n.hasMsPointerEvents?this.__updatePointers(e,this.__pointerEndRegex.test(t)):e.pointerType=-1===t.indexOf("mouse")?"touch":"mouse"},e.prototype.__setCapture=function(e){di(this.__capturedTarget)&&!ri(e)&&(this.__capturedTarget=e)},e.prototype.__updatePointers=function(e,t){var n,i=e.pointerId,r=this.__pointerHash,o=r[i];if(t)vi(o)||((n=this.__pointerEvents.indexOf(o))>-1&&this.__pointerEvents.splice(n,1),Li(this.__pointerHash,i));else{if(1===i&&!hi(r))return;e.identifier=e.pointerId,n=this.__pointerEvents.indexOf(o),vi(o)||n<0?this.__pointerEvents.push(e):this.__pointerEvents.splice(n,1,e),r[i]=e}},e.prototype.__findFirstSubscriber=function(e,t){var n,i;if(!di(e))do{if(!vi(n=e.__plat)&&!vi(n.domEvent)&&!vi(i=this._subscribers[n.domEvent][t]))return i}while(!di(e=e.parentNode))},e.prototype.__findFirstSubscribers=function(e,t){if(di(e))return[];var n,i,r,o,s,a=[];do{if(!vi(n=e.__plat)&&!vi(n.domEvent))for(i=this._subscribers[n.domEvent],r=Object.keys(i);r.length>0;)o=r.pop(),-1!==(s=t.indexOf(o))&&(a.push(i[o]),t.splice(s,1))}while(t.length>0&&!di(e=e.parentNode));return a},e.prototype.__removeEventListener=function(e,t,n,i){var r=this._gestures;e.removeEventListener(t,n,i);var o=r.$swipe,s=r.$track,a=t;if(-1!==t.indexOf(s)){var l=r.$trackend;a=t===l?l:s}else-1!==t.indexOf(o)&&(a=o);this._gestureCount[a]-=1,this.__unregisterElement(e,t)},e.prototype.__removeElement=function(t){this.__returnSelections(t),vi(t.className)||rr(t,e.config.styleConfig[0].className);var n=t.__plat;Li(n,"domEvent"),hi(n)&&Li(t,"__plat")},e.prototype.__standardizeEventObject=function(e){this.__setTouchPoint(e);var t,n=-1!==this._startEvents.indexOf(e.type),i=e.changedTouches,r=!vi(i),o=e.timeStamp,s=e.touches;if(ni(s)||(s=this.__pointerEvents),r)if(n)t=e.preventDefault.bind(e),(e=i[0]).preventDefault=t;else{var a=this.__getTouchIndex(i);if(a>=0)t=e.preventDefault.bind(e),(e=i[a]).preventDefault=t;else if(this.__getTouchIndex(s)>=0)return null}return n&&this.__setCapture(e.target),this.__normalizeButtons(e),e._touches=s,e.offset=this.__getOffset(e),(vi(e.timeStamp)||o>e.timeStamp)&&(e.timeStamp=o),e},e.prototype.__normalizeButtons=function(e){var t;if(_i(e.buttons)&&0!==e.buttons)t=e.buttons;else if(_i(e.which)&&e.which>0)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}e._buttons=t},e.prototype.__getTouchIndex=function(e){var t=this.__lastTouchDown;ni(t)||(t={});for(var n=t.identifier,i=e.length,r=0;r<i;r+=1)if(e[r].identifier===n)return r;return-1},e.prototype.__getOffset=function(e){var t,n,i=this.__capturedTarget;if(ni(i)||(i=e.target),ri(i))return{x:e.clientX,y:e.clientY};if(!vi(e.offsetX)&&!vi(e.offsetY)&&i===e.target)return{x:e.offsetX,y:e.offsetY};if(fi(i.getBoundingClientRect)){var r=i.getBoundingClientRect();t=r.left,n=r.top}else for(t=i.offsetLeft,n=i.offsetTop;!di(i=i.offsetParent);)t+=i.offsetLeft,n+=i.offsetTop;return{x:e.clientX-t,y:e.clientY-n}},e.prototype.__getDistance=function(e,t,n,i){var r=t-e,o=i-n;return Math.sqrt(r*r+o*o)},e.prototype.__getVelocity=function(e,t,n,i){var r=0,o=0;return n>0&&(r=e/n),i>0&&(o=t/i),isFinite(r)||(r=0),isFinite(o)||(o=0),{x:r,y:o}},e.prototype.__getDirection=function(e,t){var n=Math.abs(e),i=Math.abs(t),r=this.__lastMoveEvent;ni(r)||(r={});var o=r.direction;ni(o)&&(o={x:"none",y:"none",primary:"none"});var s=o.x,a=o.y,l=o.primary;hi(s)&&(s="none"),hi(a)&&(a="none"),hi(l)&&(l="none");var u=0===e?s:e<0?"left":"right",c=0===t?a:t<0?"up":"down";return{x:u,y:c,primary:n===i?l:n>i?u:c}},e.prototype.__handleOriginChange=function(e){var t=this.__lastMoveEvent;if(!di(t)){var n=t.direction,i=n.x===e.x,r=n.y===e.y;if(!i||!r){var o=this.__swipeOrigin,s=this._gestures,a=[s.$swipe,s.$swipedown,s.$swipeleft,s.$swiperight,s.$swipeup];i||(o.clientX=t.clientX,o.xTimestamp=t.timeStamp,o.xTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.xTarget,a).length>0)),r||(o.clientY=t.clientY,o.yTimestamp=t.timeStamp,o.yTarget=t.target,this._android44orBelow&&(this.__haveSwipeSubscribers=this.__findFirstSubscribers(o.yTarget,a).length>0))}}},e.prototype.__getRegisteredSwipes=function(t,n,i,r){var o,s=this._gestures.$swipe,a=e.config.velocities.minSwipeVelocity,l=[s],u=this.__swipeOrigin;return ni(u)||(u={}),i>r?(o=u.xTarget,n.x>=a&&l.push(s+t.x)):r>i&&(o=u.yTarget,n.y>=a&&l.push(s+t.y)),this.__findFirstSubscribers(o,l)},e.prototype.__isHorizontal=function(e){return"left"===e||"right"===e},e.prototype.__appendGestureStyle=function(){var t,n,i=this._document;if(!this._compat.platCss)if(!di(i.styleSheets)&&i.styleSheets.length>0){var r=i.styleSheets[0];for(n=(t=e.config.styleConfig).length;n>0;)n-=1,r.insertRule(this.__createStyle(t[n]),0)}else{var o=i.head,s=i.createElement("style"),a="";for(s.type="text/css",n=(t=e.config.styleConfig).length;n>0;)n-=1,a=this.__createStyle(t[n])+a;s.textContent=a,o.appendChild(s)}},e.prototype.__createStyle=function(e){var t=e.styles;mi(t)||(t=[]);var n=t.length,i="."+e.className+" { ",r="";n=t.length;for(var o=0;o<n;o+=1)r+=t[o]+";";return i+=r+" } "},e.prototype.__blurFocusedElement=function(){var e=this.__focusedElement;ni(e)||(e={}),fi(e.blur)&&e.blur()},e.prototype.__waitForBlur=function(e){var t=this;this.__blurRemover=this.addEventListener(e,"blur",function(){t.__blurRemover(),t.__blurRemover=Kn,e===t.__focusedElement&&(t.__focusedElement=null)},!1)},e.prototype.__clickTarget=function(e){var t=this,n=!1,i=function(){n=!0,e.removeEventListener("click",i,!1)};e.addEventListener("click",i,!1),ki(function(){n||(e.removeEventListener("click",i,!1),t._document.body.contains(e)&&fi(e.click)&&e.click())})},e.prototype.__handleInput=function(e){this.__blurRemover();var t=e.nodeName;if(!li(t))return this.__focusedElement=null,void this.__blurFocusedElement();var n=!0;switch(t.toLowerCase()){case"input":switch(e.type){case"range":this.__blurFocusedElement();break;case"text":case"password":case"email":case"number":case"tel":case"search":case"url":e.focus(),this.__waitForBlur(e);break;default:this.__blurFocusedElement(),this.__clickTarget(e)}break;case"a":case"button":case"label":this.__blurFocusedElement(),this.__clickTarget(e);break;case"textarea":e.focus(),this.__waitForBlur(e);break;case"select":n=!1;break;default:this.__blurFocusedElement(),this.__clickTarget(e)}return this.__focusedElement=e,n},e.prototype.__preventClickFromTouch=function(){var t=this._document,n=this.__ignoreEvent,i=this.__boundPreventDefaultClick,r=e.config.intervals.delayedClickInterval;r<=0||(this.__delayedClickRemover={mousedown:Si(function(){n.mousedown=!1},r),mouseup:Si(function(){n.mouseup=!1},r),click:Si(function(){t.removeEventListener("click",i,!0)},r)},n.mousedown=n.mouseup=!0,ki(function(){t.addEventListener("click",i,!0)}))},e.prototype.__preventDefaultClick=function(e){return e.preventDefault(),e.stopImmediatePropagation(),this._document.removeEventListener("click",this.__boundPreventDefaultClick,!0),this.__delayedClickRemover.click(),!1},e.prototype.__removeSelections=function(e){oi(e)&&(vi(e.onselectstart)||e.addEventListener("selectstart",this.__preventDefault,!1),vi(e.ondragstart)||e.addEventListener("dragstart",this.__preventDefault,!1))},e.prototype.__returnSelections=function(e){oi(e)&&(vi(e.onselectstart)||e.removeEventListener("selectstart",this.__preventDefault,!1),vi(e.ondragstart)||e.removeEventListener("dragstart",this.__preventDefault,!1))},e.prototype.__preventDefault=function(e){var t=e.target.nodeName;return li(t)&&(t=t.toLowerCase()),"input"===t||"textarea"===t||(e.preventDefault(),!1)},e._inject={_document:m,_compat:d},e.config={intervals:{tapInterval:300,dblTapInterval:300,holdInterval:400,dblTapZoomDelay:0,delayedClickInterval:400},distances:{minScrollDistance:3,maxDblTapDistance:10},velocities:{minSwipeVelocity:.645},styleConfig:[{className:"plat-gesture",styles:["-moz-user-select: none","-khtml-user-select: none","-webkit-touch-callout: none","-webkit-user-select: none","-webkit-user-drag: none","-webkit-tap-highlight-color: transparent","-webkit-overflow-scrolling: touch","-ms-user-select: none","-ms-touch-action: manipulation","touch-action: manipulation"]},{className:"plat-no-touch-action",styles:["-ms-touch-action: none","touch-action: none"]}]},e.gestures={$tap:qt,$dbltap:Ht,$hold:Gt,$release:Jt,$swipe:Kt,$swipeleft:Zt,$swiperight:en,$swipeup:tn,$swipedown:nn,$track:rn,$trackleft:on,$trackright:sn,$trackup:an,$trackdown:ln,$trackend:un},e}();function I(){return N.config}t.DomEvents=N,sr.injectable(B,N),t.IDomEventsConfig=I,sr.injectable("$IDomEventsConfig",I);var R=function(){function e(){this._document=Cr(m)}return e.prototype.initialize=function(e,t,n){this.element=e,this.event=t,this.eventType=li(n)?n:"CustomEvent"},e.prototype.trigger=function(e,t,n){var i=this._document.createEvent(this.eventType);return ni(e)&&ei(!1,!1,i,e),i.initCustomEvent(this.event,!0,!0,di(t)?0:t),oi(n)||(n=this.element),n.dispatchEvent(i)},e}();t.DomEvent=R,sr.injectable("$DomEventInstance",R,null,bn);var A=function(e){function t(t,n){var i=e.call(this)||this;return i.count=0,i.element=t,i.event=n,i.count+=1,i}return __extends(t,e),t.prototype.trigger=function(e){var t=this._document.createEvent("CustomEvent"),n=this.element,i=e.target;this.__extendEventObject(t,e),t.initCustomEvent(this.event,!0,!0,0);var r=ri(n)||n.contains(i)?i.dispatchEvent(t):n.dispatchEvent(t);return r||e.preventDefault(),r},t.prototype.__extendEventObject=function(e,t){var n=t.pointerType;e.clientX=t.clientX,e.clientY=t.clientY,e.offsetX=t.offset.x,e.offsetY=t.offset.y,e.direction=di(t.direction)?{x:"none",y:"none",primary:"none"}:t.direction,e.touches=t._touches,e.velocity=di(t.velocity)?{x:0,y:0}:t.velocity,e.identifier=di(t.identifier)?0:t.identifier,e.pointerType=_i(n)?this.__convertPointerType(n,t.type):n,e.screenX=t.screenX,e.screenY=t.screenY,e.pageX=t.pageX,e.pageY=t.pageY,e.buttons=t._buttons},t.prototype.__convertPointerType=function(e,t){switch(e){case MSPointerEvent.MSPOINTER_TYPE_MOUSE:return"mouse";case MSPointerEvent.MSPOINTER_TYPE_PEN:return"pen";case MSPointerEvent.MSPOINTER_TYPE_TOUCH:return"touch"}return-1===t.indexOf("mouse")?"touch":"mouse"},t}(R);!function(e){var t=function(){function e(){this._animatedElements={}}return e.prototype.create=function(e,t,n){return this._create(e,t,n,{key:null})},e.prototype.animate=function(e,t,n){return this._animate(e,t,n,{key:null})},e.prototype.enter=function(e,t,n,i,r){return this._animate(e,t,r,{key:"enter",parent:n,refChild:i})},e.prototype.leave=function(e,t,n){return this._animate(e,t,n,{key:"leave"})},e.prototype.move=function(e,t,n,i,r){return this._animate(e,t,r,{key:"move",parent:n,refChild:i})},e.prototype.show=function(e,t,n){return this._animate(e,t,n,{key:"show"})},e.prototype.hide=function(e,t,n){return this._animate(e,t,n,{key:"hide"})},e.prototype.all=function(e){for(var t=this,i=e.length,r=[],o=new n(function(n){t._Promise.all(e).then(function(){n()})}),s=0;s<i;s+=1)r=r.concat(e[s].getInstances());return o.initialize(r),o.then(Kn)},e.prototype.resolve=function(){var e=new n(function(t){t(function(){return e})});return e},e.prototype._animate=function(e,t,n,i){var r=this._create(e,t,n,i),o=r.current;return r.previous.then(function(){Ri(function(){o.start()})}),o},e.prototype._create=function(e,t,i,r){var o,s=this,a=yr[t],l=[],u=[];if((!this._compat.animationSupported||vi(a))&&vi(a=br[t]))return e=this.__constructAnimatableElements(e,{inject:Kn},u,l),this._handlePreInitFunctionality(e,u,r),this._handlePostInitFunctionality(e,u,r),this._handleEndFunctionality(e,u,r),{previous:o=this.resolve(),current:o};e=this.__constructAnimatableElements(e,a,u,l);var c=u.length;if(0===c)return this._handlePreInitFunctionality(e,u,r),this._handlePostInitFunctionality(e,u,r),this._handleEndFunctionality(e,u,r),{previous:o=this.resolve(),current:o};this._handlePreInitFunctionality(e,u,r);var h,p=ji("animation_"),_=this.__setAnimationId(p,u),f=new n(function(t){var n=s._Promise;h=n.all(_).then(function(){for(var o=[],a=0;a<c;a+=1)o.push(l[a].instantiate(u[a],i));s._handlePostInitFunctionality(e,u,r);var h=n.all(o),_=s.__isParentAnimating(u),d=s.__generateAnimatedElement(p,u,f);if(!di(_)){s._handleEndFunctionality(e,u,r),d.animationEnd(!0);var v=s._animatedElements[_],m=ci(v.promise)?function(){return v.promise}:function(){return f};h.then(function(){t(m)})}s.__stopChildAnimations(u),d.promise=f,h.then(function(){s._handleEndFunctionality(e,u,r),d.animationEnd(),t(function(){return f})})})});return f.initialize(l),{previous:h,current:f}},e.prototype._handlePreInitFunctionality=function(e,t,n){switch(n.key){case"move":for(var i=0;i<length;i+=1)nr(e[i])}},e.prototype._handlePostInitFunctionality=function(e,t,n){var i,r;switch(n.key){case"enter":case"move":var o,s=n.refChild;if(oi(s)?o=s.parentNode:(o=n.parent,s=null),!oi(o))break;for(i=e.length,r=0;r<i;r+=1)o.insertBefore(e[r],s);break;case"show":for(i=t.length,r=0;r<i;r+=1)t[r].removeAttribute(Pt)}},e.prototype._handleEndFunctionality=function(e,t,n){var i,r;switch(n.key){case"leave":for(i=e.length,r=0;r<i;r+=1)nr(e[r]);break;case"hide":for(i=t.length,r=0;r<i;r+=1)t[r].setAttribute(Pt,"")}},e.prototype.__setAnimationId=function(e,t){for(var n,i,r,o=this._animatedElements,s=[],a=t.length,l=0;l<a;l+=1)vi(i=(r=t[l]).__plat)?(r.__plat={animation:e},ir(r,Ot)):vi(i.animation)?(i.animation=e,ir(r,Ot)):(vi(n=o[i.animation])||(s.push(n.promise),n.animationEnd(!0)),i.animation=e);return s},e.prototype.__generateAnimatedElement=function(e,t,n){var i=this._animatedElements;return i[e]={animationEnd:function(r){var o,s,a,l=t.length;if(!0===r)return n.cancel(),void Li(i,e);for(var u=0;u<l;u+=1)ni(o=(s=t[u]).__plat)||(o={}),vi(a=o.animation)||a!==e||(rr(s,Ot),Li(o,"animation"),hi(o)&&Li(s,"__plat"));Li(i,e)}}},e.prototype.__isParentAnimating=function(e){for(var t,n=e[0];!ri(n=n.parentNode)&&!di(n)&&n.nodeType===Node.ELEMENT_NODE;)if(or(n,Ot)){var i=n.__plat;if(ni(i)||(i={}),li(t=i.animation)){if(!di(this._animatedElements[t]))return t;Li(i,"animation"),hi(i)&&Li(n,"__plat"),rr(n,Ot)}}},e.prototype.__stopChildAnimations=function(e){for(var t,n,i,r,o=this._animatedElements,s=Array.prototype.slice,a=e.length,l=0;l<a;l+=1)for(t=s.call(e[l].querySelectorAll("."+Ot));t.length>0;)ni(i=t.pop().__plat)||(i={}),di(r=i.animation)||(ni(n=o[r])||(n={}),fi(n.animationEnd)&&n.animationEnd(!0))},e.prototype.__constructAnimatableElements=function(e,t,n,i){if(!mi(e))if(si(e))e=Array.prototype.slice.call(e.childNodes);else if(gi(e))e=Array.prototype.slice.call(e);else{if(!oi(e)||e.nodeType!==Node.ELEMENT_NODE)return[];e=[e]}for(var r,o=e.length,s=0;s<o;s+=1)oi(r=e[s])&&r.nodeType===Node.ELEMENT_NODE&&(n.push(r),i.push(t.inject()));return e},e._inject={_compat:d,_Promise:f,_document:m},e}();e.Animator=t,sr.injectable(M,t);var n=function(e){function t(t,n){var i=e.call(this,t)||this;return i._Promise=Cr(f),i.__animationState=0,i.__animationInstances=[],di(n)||(i.__animationInstances=n.__animationInstances,i.__animationState=n.__animationState),i}return __extends(t,e),t.prototype.initialize=function(e){hi(this.__animationInstances)&&(mi(e)?this.__animationInstances=e:ni(e)&&(this.__animationInstances=[e]))},t.prototype.getInstances=function(){return this.__animationInstances},t.prototype.start=function(){if(!(this.__animationState>0)){for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;i+=1)fi((e=t[i]).start)&&e.start();this.__animationState=1}},t.prototype.pause=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;r+=1)fi((e=t[r]).pause)&&n.push(e.pause());return this._Promise.all(n).then(Kn)},t.prototype.resume=function(){if(1!==this.__animationState)return this._Promise.resolve();for(var e,t=this.__animationInstances,n=[],i=t.length,r=0;r<i;r+=1)fi((e=t[r]).resume)&&n.push(e.resume());return this._Promise.all(n).then(Kn)},t.prototype.cancel=function(){if(2===this.__animationState)return this;for(var e,t=this.__animationInstances,n=t.length,i=0;i<n;i+=1)fi((e=t[i]).cancel)&&e.cancel(),fi(e.end)&&e.end();return this.__animationState=2,this},t.prototype.isCanceled=function(){return 2===this.__animationState},t.prototype.then=function(t,n){return e.prototype.then.call(this,t)},t.prototype.catch=function(t){return e.prototype.catch.call(this,t)},t}(Er.Promise);e.AnimationPromise=n;var i=function(){function e(){this.__eventListeners=[]}return e.prototype.initialize=function(){},e.prototype.start=function(){},e.prototype.end=function(){for(var e=this.__eventListeners;e.length>0;)e.pop()();fi(this._resolve)&&(this._resolve(),this._resolve=null)},e.prototype.pause=function(){return this._Promise.resolve()},e.prototype.resume=function(){return this._Promise.resolve()},e.prototype.cancel=function(){this.end()},e.prototype.addEventListener=function(e,t,n){if(!fi(t))return this._log.warn('An animation\'s "addEventListener" must take a function as the second argument.'),Kn;t=t.bind(this);var i=this.dom.addEventListener(this.element,e,function(e){e.stopPropagation(),t(e)},n),r=this.__eventListeners;return r.push(i),function(){i();var e=r.indexOf(i);-1!==e&&r.splice(e,1)}},e.prototype.instantiate=function(e,t){var i=this;this.element=e,this.options=t;var r=new n(function(e){i._resolve=e,i.initialize()});return r.initialize(this),r},e._inject={_window:G,_compat:d,_log:E,_Promise:f,dom:z,utils:H},e}();e.BaseAnimation=i;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationEvents=t._compat.animationEvents,t}return __extends(t,e),t.prototype.animationStart=function(e){return this.addEventListener(this._animationEvents.$animationStart,e,!1)},t.prototype.animationEnd=function(e){return this.addEventListener(this._animationEvents.$animationEnd,e,!1)},t.prototype.animationIteration=function(e){return this.addEventListener(this._animationEvents.$animationIteration,e,!1)},t.prototype.transitionStart=function(e){return this.addEventListener(this._animationEvents.$transitionStart,e,!1)},t.prototype.transitionEnd=function(e){return this.addEventListener(this._animationEvents.$transitionEnd,e,!1)},t}(i);e.CssAnimation=r;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ft,t._cancelAnimation=Kn,t}return __extends(t,e),t.prototype.initialize=function(){ir(this.element,this.className+Tn)},t.prototype.start=function(){var e=this;this._cancelAnimation=Ri(function(){var t=e.element,n=e.className;if(null===t.offsetParent)return e._dispose(),void e.end();ir(t,n);var i=e._animationEvents.$animation,r=e.options;ni(r)||(r={});var o=e._window.getComputedStyle(t,r.pseudo),s=o[i+"Name"];if(""===s||"none"===s||"paused"===o[i+"PlayState"])return e._dispose(),void e.end();r.preserveInit||rr(t,n+Tn),e._cancelAnimation=e.animationEnd(function(){e._cancelAnimation=Ri(function(){e._dispose(),e.end()})})})},t.prototype.pause=function(){var e=this;if(this._cancelAnimation===Kn)return this._Promise.resolve();var t=this._compat.animationEvents;return new this._Promise(function(n){Ri(function(){e._cancelAnimation!==Kn&&(e.element.style[t.$animation+"PlayState"]="paused"),n()})})},t.prototype.resume=function(){var e=this;if(this._cancelAnimation===Kn)return this._Promise.resolve();var t=this._compat.animationEvents;return new this._Promise(function(n){Ri(function(){e._cancelAnimation!==Kn&&(e.element.style[t.$animation+"PlayState"]="running"),n()})})},t.prototype.cancel=function(){this._cancelAnimation(),this._dispose(),this.end()},t.prototype._dispose=function(){var e=this.className;rr(this.element,e+" "+e+Tn),this._cancelAnimation=Kn},t}(r);e.SimpleCssAnimation=o,sr.animation(Ft,o);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Bt,t}return __extends(t,e),t}(o);e.FadeIn=s,sr.animation(Bt,s);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Ut,t}return __extends(t,e),t}(o);e.FadeOut=a,sr.animation(Ut,a);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Dt,t}return __extends(t,e),t}(o);e.Enter=l,sr.animation(Dt,l);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=$t,t}return __extends(t,e),t}(o);e.Leave=u,sr.animation($t,u);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=zt,t}return __extends(t,e),t}(o);e.Move=c,sr.animation(zt,c);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className=Mt,t._animationCanceled=Kn,t._normalizeRegex=/-/g,t._nonNumRegex=/[^\-0-9\.]/g,t._normalizedKeys={},t._transitionCount=0,t._count=0,t._started=!1,t._usingCss=!1,t}return __extends(t,e),t.prototype.initialize=function(){ir(this.element,this.className+Tn)},t.prototype.start=function(){var e=this;this._animationCanceled=Ri(function(){var t=e.element,n=e.className;null===t.offsetParent&&(e._animate(),e._dispose(),e.end()),ir(t,n),e._started=!0;var i=e.utils,r=e._animationEvents.$transition,o=e.options;ni(o)||(o={});for(var s,a=e._window.getComputedStyle(t,o.pseudo),l=e._properties=a[r+"Property"].split(","),u=a[r+"Duration"].split(","),c=l.length,h=c,p=!1;c>0;)""===(s=l[c-=1])||"none"===s?l.splice(c,1):h>1&&"all"===s&&(e._log.debug('Improper transition declaration on class "'+t.className+'"'),l.splice(c,1));if(0===l.length)p=!0;else{for(c=u.length;c>0&&(""===(s=u[c-=1])||"0s"===s););c<0&&(p=!0)}if(p)return e._animate(),e._dispose(),void e.end();i.isNumber(o.count)&&o.count>0&&(e._count=o.count),!1===o.preserveInit&&rr(t,n+Tn),e._animationCanceled=e.transitionEnd(e._done),e._animate()||(i.isEmpty(o.properties)?e.__cssTransition(a,u):(e._dispose(),e.end()))})},t.prototype.cancel=function(){this._animationCanceled(),this._started||this._animate(),this._dispose(),this.end()},t.prototype._dispose=function(){var e=this.className;rr(this.element,e+" "+e+Tn),this._animationCanceled=Kn},t.prototype._done=function(e){var t=e.propertyName;if(li(t)){this._transitionCount+=1;var n=this._transitionCount;if(t=t.replace(this._normalizeRegex,"").toLowerCase(),n<this._count||!this._usingCss&&!0===this._normalizedKeys[t]&&n<this._properties.length)return}this._dispose(),this.end()},t.prototype._animate=function(){var e=this._normalizedKeys,t=this._normalizeRegex,n=this.options;ni(n)||(n={});var i=this.options.properties;ni(i)||(i={});var r,o,s,a=Object.keys(i),l=a.length,u=0,c=this.element.style;for(ni(c)||(c={});a.length>0;)o=c[r=a.shift()],li(s=i[r])?(c[r]=s,o===c[r]?u+=1:e[r.replace(t,"").toLowerCase()]=!0):u+=1;return u<l},t.prototype._toMs=function(e){var t=this._nonNumRegex,n=e.match(t)[0],i=Number(e.replace(t,""));return this.utils.isNumber(i)?"s"===n?1e3*i:"ms"===n?i:0:0},t.prototype.__cssTransition=function(e,t){var n,i,r,o,s=this,a=this._animationEvents.$transition,l=e[a+"Delay"].split(","),u=this._properties,c=u.length,h=this._normalizedKeys,p=this._normalizeRegex,_=0,f=0,d=!1,v=this.utils.defer.bind(this,function(t,n){s._animationCanceled!==Kn&&("all"!==t&&e[t]===n||(d=!0),(f+=1)<c||d||(s._dispose(),s.end()))});for(this._usingCss=!0,isFinite(this._count)&&0!==this._count||(this._count=c);_<c;_+=1)i=u[_]=u[_].trim(),r=t.length>_?t[_].trim():t[t.length-1].trim(),o=l.length>_?l[_].trim():l[l.length-1].trim(),h[i.replace(p,"").toLowerCase()]=!0,n=e[i],v(this._toMs(r)+this._toMs(o),[i,n])},t}(r);e.SimpleCssTransition=h,sr.animation(Mt,h)}(t.animations||(t.animations={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=this._router=this._Router.currentRouter(),t=this._getParentViewport();di(t)||di(t._router)||(this._parentRouter=t._router).addChild(e),this._navigator.initialize(e)},t.prototype.loaded=function(){var e=this;(this._animate=ni(this.options)&&!0===this.options.value.animate)&&this.dom.addClass(this.element,rt+"-animate"),this._Promise.resolve(this._router.finishNavigating).then(function(){e._router.register(e)})},t.prototype.canNavigateTo=function(e){var t=this,n=this._Router.currentRouter,i=n(),r=!0,o=this._Injector.getDependency(e.delegate.view),s=o.inject(),a=e.parameters,l=n();if(!ni(s))return this._Promise.resolve(null);if(i!==l){l.initialize(this._router);var u=Cr(k);s.navigator=u,u.initialize(l)}else s.navigator=this._navigator;return fi(s.canNavigateTo)&&(r=s.canNavigateTo(a,e.query)),this._Promise.resolve(r).then(function(e){return t._nextInjector=o,t._nextView=s,e})},t.prototype.canNavigateFrom=function(){var e=this.controls[0],t=!0;return ni(e)&&fi(e.canNavigateFrom)&&(t=e.canNavigateFrom()),this._Promise.resolve(t)},t.prototype.navigateTo=function(e){var t=this._nextInjector;ni(t)||(t=this._Injector.getDependency(e.delegate.view));var n=this._createNodeMap(t),i=this.element,r=n.element,o=(e.parameters,e.query),s=n.uiControlNode.control;if(this._nextInjector=this._nextView=void 0,this._animate){var a=this._animator,l=this.dom;this._navigator.isBackNavigation()?(l.addClass(r,Vt),a.enter(r,Dt,i).then(function(){l.removeClass(r,Vt)})):a.enter(r,Dt,i)}else i.insertBefore(r,null);var u=this._managerCache.read(this.uid),c=this._ElementManagerFactory.getInstance();return u.children=[],c.initialize(n,u),fi(s.navigatedTo)&&s.navigatedTo(e.parameters,o),c.setUiControlTemplate(),s.hasOwnContext?c.observeRootContext(s,c.fulfillAndLoad):c.fulfillAndLoad()},t.prototype.navigateFrom=function(){var e=this,t=this.controls[0],n=ni(t);return(n&&fi(t.navigatingFrom)?this._Promise.resolve(t.navigatingFrom()):this._Promise.resolve()).catch(function(t){if(ni(t))return li(t.message)?void e._log.debug(e.type+" error: "+t.message):void e._log.debug(e.type+" error: "+JSON.stringify(t));e._log.debug(t)}).then(function(){if(e._animate&&n){var i=t.element;e._navigator.isBackNavigation()&&e.dom.addClass(i,Vt),e._animator.leave(i,$t).then(function(){Or.dispose(t)})}else Or.dispose(t)})},t.prototype.dispose=function(){this._router.unregister(this),this._navigator.dispose()},t.prototype._createNodeMap=function(e){var t=this._nextView;ni(t)||(t=e.inject());var n=this._document,i=e.name,r=t.replaceWith,o=hi(r)||"any"===r?n.createElement("div"):n.createElement(r);return o.setAttribute(ot,i),o.className=st,{element:o,attributes:{},nodes:[],uiControlNode:{control:t,nodeName:i,expressions:[],injector:e}}},t.prototype._getParentViewport=function(){for(var e=this.parent,t=this.type;!di(e)&&e.type!==t;)e=e.parent;return e},t._inject={_Router:W,_Promise:f,_Injector:oe,_ElementManagerFactory:j,_document:m,_managerCache:O,_animator:M,_navigator:k},t}(n);e.Viewport=t,sr.control(rt,t);var i=function(e){function t(){var t=e.call(this)||this;t.replaceWith=null,t.__isFirst=!1;var n=Cr(P);return t.__templateControlCache=n.create(pt),t}return __extends(t,e),t.prototype.initialize=function(){var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={});var n=this._id=t.id;if(di(n))this._log.warn(this.type+" instantiated without an id option");else{this._url=t.templateUrl;var i=this.__templateControlCache.read(n);di(i)?(this.__isFirst=!0,this._initializeTemplate()):this.__templatePromise=i}},t.prototype.loaded=function(){this.__isFirst||this._waitForTemplateControl(this.__templatePromise)},t.prototype.dispose=function(){if(this.__isFirst){var e=this.__templateControlCache;e.remove(this._id),0===e.info().size&&e.dispose()}},t.prototype._initializeTemplate=function(){var e=this,t=this._id;if(!di(t)){var i,r,o=this.endNode.parentNode,s=this._url;di(s)?(i=this._document.createDocumentFragment(),Hi(this.elementNodes,i)):(i=this._templateCache.read(s),Yi(this.elementNodes,o)),this.elementNodes=[],ci(i)?r=i.catch(function(t){if(di(t))return n.determineTemplate(e,s)}).then(function(n){return e.bindableTemplates.add(t,n.cloneNode(!0)),e}):(this.bindableTemplates.add(t,i.cloneNode(!0)),r=this._Promise.resolve(this)),this.__templateControlCache.put(t,r)}},t.prototype._waitForTemplateControl=function(e){var t=this;ci(e)&&e.then(function(e){return di(t._url)||t._url===e._url||t._log.warn("The specified url: "+t._url+" should match "+t.type+' with id: "'+t._id+'". Loading original url.'),t.__mapBindableTemplates(e),t.bindableTemplates.bind(t._id)}).then(function(e){var n=t.endNode;Xi(n.parentNode,e,n)}).catch(function(e){ki(function(){t._log.warn("Problem resolving "+t.type+" url: "+e.response)})})},t.prototype.__mapBindableTemplates=function(e){var t=this.bindableTemplates;t.cache=e.bindableTemplates.cache,t.templates=e.bindableTemplates.templates},t._inject={_Promise:f,_templateCache:F,_document:m},t}(n);e.Template=i,sr.control(it,i);var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.innerTemplate=Hi(this.element.childNodes)},t.prototype.loaded=function(){this.element.appendChild(this.innerTemplate.cloneNode(!0))},t}(n);e.Ignore=o,sr.control(tt,o);var s=function(e){function t(){var t=e.call(this)||this;return t.priority=120,t._aliases={index:cn.index,even:cn.even,odd:cn.odd,first:cn.first,last:cn.last},t._blockLength=0,t._addQueue=[],t._itemLength=0,t.__listenerSet=!1,t.itemsLoaded=new t._Promise(function(e,n){t.__resolveFn=e,t.__rejectFn=n}).catch(Kn),t}return __extends(t,e),t.prototype.setTemplate=function(){this.bindableTemplates.add("item",this.element.childNodes)},t.prototype.contextChanged=function(e,t){mi(e)?this._setListener():e=[],this._executeEvent([{object:e,type:"splice"}])},t.prototype.loaded=function(){var e=this.options,t=this._animate=ni(e)&&!0===e.value.animate,n=this.context;if(this._container=this.element,t&&(this._animationQueue=[]),this._setAliases(),mi(n)){var i=this._addQueue,r=n.length,o=this._addItems(0,r,0).then(function(){var e=i.indexOf(o);-1!==e&&i.splice(e,1)});i.push(o),this._setListener()}},t.prototype.dispose=function(){this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._animationQueue=this._addQueue=null},t.prototype._setAliases=function(){var e=this.options;if(!vi(e)){var t=e.value.aliases;if(ni(t))for(var n,i=this._aliases,r=Object.keys(i),o=r.length,s=0;s<o;s+=1)li(n=t[r[s]])&&(i[r[s]]=n)}},t.prototype._addItems=function(e,t,n){var i=this,r=+(e+t),o=[],s=e;for(this._itemLength+=t;e<r;)o.push(this._bindItem(e)),e+=1;return o.length>0&&(this.itemsLoaded=this._Promise.all(o).then(function(e){if(i._setBlockLength(e),n>0)for(var t=e.length,r=i._container,o=0;o<t;o+=1)o<n?i._appendAnimatedItem(e[o]):r.insertBefore(e[o],null);else i._appendItems(e);i._updateResource(s-1),fi(i.__resolveFn)&&(i.__resolveFn(),i.__resolveFn=i.__rejectFn=null)}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),i._log.error(e)})})),this.itemsLoaded},t.prototype._appendItems=function(e){Hi(e,this._container)},t.prototype._appendAnimatedItem=function(e){if(oi(e)){var t=this._animationQueue,n={animation:this._animator.enter(e,Dt,this._container).then(function(){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}),op:null};t.push(n)}},t.prototype._removeItems=function(e,t){for(var i=n.dispose,r=this.controls,o=e+t;o>e;)i(r[o-=1]);this._updateResource(r.length-1)},t.prototype._bindItem=function(e){return this.bindableTemplates.bind("item",e,this._getAliases(e))},t.prototype._setBlockLength=function(e){this._blockLength>0||0===e.length||(this._blockLength=e[0].childNodes.length)},t.prototype._updateResource=function(e){var t=this.controls;e<0||e>=t.length||t[e].resources.add(this._getAliases(e))},t.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},t.prototype._executeEvent=function(e){var t="_"+e[0].type;fi(this[t])&&this[t](e)},t.prototype._getAliases=function(e){var t=e%2==0,n={},i=this._aliases,r=Pn;return n[i.index]={value:e,type:r},n[i.even]={value:t,type:r},n[i.odd]={value:!t,type:r},n[i.first]={value:0===e,type:r},n[i.last]={value:e===this.context.length-1,type:r},n},t.prototype._push=function(e){var t=e[0],n=this._addQueue,i=t.addedCount,r=this._addItems(t.index,i,this._animate?i:0).then(function(){var e=n.indexOf(r);-1!==e&&n.splice(e,1)});n.push(r)},t.prototype._pop=function(e){var t=this,n=e[0],i=n.object.length;if(0!==n.removed.length){var r=n.object.length;this._itemLength>0&&(this._itemLength-=1),this._Promise.all(this._addQueue).then(function(){t._animate?t._animateItems(i,1,$t,"leave",!1).then(function(){t._removeItems(r,1)}):t._removeItems(r,1)})}},t.prototype._unshift=function(e){var t=e[0],n=t.addedCount,i=this._addQueue;if(this._animate){var r=this._animationQueue,o=r.length;this._animateItems(0,n,Dt,null,o>0&&"clone"===r[o-1].op)}var s=this._addItems(t.object.length-n,n,0).then(function(){var e=i.indexOf(s);-1!==e&&i.splice(e,1)});i.push(s)},t.prototype._shift=function(e){var t=this,n=this._addQueue,i=e[0];if(0!==i.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,$t,"clone",!0)]));var r=i.object.length;this._itemLength>0&&(this._itemLength-=1),this._Promise.all(n).then(function(){t._removeItems(r,1)})}},t.prototype._splice=function(e){var t,n=this,i=e[0],r=i.addedCount,o=this._itemLength,s=this._animate,a=this._addQueue;if(di(r)){s&&this._cancelCurrentAnimations();var l=i.object.length,u=o-l;l>o?(t=this._addItems(o,-u,0).then(function(){var e=a.indexOf(t);-1!==e&&a.splice(e,1)}),a.push(t)):o>l&&(o>=u?this._itemLength-=u:this._itemLength=0,this._Promise.all(a).then(function(){n._removeItems(o-u,u)}))}else{var c=i.removed.length,h=this._animationQueue;if(r>c){var p=r-c,_=void 0;if(s){_=r;var f=h.length,d=i.index;o<r-d&&(_=o-d),this._animateItems(d,_,Dt,null,f>0&&"clone"===h[f-1].op),_=r-_}else _=0;t=this._addItems(i.object.length-p,p,_).then(function(){var e=a.indexOf(t);-1!==e&&a.splice(e,1)}),a.push(t)}else if(c>r){var v=r>0;s&&!v&&0===a.length&&(a=a.concat([this._animateItems(i.index,c,$t,"clone",!0)]));var m=c-r;o>=m?this._itemLength-=m:this._itemLength=0,this._Promise.all(a).then(function(){if(s&&v){var e=h.length;n._animateItems(i.index,r,Dt,null,e>0&&"clone"===h[e-1].op)}n._removeItems(o-m,m)})}}},t.prototype._calculateBlockLength=function(e,t){return this._blockLength},t.prototype._animateItems=function(e,t,n,i,r){var o=this._calculateBlockLength();if(0===o)return this._Promise.resolve();var s=e*o;switch(i){case"clone":return this._handleClonedContainerAnimation(s,t*o+s,n,!0===r);case"leave":return this._handleLeave(s,t*o+s,n);default:return this._handleSimpleAnimation(s,t*o+s,n,!0===r)}},t.prototype._handleSimpleAnimation=function(e,t,n,i){var r=this._container,o=Array.prototype.slice.call(r.childNodes,e,t);if(0===o.length)return this._Promise.resolve();var s=this._animationQueue,a=this._animator.create(o,n),l=a.current.then(function(){var e=s.indexOf(c);-1!==e&&s.splice(e,1)}),u=function(){return a.previous.then(function(){l.start()}),l},c={animation:l,op:null};if(i&&s.length>0){var h=this._cancelCurrentAnimations().then(u);return s.push(c),h}return s.push(c),u()},t.prototype._handleLeave=function(e,t,n){var i=this._container,r=Array.prototype.slice.call(i.childNodes,e,t);if(0===r.length)return this._Promise.resolve();var o=this._animationQueue,s=this._animator.leave(r,n).then(function(){var e=o.indexOf(a);-1!==e&&o.splice(e,1)}),a={animation:s,op:"leave"};return o.push(a),s},t.prototype._handleClonedContainerAnimation=function(e,t,n,i){var r,o=this._container,s=o.cloneNode(!0),a=Array.prototype.slice.call(s.childNodes,e,t);if(0===a.length)return this._Promise.resolve();var l=this._animationQueue,u=this._animator.create(a,n),c=u.current.then(function(){var e=l.indexOf(p);e>-1&&l.splice(e,1),di(r)||r.replaceChild(o,s)}),h=function(){return di(r=o.parentNode)||c.isCanceled()?c:(r.replaceChild(s,o),u.previous.then(function(){c.start()}),c)},p={animation:c,op:"clone"};if(i&&l.length>0){var _=this._cancelCurrentAnimations().then(h);return l.push(p),_}return l.push(p),h()},t.prototype._cancelCurrentAnimations=function(){for(var e=this._animationQueue,t=[],n=e.length,i=0;i<n;i+=1)t.push(e[i].animation.cancel());return this._Promise.all(t)},t._inject={_animator:M,_Promise:f},t}(n);e.ForEach=s,sr.control(Ke,s);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith=_t,t._structuredDataElements=[],t}return __extends(t,e),t.prototype.initialize=function(){var e=this;this.on(It,function(){e._removeAllElements()})},t.prototype.setTemplate=function(){var e=ft,t="title",n="author",i="description",r=yt,o=bt;this.element.setAttribute("prefix","og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"),this._titleElement=this._createElement(t),this._ogTitleElement=this._createElement(e,r+t),this._twitterTitleElement=this._createElement(e,o+t),this._descriptionElement=this._createElement(e,i),this._ogDescriptionElement=this._createElement(e,r+i),this._twitterDescriptionElement=this._createElement(e,o+i),this._ogUrlElement=this._createElement(e,"og:url"),this._twitterUrlElement=this._createElement(e,o+"url"),this._authorElement=this._createElement(e,n),this._googleAuthorElement=this._createElement("link",n),this._fbAuthorElement=this._createElement(e,"article:"+n),this._twitterCreatorElement=this._createElement(e,o+"creator"),this._ogTypeElement=this._createElement(e,"og:type")},t.prototype.title=function(e){return li(e)?(this._titleElement.innerText=e,this._setContent([this._ogTitleElement,this._twitterTitleElement],e),e):this._getContent(this._titleElement)},t.prototype.description=function(e){return li(e)?(this._setContent([this._descriptionElement,this._ogDescriptionElement,this._twitterDescriptionElement],e),e):this._getContent(this._descriptionElement)},t.prototype.url=function(e){return li(e)?(this._setContent([this._ogUrlElement,this._twitterUrlElement],e),e):this._getContent(this._ogUrlElement)},t.prototype.author=function(e){return li(e)?(this._setContent([this._authorElement],e),e):this._getContent(this._authorElement)},t.prototype.googleAuthor=function(e){return li(e)?(this._setContent([this._googleAuthorElement],e),e):this._getContent(this._googleAuthorElement)},t.prototype.fbAuthor=function(e){return li(e)?(this._setContent([this._fbAuthorElement],e),e):this._getContent(this._fbAuthorElement)},t.prototype.twitterCreator=function(e){return li(e)?(this._setContent([this._twitterCreatorElement],e),e):this._getContent(this._twitterCreatorElement)},t.prototype.fbType=function(e){return li(e)?(this._setContent([this._ogTypeElement],e),e):this._getContent(this._ogTypeElement)},t.prototype.images=function(e){var t=this;if(mi(e)){var n,i,r=ft,o=this.element;Ci(function(e){e=t._browser.urlUtils(e).href,2!==o.querySelectorAll(r+'[content="'+e+'"]').length&&(n=t._createElement(r,"og:"+mt,!0),i=t._createElement(r,"twitter:"+mt,!0),t._setContent([n,i],e))},e)}},t.prototype.videos=function(e){var t=this;if(mi(e)){var n,i=this._browser,r=this.element;Ci(function(e){e=i.urlUtils(e).href,1!==r.querySelectorAll('meta[content="'+e+'"]').length&&(n=t._createElement("meta","og:video",!0),t._setContent([n],e))},e)}},t.prototype.structuredData=function(e){if(!hi(e)){var t=this._document.createElement("script"),n=this._titleElement.nextSibling;t.setAttribute("type","application/ld+json"),t.textContent=JSON.stringify(e),this._structuredDataElements.push(t),this.dom.insertBefore(this.element,t,n)}},t.prototype.blogPostings=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.length,i=0;i<n;i+=1)this.structuredData(e[i])},t.prototype.loaded=function(){this.url(this._browser.url())},t.prototype.navigated=function(e){this.url(e)},t.prototype._getContent=function(e){var t=e.nodeName.toLowerCase();return"title"===t?e.innerText:t===ft?e.getAttribute(Ct):t===dt?e.getAttribute("href"):void 0},t.prototype._setContent=function(e,t){for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=this._titleElement.nextSibling,a=this.dom,l=0;l<o;l+=1)(n=e[l]).nodeName.toLowerCase()===ft?n.setAttribute("content",t):n.setAttribute("href",t),-1===r.indexOf(n)&&a.insertBefore(i,n,s)},t.prototype._createElement=function(e,t,n){var i,r=li(t),o=this.element,s=!r||0!==t.indexOf(yt)&&0!==t.indexOf(gt)?"name":vt;return e===dt&&(s="rel"),!n&&r?i=o.querySelector(e+"["+s+'="'+t+'"]'):n||(i=o.querySelector(e)),oi(i)||(i=this._document.createElement(e)),r&&i.setAttribute(s,t),i},t.prototype._removeAllElements=function(){var e=Array.prototype.slice,t=this._document.head.querySelectorAll('meta[property^="og:"]'),n=this._document.head.querySelectorAll('meta[name^="'+bt+'"]');this._removeElements.apply(this,[this._descriptionElement,this._authorElement,this._googleAuthorElement].concat(e.call(t),e.call(n),e.call(this._structuredDataElements))),this._structuredDataElements=[]},t.prototype._removeElements=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,i=this.element,r=Array.prototype.slice.call(i.children),o=e.length,s=0;s<o;s+=1)n=e[s],-1!==r.indexOf(n)&&i.removeChild(n)},t._inject={_document:m,_browser:Q},t}(n);e.Head=a;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setTemplate=function(){this.dom.clearNode(this.element)},t.prototype.loaded=function(){var e=this.options;ni(e)&&(this._onOptionsChanged(e.value),e.observe(this._onOptionsChanged))},t.prototype._onOptionsChanged=function(e,t){var n=this;if(e!==t)if(ni(e)){var i=e.html;if(i!==this._html){this._html=i;var r=li(i);if(di(i)||r&&""===i.trim())this.controls.length>0?this._TemplateControlFactory.dispose(this.controls[0]):this.dom.clearNode(this.element);else if(r)if(!0!==e.compile)Wi(this.element,i);else{var o=this.controls.length>0;this.bindableTemplates.once(i).then(function(e){o?n._TemplateControlFactory.dispose(n.controls[0]):n.dom.clearNode(n.element),n.element.insertBefore(e,null)})}else this._log.debug("Trying to bind a non-string value to "+this.type+".")}}else this._log.debug("plat-options for "+this.type+" must be an object.")},t._inject={_TemplateControlFactory:V},t}(n);e.InnerHtml=l,sr.control(Ze,l);var u=function(e){function t(){var t=e.call(this)||this;return t.replaceWith="select",t.priority=120,t.groups={},t.itemsLoaded=new t._Promise(function(e,n){t.__resolveFn=e,t.__rejectFn=n}).catch(Kn),t}return __extends(t,e),t.prototype.setTemplate=function(){this.bindableTemplates.add("option",this.element.childNodes);var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={});var n=t.default;if(ni(n)){var i=this._document.createElement("option"),r=n.value,o=n.textContent;i.value=vi(r)?o:r,i.textContent=vi(o)?r:o,this.element.insertBefore(i,null)}if(di(t.group))this._isGrouped=!1;else{var s=this._group=t.group,a=this._document.createElement("optgroup");a.label=vn+s+mn,this.bindableTemplates.add("group",a),this._isGrouped=!0}},t.prototype.contextChanged=function(e,t){var n=this;if(!hi(e)&&mi(e)){var i=mi(e)?e.length:0,r=mi(t)?t.length:0;this._setListener(),i>r?this._addItems(i-r,r):i<r&&this._removeItems(r-i),this.itemsLoaded.then(this._observeChange.bind(this))}else hi(t)||this.itemsLoaded.then(function(){n._removeItems(n.controls.length)}).then(this._observeChange.bind(this))},t.prototype.loaded=function(){if(vi(this._isGrouped)){var e=this.options;ni(e)||(e={});var t=e.value;ni(t)||(t={}),this._group=t.group,this._isGrouped=!di(this._group)}this._defaultOption=this.element.firstElementChild;var n=this.context;mi(n)&&(this._addItems(n.length,0),this._setListener())},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null),this._defaultOption=null},t.prototype.observeProperties=function(e){var t=this,n=this.element;if(this._binder=e,n.multiple){if(di(e.evaluate())){var i=[];this.inputChanged(i,this.__lastValue),this.__lastValue=i}e.observeProperty(this._setSelectedIndices),e.observeArrayChange(function(){t._setSelectedIndices(e.evaluate(),null,null)})}else e.observeProperty(this._setSelectedIndex);this.addEventListener(n,"change",this._observeChange,!1)},t.prototype._setSelectedIndex=function(e,t,n,i){var r=this,o=this.element,s=o.value;if(di(e))return!0!==i&&this._document.body.contains(o)?void(o.selectedIndex=-1):void this.itemsLoaded.then(function(){if(di(r._binder.evaluate())){var e=o.value;r.inputChanged(e,r.__lastValue),r.__lastValue=e}});li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)?(this._propertyType="boolean",e=e.toString()):(e=fi(e.toString)?e.toString():Object.prototype.toString.call(e),this._log.info('Trying to bind the invalid value "'+e+'" to a '+this.type+"."))),s!==e&&this.itemsLoaded.then(function(){if(r._document.body.contains(o))o.value=r.__lastValue=e,o.value===e&&-1!==o.selectedIndex||(o.selectedIndex=-1);else{if(o.value=e,o.value!==e){o.value=s;var t=r._castValue(o.value);r.inputChanged(t,r.__lastValue),r.__lastValue=t}r.__lastValue=e}})},t.prototype._setSelectedIndices=function(e,t,n,i){var r=this;this.itemsLoaded.then(function(){var t,n=r.element.options,o=di(e),s=di(n)?0:n.length;if(!o&&mi(e)){for(var a,l,u,c=1/0;s>0;)if(a=(t=n[s-=1]).value,-1===e.indexOf(a)){l=Number(a);var h=e.indexOf(l),p=e.indexOf(!0),_=e.indexOf(!1);_i(l)&&-1!==h?((u=h)<c&&(r._propertyType="number",c=u),t.selected=!0):"true"===a&&-1!==p||"false"===a&&-1!==_?((u=p>_?p:_)<c&&(r._propertyType="boolean",c=u),t.selected=!0):t.selected=!1}else t.selected=!0;r.__lastValue=e}else{if(!0===i&&di(r._binder.evaluate())){var f=r._getSelectedValues();r.inputChanged(f,r.__lastValue),r.__lastValue=f}for(;s>0;){if(t=n[s-=1],!o&&t.value===""+e)return void(t.selected=!0);t.selected=!1}r.__lastValue=e}})},t.prototype._observeChange=function(){var e=this.element,t=e.multiple?this._getSelectedValues():this._castValue(e.value);t!==this.__lastValue&&(this.inputChanged(t,this.__lastValue),this.__lastValue=t)},t.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).selected&&i.push(this._castValue(e.value));return i},t.prototype._castValue=function(e){var t,n=this._propertyType;if(di(n))return e;switch(n){case"number":t=hi(e)?null:Number(e);break;case"boolean":switch(e){case"true":t=!0;break;case"false":case"0":case"null":case"undefined":t=!1;break;default:t=!!e}break;default:t=e}return t},t.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},t.prototype._executeEvent=function(e){var t="_"+e[0].type;fi(this[t])&&this[t](e)},t.prototype._addItems=function(e,t){for(var n=this,i=this.bindableTemplates,r=[],o=this._insertOption;e>0;)e-=1,r.push(i.bind("option",t).then(o.bind(this,t))),t+=1;return r.length>0&&(this.itemsLoaded=this._Promise.all(r).then(function(){fi(n.__resolveFn)&&(n.__resolveFn(),n.__resolveFn=n.__rejectFn=null)}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),n._log.error(e)})})),this.itemsLoaded},t.prototype._insertOption=function(e,t){var n=this.element;if(this._isGrouped){var i=this.groups,r=this.context[e];ni(r)||(r={});var o=r[this._group],s=i[o];return di(s)?i[o]=this.bindableTemplates.bind("group",e).then(function(e){return(s=i[o]=e.childNodes[1]).insertBefore(t,null),n.insertBefore(e,null),s}):ci(s)?s.then(function(e){e.insertBefore(t,null)}):(s.insertBefore(t,null),this._Promise.resolve())}return n.insertBefore(t,null),this._Promise.resolve()},t.prototype._removeItems=function(e){for(var t=n.dispose,i=this.controls;e>0;)e-=1,t(i.pop())},t.prototype._removeItem=function(){this._isGrouped?this._resetSelect():this._removeItems(1)},t.prototype._resetSelect=function(){this._removeItems(this.controls.length),this.groups={},di(this._defaultOption)||this.element.insertBefore(this._defaultOption.cloneNode(!0),null),this._addItems(this.context.length,0)},t.prototype._push=function(e){var t=e[0];this._addItems(t.addedCount,t.index)},t.prototype._pop=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},t.prototype._unshift=function(e){if(this._isGrouped)this._resetSelect();else{var t=e[0],n=t.addedCount;this._addItems(n,t.object.length-n-1)}},t.prototype._shift=function(e){var t=this;0!==e[0].removed.length&&this.itemsLoaded.then(function(){t._removeItem()})},t.prototype._splice=function(e){var t=this;if(this._isGrouped)this._resetSelect();else{var n=e[0],i=n.addedCount,r=n.removed.length;i>r?this._addItems(i-r,n.object.length-i-1):r>i&&this.itemsLoaded.then(function(){t._removeItems(r-i)})}},t.prototype._sort=function(e){this._isGrouped&&this._resetSelect()},t.prototype._reverse=function(e){this._isGrouped&&this._resetSelect()},t._inject={_Promise:f,_document:m},t}(r);e.Select=u,sr.control(nt,u);var c=function(e){function t(){var t=e.call(this)||this;t._animate=!1,t.__condition=!0,t.__firstTime=!0,t.__isBound=!1;var n=t._document;return t.commentNode=n.createComment(""+et+wn+"placeholder"),t.fragmentStore=n.createDocumentFragment(),t}return __extends(t,e),t.prototype.contextChanged=function(){var e=this.options.value;if(!hi(e))return this._setter(e)},t.prototype.setTemplate=function(){this.bindableTemplates.add("template",Array.prototype.slice.call(this.element.childNodes))},t.prototype.loaded=function(){var e=this.options;ni(e)?this._animate=!0===e.value.animate:(this._log.warn("No condition specified in "+me+" for "+this.type+"."),this.options={value:{condition:!0},observe:Kn});var t=this.contextChanged();return this.__removeListener=this.options.observe(this._setter),t},t.prototype.dispose=function(){fi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null),fi(this.__cancelFrame)&&(this.__cancelFrame(),this.__cancelFrame=null),this.commentNode=null,this.fragmentStore=null},t.prototype._setter=function(e){var t,n,i,r=this,o=!!e.condition;return o!==this.__condition||this.__firstTime?(o?(t=this.__leavePromise,n=function(){return r.__leavePromise=null,r._addItem()}):(t=this.__enterPromise,n=function(){return r.__enterPromise=null,r._removeItem()}),i=di(t)?n():this._animate&&fi(t.cancel)?t.cancel().then(n):t.then(n),this.__firstTime=!1,this.__condition=o,i):this._Promise.resolve(null)},t.prototype._addItem=function(){var e=this,t=this.__isBound;return t&&!oi(this.commentNode.parentNode)?this._Promise.resolve(null):t?di(this.__initialBind)?this._animate?this._animateEntrance():this._elementEntrance():(this.__initialBind=this.__initialBind.then(function(){return e.__initialBind=null,e._animate?e._animateEntrance():e._elementEntrance()}),this.__initialBind):(this.__isBound=!0,this.__initialBind=this.bindableTemplates.bind("template").then(function(t){e.__initialBind=null;var n=e.element;return n.parentNode===e.fragmentStore||di(n.parentNode)?(n.insertBefore(t,null),e._animate?e._animateEntrance():e._elementEntrance()):e._animate?(e.__enterPromise=e._animator.animate(n,Dt).then(function(){e.__enterPromise=null}),n.insertBefore(t,null),e.__enterPromise):void n.insertBefore(t,null)}))},t.prototype._elementEntrance=function(){var e=this,t=this.commentNode,n=t.parentNode;return oi(n)?(this.__enterPromise=new this._Promise(function(i){e.__cancelFrame=Ri(function(){n.insertBefore(e.element,t),i()})}).then(function(){e.__enterPromise=null}),this.__enterPromise):this._Promise.resolve()},t.prototype._animateEntrance=function(){var e=this,t=this.commentNode,n=t.parentNode;return oi(n)?(this.__enterPromise=this._animator.enter(this.element,Dt,n,t).then(function(){e.__enterPromise=null}),this.__enterPromise):this._animator.resolve().then(Kn)},t.prototype._removeItem=function(){var e=this;return di(this.__initialBind)?this._animate?this._animateLeave():this._elementLeave():(this.__initialBind=this.__initialBind.then(function(){return e.__initialBind=null,e._animate?e._animateLeave():e._elementLeave()}),this.__initialBind)},t.prototype._elementLeave=function(){var e=this;return this.__leavePromise=new this._Promise(function(t){e.__cancelFrame=Ri(function(){var n=e.element,i=n.parentNode,r=n.nextSibling;oi(i)?(oi(e.commentNode.parentNode)||i.insertBefore(e.commentNode,r),e.fragmentStore.insertBefore(n,null),t()):t()})}).then(function(){e.__leavePromise=null}),this.__leavePromise},t.prototype._animateLeave=function(){var e=this,t=this.element;return this.__leavePromise=this._animator.leave(t,$t).then(function(){var n=t.parentNode,i=t.nextSibling;e.__leavePromise=null,oi(e.commentNode.parentNode)||n.insertBefore(e.commentNode,i),e.fragmentStore.insertBefore(t,null)}),this.__leavePromise},t._inject={_animator:M,_Promise:f,_document:m},t}(n);e.If=c,sr.control(et,c);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="a",t._router=t._Router.currentRouter(),t._allowClick=!1,t}return __extends(t,e),t.prototype.initialize=function(){this._removeClickListener=this.dom.addEventListener(this.element,"click",this._handleClick.bind(this),!1)},t.prototype.loaded=function(){var e=this.options,t=this.setHref.bind(this);if(!ni(e))return this._log.warn("No options specified for "+this.type+". Please send in options of type plat.ui.controls.ILinkOptions."),(e=this.options={}).value={view:""},void this.setHref();ni(e.value)||(e.value={view:""}),this.addEventListener(this.element,qt,this._handleTap,!1),t(),e.observe(t)},t.prototype.setHref=function(){var e=this.getHref();hi(e)||(this.element.href=e)},t.prototype.getHref=function(){if(!di(this._router)){var e=this.options.value,t=e.view;if(!0!==e.isUrl){var n=e.parameters,i=e.query;if(hi(t))return t;t=this._router.generate(t,n,i)}return this._browser.formatUrl(t)}},t.prototype.dispose=function(){Si(this._removeClickListener,3e3)},t.prototype._handleClick=function(e){if(this._allowClick)this._allowClick=!1;else{var t;if(_i(e.buttons)&&0!==e.buttons)t=e.buttons;else if(_i(e.which)&&e.which>0)t=e.which;else switch(e.button){case-1:t=0;break;case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;case 3:t=8;break;case 4:t=16;break;default:t=1}1===t&&e.preventDefault()}},t.prototype._handleTap=function(e){var t=this;if(1===e.buttons){var n=this.getHref();if(!vi(n)){var i=this.element.target;if(hi(i)||"_self"===i)return e.preventDefault(),void Ri(function(){t._browser.url(n)});this._allowClick=!0,this.element.click()}}},t._inject={_Router:W,_Injector:oe,_browser:Q,_window:G},t}(n);e.Link=h,sr.control(Je,h)}(t.controls||(t.controls={}))}(Mr=e.ui||(e.ui={})),function(e){var t=function(){function e(){}return e.prototype.compile=function(e,t){var n,i,r,o=!di(t)?this._managerCache.read(t.uid):null,s=this._ElementManagerFactory.create,a=e.childNodes;if(a=vi(a)?fi(e.push)?e:Array.prototype.slice.call(e):Array.prototype.slice.call(a),di(o)){n=a.length;for(var l=0;l<n;l+=1)(r=a[l]).nodeType===Node.ELEMENT_NODE&&(di(s(r))||this.compile(r)),l+=(i=a.length)-n,n=i}else this._compileNodes(a,o)},e.prototype._compileNodes=function(e,t){for(var n,i,r,o=this._ElementManagerFactory.create,s=this._CommentManagerFactory.create,a=this._TextManagerFactory.create,l=e.length,u=0;u<l;u+=1){switch((n=e[u]).nodeType){case Node.ELEMENT_NODE:di(i=o(n,t))||this._compileNodes(Array.prototype.slice.call(n.childNodes),i);break;case Node.TEXT_NODE:a(n,t);break;case Node.COMMENT_NODE:s(n,t)}u+=(r=e.length)-l,l=r}},e._inject={_ElementManagerFactory:j,_TextManagerFactory:L,_CommentManagerFactory:R,_managerCache:O},e}();e.Compiler=t,sr.injectable(I,t);var n=function(){function e(){this.isClone=!1}return e.hasMarkup=function(t){return e._markupRegex.test(t)},e.findMarkup=function(t){var n,i,r,o,s=vn.length,a=mn.length,l=mn[a-1],u=[],c=e._wrapExpression,h=e._parser;for(n=(t=t.replace(e._newLineRegex,"")).indexOf(vn),i=t.indexOf(mn);-1!==n&&-1!==i;){for(0!==n&&u.push(c(t.slice(0,n)));t[i]!==l||t[i+1]===l;)i+=1;i+=1,"="===(r=t.slice(n+s,i-a))[0]?((o=h.parse(r.slice(1).trim())).oneTime=!0,u.push(o)):u.push(h.parse(r.trim())),n=(t=t.slice(i)).indexOf(vn),i=t.indexOf(mn)}return n>=0&&i>=0?u.push(c(t.slice(i))):""!==t&&u.push(c(t)),u},e.build=function(t,n){for(var i,r=t.length,o={},s=e._TemplateControlFactory.evaluateExpression,a="",l=0;l<r;l+=1)if(ni(i=s(t[l],n,o)))try{a+=JSON.stringify(i,null,4)}catch(t){di(t.description)||(t.description="Cannot stringify object: "+t.description),t.message="Cannot stringify object: "+t.message,e._log.warn(t)}else di(i)||(a+=i);return a},e.observeExpressions=function(t,n,i){for(var r,o,s,a,l=e.__findUniqueIdentifiers(t),u=l.identifiers,c=l.oneTimeIdentifiers,h={listener:i,uid:n.uid};u.length>0;)o=e.__getObservationDetails(u.pop(),n),di(s=o.manager)||s.observe(o.absoluteIdentifier,h);for(var p=function(){if(r=c.pop(),o=e.__getObservationDetails(r,n),!di(s=o.manager)&&!o.isDefined){a=o.absoluteIdentifier;var t=s.observe(a,h),i=s.observe(a,{uid:n.uid,listener:function(){t(),i()}})}};c.length>0;)p()},e._wrapExpression=function(e){return{evaluate:function(){return e},identifiers:[],aliases:[],expression:e}},e.__findUniqueIdentifiers=function(e){var t,n=e.length;if(1===n)return!0===(t=e[0]).oneTime?{identifiers:[],oneTimeIdentifiers:t.identifiers.slice(0)}:{identifiers:t.identifiers.slice(0),oneTimeIdentifiers:[]};for(var i,r,o,s,a,l={},u={},c=[],h=[],p=0;p<n;p+=1)for(a=(t=e[p]).oneTime,s=(i=t.identifiers).length,o=0;o<s;o+=1)if(r=i[o],a){if(!0===l[r])continue;u[r]||(u[r]=!0,h.push(r))}else l[r]||(l[r]=!0,c.push(r)),!0===u[r]&&(u[r]=!1,h.splice(h.indexOf(r),1));return{identifiers:c,oneTimeIdentifiers:h}},e.__getObservationDetails=function(t,n){var i,r=e._ContextManager,o=t.split("."),s="",a=!1;if("@"===t[0]){var l={},u=o.shift().slice(1),c=void 0;if(o.length>0&&(s="."+o.join(".")),di(c=l[u])&&(c=l[u]=n.findResource(u)),!di(c)&&!di(c.resource)){var h=c.resource.type;u===Dn?(i=r.getManager(Or.getRootControl(n)),s=n.absoluteContextPath+s):u===Fn?(i=r.getManager(l[u].control),s="context"+s):h!==Rn&&h!==Pn||(i=r.getManager(l[u].control),s="resources."+u+".value"+s)}}else(a=!vi(r.getContext(n.context,o)))||vi(r.getContext(n,o))?(i=r.getManager(Or.getRootControl(n)),s=n.absoluteContextPath+"."+t):i=null;return{absoluteIdentifier:s,manager:i,isDefined:a}},e.prototype.initialize=function(e,t){this.nodeMap=e,this.parent=t,di(t)||(this.isClone=t.isClone,t.children.push(this))},e.prototype.getParentControl=function(){for(var e,t=this.parent;di(e)&&!di(t);)e=t.getUiControl(),t=t.parent;return e},e.prototype.clone=function(e,t){return 1},e.prototype.bind=function(){},e}();function i(e,t,i,r,o){return n._markupRegex=e.markupRegex,n._newLineRegex=e.newLineRegex,n._ContextManager=t,n._parser=i,n._TemplateControlFactory=r,n._log=o,n}e.NodeManager=n,e.INodeManagerStatic=i,sr.injectable(A,i,[T,S,w,V,E],gn);var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=[],t.type="element",t.replace=!1,t.hasOwnContext=!1,t}return __extends(t,e),t.create=function(e,n){var i=e.nodeName.toLowerCase(),r=i,o=_r[i];ni(o)||(o=fr[i]);var s,a=!0,l=!1;if(di(o)&&(e.hasAttribute(ot)?(i=e.getAttribute(ot).toLowerCase(),ni(o=_r[i])||(o=fr[i]),a=!1):e.hasAttribute(ht+ot)&&(i=e.getAttribute(ht+ot).toLowerCase(),ni(o=_r[i])||(o=fr[i]),a=!1)),!di(o)){var u=o.inject();s={control:u,resourceElement:t.locateResources(e),nodeName:i,expressions:[],injector:o},l=!0,a&&e.setAttribute(ot,i);var c=u.replaceWith,h="any"===c&&a;if(!hi(c)&&("any"!==c||h)&&c.toLowerCase()!==r){h&&(c="div");var p=t._document.createElement(c);p.nodeType===Node.ELEMENT_NODE&&(e=Ji(e,p))}}var _=t._collectAttributes(e.attributes),f=t.getInstance();return _.element=e,!l&&li(_.childContext)?(o=vr[q],l=!0,_.uiControlNode={control:o.inject(),resourceElement:null,nodeName:ut,expressions:[],injector:o}):_.uiControlNode=s,f.initialize(_,n),_.hasControl||l?(f.setUiControlTemplate(),l?null:f):(f.bind=function(){return[]},f)},t.locateResources=function(e){for(var t,n,i=Array.prototype.slice.call(e.childNodes);i.length>0;)if((n=(t=i.shift()).nodeName.toLowerCase())===at||n==="x-"+at)return e.removeChild(t);return null},t.clone=function(e,n,i,r,o){if(di(o)){var s=n.getUiControl();ni(s)||(s=n.getParentControl()),o=t._cloneNodeMap(e.nodeMap,i,s,r)}var a=t.getInstance(),l=!di(r);return a.nodeMap=o,a.parent=n,di(n)||n.children.push(a),a.replace=e.replace,a.replaceNodeLength=e.replaceNodeLength,a.hasOwnContext=e.hasOwnContext,a.isClone=!0,o.hasControl||l||(a.bind=function(){return[]}),l&&t._managerCache.put(r.uid,a),a},t.cloneUiControl=function(e,n){var i=e.uiControlNode;if(!di(i)&&!di(i.injector)){var r=i.control,o=i.injector.inject(),s=t._ResourcesFactory.getInstance(),a=t._AttributesFactory.getInstance();return o.parent=n,n.controls.push(o),o.controls=[],a.initialize(o,e.attributes),o.attributes=a,s.initialize(o,r.resources),o.resources=s,t._ResourcesFactory.addControlResources(o),di(r.innerTemplate)||(o.innerTemplate=r.innerTemplate.cloneNode(!0)),o.type=r.type,o.bindableTemplates=t._BindableTemplatesFactory.create(o,r.bindableTemplates),o.replaceWith=r.replaceWith,o}},t.createAttributeControls=function(e,n,i,r,o){var s,a=e.nodes,l=!0===o?r:e.element;if(oi(l)){if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0===o?t._copyAttributeNodes(a):[];s=l.attributes}var u,c,h,p,_,f,d=e.attributes,v=[],m=a.length;for(f=0;f<m;f+=1)if(_=(c=a[f]).nodeName,p=null,di(h=c.injector)||(p=h.inject(),c.control=p,p.parent=n,p.element=l,(u=t._AttributesFactory.getInstance()).initialize(p,d),p.attributes=u,p.type=_,li(p.uid)||(p.uid=ji(le)),p.templateControl=i),!0===o){var g=null;ni(s)&&(ni(g=s.getNamedItem(_))||(g=s.getNamedItem(ht+_))),v.push({control:p,expressions:c.expressions,node:g,nodeName:_,injector:h}),di(p)||(di(n)||n.controls.push(p),fi(p.initialize)&&p.initialize())}if(!o)for(a.sort(function(e,t){var n=e.control,i=t.control;if(di(n))return 1;if(di(i))return-1;var r=_i(n.priority)?n.priority:0;return(_i(i.priority)?i.priority:0)-r}),f=0;f<m;f+=1)di(p=(c=a[f]).control)||(di(n)||n.controls.push(p),fi(p.initialize)&&p.initialize());return v},t.getInstance=function(){var e=new t;return e._Promise=Cr(f),e._ContextManager=n._ContextManager,e._compiler=Cr(I),e._CommentManagerFactory=Cr(R),e._ControlFactory=Cr(v),e._TemplateControlFactory=n._TemplateControlFactory,e._BindableTemplatesFactory=t._BindableTemplatesFactory,e._log=t._log,e},t._collectAttributes=function(e){for(var i,r,o,s,a,l,u,c,h=[],p=n.hasMarkup,_=n.findMarkup,f=n._parser,d=e.length,v={},m=!1,g=0;g<d;g+=1)o=(i=e[g]).value,r=i.name.replace(/^data-/i,"").toLowerCase(),ni(c=_r[r])||(c=fr[r]),r===lt?""!==o&&(1!==(s=f.parse(o)).identifiers.length&&t._log.warn("Incorrect "+lt+": "+o+", must contain a single identifier."),a=s.identifiers[0]):r!==ot&&(u=(l=p(o))?_(o):[],m||!l&&di(c)||(m=!0),h.push({control:null,node:i,nodeName:r,expressions:u,injector:c})),v[Ai(r)]=o;return{element:null,attributes:v,nodes:h,childContext:a,hasControl:m}},t._copyAttributeNodes=function(e){for(var t,n=[],i=e.length,r=0;r<i;r+=1)t=e[r],n.push({expressions:t.expressions,nodeName:t.nodeName});return n},t._cloneNode=function(e,t,n){return{control:n,injector:e.injector,expressions:e.expressions,node:t,nodeName:e.nodeName}},t._cloneNodeMap=function(e,n,i,r){var o=e.hasControl,s={attributes:e.attributes,childContext:e.childContext,nodes:[],element:n,uiControlNode:di(e.uiControlNode)?null:t._cloneNode(e.uiControlNode,n,r),hasControl:o};return o&&(s.nodes=t.createAttributeControls(e,i,r,n,!0)),s},t.prototype.clone=function(e,n,i){var r,o,s,a,l=this.replace,u=this.children,c=di(i)?null:i.uiControlNode.control,h=!di(c);if(!h){var p=n.getUiControl();ni(p)||(p=n.getParentControl()),h=!di(c=t.cloneUiControl(this.nodeMap,p))}if(l){var _=e.parentNode.childNodes,f=Array.prototype,d=f.indexOf.call(_,e);r=f.slice.call(_,d+1,d+this.replaceNodeLength),o=t.clone(this,n,null,c,i),c.elementNodes=r,c.startNode=e,c.endNode=r.pop(),s=u.shift(),a=u.shift(),s.clone(c.startNode,o),a.clone(c.endNode,o),fi(c.initialize)&&c.initialize()}else r=Array.prototype.slice.call(e.childNodes),i=(o=t.clone(this,n,e,c,i)).nodeMap,h&&(c.element=e,fi(c.initialize)&&c.initialize());for(var v=u.length,m=0,g=0;g<v;g+=1)m+=u[g].clone(r[m],o);return l?(u.unshift(a),u.unshift(s),m+2):1},t.prototype.initialize=function(n,i,r){e.prototype.initialize.call(this,n,i);var o,s=n.uiControlNode,a=!di(s);a&&(this._populateUiControl(),o=s.control,this.hasOwnContext=o.hasOwnContext),n.hasControl&&t.createAttributeControls(n,this.getParentControl(),o),!r&&a&&fi(o.initialize)&&o.initialize()},t.prototype.bind=function(){var e=this,t=this.nodeMap,n=this.getParentControl(),i=t.uiControlNode,r=[];if(!di(i)){var o,s=i.control,a=this._TemplateControlFactory,l=!s.hasOwnContext,c=this._ContextManager.getManager,h=t.childContext,p=di(n)?u:n.absoluteContextPath;if(r.push(s),l&&!di(h))if("@"===h[0]){var _=h.split("."),f=_.shift().slice(1),d=a.findResource(s,f);if(ni(d)){var v=d.resource;h=_.length>0?"."+_.join("."):"",f===Dn?p+=h:f===Fn?p=u+h:v.type===Rn||v.type===Pn?(p="resources."+f+".value"+h,s.root=d.control):this._log.warn('Only resources of type "observable" can be set as context.')}else this._log.warn("Could not set the context of "+s.type+' with the resource specified as "'+h+'".')}else p+="."+h;ni(s.root)||(s.root=this._ControlFactory.getRootControl(s),ni(s.root)||(s.root=s)),o=c(s.root);var m=!1;l?(s.context=o.getContext(p.split("."),!1),m=vi(s.context)&&!this._BindableTemplatesFactory.isBoundControl(s)):p=u,m?this.contextPromise=new this._Promise(function(t,n){var i=o.observe(p,{uid:s.uid,listener:function(n,r){vi(n)||(i(),s.context=n,e._beforeLoad(s,p),t())}})}):this._beforeLoad(s,p)}return this._observeControlIdentifiers(t.nodes,n,r,t.element),r},t.prototype.setUiControlTemplate=function(e){var t=this,n=this.nodeMap.uiControlNode;if(di(n))di(this.parent)&&this.bindAndLoad();else{var i=n.control;this.templatePromise=this._TemplateControlFactory.determineTemplate(i,e).then(function(e){t.templatePromise=null,t._initializeControl(i,e.cloneNode(!0))},function(e){if(t.templatePromise=null,di(e)){var n=e;t._BindableTemplatesFactory.isBoundControl(i)&&(n=Hi(i.element.childNodes)),t._initializeControl(i,n)}else ki(function(){li(e)&&(e=new Error(e)),t._log.error(e)})})}},t.prototype.getUiControl=function(){var e=this.nodeMap.uiControlNode;if(!di(e))return e.control},t.prototype.fulfillTemplate=function(){var e=this;return di(this.templatePromise)?this._fulfillChildTemplates():this.templatePromise.then(function(){return e._fulfillChildTemplates()})},t.prototype.fulfillAndLoad=function(){var e=this;return this.fulfillTemplate().then(function(){return e.bindAndLoad()}).catch(function(t){ki(function(){li(t)&&(t=new Error(t)),e._log.error(t)})})},t.prototype.bindAndLoad=function(){var e=this,t=this.bind();return(ci(this.contextPromise)?this.contextPromise.then(function(){return e._bindChildren()}):this._bindChildren()).then(function(){return e._loadControls(t,e.getUiControl())}).catch(function(t){ki(function(){li(t)&&(t=new Error(t)),e._log.error(t)})})},t.prototype.observeRootContext=function(e,t){var n=this;return t=t.bind(this),di(e.context)?new this._Promise(function(i){var r=n._ContextManager.getManager(e).observe(u,{listener:function(){r(),t().then(i)},uid:e.uid})}).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),n._log.error(e)})}):t()},t.prototype._beforeLoad=function(e,n){var i=this._ContextManager.getManager(e.root),r=this._TemplateControlFactory;e.zCC__plat=i.observe(n,{uid:e.uid,priority:1e3,listener:function(t,n){e.context=t}}),r.setAbsoluteContextPath(e,n),r.setContextResources(e),t._ResourcesFactory.bindResources(e.resources)},t.prototype._bindChildren=function(){for(var e,t=this.children,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).hasOwnContext?this.isClone?i.push(e.observeRootContext(e.getUiControl(),e.bindAndLoad)):i.push(e.observeRootContext(e.getUiControl(),e.fulfillAndLoad)):vi(e.children)?e.bind():i.push(e.bindAndLoad());return this._Promise.all(i)},t.prototype._loadControls=function(e,t){var n,i,r,o,s=e.length,a=this._ControlFactory.load,l=di(t);if(l)o=0;else{var u=t.priority;r=_i(u)?u:100,o=1}for(;o<s;o+=1)(n=e[o]).templateControl=t,!l&&r>n.priority&&(l=!0,i=a(t)),a(n);return l||(i=a(t)),i},t.prototype._populateUiControl=function(){var e=this.nodeMap,n=this.getParentControl(),i=e.uiControlNode,r=i.control,o=e.element,s=Array.prototype.slice.call(o.childNodes),a=t._AttributesFactory.getInstance(),l=this.replace=null===r.replaceWith||""===r.replaceWith,u=r.uid,c=r.resources;li(u)||(u=r.uid=ji(le)),t._managerCache.put(u,this),di(n)||r.parent===n||(n.controls.push(r),r.parent=n),fi(o.setAttribute)&&o.setAttribute(Pt,""),r.element=o,r.controls=[],a.initialize(r,e.attributes),r.attributes=a,ni(c)&&fi(c.add)?c.add(i.resourceElement):((c=t._ResourcesFactory.getInstance()).initialize(r,i.resourceElement),r.resources=c),t._ResourcesFactory.addControlResources(r),r.type=i.nodeName,ni(r.bindableTemplates)||(r.bindableTemplates=this._BindableTemplatesFactory.create(r)),!(s.length>0)||hi(r.templateString)&&hi(r.templateUrl)||(r.innerTemplate=Hi(s)),l&&this._replaceElement(r,e)},t.prototype._replaceElement=function(e,n){var i=n.element,r=i.parentNode,o=t._document,s=e.type,a=e.uid,l=e.startNode=o.createComment(s+" "+a+Nn),u=e.endNode=o.createComment(s+" "+a+kn),c=this._CommentManagerFactory.create;c(l,this),c(u,this),r.insertBefore(l,i),r.insertBefore(u,i.nextSibling),e.elementNodes=Gi(i),e.element=n.element=null},t.prototype._initializeControl=function(e,n){var i,r=this.nodeMap.element,o=this.replace;if(!di(n)){var s=t.locateResources(n);di(s)||e.resources.add(t._ResourcesFactory.parseElement(s)),o?(i=e.endNode,e.elementNodes=Array.prototype.slice.call(n.childNodes),Xi(i.parentNode,n,i)):Xi(r,n,r.lastChild)}if(fi(e.setTemplate)&&e.setTemplate(),o){this._compiler.compile(e.elementNodes,e);var a=e.startNode,l=a.parentNode,u=Array.prototype.slice.call(l.childNodes);i=e.endNode,e.elementNodes=u.slice(u.indexOf(a)+1,u.indexOf(i)),this.replaceNodeLength=e.elementNodes.length+2}else this._compiler.compile(r,e);di(e.parent)&&this.fulfillAndLoad()},t.prototype._observeControlIdentifiers=function(e,t,i,r){for(var o,s,a,l=!di(t),u=this.replace,c=[],p=e.length,_=0;_<p;_+=1)s=(o=e[_]).control,l&&o.expressions.length>0&&(a=h.getInstance(),c.push(a),a.initialize(r,o,t,i,u),n.observeExpressions(o.expressions,t,a.attributeChanged.bind(a))),di(s)||i.push(s);for(p=c.length,_=0;_<p;_+=1)c[_].attributeChanged()},t.prototype._fulfillChildTemplates=function(){for(var e,t=this,n=this.children,i=n.length,r=[],o=0;o<i;o+=1)vi((e=n[o]).children)||r.push(e.fulfillTemplate());return this._Promise.all(r).catch(function(e){ki(function(){li(e)&&(e=new Error(e)),t._log.error(e)})})},t._inject={_Promise:f,_ContextManager:S,_compiler:I,_CommentManagerFactory:R,_ControlFactory:v,_TemplateControlFactory:V,_BindableTemplatesFactory:$,_log:E},t}(n);function o(e,t,n,i,o,s){return r._document=e,r._managerCache=t,r._ResourcesFactory=n,r._AttributesFactory=i,r._BindableTemplatesFactory=o,r._log=s,r}e.ElementManager=r,e.IElementManagerFactory=o,sr.injectable(j,o,[m,O,U,D,$,E],Cn),sr.injectable("$ElementManagerInstance",r,null,bn);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="text",t}return __extends(t,e),t.create=function(e,i){var r=e.nodeValue,o=new t;if(n.hasMarkup(r)){var s={nodes:[{node:e,expressions:n.findMarkup(r)}]};return o.initialize(s,i),o}return o.initialize(null,i),o.bind=Kn,o},t._cloneNodeMap=function(e,t){var n=e.nodes[0];return{nodes:[{expressions:n.expressions,nodeName:n.nodeName,node:t}]}},t._clone=function(e,n,i){var r=e.nodeMap,o=new t;return di(r)?(o.initialize(null,i),o.bind=Kn):o.initialize(t._cloneNodeMap(r,n),i),o},t.prototype.clone=function(e,n){return t._clone(this,e,n),1},t.prototype.bind=function(){var e=this.getParentControl(),t=this.nodeMap.nodes[0],i=t.node,r=t.expressions;n.observeExpressions(t.expressions,e,this._setText.bind(this,i,e,r)),this._setText(i,e,r)},t.prototype._setText=function(e,t,i){ni(t)||(t={}),e.nodeValue=n.build(i,t)},t}(n);function a(){return s}e.TextManager=s,e.ITextManagerFactory=a,sr.injectable(L,a,null,Cn),sr.injectable("$TextManagerInstance",s,null,bn);var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="comment",t}return __extends(t,e),t.create=function(e,n){var i=new t;return i.initialize({nodes:[{node:e}]},n),i},t.prototype.clone=function(e,n){return t.create(e,n),1},t}(n);function c(){return l}e.CommentManager=l,e.ICommentManagerFactory=c,sr.injectable(R,c,null,Cn),sr.injectable("$CommentManagerInstance",l,null,bn);var h=function(){function e(){this._lastValues={}}return e.getInstance=function(){var t=new e;return t._NodeManager=Cr(A),t},e.prototype.initialize=function(e,t,n,i,r){this.element=e,this.node=t,this.parent=n,this._controls=i,this.replace=r,t.nodeName!==xn?this.attributeChanged=this._staticAttributeChanged:this.attributeChanged=this._dynamicAttributeChanged},e.prototype._dynamicAttributeChanged=function(){var e,t,n=this.node,i=n.node,r=this._NodeManager,o=this._lastValues,s=this.element,a=i.value,l=r.build(n.expressions,this.parent).trim().split(/\s+/),u=l.length;if(r.hasMarkup(a)){vn.length;for(var c=mn.length,h=mn[c-1],p=a.indexOf(vn),_=a.indexOf(mn);-1!==p&&-1!==_;){for(;a[_]!==h||a[_+1]===h;)_+=1;p=(a=a.slice(0,p).trim()+" "+a.slice(_).trim()).indexOf(vn),_=a.indexOf(mn)}i.value=a.trim()}for(t=0;t<u;t+=1)o[l[t]]=!0;for(u=(l=Object.keys(o)).length,t=0;t<u;t+=1)o[e=l[t]]?(ir(s,e),o[e]=!1):(Li(o,e),rr(s,e));this._notifyAttributes(n.nodeName,i.value)},e.prototype._staticAttributeChanged=function(){this._controls;var e=this.node,t=Ai(e.nodeName),n=this._NodeManager.build(e.expressions,this.parent);this._notifyAttributes(t,n),this.replace||(e.node.value=n)},e.prototype._notifyAttributes=function(e,t){for(var n,i,r=this._controls,o=r.length,s=0;s<o;s+=1)i=(n=r[s].attributes)[e],n[e]=t,n._attributeChanged(e,t,i)},e}();e.AttributeManager=h}(e.processing||(e.processing={})),function(e){var t=function(){function e(){this.uid=ji(le),this.isRoot=!1,this._removeUrlListener=Kn,this._ignoreOnce=!1,this._backNavigate=!1}return e.prototype.initialize=function(t){this._router=t,ni(t)&&t.isRoot&&!ni(e._root)&&(this.isRoot=!0,e._root=this,this._observeUrl())},e.prototype.navigate=function(e,t){var n,i=this;return t=ni(t)?t:{},this.finishNavigating().then(function(){if(!li(n=t.isUrl?e:i._generate(e,t.parameters,t.query))){var r=new Error("Cannot serialize url from input parameters, check your view reference.");i._log.error(r)}return i._navigate(n,t.replace)})},e.prototype.finishNavigating=function(){var t=e._root._router;return t.navigating?t.finishNavigating.catch(Kn):this._Promise.resolve()},e.prototype.goBack=function(t){var n=this;t=ni(t)?t:{};var i=Number(t.length);return _i(i)||(i=1),this.isRoot?this.finishNavigating().then(function(){return n._backNavigate=!0,n._goBack(i)}):e._root.goBack(t)},e.prototype.isBackNavigation=function(){return this.isRoot?this._backNavigate:e._root.isBackNavigation()},e.prototype.dispose=function(){this._removeUrlListener(),Li(this,"router")},e.prototype._navigate=function(t,n){var i=this;return this.isRoot?new this._Promise(function(e,r){i._resolveNavigate=e,i._rejectNavigate=r,i._browser.url()===i._browser.url(t,n)&&i._resolveNavigate()}):e._root._navigate(t,n)},e.prototype._goBack=function(e){var t=this;return new this._Promise(function(n,i){t._resolveNavigate=n,t._rejectNavigate=i,t._browser.back(e)})},e.prototype._observeUrl=function(){var e=this;if(ni(this._router)){var t,n=this._EventManager,i=Cr(_t),r=ni(i)&&fi(i.navigated),o=function(n){e._previousUrl=t;var i=e._history,r=i.state;e._ignoreOnce=!0,di(r.previousLocation)||r.previousLocation===t?i.go(-1):i.go(1),e._backNavigate=!1,fi(e._rejectNavigate)&&e._rejectNavigate(n),hi(n)||e._log.warn(n)};this._previousUrl=this._browser.url(),n.dispose(this.uid),n.on(this.uid,At,function(){n.dispatch("backButtonPressed",e,n.DIRECT).defaultPrevented||e.goBack()}),n.on(this.uid,Rt,function(s,a){if(e._ignoreOnce)return e._ignoreOnce=!1,void(fi(e._resolveNavigate)&&(e._backNavigate=!1,e._resolveNavigate()));t=e._previousUrl,n.dispatch(St,e,n.DIRECT,[a]).defaultPrevented?o(new Error("Navigation prevented during "+St+" event")):e.finishNavigating().then(function(){return n.dispatch(It,e,n.DIRECT,[a]),e._router.navigate(a.pathname,a.query)}).then(function(){e._previousUrl=a.pathname,fi(e._resolveNavigate)&&(e._backNavigate=!1,e._resolveNavigate()),r&&i.navigated(a.href),n.dispatch("navigated",e,n.DIRECT,[a])},o)})}},e.prototype._generate=function(e,t,n){if(!di(this._router))return hi(e)?e:this._router.generate(e,t,n)},e._inject={_Promise:f,_Injector:oe,_browserConfig:Y,_browser:Q,_EventManager:b,_window:G,_log:E,_history:se},e}();function n(e){return e.history}e.Navigator=t,sr.injectable(k,t,null,bn),e.History=n,sr.injectable(se,n,[G]);var i,r=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),o={},s={},a={},l=function(){function e(){this.type=hn,this.name="",this.regex=""}return e.parse=function(t,n,r){if(!(li(t)&&mi(n)&&ni(r)))return[];"/"===t[0]&&(t=t.slice(1));for(var l,u,c,h=t.split("/"),p=h.length,_=e.__findSegment,f=[],d=e._regex,v=0;v<p;v+=1)""!==(l=h[v])?ni(c=l.match(d.dynamicSegmentsRegex))?(u=c[1],f.push(_(u,ee,o)),n.push(u),r.dynamics+=1):ni(c=l.match(d.splatSegmentRegex))?(u=c[1],f.push(_(u,te,s)),n.push(u),r.splats+=1):(f.push(_(l,Z,a)),r.statics+=1):(ni(i)||(i=Cr(K)),f.push(i));return f},e.__findSegment=function(e,t,n){var i=n[e];return ni(i)||(i=n[e]=Cr(t)).initialize(e),i},e.prototype.initialize=function(e){this.name=e},e.prototype.reduceCharacters=function(e,t){return ni(this._specification)&&(t=e(t,this._specification)),t},e.prototype.generate=function(e){return this.name},e}();function u(e){return l._regex=e,l}e.BaseSegment=l,e.IBaseSegmentFactory=u,sr.injectable(J,u,[T],Cn),sr.injectable(K,l,null,bn);var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=_n,t}return __extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.regex=this.name.replace(r,"\\$1")},t.prototype.reduceCharacters=function(e,t){for(var n=this.name,i=n.length,r=t,o=0;o<i;o+=1)r=e(r,{validCharacters:n[o]});return r},t}(l);e.StaticSegment=c,sr.injectable(Z,c,null,bn);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=pn,t}return __extends(t,e),t.prototype.generate=function(e){if(ni(e))return e[this.name]},t}(l);e.VariableSegment=h,sr.injectable("$VariableSegmentInstance",h,null,bn);var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=fn,t.regex="(.+)",t._specification={invalidCharacters:"",repeat:!0},t}return __extends(t,e),t}(h);e.SplatSegment=p,sr.injectable(te,p,null,bn);var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=dn,t.regex="([^/]+)",t._specification={invalidCharacters:"/",repeat:!0},t}return __extends(t,e),t}(h);e.DynamicSegment=_,sr.injectable(ee,_,null,bn);var d=function(){function e(){this.initialize()}return e.compile=function(e,t){return e.reduceCharacters(function(e,t){return e.add(t)},t)},e.link=function(e,t){for(var n,i,r,o,s,a=e.delegates,l=e.regex,u=a.length,c=t.match(l),h=[],p=1,_=0;_<u;_+=1){for(i={},o=(n=(s=a[_]).names).length,r=0;r<o;r+=1)i[n[r]]=c[p],p+=1;h.push({delegate:s.delegate,parameters:i,isDynamic:o>0})}return h},e.recognize=function(e,t){for(var n,i=[],r=t.length,o=0;o<r;o+=1)n=t[o],i=i.concat(n.match(e));return i},e.sort=function(e){return mi(e)?e.sort(function(e,u){if(t=e.types,o=u.types,n=t.splats,s=o.splats,n!==s)return n-s;if(i=t.statics,r=t.dynamics,a=o.statics,l=o.dynamics,n>0){if(i!==a)return a-i;if(r!==l)return l-r}return r!==l?r-l:i!==a?a=i:0}):e;var t,n,i,r,o,s,a,l},e.prototype.initialize=function(e){this.specification=e,this.nextStates=[]},e.prototype.add=function(t){var n=this._find(t);return ni(n)?n:((n=Cr(e)).initialize(t),this.nextStates.push(n),t.repeat&&n.nextStates.push(n),n)},e.prototype.match=function(e){var t,n,i=[];return this._someChildren(function(r){t=r.specification,li(n=t.validCharacters)&&n.indexOf(e)>-1?i.push(r):li(n=t.invalidCharacters)&&-1===n.indexOf(e)&&i.push(r)}),i},e.prototype._find=function(e){var t,n,i=e.validCharacters,r=e.invalidCharacters;return this._someChildren(function(e){if((t=e.specification).validCharacters===i&&t.invalidCharacters===r)return n=e,!0}),n},e.prototype._someChildren=function(e){for(var t=this.nextStates,n=t.length,i=0;i<n;i+=1)if(!0===e(t[i]))return!0;return!1},e}();function v(){return d}e.State=d,e.IStateStatic=v,sr.injectable(ne,v,null,gn),sr.injectable(ie,d,null,bn);var m=function(){function e(){this._namedRoutes={}}return e.prototype.register=function(e,t){if(mi(e)){for(var n,i=this._rootState,r=e.length,o=["^"],s={statics:0,dynamics:0,splats:0},a=[],l=[],u=0;u<r;u+=1)n=this._parse(e[u],a,s),l=l.concat(n),i=this._compile(n,i,o);(i=this._finalize(i,o)).delegates=a,i.regex=new RegExp(o.join("")+"$"),i.types=s,ni(t)&&li(t.name)&&(this._namedRoutes[this._toLowerCase(t.name)]={segments:l,delegates:a})}},e.prototype.recognize=function(e){var t,n;return e=this._addLeadingSlash(e),(t=this._hasTrailingSlash(e))&&(e=e.substr(0,e.length-1)),n=this._filter(this._findStates(e)),this._link(n[0],e,t)},e.prototype.generate=function(e,t){e=this._toLowerCase(e);var n,i,r=this._namedRoutes[e],o="";if(ni(r)){i=(n=r.segments).length;for(var s=0;s<i;s+=1){var a=n[s];a.type!==hn&&(o+="/",o+=a.generate(t))}return o=this._addLeadingSlash(o)}},e.prototype.delegatesFor=function(e){e=this._toLowerCase(e);var t,n=this._namedRoutes[e];return ni(n)&&mi(t=n.delegates)?t.slice(0):[]},e.prototype.exists=function(e){return ni(this._namedRoutes[this._toLowerCase(e)])},e.prototype._toLowerCase=function(e){return li(e)?e.toLowerCase():e},e.prototype._finalize=function(e,t){return e===this._rootState&&(e=e.add({validCharacters:"/"}),t.push("/")),e},e.prototype._parse=function(e,t,n){var i=[];return t.push({delegate:e.delegate,names:i}),this._BaseSegmentFactory.parse(e.pattern,i,n)},e.prototype._compile=function(e,t,n){for(var i,r=e.length,o=this._State.compile,s=0;s<r;s+=1)(i=e[s]).type!==hn&&(t=o(i,t=t.add({validCharacters:"/"})),n.push("/"+i.regex));return t},e.prototype._addLeadingSlash=function(e){return"/"!==(e=decodeURI(e))[0]&&(e="/"+e),e},e.prototype._hasTrailingSlash=function(e){var t=e.length;return t>1&&"/"===e[t-1]},e.prototype._findStates=function(e){for(var t=[this._rootState],n=this._State.recognize,i=e.length,r=0;r<i&&0!==(t=n(e[r],t)).length;r+=1);return t},e.prototype._filter=function(e){for(var t,n=e.length,i=[],r=0;r<n;r+=1)mi((t=e[r]).delegates)&&i.push(t);return this._State.sort(i)},e.prototype._link=function(e,t,n){if(ni(e)&&mi(e.delegates))return n&&this._isDynamic(e)&&(t+="/"),this._State.link(e,t)},e.prototype._isDynamic=function(e){return"(.+)$"===e.regex.source.slice(-5)},e._inject={_BaseSegmentFactory:J,_State:ne,_rootState:ie},e}();e.RouteRecognizer=m,sr.injectable(re,m,null,bn);var g="/*childRoute",y=g.length,C=function(){function e(){this.navigating=!1,this.children=[],this.isRoot=!1,this._paramTransforms={},this._queryTransforms={},this._interceptors={},this._ports=[],this._resolve=this._Promise.resolve.bind(this._Promise),this._reject=this._Promise.reject.bind(this._Promise),this.uid=ji(le),this.isRoot=di(e.currentRouter()),e.currentRouter(this),this.initialize()}return e.currentRouter=function(t){return di(t)||(e.__currentRouter=t),e.__currentRouter},e.prototype.initialize=function(e){this.parent=e},e.prototype.addChild=function(e){return di(e)||this.children.indexOf(e)>-1?e:(e.initialize(this),this.children.push(e),e)},e.prototype.removeChild=function(t){var n=this.children,i=n.indexOf(t);i<0||(n.splice(i,1),e.currentRouter()===t&&e.currentRouter(this))},e.prototype.register=function(e){var t=this,n=this._ports;return di(e)||n.indexOf(e)>-1?this._resolve():(n.push(e),ni(this.currentRouteInfo)?(this.navigating=!0,this._resolve(this.finishNavigating).catch(Kn).then(function(){var e=ti(t.currentRouteInfo,!0);return t.finishNavigating=t._canNavigateTo(e).then(function(n){if(n)return t.currentRouteInfo=void 0,t._performNavigation(e)}).then(function(){t.navigating=!1,t.currentRouteInfo=e},function(){t.navigating=!1})})):this._resolve())},e.prototype.unregister=function(e){var t=this._ports,n=t.indexOf(e);n<0||(t.splice(n,1),0!==t.length||di(this.parent)||this.parent.removeChild(this))},e.prototype.configure=function(e,t){var n=this;return mi(e)?Ci(function(e){n._configureRoute(e)},e):this._configureRoute(e),!1!==t?this._forceNavigate():this._resolve()},e.prototype.unknown=function(e){return this._unknownHandler=e,this},e.prototype.param=function(e,t,n){return this._addHandler(e,t,n,this._paramTransforms)},e.prototype.queryParam=function(e,t,n){return this._addHandler(e,t,n,this._queryTransforms)},e.prototype.intercept=function(e,t){vi(t)&&(t="*");var n=t;"*"!==t&&(t=this._Injector.convertDependency(t)),t===Sn&&(t=n);var i=this._interceptors[t];return mi(i)||(i=this._interceptors[t]=[]),i.push(e),this},e.prototype.navigate=function(e,t,n,i){var r=this;!1===i&&(i=!ni(this.currentRouteInfo)),ni(t)||(t={});var o=this._resolve,s=Fi(t);if("/"===e&&(e=""),n=!0===n,!li(e)||this.navigating||!n&&e===this._previousUrl&&s===this._previousQuery)return this.navigating?this.finishNavigating.then(function(){return r.navigate(e,t,n)}):o();var a,l,u,c=this._recognizer,h=c.recognize(e),p=hi(h);p||((a=h[0]).query=t);var _=this._isSameRoute(a);if(p||_){var f=e;if(_){var d=a.delegate.alias;hi(d)&&(d=a.delegate.view),u=c.generate(d,a.parameters),f=f.replace(u,"")}if("/"===f||""===f?(f="",Ni(function(e){return!hi(h=e._recognizer.recognize(f))},this.children)):h=this._childRecognizer.recognize(f),hi(h)){if(p){if(this._previousUrl=f,this._previousQuery=s,this.currentRouteInfo=a,fi(this._unknownHandler)){var v={segment:e,view:void 0};return o(this._unknownHandler(v)).then(function(){var t=v.view;if(!vi(t))return r.configure({pattern:e,view:t})})}return o()}h=c.recognize(e),(a=h[0]).query=t,l=a.delegate.pattern}else if((a=h[0]).query=t,l=(l=a.delegate.pattern).slice(0,l.length-y),!p||this._isSameRoute(a))return this.navigating=!0,this.finishNavigating=this._navigateChildren(a).then(function(){r._previousUrl=e,r._previousQuery=s,r.navigating=!1},function(e){throw r.navigating=!1,e})}else l=a.delegate.pattern;var m=a.delegate.alias;hi(m)&&(m=a.delegate.view),u=c.generate(m,a.parameters);var g=this._previousSegment;this._previousSegment=u,this.navigating=!0;var b=this._nextRouteInfo=ti(a,!0);return this.finishNavigating=this._canNavigate(a,i).then(function(t){if(!t)throw r.navigating=!1,new Error("Not cleared to navigate");return r._previousUrl=e,r._previousQuery=s,r._performNavigation(a)}).then(function(){r._previousPattern=l,r._previousSegment=u,r.currentRouteInfo=b,r.navigating=!1},function(e){throw r._previousSegment=g,r.navigating=!1,e})},e.prototype.generate=function(e,t,n){var i=e;(e=this._Injector.convertDependency(e))===Sn&&(e=i);for(var r=this,o="";!di(r)&&!r._recognizer.exists(e);)r=r.parent;if(di(r))throw new Error("Route for "+e+" does not exist.");for(var s,a=r._recognizer.generate(e,t);!di(r=r.parent);)o=(s=di(s=r._previousSegment)||"/"===s?"":s)+o;return o+a+Fi(n)},e.prototype._configureRoute=function(e){var t=this._Injector.convertDependency(e.view),n=e.alias;if(hi(n)&&(n=t),t!==Sn){e.view=t,e.alias=n,hi(n)&&(e.alias=t);var i={pattern:e.pattern,delegate:e},r=e.pattern+g,o={pattern:r,delegate:{pattern:r,view:t,alias:n}};this._recognizer.register([i],{name:n}),this._childRecognizer.register([o])}},e.prototype._addHandler=function(e,t,n,i){vi(n)&&(n="*");var r=n;if("*"!==n&&(n=this._Injector.convertDependency(n)),n===Sn&&(n=r),hi(n)||hi(t))return this;var o=i[n];ni(o)||(o=i[n]={});var s=o[t];return mi(s)||(s=o[t]=[]),s.push(e),this},e.prototype._forceNavigate=function(){var e,t=this;this._resolve;if(this.navigating)return this.finishNavigating.then(function(){return t._forceNavigate()});if(this.isRoot&&hi(this._previousUrl)){var n=this._browser.urlUtils();this._previousUrl=n.pathname,e=n.query}return hi(this._previousQuery)||(e=Oi(this._previousQuery)),this.navigate(this._previousUrl,e,!0)},e.prototype._navigateChildren=function(e,t){void 0===t&&(t=!0);var n=this._getChildRoute(e);return di(n)?this._resolve():Ei(function(i){return i.navigate(n,e.query,void 0,t)},this.children).then(Kn)},e.prototype._getChildRoute=function(e){if(!di(e)){var t=e.parameters.childRoute;return li(t)||(t=""),"/"+t}},e.prototype._performNavigation=function(e){var t=this,n=this._isSameRoute(this._nextRouteInfo);return this._performNavigateFrom(n).then(function(){if(!n)return Ei(function(t){return t.navigateTo(e)},t._ports)}).then(function(){return t._navigateChildren(e,!1)})},e.prototype._performNavigateFrom=function(e){var t=this;return Ei(function(e){return e._performNavigateFrom()},this.children).then(function(){if(!e)return Ei(function(e){return e.navigateFrom()},t._ports)}).then(Kn)},e.prototype._canNavigate=function(e,t){var n=this;void 0===t&&(t=!0);var i=this._isSameRoute(this._nextRouteInfo);return t?this._canNavigateFrom(i).then(function(t){return t?n._canNavigateTo(e,i):t}):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return n._callInterceptors(e)}).then(function(){return!0},function(){return!0})},e.prototype._canNavigateFrom=function(e){var t=this;return this._Promise.all(this.children.reduce(function(e,t){return e.concat(t._canNavigateFrom())},[])).then(Mi).then(function(n){return!n||e?[n]:Ei(function(e){return e.canNavigateFrom()},t._ports)}).then(Mi)},e.prototype._canNavigateTo=function(e,t){var n=this;return hi(this._ports)?this._resolve(!0):this._callAllHandlers(e.delegate.alias,e.parameters,e.query).then(function(){return n._callInterceptors(e)}).then(function(i){return!1===i||t?[i]:Ei(function(t){return t.canNavigateTo(e)},n._ports)}).then(Mi)},e.prototype._callAllHandlers=function(e,t,n){var i=this;return this._callHandlers(this._queryTransforms["*"],n,void 0,!0).then(function(){return i._callHandlers(i._queryTransforms[e],n,void 0,!0)}).then(function(){return i._callHandlers(i._paramTransforms["*"],t,n)}).then(function(){return i._callHandlers(i._paramTransforms[e],t,n)}).then(Kn)},e.prototype._callHandlers=function(e,t,n,i){var r=this._resolve;return ni(t)||(t={}),Ei(function(e,o){return Ti(function(e){return!0!==i&&vi(t[o])?r():r(e(t[o],t,n))},e)},e).then(Kn)},e.prototype._callInterceptors=function(e){var t=this,n=this._resolve;return Ti(function(t){return n(t(e))},this._interceptors["*"]).then(Mi).then(function(i){return i?Ei(function(t){return n(t(e))},t._interceptors[e.delegate.alias]):[i]}).then(Mi)},e.prototype._isSameRoute=function(e){var t=ti(this.currentRouteInfo,!0);if(e=ti(e,!0),this._sanitizeRouteInfo(t),this._sanitizeRouteInfo(e),!ni(t)||!ni(e))return!1;var n=t.delegate,i=e.delegate,r=Fi(t.parameters),o=Fi(e.parameters),s=Fi(t.query),a=Fi(e.query);return n.view===i.view&&n.alias===i.alias&&n.pattern===i.pattern&&r===o&&(s===a||this.children.length>0)},e.prototype._sanitizeRouteInfo=function(e){if(ni(e)&&e.parameters.hasOwnProperty("childRoute")){var t=e.delegate,n=t.pattern;t.pattern=n.slice(0,n.length-y),Li(e.parameters,"childRoute")}},e.prototype._clearInfo=function(){this._previousSegment=void 0,this._previousPattern=void 0,this._previousUrl=void 0,this._previousQuery=void 0,this.currentRouteInfo=void 0,this.navigating=!1,Ci(function(e){e._clearInfo()},this.children)},e._inject={_Promise:f,_Injector:oe,_EventManager:b,_browser:Q,_browserConfig:Y,_recognizer:re,_childRecognizer:re},e}();function x(){return C}e.Router=C,sr.injectable("$Router",C,null,bn),e.IRouterStatic=x,sr.injectable(W,x)}(e.routing||(e.routing={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialize=function(){var e=Ai(this.type),t=this.attributes[e];hi(t)||this._isPrecompiled()||(this._label=t,this._define(t))},t.prototype.dispose=function(){for(var e=this._label,t=this.parent;!vi(e)&&ni(t);)ni(t[e])&&oi(t[e].element)&&t[e].element===this.element&&Li(t,e),t=t.parent},t.prototype._define=function(e){var t=this.templateControl;di(t)||(t.name=e);for(var n={element:this.element,control:t},i=this.parent;ni(i);){ni(i[e])||(i[e]=n),i=i.parent}},t.prototype._isPrecompiled=function(){for(var e=this.parent;!di(e);){if(-1!==e.type.indexOf(En))return!0;e=e.parent}return!1},t}(Dr);e.Name=t,sr.control(ve,t);var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._aliases=[],t}return __extends(t,e),t.prototype.loaded=function(){di(this.element)||(this.attribute=Ai(this.type),this._setListener())},t.prototype._setListener=function(){var e=this.attributes[this.attribute];hi(this.event)||hi(e)||(this._parseArgs(e),this._addEventListeners())},t.prototype._addEventListeners=function(){this.addEventListener(this.element,this.event,this._onEvent,!1)},t.prototype._buildExpression=function(){var e,t,n,i=this.parent,r=this.templateControl,o=this._listener,s=Kn;if(di(r)?di(i)||(t=i.getResources(this._aliases),n=i.context):(t=r.getResources(this._aliases),di(i)||(n=i.context)),"@"===o[0]){if(!di(t)){var a=o.split("."),l=t[a[0].slice(1)];if(ni(l)){a.shift();for(var u=void 0;a.length>1&&!di(l[u=a.shift()]);)l=l[u];1===a.length?fi(l[u=a.shift()])&&(e=l,s=l[u]):this._log.warn('Invalid path for function "'+o+'"')}else fi(l)&&(s=l)}}else{var c=this.findProperty(o,this.templateControl);if(di(c))return this._log.warn("Could not find property "+o+" on any associated control."),{fn:Kn,context:{},args:[]};var h=c.expression.identifiers;if(h.length>1)return this._log.warn("Cannot have more than one identifier in a "+this.type+"'s expression."),{fn:Kn,context:{},args:[]};var p=h[0].split("."),_=c.control;if(p.pop(),p.length>0)for(var f=void 0;p.length>0&&!di(_[f=p.shift()]);)_=_[f];s=c.value,e=_}return{fn:s,context:e,args:di(this._args)?[]:this._args.evaluate(n,t)}},t.prototype._onEvent=function(e){var t=this._buildExpression(),n=t.fn;fi(n)?n.apply(t.context,t.args.concat(e)):this._log.warn("Cannot find registered event method "+this._listener+" for control: "+this.type)},t.prototype._parseArgs=function(e){if(!hi(e)){var t,n=this._regex.argumentRegex.exec(e),i=[];if(di(n))t=e;else if(t=e.slice(0,n.index),""!==n[1]){var r=this._parser.parse("["+n[1]+"]");i=r.aliases,this._args=r}if("@"===t[0]){var o=t.slice(1).split(".")[0];-1===i.indexOf(o)&&i.push(o)}this._listener=t,this._aliases=i}},t._inject={_parser:w,_regex:T},t}(Dr);e.SimpleEventControl=n;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=qt,t}return __extends(t,e),t}(n);e.Tap=i;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="blur",t}return __extends(t,e),t}(n);e.Blur=r;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="change",t}return __extends(t,e),t}(n);e.Change=o;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="copy",t}return __extends(t,e),t}(n);e.Copy=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="cut",t}return __extends(t,e),t}(n);e.Cut=a;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="paste",t}return __extends(t,e),t}(n);e.Paste=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Ht,t}return __extends(t,e),t}(n);e.DblTap=c;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="focus",t}return __extends(t,e),t}(n);e.Focus=h;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Qt,t}return __extends(t,e),t}(n);e.TouchStart=p;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Yt,t}return __extends(t,e),t}(n);e.TouchEnd=_;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Wt,t}return __extends(t,e),t}(n);e.TouchMove=f;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Xt,t}return __extends(t,e),t}(n);e.TouchCancel=v;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Gt,t}return __extends(t,e),t}(n);e.Hold=g;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Jt,t}return __extends(t,e),t}(n);e.Release=y;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Kt,t}return __extends(t,e),t}(n);e.Swipe=b;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=Zt,t}return __extends(t,e),t}(n);e.SwipeLeft=C;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=en,t}return __extends(t,e),t}(n);e.SwipeRight=x;var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=tn,t}return __extends(t,e),t}(n);e.SwipeUp=E;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=nn,t}return __extends(t,e),t}(n);e.SwipeDown=N;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=rn,t}return __extends(t,e),t}(n);e.Track=k;var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=on,t}return __extends(t,e),t}(n);e.TrackLeft=I;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=sn,t}return __extends(t,e),t}(n);e.TrackRight=R;var j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=an,t}return __extends(t,e),t}(n);e.TrackUp=j;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=ln,t}return __extends(t,e),t}(n);e.TrackDown=A;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event=un,t}return __extends(t,e),t}(n);e.TrackEnd=L;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="submit",t}return __extends(t,e),t.prototype._onEvent=function(t){this.element.hasAttribute("action")||t.preventDefault(),e.prototype._onEvent.call(this,t)},t}(n);e.Submit=P;var O=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.event="input",e}return __extends(n,t),n.prototype._addEventListeners=function(){var t,n=this,i=this.element,r=this._compat,o=!1,s=!1,a=function(e){o||n._onEvent(e)},l=function(e){fi(t)||(t=ki(function(){a(e),t=null}))};vi(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(e){o=!1,a(e)},!1)),this.addEventListener(i,"input",function(e){s=!0,a(e)},!1),this.addEventListener(i,"change",function(e){s?s=!1:a(e)},!1),r.hasEvent("input")||(this.addEventListener(i,"keydown",function(t){var n=t.keyCode,i=e.KeyCodes;n===i.lwk||n===i.rwk||n>=i.shift&&n<=i.escape||n>i.space&&n<=i.down||l(t)},!1),this.addEventListener(i,"cut",l,!1),this.addEventListener(i,"paste",l,!1))},n._inject={_compat:d},n}(n);e.React=O,sr.control(we,i),sr.control(Te,r),sr.control(Ne,o),sr.control(ke,s),sr.control(Se,a),sr.control(Ie,l),sr.control(Re,c),sr.control(je,h),sr.control(Ae,P),sr.control(Le,p),sr.control(Pe,_),sr.control(Oe,f),sr.control(Fe,v),sr.control(Me,g),sr.control(De,y),sr.control($e,b),sr.control(ze,C),sr.control(Be,x),sr.control(Ue,E),sr.control(Ve,N),sr.control(qe,k),sr.control(He,I),sr.control(Qe,R),sr.control(Ye,j),sr.control(We,A),sr.control(Xe,L),sr.control(Ge,O),e.KeyCodes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,"caps lock":20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,"left arrow":37,up:38,"up arrow":38,right:39,"right arrow":39,down:40,"down arrow":40,insert:45,delete:46,0:48,zero:48,")":48,"right parenthesis":48,1:49,one:49,"!":49,exclamation:49,"exclamation point":49,2:50,two:50,"@":50,at:50,3:51,three:51,"#":51,"number sign":51,hash:51,pound:51,4:52,four:52,$:52,dollar:52,"dollar sign":52,5:53,five:53,"%":53,percent:53,"percent sign":53,6:54,six:54,"^":54,caret:54,7:55,seven:55,"&":55,ampersand:55,8:56,eight:56,"*":56,asterisk:56,9:57,nine:57,"(":57,"left parenthesis":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lwk:91,"left window key":91,rwk:92,"right window key":92,select:93,"select key":93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"num lock":144,"scroll lock":145,";":186,"semi-colon":186,":":186,colon:186,"=":187,equal:187,"equal sign":187,"+":187,plus:187,",":188,comma:188,"<":188,lt:188,"less than":188,"left angle bracket":188,"-":189,dash:189,_:189,underscore:189,".":190,period:190,">":190,gt:190,"greater than":190,"right angle bracket":190,"/":191,"forward slash":191,"?":191,"question mark":191,"`":192,"grave accent":192,"~":192,tilde:192,"[":219,"open bracket":219,"{":219,"open brace":219,"\\":220,"back slash":220,"|":220,pipe:220,"]":221,"close bracket":221,"}":221,"close brace":221,"'":222,"single quote":222,'"':222,"double quote":222};var F=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.keyCodes={},e}return __extends(n,t),n.prototype._setListener=function(){var e=this.attribute;if(!hi(this.event)&&!hi(e)){var n=this.attributes[e].trim();if("{"===n[0]){var i=this.evaluateExpression(n);ni(i)||(i={method:""});var r=this._filterArgs(i);return this._setKeyCodes(r),void this.addEventListener(this.element,this.event,this._onEvent,!1)}t.prototype._setListener.call(this)}},n.prototype._filterArgs=function(e){var t=e.key,n=e.keys;return this._parseArgs(e.method),mi(n)?n:li(n)?[n]:mi(t)?t:li(t)?[t]:void(di(e.char)&&di(e.chars)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},n.prototype._onEvent=function(e){this._compareKeys(e)&&t.prototype._onEvent.call(this,e)},n.prototype._compareKeys=function(e){var t=this.keyCodes,n=e.keyCode;return(di(n)||0===n)&&(n=e.which),hi(t)||!0===t[n]},n.prototype._setKeyCodes=function(t){mi(t)||(t=[]);for(var n,i=t.length,r=this.keyCodes,o=0;o<i;o+=1)r[_i(n=t[o])?n:e.KeyCodes[n.toLowerCase()]]=!0},n}(n);e.KeyCodeEventControl=F;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,e),t}(F);e.KeyDown=M;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keydown",t}return __extends(t,e),t.prototype._onEvent=function(t){var n=this,i=t.keyCode;if((di(i)||0===i)&&(i=t.which),e.prototype._compareKeys.call(this,t)&&(i>=48&&i<=90||i>=186||i>=96&&i<=111))var r=this.addEventListener(this.element,"keypress",function(t){r(),e.prototype._onEvent.call(n,t)},!1)},t.prototype._compareKeys=function(e){return!0},t}(F);e.KeyPress=D;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keyup",t}return __extends(t,e),t}(F);e.KeyUp=$;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.event="keypress",t}return __extends(t,e),t.prototype._filterArgs=function(e){var t=e.char,n=e.chars;return this._parseArgs(e.method),mi(n)?n:li(n)?[n]:mi(t)?t:li(t)?[t]:void(di(e.key)&&di(e.keys)||this._log.warn(this.type+" should be using the property key or keys to denote key codes or keys and not char codes or characters."))},t.prototype._onEvent=function(t){var n,i=this.keyCodes,r=t.charCode;if((di(r)||0===r)&&(r=t.which),di(r)||0===r){if(!li(n=t.key))return}else n=String.fromCharCode(r);(hi(i)||!0===i[n])&&e.prototype._onEvent.call(this,t)},t.prototype._compareKeys=function(e){return!0},t.prototype._setKeyCodes=function(e){mi(e)||(e=[]);for(var t,n=e.length,i=this.keyCodes,r=0;r<n;r+=1)i[_i(t=e[r])?String.fromCharCode(t):t]=!0},t}(F);e.CharPress=z,sr.control(pe,M),sr.control(_e,D),sr.control(fe,$),sr.control(de,z);var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t._stopSetter=Kn,t}return __extends(t,e),t.prototype.loaded=function(){di(this.element)||(this.attribute=Ai(this.type),this.setter(),this.__removeListener=this.attributes.observe(this.setter,this.attribute))},t.prototype.contextChanged=function(){di(this.element)||this.setter()},t.prototype.dispose=function(){this._stopSetter(),fi(this.__removeListener)&&(this.__removeListener(),this.__removeListener=null)},t.prototype.setter=function(){var e=this;this._stopSetter(),this._stopSetter=Ri(function(){var t=e.element,n=e.property;if(oi(t))switch(e.attributes[e.attribute]){case"false":case"0":case"null":case"":t.setAttribute(n,""),t[n]=!1,t.removeAttribute(n);break;default:t.setAttribute(n,n),t[n]=!0}})},t}(Dr);e.SetAttributeControl=B;var U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="checked",t}return __extends(t,e),t}(B);e.Checked=U;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="disabled",t}return __extends(t,e),t}(B);e.Disabled=V;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="selected",t}return __extends(t,e),t}(B);e.Selected=q;var H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="readonly",t}return __extends(t,e),t}(B);e.ReadOnly=H;var Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="display",t.value="none",t.importance="important",t._initialValue="",t}return __extends(t,e),t.prototype.initialize=function(){var e=this.element.style;ni(e)||(e={getPropertyValue:Kn});var t=e.getPropertyValue(this.property);this._setValue(this.value,this.importance),hi(t)||"none"===t||(this._initialValue=t)},t.prototype.setter=function(){var e=this;this._stopSetter(),this._stopSetter=Ri(function(){if(oi(e.element))switch(e.attributes[e.attribute]){case"false":case"0":case"null":case"":e._setValue(e.value,e.importance);break;default:e._setValue(e._initialValue)}})},t.prototype._setValue=function(e,t){var n=this.property,i=this.element.style;ni(i)||(i={setProperty:Kn,removeProperty:Kn,getPropertyValue:Kn,getPropertyPriority:Kn});var r=i.getPropertyValue(n),o=i.getPropertyPriority(n);e===r&&t===o||(hi(e)?i.removeProperty(n):i.setProperty(n,e,t))},t}(B);e.Visible=Y;var W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="style",t._styleRegex=/(.*?):(.*)/,t._urlRegex=/url\([^\)]*\)/gi,t._urlReplace="[PLAT-STYLE-URL]",t.__addedStyles=[],t.__oldStyles={},t}return __extends(t,e),t.prototype.setter=function(){var e=this;this._stopSetter();var t=this.element,n=this.attributes[this.attribute];hi(n)||di(t)||(this._stopSetter=Ri(function(){var i=[],r=e._urlReplace;n=n.replace(e._urlRegex,function(e){return i.push(e),r});var o,s,a,l,u=t.style,c=e.__addedStyles,h=e.__oldStyles,p=[],_=n.split(";"),f={},d=e._styleRegex,v=_.length;for(l=0;l<v;l+=1)di(a=d.exec(_[l]))||a.length<3||0===(o=a[1].trim()).length||vi(u[o])||(-1===c.indexOf(o)&&(h[o]=u[o]),p.push(o),s=a[2].trim(),i.length>0&&-1!==s.indexOf(r)&&(s=s.replace(r,i.shift())),f[o]=s);for(v=c.length;v>0;)o=c[v-=1],-1===p.indexOf(o)&&(f[o]=h[o],c.splice(v,1));var m=Object.keys(f);for(v=m.length;v>0;)u[o=m[v-=1]]=f[o];e.__addedStyles=c.concat(p)}))},t}(B);e.Style=W,sr.control(ge,U),sr.control(ye,V),sr.control(be,q),sr.control(Ce,H),sr.control(xe,Y),sr.control(Ee,W);var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];hi(n)||di(e)||vi(e[t])||(e[t]=n)},t}(B);e.ElementPropertyControl=X;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="href",t}return __extends(t,e),t}(X);e.Href=G;var J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="src",t}return __extends(t,e),t.prototype.setter=function(){var e=this.element,t=this.property,n=this.attributes[this.attribute];hi(n)||di(e)||vi(e[t])||(e[t]=this._browser.urlUtils(n))},t._inject={_browser:Q},t}(X);e.Src=J,sr.control(ce,G),sr.control(he,J);var K=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.priority=100,e._supportsTwoWayBinding=!1,e._dateRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])/,e._dateTimeLocalRegex=/([0-9]{4})-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])T(0[1-9]|1[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9])(?:\.([0-9]+))?)?/,e.__fileSupported=Cr(d).fileSupported,e.__fileNameRegex=Cr(T).fileNameRegex,e.__isSelf=!1,e}return __extends(n,t),n.prototype.initialize=function(){this._determineType()},n.prototype.loaded=function(){var e=this.parent;if(!di(e)&&!di(this.element)){var t=Ai(this.type),n=this._parser,i=this._expression=n.parse(this.attributes[t]),r=i.identifiers;if(1!==r.length)return this._log.warn("Only 1 identifier allowed in a "+this.type+" expression."),void(this._contextExpression=null);var o=r[0].split(".");if(this._property=o.pop(),i.aliases.length>0){var s=i.aliases[0],a=e.findResource(s),l=void 0;if(ni(a)){if((l=a.resource.type)!==Rn&&l!==Pn)return}else a={resource:{}};s===Dn||s===Fn?this._contextExpression=n.parse(o.join(".")):(this._property="value",this._contextExpression={evaluate:function(){return a.resource},aliases:[],identifiers:[],expression:""})}else o.length>0?this._contextExpression=n.parse(o.join(".")):this._contextExpression={evaluate:function(){return e.context},aliases:[],identifiers:[],expression:""};this._supportsTwoWayBinding&&this.templateControl.observeProperties(this),this._watchExpression(),di(this._addEventType)||this._addEventType()}},n.prototype.contextChanged=function(){this._watchExpression()},n.prototype.dispose=function(){this._addEventType=null},n.prototype.evaluate=function(){var e=this._expression;if(!vi(e))return this.evaluateExpression(e)},n.prototype.observeProperty=function(e,t,n){return this._observeProperty(e,t,n)},n.prototype.observeArrayChange=function(e,t){return this._observeProperty(e,t,!1,!0)},n.prototype._addTextEventListener=function(){var t,n=this,i=this.element,r=this._compat,o=!1,s=function(){o||n._propertyChanged()},a=function(){fi(t)||(t=ki(function(){s(),t=null}))};vi(r.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){o=!0},!1),this.addEventListener(i,"compositionend",function(){o=!1,s()},!1)),r.hasEvent("input")?this.addEventListener(i,"input",s,!1):(this.addEventListener(i,"keydown",function(t){var n=e.KeyCodes,i=t.keyCode;(di(i)||0===i)&&(i=t.which),i===n.lwk||i===n.rwk||i>=n.shift&&i<=n.escape||i>n.space&&i<=n.down||a()},!1),this.addEventListener(i,"cut",a,!1),this.addEventListener(i,"paste",a,!1)),this.addEventListener(i,"change",s,!1)},n.prototype._addChangeEventListener=function(){this.addEventListener(this.element,"change",this._propertyChanged,!1)},n.prototype._addButtonEventListener=function(){this.addEventListener(this.element,qt,this._propertyChanged,!1)},n.prototype._addRangeEventListener=function(){var e=this.element;this._compat.hasEvent("input")&&this.addEventListener(e,"input",this._propertyChanged,!1),this.addEventListener(e,"change",this._propertyChanged,!1)},n.prototype._getChecked=function(){return this.element.checked},n.prototype._getValue=function(){return this.element.value},n.prototype._getTextContent=function(){return this.element.textContent},n.prototype._getDate=function(){var e=this.element.value,t=this._dateRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(4===n.length)return new Date(Number(n[1]),Number(n[2])-1,Number(n[3]))}return e},n.prototype._getDateTimeLocal=function(){var e=this.element.value,t=this._dateTimeLocalRegex;if("string"!==this._propertyType&&t.test(e)){var n=t.exec(e);if(8===n.length)return di(n[6])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5])):di(n[7])?new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6])):new Date(Number(n[1]),Number(n[2])-1,Number(n[3]),Number(n[4]),Number(n[5]),Number(n[6]),Number(n[7]))}return e},n.prototype._getFile=function(){var e=this.element,t=e.value;return this.__fileSupported?e.files.length>0?e.files[0]:null:{name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:Kn,msClose:Kn,slice:function(){return{}}}},n.prototype._getFiles=function(){var e=this.element;if(this.__fileSupported)return Array.prototype.slice.call(e.files);for(var t,n=e.value.split(/,|;/g),i=n.length,r=[],o=function(){return{}},s=0;s<i;s+=1)t=n[s],r.push({name:t.replace(this.__fileNameRegex,""),path:t,lastModifiedDate:void 0,type:void 0,size:void 0,msDetachStream:Kn,msClose:Kn,slice:o});return r},n.prototype._getSelectedValues=function(){for(var e,t=this.element.options,n=t.length,i=[],r=0;r<n;r+=1)(e=t[r]).selected&&i.push(e.value);return i},n.prototype._setText=function(e,t,n){if(!this.__isSelf)return di(e)&&(e="",!0===n)?(di(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setRange=function(e,t,n){if(!this.__isSelf)return hi(e)&&(e=""===e?"0":0,!0===n)?(hi(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setHidden=function(e,t,n){if(!this.__isSelf)return hi(e)&&(e="",!0===n)?(hi(this.element.value)&&this._setValue(e),void this._propertyChanged()):void this._setValue(e)},n.prototype._setValue=function(e){var t=this.element;li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)&&(this._propertyType="boolean",e=e.toString())),t.value!==e&&(t.value=e)},n.prototype._setChecked=function(e,t,n){if(!this.__isSelf)return pi(e)||(e=!!e,!0!==n)?void(this.element.checked=e):(this.element.checked=e,void this._propertyChanged())},n.prototype._setRadio=function(e){var t=this.element;this.__isSelf||(di(e)?t.checked&&this._propertyChanged():(li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)&&(this._propertyType="boolean",e=e.toString())),t.checked=t.value===e))},n.prototype._setDate=function(e,t,n){if(!this.__isSelf){if(!yi(e))return this._dateRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2);this._setValue(e.getFullYear()+"-"+r+"-"+i)}},n.prototype._setDateTimeLocal=function(e,t,n){if(!this.__isSelf){if(!yi(e))return this._dateTimeLocalRegex.test(e)?(this._propertyType="string",void this._setValue(e)):(this._setValue(""),void(!0===n&&this._propertyChanged()));var i=("0"+e.getDate()).slice(-2),r=("0"+(e.getMonth()+1)).slice(-2),o=("0"+e.getHours()).slice(-2),s=("0"+e.getMinutes()).slice(-2),a=("0"+e.getSeconds()).slice(-2),l=e.getMilliseconds();this._setValue(e.getFullYear()+"-"+r+"-"+i+"T"+o+":"+s+":"+a+"."+l)}},n.prototype._setSelectedIndex=function(e,t,n){if(!this.__isSelf){var i=this.element,r=i.value;if(di(e))return!0!==n&&this._document.body.contains(i)?void(i.selectedIndex=-1):void this._propertyChanged();if(li(e)||(_i(e)?(this._propertyType="number",e=e.toString()):pi(e)?(this._propertyType="boolean",e=e.toString()):this._log.info("Trying to bind an invalid value to a <select> element using a "+this.type+".")),r!==e){if(!this._document.body.contains(i))return i.value=e,void(i.value!==e&&(i.value=r,this._propertyChanged()));i.value=e,i.value===e&&-1!==i.selectedIndex||(i.selectedIndex=-1)}}},n.prototype._setSelectedIndices=function(e,t,n){if(!this.__isSelf){var i,r=di(e),o=this.element.options,s=di(o)?0:o.length;if(!r&&mi(e))for(var a,l,u,c=1/0;s>0;)if(a=(i=o[s-=1]).value,-1===e.indexOf(a)){l=Number(a),u=e.indexOf(l);var h=e.indexOf(!0),p=e.indexOf(!1);_i(l)&&-1!==u?(u<c&&(this._propertyType="number",c=u),i.selected=!0):"true"===a&&-1!==h||"false"===a&&-1!==p?((u=-1!==h?h:p)<c&&(this._propertyType="boolean",c=u),i.selected=!0):i.selected=!1}else i.selected=!0;else for(!0===n&&this._propertyChanged();s>0;){if(i=o[s-=1],!r&&i.value===""+e)return void(i.selected=!0);i.selected=!1}}},n.prototype._determineType=function(){if(!this._observingBindableProperty()){var e=this.element;if(!di(e))switch(e.nodeName.toLowerCase()){case"input":switch(e.type){case"button":case"submit":case"reset":case"image":this._addEventType=this._addButtonEventListener,this._getter=this._getValue;break;case"checkbox":this._addEventType=this._addChangeEventListener,this._getter=this._getChecked,this._setter=this._setChecked;break;case"radio":this._initializeRadio();break;case"range":this._addEventType=this._addRangeEventListener,this._getter=this._getValue,this._setter=this._setRange;break;case"date":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDate,this._setter=this._setDate;break;case"datetime-local":this._propertyType="nullable",this._addEventType=this._addChangeEventListener,this._getter=this._getDateTimeLocal,this._setter=this._setDateTimeLocal;break;case"file":this._propertyType="nullable";var t=e.multiple;this._addEventType=this._addChangeEventListener,this._getter=t?this._getFiles:this._getFile;break;case"hidden":this._getter=this._getValue,this._setter=this._setHidden;break;case"number":this._propertyType="number";default:this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText}break;case"textarea":this._addEventType=this._addTextEventListener,this._getter=this._getValue,this._setter=this._setText;break;case"select":this._initializeSelect();break;case"button":this._addEventType=this._addButtonEventListener,this._getter=this._getTextContent}}},n.prototype._watchExpression=function(){var e,t=this,n=this._contextExpression,i=this.evaluateExpression(n);if(!ni(i)){if(!(di(i)&&n.identifiers.length>0))return void this._log.warn("Cannot index into a non-object type: "+this.type+'="'+this._expression.expression+'"');i=this._createContext(n.identifiers[0])}if(fi(this._setter)){this._setter===this._setSelectedIndices&&(di(i[e=this._property])&&(i[e]=[]),this.observeArray(function(e){t._setter(e[0].object,null,!0)},n+"."+e));var r=this._expression;this.observeExpression(function(e,n){t._setter(e,n)},r),this._setter(this.evaluateExpression(r),void 0,!0)}},n.prototype._createContext=function(e){var t=e.split("."),n=t.shift().slice(1),i=this.parent;return n===Fn?(e=t.join("."),i=this.parent.root):n===u&&(e=t.join(".")),this._ContextManager.createContext(i,e)},n.prototype._castProperty=function(e,t){var n;if(di(t)&&(t=this._propertyType),di(t))return e;if(ni(e))if(mi(e)){var i=e.length;n=[];for(var r=0;r<i;r+=1)n.push(this._castProperty(e[r],t))}else if(yi(e)||ai(e)||ci(e)||ii(e)||oi(e))n=e;else{var o=Object.keys(e),s=void 0;for(n={};o.length>0;)n[s=o.pop()]=e[s]}else switch(t){case"string":n=li(e)?e:fi(e.toString)?e.toString():Object.prototype.toString.call(e);break;case"number":n=hi(e)?null:Number(e);break;case"boolean":switch(e){case"true":n=!0;break;case"false":case"0":case"null":case"undefined":n=!1;break;default:n=!!e}break;case"nullable":hi(e)&&(n=null);break;default:n=e}return n},n.prototype._propertyChanged=function(){if(!di(this._contextExpression)){var e=this.evaluateExpression(this._contextExpression);if(ni(e)){var t=this._property,n=this._castProperty(this._getter());e[t]!==n&&(this.__isSelf=!0,e[t]=n,this.__isSelf=!1)}}},n.prototype._initializeRadio=function(){var e=this.element;if(this._addEventType=this._addChangeEventListener,this._getter=this._getValue,this._setter=this._setRadio,!e.hasAttribute("name")){var t=Ai(this.type),n=this.attributes[t];e.setAttribute("name",n)}e.hasAttribute("value")||e.setAttribute("value","")},n.prototype._initializeSelect=function(){var e,t=this.element,n=t.multiple,i=t.options,r=i.length;this._addEventType=this._addChangeEventListener,n?(this._getter=this._getSelectedValues,this._setter=this._setSelectedIndices):(this._getter=this._getValue,this._setter=this._setSelectedIndex);for(var o=0;o<r;o+=1)(e=i[o]).hasAttribute("value")||e.setAttribute("value",e.textContent)},n.prototype._observingBindableProperty=function(){var e=this,t=this.templateControl;return!!(ni(t)&&fi(t.onInput)&&fi(t.observeProperties))&&(t.onInput(function(t){e._getter=function(){return t},e._propertyChanged()}),this._supportsTwoWayBinding=!0)},n.prototype._observeProperty=function(e,t,n,i){var r,o,s=this;if(hi(t))r=this._expression.expression;else if(_i(t))r=this._expression.expression+"."+t;else{var a=this._parser,l=a.parse(t).identifiers;if(1!==l.length)return void this._log.warn("Only 1 identifier path allowed with "+this.type);var u=(r=a.parse(this._expression.expression+"."+l[0]).identifiers[0]).split(".");u.pop();var c=u.join("."),h=this.evaluateExpression(c);if(!ni(h)){if(!di(h))return void this._log.warn("Cannot index a primitive type: "+this.type+'="'+this._expression.expression+'"');h=this._ContextManager.createContext(this.parent,c)}}if(e=e.bind(this.templateControl),n=!0===n,!0===i)o=this.observeArray(function(n){e(n,t)},r);else{o=this.observe(function(i,r){s.__isSelf||i===r||(n&&(s._propertyType=s._getPropertyType(i)),e(i,r,t))},r);var p=this.evaluateExpression(r);n&&(this._propertyType=this._getPropertyType(p)),e(p,void 0,t,!0)}return o},n.prototype._getPropertyType=function(e){return ni(e)?e:li(e)?"string":_i(e)?"number":pi(e)?"boolean":void 0},n._inject={_parser:w,_ContextManager:S,_compat:d,_document:m},n}(Dr);e.Bind=K,sr.control(ue,K);var Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="",t.priority=200,t._listeners=[],t._boundAddListener=t._addListener.bind(t),t}return __extends(t,e),t.prototype.initialize=function(){this.attribute=Ai(this.type),this._setProperty(this._getValue())},t.prototype.loaded=function(){this._observeProperty(),this._setProperty(this._getValue())},t.prototype.dispose=function(){fi(this._removeListener)&&this._removeListener(),this._listeners=[]},t.prototype._setProperty=function(e,t){var n=this.templateControl;di(n)||(this._ContextManager.defineGetter(n,this.property,{value:e,observe:this._boundAddListener},!0,!0),this._callListeners(e,t))},t.prototype._callListeners=function(e,t){for(var n=this._listeners,i=n.length,r=0;r<i;r+=1)n[r](e,t)},t.prototype._addListener=function(e){var t=this._listeners;return e=e.bind(this.templateControl),t.push(e),function(){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},t.prototype._getValue=function(){if(!di(this.templateControl))return this.evaluateExpression(this.attributes[this.attribute])},t.prototype._observeProperty=function(){di(this.templateControl)||(this._removeListener=this.observeExpression(this._setProperty,this.attributes[this.attribute]))},t._inject={_ContextManager:S},t}(Dr);e.ObservableAttributeControl=Z;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.property="options",t}return __extends(t,e),t}(Z);e.Options=ee,sr.control(me,ee)}(e.controls||(e.controls={}));var zr=function(){function e(){this.uid=ji(le),this._log=e._log,(this.navigator=Cr(k)).initialize(Cr(W).currentRouter())}return e.start=function(){if(e._compat.isCompatible){e.__addPlatCss();var t=e._EventManager;t.dispose(In),t.on(In,xt,e.__ready),t.on(In,Tt,e.__shutdown),t.initialize()}else e._log.error(new Error("PlatypusTS only supports modern browsers where Object.defineProperty is defined"))},e.registerApp=function(t){!di(e.app)&&li(e.app.uid)&&e._EventManager.dispose(e.app.uid),e.__injector=t},e.load=function(t){var n=e._LifecycleEvent,i=e._compiler,r=e._document.body,o=e._document.head;return n.dispatch(kt,e),di(t)?(r.setAttribute(Pt,""),void ki(function(){i.compile([o]),i.compile([r]),r.removeAttribute(Pt)})):fi(t.setAttribute)?(t.setAttribute(Pt,""),void ki(function(){i.compile([t]),t.removeAttribute(Pt)})):void ki(function(){i.compile([t])})},e.__ready=function(t){ar.Injector.initialize(),e.__registerAppEvents(t),t.defaultPrevented||e.load()},e.__shutdown=function(){var t=navigator.app,n=e._LifecycleEvent;if(!di(t)&&fi(t.exitApp)){if(n.dispatch(Nt,e).defaultPrevented)return;t.exitApp()}},e.__registerAppEvents=function(t){var n=e.__injector;if(!di(n)&&fi(n.inject)){var i=e.app=n.inject();i.on(Et,i.suspend),i.on("resume",i.resume),i.on("online",i.online),i.on(wt,i.offline),i.on("error",i.error),i.on(Nt,i.exiting),fi(i.ready)&&i.ready(t)}},e.__addPlatCss=function(){var t=e._document;if(!e._compat.platCss)if(!di(t.styleSheets)&&t.styleSheets.length>0)t.styleSheets[0].insertRule("[plat-hide] { display: none !important; }",0);else{var n=document.createElement("style");n.textContent="[plat-hide] { display: none !important; }",document.head.appendChild(n)}},e.prototype.suspend=function(e){},e.prototype.resume=function(e){},e.prototype.error=function(e){},e.prototype.ready=function(e){},e.prototype.exiting=function(e){},e.prototype.online=function(e){},e.prototype.offline=function(e){},e.prototype.dispatchEvent=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=e._EventManager;ni(r)||(r=Cr(b)),r.dispatch(t,this,r.DIRECT,n)},e.prototype.on=function(t,n){var i=e._EventManager;return ni(i)||(i=Cr(b)),i.on(this.uid,t,n,this)},e.prototype.load=function(t){e.load(t)},e.prototype.exit=function(){this.dispatchEvent(Tt)},e.app=null,e}();function Br(e,t,n,i,r,o){return zr._compat=e,zr._EventManager=t,zr._document=n,zr._compiler=i,zr._LifecycleEvent=r,zr._log=o,zr}function Ur(e){return e.app}e.App=zr,e.IAppStatic=Br,sr.injectable(c,Br,[d,b,m,I,C,E],gn),e.IApp=Ur,sr.injectable("$App",Ur,[c],bn)}(plat||(plat={})),module.exports=plat;